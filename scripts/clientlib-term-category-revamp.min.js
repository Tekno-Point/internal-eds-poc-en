/*!
 * typeahead.js 0.11.1
 * https://github.com/twitter/typeahead.js
 * Copyright 2013-2015 Twitter, Inc. and other contributors; Licensed MIT
 */

(function(root, factory) {
    if (typeof define === "function" && define.amd) {
        define("bloodhound", [ "jquery" ], function(a0) {
            return root["Bloodhound"] = factory(a0);
        });
    } else if (typeof exports === "object") {
        module.exports = factory(require("jquery"));
    } else {
        root["Bloodhound"] = factory(jQuery);
    }
})(this, function($) {
    var _ = function() {
        "use strict";
        return {
            isMsie: function() {
                return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2] : false;
            },
            isBlankString: function(str) {
                return !str || /^\s*$/.test(str);
            },
            escapeRegExChars: function(str) {
                return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");
            },
            isString: function(obj) {
                return typeof obj === "string";
            },
            isNumber: function(obj) {
                return typeof obj === "number";
            },
            isArray: $.isArray,
            isFunction: $.isFunction,
            isObject: $.isPlainObject,
            isUndefined: function(obj) {
                return typeof obj === "undefined";
            },
            isElement: function(obj) {
                return !!(obj && obj.nodeType === 1);
            },
            isJQuery: function(obj) {
                return obj instanceof $;
            },
            toStr: function toStr(s) {
                return _.isUndefined(s) || s === null ? "" : s + "";
            },
            bind: $.proxy,
            each: function(collection, cb) {
                $.each(collection, reverseArgs);
                function reverseArgs(index, value) {
                    return cb(value, index);
                }
            },
            map: $.map,
            filter: $.grep,
            every: function(obj, test) {
                var result = true;
                if (!obj) {
                    return result;
                }
                $.each(obj, function(key, val) {
                    if (!(result = test.call(null, val, key, obj))) {
                        return false;
                    }
                });
                return !!result;
            },
            some: function(obj, test) {
                var result = false;
                if (!obj) {
                    return result;
                }
                $.each(obj, function(key, val) {
                    if (result = test.call(null, val, key, obj)) {
                        return false;
                    }
                });
                return !!result;
            },
            mixin: $.extend,
            identity: function(x) {
                return x;
            },
            clone: function(obj) {
                return $.extend(true, {}, obj);
            },
            getIdGenerator: function() {
                var counter = 0;
                return function() {
                    return counter++;
                };
            },
            templatify: function templatify(obj) {
                return $.isFunction(obj) ? obj : template;
                function template() {
                    return String(obj);
                }
            },
            defer: function(fn) {
                setTimeout(fn, 0);
            },
            debounce: function(func, wait, immediate) {
                var timeout, result;
                return function() {
                    var context = this, args = arguments, later, callNow;
                    later = function() {
                        timeout = null;
                        if (!immediate) {
                            result = func.apply(context, args);
                        }
                    };
                    callNow = immediate && !timeout;
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                    if (callNow) {
                        result = func.apply(context, args);
                    }
                    return result;
                };
            },
            throttle: function(func, wait) {
                var context, args, timeout, result, previous, later;
                previous = 0;
                later = function() {
                    previous = new Date();
                    timeout = null;
                    result = func.apply(context, args);
                };
                return function() {
                    var now = new Date(), remaining = wait - (now - previous);
                    context = this;
                    args = arguments;
                    if (remaining <= 0) {
                        clearTimeout(timeout);
                        timeout = null;
                        previous = now;
                        result = func.apply(context, args);
                    } else if (!timeout) {
                        timeout = setTimeout(later, remaining);
                    }
                    return result;
                };
            },
            stringify: function(val) {
                return _.isString(val) ? val : JSON.stringify(val);
            },
            noop: function() {}
        };
    }();
    var VERSION = "0.11.1";
    var tokenizers = function() {
        "use strict";
        return {
            nonword: nonword,
            whitespace: whitespace,
            obj: {
                nonword: getObjTokenizer(nonword),
                whitespace: getObjTokenizer(whitespace)
            }
        };
        function whitespace(str) {
            str = _.toStr(str);
            return str ? str.split(/\s+/) : [];
        }
        function nonword(str) {
            str = _.toStr(str);
            return str ? str.split(/\W+/) : [];
        }
        function getObjTokenizer(tokenizer) {
            return function setKey(keys) {
                keys = _.isArray(keys) ? keys : [].slice.call(arguments, 0);
                return function tokenize(o) {
                    var tokens = [];
                    _.each(keys, function(k) {
                        tokens = tokens.concat(tokenizer(_.toStr(o[k])));
                    });
                    return tokens;
                };
            };
        }
    }();
    var LruCache = function() {
        "use strict";
        function LruCache(maxSize) {
            this.maxSize = _.isNumber(maxSize) ? maxSize : 100;
            this.reset();
            if (this.maxSize <= 0) {
                this.set = this.get = $.noop;
            }
        }
        _.mixin(LruCache.prototype, {
            set: function set(key, val) {
                var tailItem = this.list.tail, node;
                if (this.size >= this.maxSize) {
                    this.list.remove(tailItem);
                    delete this.hash[tailItem.key];
                    this.size--;
                }
                if (node = this.hash[key]) {
                    node.val = val;
                    this.list.moveToFront(node);
                } else {
                    node = new Node(key, val);
                    this.list.add(node);
                    this.hash[key] = node;
                    this.size++;
                }
            },
            get: function get(key) {
                var node = this.hash[key];
                if (node) {
                    this.list.moveToFront(node);
                    return node.val;
                }
            },
            reset: function reset() {
                this.size = 0;
                this.hash = {};
                this.list = new List();
            }
        });
        function List() {
            this.head = this.tail = null;
        }
        _.mixin(List.prototype, {
            add: function add(node) {
                if (this.head) {
                    node.next = this.head;
                    this.head.prev = node;
                }
                this.head = node;
                this.tail = this.tail || node;
            },
            remove: function remove(node) {
                node.prev ? node.prev.next = node.next : this.head = node.next;
                node.next ? node.next.prev = node.prev : this.tail = node.prev;
            },
            moveToFront: function(node) {
                this.remove(node);
                this.add(node);
            }
        });
        function Node(key, val) {
            this.key = key;
            this.val = val;
            this.prev = this.next = null;
        }
        return LruCache;
    }();
    var PersistentStorage = function() {
        "use strict";
        var LOCAL_STORAGE;
        try {
            LOCAL_STORAGE = window.localStorage;
            LOCAL_STORAGE.setItem("~~~", "!");
            LOCAL_STORAGE.removeItem("~~~");
        } catch (err) {
            LOCAL_STORAGE = null;
        }
        function PersistentStorage(namespace, override) {
            this.prefix = [ "__", namespace, "__" ].join("");
            this.ttlKey = "__ttl__";
            this.keyMatcher = new RegExp("^" + _.escapeRegExChars(this.prefix));
            this.ls = override || LOCAL_STORAGE;
            !this.ls && this._noop();
        }
        _.mixin(PersistentStorage.prototype, {
            _prefix: function(key) {
                return this.prefix + key;
            },
            _ttlKey: function(key) {
                return this._prefix(key) + this.ttlKey;
            },
            _noop: function() {
                this.get = this.set = this.remove = this.clear = this.isExpired = _.noop;
            },
            _safeSet: function(key, val) {
                try {
                    this.ls.setItem(key, val);
                } catch (err) {
                    if (err.name === "QuotaExceededError") {
                        this.clear();
                        this._noop();
                    }
                }
            },
            get: function(key) {
                if (this.isExpired(key)) {
                    this.remove(key);
                }
                return decode(this.ls.getItem(this._prefix(key)));
            },
            set: function(key, val, ttl) {
                if (_.isNumber(ttl)) {
                    this._safeSet(this._ttlKey(key), encode(now() + ttl));
                } else {
                    this.ls.removeItem(this._ttlKey(key));
                }
                return this._safeSet(this._prefix(key), encode(val));
            },
            remove: function(key) {
                this.ls.removeItem(this._ttlKey(key));
                this.ls.removeItem(this._prefix(key));
                return this;
            },
            clear: function() {
                var i, keys = gatherMatchingKeys(this.keyMatcher);
                for (i = keys.length; i--; ) {
                    this.remove(keys[i]);
                }
                return this;
            },
            isExpired: function(key) {
                var ttl = decode(this.ls.getItem(this._ttlKey(key)));
                return _.isNumber(ttl) && now() > ttl ? true : false;
            }
        });
        return PersistentStorage;
        function now() {
            return new Date().getTime();
        }
        function encode(val) {
            return JSON.stringify(_.isUndefined(val) ? null : val);
        }
        function decode(val) {
            return $.parseJSON(val);
        }
        function gatherMatchingKeys(keyMatcher) {
            var i, key, keys = [], len = LOCAL_STORAGE.length;
            for (i = 0; i < len; i++) {
                if ((key = LOCAL_STORAGE.key(i)).match(keyMatcher)) {
                    keys.push(key.replace(keyMatcher, ""));
                }
            }
            return keys;
        }
    }();
    var Transport = function() {
        "use strict";
        var pendingRequestsCount = 0, pendingRequests = {}, maxPendingRequests = 6, sharedCache = new LruCache(10);
        function Transport(o) {
            o = o || {};
            this.cancelled = false;
            this.lastReq = null;
            this._send = o.transport;
            this._get = o.limiter ? o.limiter(this._get) : this._get;
            this._cache = o.cache === false ? new LruCache(0) : sharedCache;
        }
        Transport.setMaxPendingRequests = function setMaxPendingRequests(num) {
            maxPendingRequests = num;
        };
        Transport.resetCache = function resetCache() {
            sharedCache.reset();
        };
        _.mixin(Transport.prototype, {
            _fingerprint: function fingerprint(o) {
                o = o || {};
                return o.url + o.type + $.param(o.data || {});
            },
            _get: function(o, cb) {
                var that = this, fingerprint, jqXhr;
                fingerprint = this._fingerprint(o);
                if (this.cancelled || fingerprint !== this.lastReq) {
                    return;
                }
                if (jqXhr = pendingRequests[fingerprint]) {
                    jqXhr.done(done).fail(fail);
                } else if (pendingRequestsCount < maxPendingRequests) {
                    pendingRequestsCount++;
                    pendingRequests[fingerprint] = this._send(o).done(done).fail(fail).always(always);
                } else {
                    this.onDeckRequestArgs = [].slice.call(arguments, 0);
                }
                function done(resp) {
                    cb(null, resp);
                    that._cache.set(fingerprint, resp);
                }
                function fail() {
                    cb(true);
                }
                function always() {
                    pendingRequestsCount--;
                    delete pendingRequests[fingerprint];
                    if (that.onDeckRequestArgs) {
                        that._get.apply(that, that.onDeckRequestArgs);
                        that.onDeckRequestArgs = null;
                    }
                }
            },
            get: function(o, cb) {
                var resp, fingerprint;
                cb = cb || $.noop;
                o = _.isString(o) ? {
                    url: o
                } : o || {};
                fingerprint = this._fingerprint(o);
                this.cancelled = false;
                this.lastReq = fingerprint;
                if (resp = this._cache.get(fingerprint)) {
                    cb(null, resp);
                } else {
                    this._get(o, cb);
                }
            },
            cancel: function() {
                this.cancelled = true;
            }
        });
        return Transport;
    }();
    var SearchIndex = window.SearchIndex = function() {
        "use strict";
        var CHILDREN = "c", IDS = "i";
        function SearchIndex(o) {
            o = o || {};
            if (!o.datumTokenizer || !o.queryTokenizer) {
                $.error("datumTokenizer and queryTokenizer are both required");
            }
            this.identify = o.identify || _.stringify;
            this.datumTokenizer = o.datumTokenizer;
            this.queryTokenizer = o.queryTokenizer;
            this.reset();
        }
        _.mixin(SearchIndex.prototype, {
            bootstrap: function bootstrap(o) {
                this.datums = o.datums;
                this.trie = o.trie;
            },
            add: function(data) {
                var that = this;
                data = _.isArray(data) ? data : [ data ];
                _.each(data, function(datum) {
                    var id, tokens;
                    that.datums[id = that.identify(datum)] = datum;
                    tokens = normalizeTokens(that.datumTokenizer(datum));
                    _.each(tokens, function(token) {
                        var node, chars, ch;
                        node = that.trie;
                        chars = token.split("");
                        while (ch = chars.shift()) {
                            node = node[CHILDREN][ch] || (node[CHILDREN][ch] = newNode());
                            node[IDS].push(id);
                        }
                    });
                });
            },
            get: function get(ids) {
                var that = this;
                return _.map(ids, function(id) {
                    return that.datums[id];
                });
            },
            search: function search(query) {
                var that = this, tokens, matches;
                tokens = normalizeTokens(this.queryTokenizer(query));
                _.each(tokens, function(token) {
                    var node, chars, ch, ids;
                    if (matches && matches.length === 0) {
                        return false;
                    }
                    node = that.trie;
                    chars = token.split("");
                    while (node && (ch = chars.shift())) {
                        node = node[CHILDREN][ch];
                    }
                    if (node && chars.length === 0) {
                        ids = node[IDS].slice(0);
                        matches = matches ? getIntersection(matches, ids) : ids;
                    } else {
                        matches = [];
                        return false;
                    }
                });
                return matches ? _.map(unique(matches), function(id) {
                    return that.datums[id];
                }) : [];
            },
            all: function all() {
                var values = [];
                for (var key in this.datums) {
                    values.push(this.datums[key]);
                }
                return values;
            },
            reset: function reset() {
                this.datums = {};
                this.trie = newNode();
            },
            serialize: function serialize() {
                return {
                    datums: this.datums,
                    trie: this.trie
                };
            }
        });
        return SearchIndex;
        function normalizeTokens(tokens) {
            tokens = _.filter(tokens, function(token) {
                return !!token;
            });
            tokens = _.map(tokens, function(token) {
                return token.toLowerCase();
            });
            return tokens;
        }
        function newNode() {
            var node = {};
            node[IDS] = [];
            node[CHILDREN] = {};
            return node;
        }
        function unique(array) {
            var seen = {}, uniques = [];
            for (var i = 0, len = array.length; i < len; i++) {
                if (!seen[array[i]]) {
                    seen[array[i]] = true;
                    uniques.push(array[i]);
                }
            }
            return uniques;
        }
        function getIntersection(arrayA, arrayB) {
            var ai = 0, bi = 0, intersection = [];
            arrayA = arrayA.sort();
            arrayB = arrayB.sort();
            var lenArrayA = arrayA.length, lenArrayB = arrayB.length;
            while (ai < lenArrayA && bi < lenArrayB) {
                if (arrayA[ai] < arrayB[bi]) {
                    ai++;
                } else if (arrayA[ai] > arrayB[bi]) {
                    bi++;
                } else {
                    intersection.push(arrayA[ai]);
                    ai++;
                    bi++;
                }
            }
            return intersection;
        }
    }();
    var Prefetch = function() {
        "use strict";
        var keys;
        keys = {
            data: "data",
            protocol: "protocol",
            thumbprint: "thumbprint"
        };
        function Prefetch(o) {
            this.url = o.url;
            this.ttl = o.ttl;
            this.cache = o.cache;
            this.prepare = o.prepare;
            this.transform = o.transform;
            this.transport = o.transport;
            this.thumbprint = o.thumbprint;
            this.storage = new PersistentStorage(o.cacheKey);
        }
        _.mixin(Prefetch.prototype, {
            _settings: function settings() {
                return {
                    url: this.url,
                    type: "GET",
                    dataType: "json"
                };
            },
            store: function store(data) {
                if (!this.cache) {
                    return;
                }
                this.storage.set(keys.data, data, this.ttl);
                this.storage.set(keys.protocol, location.protocol, this.ttl);
                this.storage.set(keys.thumbprint, this.thumbprint, this.ttl);
            },
            fromCache: function fromCache() {
                var stored = {}, isExpired;
                if (!this.cache) {
                    return null;
                }
                stored.data = this.storage.get(keys.data);
                stored.protocol = this.storage.get(keys.protocol);
                stored.thumbprint = this.storage.get(keys.thumbprint);
                isExpired = stored.thumbprint !== this.thumbprint || stored.protocol !== location.protocol;
                return stored.data && !isExpired ? stored.data : null;
            },
            fromNetwork: function(cb) {
                var that = this, settings;
                if (!cb) {
                    return;
                }
                settings = this.prepare(this._settings());
                this.transport(settings).fail(onError).done(onResponse);
                function onError() {
                    cb(true);
                }
                function onResponse(resp) {
                    cb(null, that.transform(resp));
                }
            },
            clear: function clear() {
                this.storage.clear();
                return this;
            }
        });
        return Prefetch;
    }();
    var Remote = function() {
        "use strict";
        function Remote(o) {
            this.url = o.url;
            this.prepare = o.prepare;
            this.transform = o.transform;
            this.transport = new Transport({
                cache: o.cache,
                limiter: o.limiter,
                transport: o.transport
            });
        }
        _.mixin(Remote.prototype, {
            _settings: function settings() {
                return {
                    url: this.url,
                    type: "GET",
                    dataType: "json"
                };
            },
            get: function get(query, cb) {
                var that = this, settings;
                if (!cb) {
                    return;
                }
                query = query || "";
                settings = this.prepare(query, this._settings());
                return this.transport.get(settings, onResponse);
                function onResponse(err, resp) {
                    err ? cb([]) : cb(that.transform(resp));
                }
            },
            cancelLastRequest: function cancelLastRequest() {
                this.transport.cancel();
            }
        });
        return Remote;
    }();
    var oParser = function() {
        "use strict";
        return function parse(o) {
            var defaults, sorter;
            defaults = {
                initialize: true,
                identify: _.stringify,
                datumTokenizer: null,
                queryTokenizer: null,
                sufficient: 5,
                sorter: null,
                local: [],
                prefetch: null,
                remote: null
            };
            o = _.mixin(defaults, o || {});
            !o.datumTokenizer && $.error("datumTokenizer is required");
            !o.queryTokenizer && $.error("queryTokenizer is required");
            sorter = o.sorter;
            o.sorter = sorter ? function(x) {
                return x.sort(sorter);
            } : _.identity;
            o.local = _.isFunction(o.local) ? o.local() : o.local;
            o.prefetch = parsePrefetch(o.prefetch);
            o.remote = parseRemote(o.remote);
            return o;
        };
        function parsePrefetch(o) {
            var defaults;
            if (!o) {
                return null;
            }
            defaults = {
                url: null,
                ttl: 24 * 60 * 60 * 1e3,
                cache: true,
                cacheKey: null,
                thumbprint: "",
                prepare: _.identity,
                transform: _.identity,
                transport: null
            };
            o = _.isString(o) ? {
                url: o
            } : o;
            o = _.mixin(defaults, o);
            !o.url && $.error("prefetch requires url to be set");
            o.transform = o.filter || o.transform;
            o.cacheKey = o.cacheKey || o.url;
            o.thumbprint = VERSION + o.thumbprint;
            o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;
            return o;
        }
        function parseRemote(o) {
            var defaults;
            if (!o) {
                return;
            }
            defaults = {
                url: null,
                cache: true,
                prepare: null,
                replace: null,
                wildcard: null,
                limiter: null,
                rateLimitBy: "debounce",
                rateLimitWait: 300,
                transform: _.identity,
                transport: null
            };
            o = _.isString(o) ? {
                url: o
            } : o;
            o = _.mixin(defaults, o);
            !o.url && $.error("remote requires url to be set");
            o.transform = o.filter || o.transform;
            o.prepare = toRemotePrepare(o);
            o.limiter = toLimiter(o);
            o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;
            delete o.replace;
            delete o.wildcard;
            delete o.rateLimitBy;
            delete o.rateLimitWait;
            return o;
        }
        function toRemotePrepare(o) {
            var prepare, replace, wildcard;
            prepare = o.prepare;
            replace = o.replace;
            wildcard = o.wildcard;
            if (prepare) {
                return prepare;
            }
            if (replace) {
                prepare = prepareByReplace;
            } else if (o.wildcard) {
                prepare = prepareByWildcard;
            } else {
                prepare = idenityPrepare;
            }
            return prepare;
            function prepareByReplace(query, settings) {
                settings.url = replace(settings.url, query);
                return settings;
            }
            function prepareByWildcard(query, settings) {
                settings.url = settings.url.replace(wildcard, encodeURIComponent(query));
                return settings;
            }
            function idenityPrepare(query, settings) {
                return settings;
            }
        }
        function toLimiter(o) {
            var limiter, method, wait;
            limiter = o.limiter;
            method = o.rateLimitBy;
            wait = o.rateLimitWait;
            if (!limiter) {
                limiter = /^throttle$/i.test(method) ? throttle(wait) : debounce(wait);
            }
            return limiter;
            function debounce(wait) {
                return function debounce(fn) {
                    return _.debounce(fn, wait);
                };
            }
            function throttle(wait) {
                return function throttle(fn) {
                    return _.throttle(fn, wait);
                };
            }
        }
        function callbackToDeferred(fn) {
            return function wrapper(o) {
                var deferred = $.Deferred();
                fn(o, onSuccess, onError);
                return deferred;
                function onSuccess(resp) {
                    _.defer(function() {
                        deferred.resolve(resp);
                    });
                }
                function onError(err) {
                    _.defer(function() {
                        deferred.reject(err);
                    });
                }
            };
        }
    }();
    var Bloodhound = function() {
        "use strict";
        var old;
        old = window && window.Bloodhound;
        function Bloodhound(o) {
            o = oParser(o);
            this.sorter = o.sorter;
            this.identify = o.identify;
            this.sufficient = o.sufficient;
            this.local = o.local;
            this.remote = o.remote ? new Remote(o.remote) : null;
            this.prefetch = o.prefetch ? new Prefetch(o.prefetch) : null;
            this.index = new SearchIndex({
                identify: this.identify,
                datumTokenizer: o.datumTokenizer,
                queryTokenizer: o.queryTokenizer
            });
            o.initialize !== false && this.initialize();
        }
        Bloodhound.noConflict = function noConflict() {
            window && (window.Bloodhound = old);
            return Bloodhound;
        };
        Bloodhound.tokenizers = tokenizers;
        _.mixin(Bloodhound.prototype, {
            __ttAdapter: function ttAdapter() {
                var that = this;
                return this.remote ? withAsync : withoutAsync;
                function withAsync(query, sync, async) {
                    return that.search(query, sync, async);
                }
                function withoutAsync(query, sync) {
                    return that.search(query, sync);
                }
            },
            _loadPrefetch: function loadPrefetch() {
                var that = this, deferred, serialized;
                deferred = $.Deferred();
                if (!this.prefetch) {
                    deferred.resolve();
                } else if (serialized = this.prefetch.fromCache()) {
                    this.index.bootstrap(serialized);
                    deferred.resolve();
                } else {
                    this.prefetch.fromNetwork(done);
                }
                return deferred.promise();
                function done(err, data) {
                    if (err) {
                        return deferred.reject();
                    }
                    that.add(data);
                    that.prefetch.store(that.index.serialize());
                    deferred.resolve();
                }
            },
            _initialize: function initialize() {
                var that = this, deferred;
                this.clear();
                (this.initPromise = this._loadPrefetch()).done(addLocalToIndex);
                return this.initPromise;
                function addLocalToIndex() {
                    that.add(that.local);
                }
            },
            initialize: function initialize(force) {
                return !this.initPromise || force ? this._initialize() : this.initPromise;
            },
            add: function add(data) {
                this.index.add(data);
                return this;
            },
            get: function get(ids) {
                ids = _.isArray(ids) ? ids : [].slice.call(arguments);
                return this.index.get(ids);
            },
            search: function search(query, sync, async) {
                var that = this, local;
                local = this.sorter(this.index.search(query));
                sync(this.remote ? local.slice() : local);
                if (this.remote && local.length < this.sufficient) {
                    this.remote.get(query, processRemote);
                } else if (this.remote) {
                    this.remote.cancelLastRequest();
                }
                return this;
                function processRemote(remote) {
                    var nonDuplicates = [];
                    _.each(remote, function(r) {
                        !_.some(local, function(l) {
                            return that.identify(r) === that.identify(l);
                        }) && nonDuplicates.push(r);
                    });
                    async && async(nonDuplicates);
                }
            },
            all: function all() {
                return this.index.all();
            },
            clear: function clear() {
                this.index.reset();
                return this;
            },
            clearPrefetchCache: function clearPrefetchCache() {
                this.prefetch && this.prefetch.clear();
                return this;
            },
            clearRemoteCache: function clearRemoteCache() {
                Transport.resetCache();
                return this;
            },
            ttAdapter: function ttAdapter() {
                return this.__ttAdapter();
            }
        });
        return Bloodhound;
    }();
    return Bloodhound;
});

(function(root, factory) {
    if (typeof define === "function" && define.amd) {
        define("typeahead.js", [ "jquery" ], function(a0) {
            return factory(a0);
        });
    } else if (typeof exports === "object") {
        module.exports = factory(require("jquery"));
    } else {
        factory(jQuery);
    }
})(this, function($) {
    var _ = function() {
        "use strict";
        return {
            isMsie: function() {
                return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2] : false;
            },
            isBlankString: function(str) {
                return !str || /^\s*$/.test(str);
            },
            escapeRegExChars: function(str) {
                return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");
            },
            isString: function(obj) {
                return typeof obj === "string";
            },
            isNumber: function(obj) {
                return typeof obj === "number";
            },
            isArray: $.isArray,
            isFunction: $.isFunction,
            isObject: $.isPlainObject,
            isUndefined: function(obj) {
                return typeof obj === "undefined";
            },
            isElement: function(obj) {
                return !!(obj && obj.nodeType === 1);
            },
            isJQuery: function(obj) {
                return obj instanceof $;
            },
            toStr: function toStr(s) {
                return _.isUndefined(s) || s === null ? "" : s + "";
            },
            bind: $.proxy,
            each: function(collection, cb) {
                $.each(collection, reverseArgs);
                function reverseArgs(index, value) {
                    return cb(value, index);
                }
            },
            map: $.map,
            filter: $.grep,
            every: function(obj, test) {
                var result = true;
                if (!obj) {
                    return result;
                }
                $.each(obj, function(key, val) {
                    if (!(result = test.call(null, val, key, obj))) {
                        return false;
                    }
                });
                return !!result;
            },
            some: function(obj, test) {
                var result = false;
                if (!obj) {
                    return result;
                }
                $.each(obj, function(key, val) {
                    if (result = test.call(null, val, key, obj)) {
                        return false;
                    }
                });
                return !!result;
            },
            mixin: $.extend,
            identity: function(x) {
                return x;
            },
            clone: function(obj) {
                return $.extend(true, {}, obj);
            },
            getIdGenerator: function() {
                var counter = 0;
                return function() {
                    return counter++;
                };
            },
            templatify: function templatify(obj) {
                return $.isFunction(obj) ? obj : template;
                function template() {
                    return String(obj);
                }
            },
            defer: function(fn) {
                setTimeout(fn, 0);
            },
            debounce: function(func, wait, immediate) {
                var timeout, result;
                return function() {
                    var context = this, args = arguments, later, callNow;
                    later = function() {
                        timeout = null;
                        if (!immediate) {
                            result = func.apply(context, args);
                        }
                    };
                    callNow = immediate && !timeout;
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                    if (callNow) {
                        result = func.apply(context, args);
                    }
                    return result;
                };
            },
            throttle: function(func, wait) {
                var context, args, timeout, result, previous, later;
                previous = 0;
                later = function() {
                    previous = new Date();
                    timeout = null;
                    result = func.apply(context, args);
                };
                return function() {
                    var now = new Date(), remaining = wait - (now - previous);
                    context = this;
                    args = arguments;
                    if (remaining <= 0) {
                        clearTimeout(timeout);
                        timeout = null;
                        previous = now;
                        result = func.apply(context, args);
                    } else if (!timeout) {
                        timeout = setTimeout(later, remaining);
                    }
                    return result;
                };
            },
            stringify: function(val) {
                return _.isString(val) ? val : JSON.stringify(val);
            },
            noop: function() {}
        };
    }();
    var WWW = function() {
        "use strict";
        var defaultClassNames = {
            wrapper: "twitter-typeahead",
            input: "tt-input",
            hint: "tt-hint",
            menu: "tt-menu",
            dataset: "tt-dataset",
            suggestion: "tt-suggestion",
            selectable: "tt-selectable",
            empty: "tt-empty",
            open: "tt-open",
            cursor: "tt-cursor",
            highlight: "tt-highlight"
        };
        return build;
        function build(o) {
            var www, classes;
            classes = _.mixin({}, defaultClassNames, o);
            www = {
                css: buildCss(),
                classes: classes,
                html: buildHtml(classes),
                selectors: buildSelectors(classes)
            };
            return {
                css: www.css,
                html: www.html,
                classes: www.classes,
                selectors: www.selectors,
                mixin: function(o) {
                    _.mixin(o, www);
                }
            };
        }
        function buildHtml(c) {
            return {
                wrapper: '<span class="' + c.wrapper + '"></span>',
                menu: '<div class="' + c.menu + '"></div>'
            };
        }
        function buildSelectors(classes) {
            var selectors = {};
            _.each(classes, function(v, k) {
                selectors[k] = "." + v;
            });
            return selectors;
        }
        function buildCss() {
            var css = {
                wrapper: {
                    position: "relative",
                    display: "inline-block"
                },
                hint: {
                    position: "absolute",
                    top: "0",
                    left: "0",
                    borderColor: "transparent",
                    boxShadow: "none",
                    opacity: "1"
                },
                input: {
                    position: "relative",
                    verticalAlign: "top",
                    backgroundColor: "transparent"
                },
                inputWithNoHint: {
                    position: "relative",
                    verticalAlign: "top"
                },
                menu: {
                    position: "absolute",
                    top: "100%",
                    left: "0",
                    zIndex: "100",
                    display: "none"
                },
                ltr: {
                    left: "0",
                    right: "auto"
                },
                rtl: {
                    left: "auto",
                    right: " 0"
                }
            };
            if (_.isMsie()) {
                _.mixin(css.input, {
                    backgroundImage: "url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"
                });
            }
            return css;
        }
    }();
    var EventBus = function() {
        "use strict";
        var namespace, deprecationMap;
        namespace = "typeahead:";
        deprecationMap = {
            render: "rendered",
            cursorchange: "cursorchanged",
            select: "selected",
            autocomplete: "autocompleted"
        };
        function EventBus(o) {
            if (!o || !o.el) {
                $.error("EventBus initialized without el");
            }
            this.$el = $(o.el);
        }
        _.mixin(EventBus.prototype, {
            _trigger: function(type, args) {
                var $e;
                $e = $.Event(namespace + type);
                (args = args || []).unshift($e);
                this.$el.trigger.apply(this.$el, args);
                return $e;
            },
            before: function(type) {
                var args, $e;
                args = [].slice.call(arguments, 1);
                $e = this._trigger("before" + type, args);
                return $e.isDefaultPrevented();
            },
            trigger: function(type) {
                var deprecatedType;
                this._trigger(type, [].slice.call(arguments, 1));
                if (deprecatedType = deprecationMap[type]) {
                    this._trigger(deprecatedType, [].slice.call(arguments, 1));
                }
            }
        });
        return EventBus;
    }();
    var EventEmitter = function() {
        "use strict";
        var splitter = /\s+/, nextTick = getNextTick();
        return {
            onSync: onSync,
            onAsync: onAsync,
            off: off,
            trigger: trigger
        };
        function on(method, types, cb, context) {
            var type;
            if (!cb) {
                return this;
            }
            types = types.split(splitter);
            cb = context ? bindContext(cb, context) : cb;
            this._callbacks = this._callbacks || {};
            while (type = types.shift()) {
                this._callbacks[type] = this._callbacks[type] || {
                    sync: [],
                    async: []
                };
                this._callbacks[type][method].push(cb);
            }
            return this;
        }
        function onAsync(types, cb, context) {
            return on.call(this, "async", types, cb, context);
        }
        function onSync(types, cb, context) {
            return on.call(this, "sync", types, cb, context);
        }
        function off(types) {
            var type;
            if (!this._callbacks) {
                return this;
            }
            types = types.split(splitter);
            while (type = types.shift()) {
                delete this._callbacks[type];
            }
            return this;
        }
        function trigger(types) {
            var type, callbacks, args, syncFlush, asyncFlush;
            if (!this._callbacks) {
                return this;
            }
            types = types.split(splitter);
            args = [].slice.call(arguments, 1);
            while ((type = types.shift()) && (callbacks = this._callbacks[type])) {
                syncFlush = getFlush(callbacks.sync, this, [ type ].concat(args));
                asyncFlush = getFlush(callbacks.async, this, [ type ].concat(args));
                syncFlush() && nextTick(asyncFlush);
            }
            return this;
        }
        function getFlush(callbacks, context, args) {
            return flush;
            function flush() {
                var cancelled;
                for (var i = 0, len = callbacks.length; !cancelled && i < len; i += 1) {
                    cancelled = callbacks[i].apply(context, args) === false;
                }
                return !cancelled;
            }
        }
        function getNextTick() {
            var nextTickFn;
            if (window.setImmediate) {
                nextTickFn = function nextTickSetImmediate(fn) {
                    setImmediate(function() {
                        fn();
                    });
                };
            } else {
                nextTickFn = function nextTickSetTimeout(fn) {
                    setTimeout(function() {
                        fn();
                    }, 0);
                };
            }
            return nextTickFn;
        }
        function bindContext(fn, context) {
            return fn.bind ? fn.bind(context) : function() {
                fn.apply(context, [].slice.call(arguments, 0));
            };
        }
    }();
    var highlight = function(doc) {
        "use strict";
        var defaults = {
            node: null,
            pattern: null,
            tagName: "strong",
            className: null,
            wordsOnly: false,
            caseSensitive: false
        };
        return function hightlight(o) {
            var regex;
            o = _.mixin({}, defaults, o);
            if (!o.node || !o.pattern) {
                return;
            }
            o.pattern = _.isArray(o.pattern) ? o.pattern : [ o.pattern ];
            regex = getRegex(o.pattern, o.caseSensitive, o.wordsOnly);
            traverse(o.node, hightlightTextNode);
            function hightlightTextNode(textNode) {
                var match, patternNode, wrapperNode;
                if (match = regex.exec(textNode.data)) {
                    wrapperNode = doc.createElement(o.tagName);
                    o.className && (wrapperNode.className = o.className);
                    patternNode = textNode.splitText(match.index);
                    patternNode.splitText(match[0].length);
                    wrapperNode.appendChild(patternNode.cloneNode(true));
                    textNode.parentNode.replaceChild(wrapperNode, patternNode);
                }
                return !!match;
            }
            function traverse(el, hightlightTextNode) {
                var childNode, TEXT_NODE_TYPE = 3;
                for (var i = 0; i < el.childNodes.length; i++) {
                    childNode = el.childNodes[i];
                    if (childNode.nodeType === TEXT_NODE_TYPE) {
                        i += hightlightTextNode(childNode) ? 1 : 0;
                    } else {
                        traverse(childNode, hightlightTextNode);
                    }
                }
            }
        };
        function getRegex(patterns, caseSensitive, wordsOnly) {
            var escapedPatterns = [], regexStr;
            for (var i = 0, len = patterns.length; i < len; i++) {
                escapedPatterns.push(_.escapeRegExChars(patterns[i]));
            }
            regexStr = wordsOnly ? "\\b(" + escapedPatterns.join("|") + ")\\b" : "(" + escapedPatterns.join("|") + ")";
            return caseSensitive ? new RegExp(regexStr) : new RegExp(regexStr, "i");
        }
    }(window.document);
    var Input = function() {
        "use strict";
        var specialKeyCodeMap;
        specialKeyCodeMap = {
            9: "tab",
            27: "esc",
            37: "left",
            39: "right",
            13: "enter",
            38: "up",
            40: "down"
        };
        function Input(o, www) {
            o = o || {};
            if (!o.input) {
                $.error("input is missing");
            }
            www.mixin(this);
            this.$hint = $(o.hint);
            this.$input = $(o.input);
            this.query = this.$input.val();
            this.queryWhenFocused = this.hasFocus() ? this.query : null;
            this.$overflowHelper = buildOverflowHelper(this.$input);
            this._checkLanguageDirection();
            if (this.$hint.length === 0) {
                this.setHint = this.getHint = this.clearHint = this.clearHintIfInvalid = _.noop;
            }
        }
        Input.normalizeQuery = function(str) {
            return _.toStr(str).replace(/^\s*/g, "").replace(/\s{2,}/g, " ");
        };
        _.mixin(Input.prototype, EventEmitter, {
            _onBlur: function onBlur() {
                this.resetInputValue();
                this.trigger("blurred");
            },
            _onFocus: function onFocus() {
                this.queryWhenFocused = this.query;
                this.trigger("focused");
            },
            _onKeydown: function onKeydown($e) {
                var keyName = specialKeyCodeMap[$e.which || $e.keyCode];
                this._managePreventDefault(keyName, $e);
                if (keyName && this._shouldTrigger(keyName, $e)) {
                    this.trigger(keyName + "Keyed", $e);
                }
            },
            _onInput: function onInput() {
                this._setQuery(this.getInputValue());
                this.clearHintIfInvalid();
                this._checkLanguageDirection();
            },
            _managePreventDefault: function managePreventDefault(keyName, $e) {
                var preventDefault;
                switch (keyName) {
                  case "up":
                  case "down":
                    preventDefault = !withModifier($e);
                    break;

                  default:
                    preventDefault = false;
                }
                preventDefault && $e.preventDefault();
            },
            _shouldTrigger: function shouldTrigger(keyName, $e) {
                var trigger;
                switch (keyName) {
                  case "tab":
                    trigger = !withModifier($e);
                    break;

                  default:
                    trigger = true;
                }
                return trigger;
            },
            _checkLanguageDirection: function checkLanguageDirection() {
                var dir = (this.$input.css("direction") || "ltr").toLowerCase();
                if (this.dir !== dir) {
                    this.dir = dir;
                    this.$hint.attr("dir", dir);
                    this.trigger("langDirChanged", dir);
                }
            },
            _setQuery: function setQuery(val, silent) {
                var areEquivalent, hasDifferentWhitespace;
                areEquivalent = areQueriesEquivalent(val, this.query);
                hasDifferentWhitespace = areEquivalent ? this.query.length !== val.length : false;
                this.query = val;
                if (!silent && !areEquivalent) {
                    this.trigger("queryChanged", this.query);
                } else if (!silent && hasDifferentWhitespace) {
                    this.trigger("whitespaceChanged", this.query);
                }
            },
            bind: function() {
                var that = this, onBlur, onFocus, onKeydown, onInput;
                onBlur = _.bind(this._onBlur, this);
                onFocus = _.bind(this._onFocus, this);
                onKeydown = _.bind(this._onKeydown, this);
                onInput = _.bind(this._onInput, this);
                this.$input.on("blur.tt", onBlur).on("focus.tt", onFocus).on("keydown.tt", onKeydown);
                if (!_.isMsie() || _.isMsie() > 9) {
                    this.$input.on("input.tt", onInput);
                } else {
                    this.$input.on("keydown.tt keypress.tt cut.tt paste.tt", function($e) {
                        if (specialKeyCodeMap[$e.which || $e.keyCode]) {
                            return;
                        }
                        _.defer(_.bind(that._onInput, that, $e));
                    });
                }
                return this;
            },
            focus: function focus() {
                this.$input.focus();
            },
            blur: function blur() {
                this.$input.blur();
            },
            getLangDir: function getLangDir() {
                return this.dir;
            },
            getQuery: function getQuery() {
                return this.query || "";
            },
            setQuery: function setQuery(val, silent) {
                this.setInputValue(val);
                this._setQuery(val, silent);
            },
            hasQueryChangedSinceLastFocus: function hasQueryChangedSinceLastFocus() {
                return this.query !== this.queryWhenFocused;
            },
            getInputValue: function getInputValue() {
                return this.$input.val();
            },
            setInputValue: function setInputValue(value) {
                this.$input.val(value);
                this.clearHintIfInvalid();
                this._checkLanguageDirection();
            },
            resetInputValue: function resetInputValue() {
                this.setInputValue(this.query);
            },
            getHint: function getHint() {
                return this.$hint.val();
            },
            setHint: function setHint(value) {
                this.$hint.val(value);
            },
            clearHint: function clearHint() {
                this.setHint("");
            },
            clearHintIfInvalid: function clearHintIfInvalid() {
                var val, hint, valIsPrefixOfHint, isValid;
                val = this.getInputValue();
                hint = this.getHint();
                valIsPrefixOfHint = val !== hint && hint.indexOf(val) === 0;
                isValid = val !== "" && valIsPrefixOfHint && !this.hasOverflow();
                !isValid && this.clearHint();
            },
            hasFocus: function hasFocus() {
                return this.$input.is(":focus");
            },
            hasOverflow: function hasOverflow() {
                var constraint = this.$input.width() - 2;
                this.$overflowHelper.text(this.getInputValue());
                return this.$overflowHelper.width() >= constraint;
            },
            isCursorAtEnd: function() {
                var valueLength, selectionStart, range;
                valueLength = this.$input.val().length;
                selectionStart = this.$input[0].selectionStart;
                if (_.isNumber(selectionStart)) {
                    return selectionStart === valueLength;
                } else if (document.selection) {
                    range = document.selection.createRange();
                    range.moveStart("character", -valueLength);
                    return valueLength === range.text.length;
                }
                return true;
            },
            destroy: function destroy() {
                this.$hint.off(".tt");
                this.$input.off(".tt");
                this.$overflowHelper.remove();
                this.$hint = this.$input = this.$overflowHelper = $("<div>");
            }
        });
        return Input;
        function buildOverflowHelper($input) {
            return $('<pre aria-hidden="true"></pre>').css({
                position: "absolute",
                visibility: "hidden",
                whiteSpace: "pre",
                fontFamily: $input.css("font-family"),
                fontSize: $input.css("font-size"),
                fontStyle: $input.css("font-style"),
                fontVariant: $input.css("font-variant"),
                fontWeight: $input.css("font-weight"),
                wordSpacing: $input.css("word-spacing"),
                letterSpacing: $input.css("letter-spacing"),
                textIndent: $input.css("text-indent"),
                textRendering: $input.css("text-rendering"),
                textTransform: $input.css("text-transform")
            }).insertAfter($input);
        }
        function areQueriesEquivalent(a, b) {
            return Input.normalizeQuery(a) === Input.normalizeQuery(b);
        }
        function withModifier($e) {
            return $e.altKey || $e.ctrlKey || $e.metaKey || $e.shiftKey;
        }
    }();
    var Dataset = function() {
        "use strict";
        var keys, nameGenerator;
        keys = {
            val: "tt-selectable-display",
            obj: "tt-selectable-object"
        };
        nameGenerator = _.getIdGenerator();
        function Dataset(o, www) {
            o = o || {};
            o.templates = o.templates || {};
            o.templates.notFound = o.templates.notFound || o.templates.empty;
            if (!o.source) {
                $.error("missing source");
            }
            if (!o.node) {
                $.error("missing node");
            }
            if (o.name && !isValidName(o.name)) {
                $.error("invalid dataset name: " + o.name);
            }
            www.mixin(this);
            this.highlight = !!o.highlight;
            this.name = o.name || nameGenerator();
            this.limit = o.limit || 5;
            this.displayFn = getDisplayFn(o.display || o.displayKey);
            this.templates = getTemplates(o.templates, this.displayFn);
            this.source = o.source.__ttAdapter ? o.source.__ttAdapter() : o.source;
            this.async = _.isUndefined(o.async) ? this.source.length > 2 : !!o.async;
            this._resetLastSuggestion();
            this.$el = $(o.node).addClass(this.classes.dataset).addClass(this.classes.dataset + "-" + this.name);
        }
        Dataset.extractData = function extractData(el) {
            var $el = $(el);
            if ($el.data(keys.obj)) {
                return {
                    val: $el.data(keys.val) || "",
                    obj: $el.data(keys.obj) || null
                };
            }
            return null;
        };
        _.mixin(Dataset.prototype, EventEmitter, {
            _overwrite: function overwrite(query, suggestions) {
                suggestions = suggestions || [];
                if (suggestions.length) {
                    this._renderSuggestions(query, suggestions);
                } else if (this.async && this.templates.pending) {
                    this._renderPending(query);
                } else if (!this.async && this.templates.notFound) {
                    this._renderNotFound(query);
                } else {
                    this._empty();
                }
                this.trigger("rendered", this.name, suggestions, false);
            },
            _append: function append(query, suggestions) {
                suggestions = suggestions || [];
                if (suggestions.length && this.$lastSuggestion.length) {
                    this._appendSuggestions(query, suggestions);
                } else if (suggestions.length) {
                    this._renderSuggestions(query, suggestions);
                } else if (!this.$lastSuggestion.length && this.templates.notFound) {
                    this._renderNotFound(query);
                }
                this.trigger("rendered", this.name, suggestions, true);
            },
            _renderSuggestions: function renderSuggestions(query, suggestions) {
                var $fragment;
                $fragment = this._getSuggestionsFragment(query, suggestions);
                this.$lastSuggestion = $fragment.children().last();
                this.$el.html($fragment).prepend(this._getHeader(query, suggestions)).append(this._getFooter(query, suggestions));
            },
            _appendSuggestions: function appendSuggestions(query, suggestions) {
                var $fragment, $lastSuggestion;
                $fragment = this._getSuggestionsFragment(query, suggestions);
                $lastSuggestion = $fragment.children().last();
                this.$lastSuggestion.after($fragment);
                this.$lastSuggestion = $lastSuggestion;
            },
            _renderPending: function renderPending(query) {
                var template = this.templates.pending;
                this._resetLastSuggestion();
                template && this.$el.html(template({
                    query: query,
                    dataset: this.name
                }));
            },
            _renderNotFound: function renderNotFound(query) {
                var template = this.templates.notFound;
                this._resetLastSuggestion();
                template && this.$el.html(template({
                    query: query,
                    dataset: this.name
                }));
            },
            _empty: function empty() {
                this.$el.empty();
                this._resetLastSuggestion();
            },
            _getSuggestionsFragment: function getSuggestionsFragment(query, suggestions) {
                var that = this, fragment;
                fragment = document.createDocumentFragment();
                _.each(suggestions, function getSuggestionNode(suggestion) {
                    var $el, context;
                    context = that._injectQuery(query, suggestion);
                    $el = $(that.templates.suggestion(context)).data(keys.obj, suggestion).data(keys.val, that.displayFn(suggestion)).addClass(that.classes.suggestion + " " + that.classes.selectable);
                    fragment.appendChild($el[0]);
                });
                this.highlight && highlight({
                    className: this.classes.highlight,
                    node: fragment,
                    pattern: query
                });
                return $(fragment);
            },
            _getFooter: function getFooter(query, suggestions) {
                return this.templates.footer ? this.templates.footer({
                    query: query,
                    suggestions: suggestions,
                    dataset: this.name
                }) : null;
            },
            _getHeader: function getHeader(query, suggestions) {
                return this.templates.header ? this.templates.header({
                    query: query,
                    suggestions: suggestions,
                    dataset: this.name
                }) : null;
            },
            _resetLastSuggestion: function resetLastSuggestion() {
                this.$lastSuggestion = $();
            },
            _injectQuery: function injectQuery(query, obj) {
                return _.isObject(obj) ? _.mixin({
                    _query: query
                }, obj) : obj;
            },
            update: function update(query) {
                var that = this, canceled = false, syncCalled = false, rendered = 0;
                this.cancel();
                this.cancel = function cancel() {
                    canceled = true;
                    that.cancel = $.noop;
                    that.async && that.trigger("asyncCanceled", query);
                };
                this.source(query, sync, async);
                !syncCalled && sync([]);
                function sync(suggestions) {
                    if (syncCalled) {
                        return;
                    }
                    syncCalled = true;
                    suggestions = (suggestions || []).slice(0, that.limit);
                    rendered = suggestions.length;
                    that._overwrite(query, suggestions);
                    if (rendered < that.limit && that.async) {
                        that.trigger("asyncRequested", query);
                    }
                }
                function async(suggestions) {
                    suggestions = suggestions || [];
                    if (!canceled && rendered < that.limit) {
                        that.cancel = $.noop;
                        rendered += suggestions.length;
                        that._append(query, suggestions.slice(0, that.limit - rendered));
                        that.async && that.trigger("asyncReceived", query);
                    }
                }
            },
            cancel: $.noop,
            clear: function clear() {
                this._empty();
                this.cancel();
                this.trigger("cleared");
            },
            isEmpty: function isEmpty() {
                return this.$el.is(":empty");
            },
            destroy: function destroy() {
                this.$el = $("<div>");
            }
        });
        return Dataset;
        function getDisplayFn(display) {
            display = display || _.stringify;
            return _.isFunction(display) ? display : displayFn;
            function displayFn(obj) {
                return obj[display];
            }
        }
        function getTemplates(templates, displayFn) {
            return {
                notFound: templates.notFound && _.templatify(templates.notFound),
                pending: templates.pending && _.templatify(templates.pending),
                header: templates.header && _.templatify(templates.header),
                footer: templates.footer && _.templatify(templates.footer),
                suggestion: templates.suggestion || suggestionTemplate
            };
            function suggestionTemplate(context) {
                return $("<div>").text(displayFn(context));
            }
        }
        function isValidName(str) {
            return /^[_a-zA-Z0-9-]+$/.test(str);
        }
    }();
    var Menu = function() {
        "use strict";
        function Menu(o, www) {
            var that = this;
            o = o || {};
            if (!o.node) {
                $.error("node is required");
            }
            www.mixin(this);
            this.$node = $(o.node);
            this.query = null;
            this.datasets = _.map(o.datasets, initializeDataset);
            function initializeDataset(oDataset) {
                var node = that.$node.find(oDataset.node).first();
                oDataset.node = node.length ? node : $("<div>").appendTo(that.$node);
                return new Dataset(oDataset, www);
            }
        }
        _.mixin(Menu.prototype, EventEmitter, {
            _onSelectableClick: function onSelectableClick($e) {
                this.trigger("selectableClicked", $($e.currentTarget));
            },
            _onRendered: function onRendered(type, dataset, suggestions, async) {
                this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());
                this.trigger("datasetRendered", dataset, suggestions, async);
            },
            _onCleared: function onCleared() {
                this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());
                this.trigger("datasetCleared");
            },
            _propagate: function propagate() {
                this.trigger.apply(this, arguments);
            },
            _allDatasetsEmpty: function allDatasetsEmpty() {
                return _.every(this.datasets, isDatasetEmpty);
                function isDatasetEmpty(dataset) {
                    return dataset.isEmpty();
                }
            },
            _getSelectables: function getSelectables() {
                return this.$node.find(this.selectors.selectable);
            },
            _removeCursor: function _removeCursor() {
                var $selectable = this.getActiveSelectable();
                $selectable && $selectable.removeClass(this.classes.cursor);
            },
            _ensureVisible: function ensureVisible($el) {
                var elTop, elBottom, nodeScrollTop, nodeHeight;
                elTop = $el.position().top;
                elBottom = elTop + $el.outerHeight(true);
                nodeScrollTop = this.$node.scrollTop();
                nodeHeight = this.$node.height() + parseInt(this.$node.css("paddingTop"), 10) + parseInt(this.$node.css("paddingBottom"), 10);
                if (elTop < 0) {
                    this.$node.scrollTop(nodeScrollTop + elTop);
                } else if (nodeHeight < elBottom) {
                    this.$node.scrollTop(nodeScrollTop + (elBottom - nodeHeight));
                }
            },
            bind: function() {
                var that = this, onSelectableClick;
                onSelectableClick = _.bind(this._onSelectableClick, this);
                this.$node.on("click.tt", this.selectors.selectable, onSelectableClick);
                _.each(this.datasets, function(dataset) {
                    dataset.onSync("asyncRequested", that._propagate, that).onSync("asyncCanceled", that._propagate, that).onSync("asyncReceived", that._propagate, that).onSync("rendered", that._onRendered, that).onSync("cleared", that._onCleared, that);
                });
                return this;
            },
            isOpen: function isOpen() {
                return this.$node.hasClass(this.classes.open);
            },
            open: function open() {
                this.$node.addClass(this.classes.open);
            },
            close: function close() {
                this.$node.removeClass(this.classes.open);
                this._removeCursor();
            },
            setLanguageDirection: function setLanguageDirection(dir) {
                this.$node.attr("dir", dir);
            },
            selectableRelativeToCursor: function selectableRelativeToCursor(delta) {
                var $selectables, $oldCursor, oldIndex, newIndex;
                $oldCursor = this.getActiveSelectable();
                $selectables = this._getSelectables();
                oldIndex = $oldCursor ? $selectables.index($oldCursor) : -1;
                newIndex = oldIndex + delta;
                newIndex = (newIndex + 1) % ($selectables.length + 1) - 1;
                newIndex = newIndex < -1 ? $selectables.length - 1 : newIndex;
                return newIndex === -1 ? null : $selectables.eq(newIndex);
            },
            setCursor: function setCursor($selectable) {
                this._removeCursor();
                if ($selectable = $selectable && $selectable.first()) {
                    $selectable.addClass(this.classes.cursor);
                    this._ensureVisible($selectable);
                }
            },
            getSelectableData: function getSelectableData($el) {
                return $el && $el.length ? Dataset.extractData($el) : null;
            },
            getActiveSelectable: function getActiveSelectable() {
                var $selectable = this._getSelectables().filter(this.selectors.cursor).first();
                return $selectable.length ? $selectable : null;
            },
            getTopSelectable: function getTopSelectable() {
                var $selectable = this._getSelectables().first();
                return $selectable.length ? $selectable : null;
            },
            update: function update(query) {
                var isValidUpdate = query !== this.query;
                if (isValidUpdate) {
                    this.query = query;
                    _.each(this.datasets, updateDataset);
                }
                return isValidUpdate;
                function updateDataset(dataset) {
                    dataset.update(query);
                }
            },
            empty: function empty() {
                _.each(this.datasets, clearDataset);
                this.query = null;
                this.$node.addClass(this.classes.empty);
                function clearDataset(dataset) {
                    dataset.clear();
                }
            },
            destroy: function destroy() {
                this.$node.off(".tt");
                this.$node = $("<div>");
                _.each(this.datasets, destroyDataset);
                function destroyDataset(dataset) {
                    dataset.destroy();
                }
            }
        });
        return Menu;
    }();
    var DefaultMenu = function() {
        "use strict";
        var s = Menu.prototype;
        function DefaultMenu() {
            Menu.apply(this, [].slice.call(arguments, 0));
        }
        _.mixin(DefaultMenu.prototype, Menu.prototype, {
            open: function open() {
                !this._allDatasetsEmpty() && this._show();
                return s.open.apply(this, [].slice.call(arguments, 0));
            },
            close: function close() {
                this._hide();
                return s.close.apply(this, [].slice.call(arguments, 0));
            },
            _onRendered: function onRendered() {
                if (this._allDatasetsEmpty()) {
                    this._hide();
                } else {
                    this.isOpen() && this._show();
                }
                return s._onRendered.apply(this, [].slice.call(arguments, 0));
            },
            _onCleared: function onCleared() {
                if (this._allDatasetsEmpty()) {
                    this._hide();
                } else {
                    this.isOpen() && this._show();
                }
                return s._onCleared.apply(this, [].slice.call(arguments, 0));
            },
            setLanguageDirection: function setLanguageDirection(dir) {
                this.$node.css(dir === "ltr" ? this.css.ltr : this.css.rtl);
                return s.setLanguageDirection.apply(this, [].slice.call(arguments, 0));
            },
            _hide: function hide() {
                this.$node.hide();
            },
            _show: function show() {
                this.$node.css("display", "block");
            }
        });
        return DefaultMenu;
    }();
    var Typeahead = function() {
        "use strict";
        function Typeahead(o, www) {
            var onFocused, onBlurred, onEnterKeyed, onTabKeyed, onEscKeyed, onUpKeyed, onDownKeyed, onLeftKeyed, onRightKeyed, onQueryChanged, onWhitespaceChanged;
            o = o || {};
            if (!o.input) {
                $.error("missing input");
            }
            if (!o.menu) {
                $.error("missing menu");
            }
            if (!o.eventBus) {
                $.error("missing event bus");
            }
            www.mixin(this);
            this.eventBus = o.eventBus;
            this.minLength = _.isNumber(o.minLength) ? o.minLength : 1;
            this.input = o.input;
            this.menu = o.menu;
            this.enabled = true;
            this.active = false;
            this.input.hasFocus() && this.activate();
            this.dir = this.input.getLangDir();
            this._hacks();
            this.menu.bind().onSync("selectableClicked", this._onSelectableClicked, this).onSync("asyncRequested", this._onAsyncRequested, this).onSync("asyncCanceled", this._onAsyncCanceled, this).onSync("asyncReceived", this._onAsyncReceived, this).onSync("datasetRendered", this._onDatasetRendered, this).onSync("datasetCleared", this._onDatasetCleared, this);
            onFocused = c(this, "activate", "open", "_onFocused");
            onBlurred = c(this, "deactivate", "_onBlurred");
            onEnterKeyed = c(this, "isActive", "isOpen", "_onEnterKeyed");
            onTabKeyed = c(this, "isActive", "isOpen", "_onTabKeyed");
            onEscKeyed = c(this, "isActive", "_onEscKeyed");
            onUpKeyed = c(this, "isActive", "open", "_onUpKeyed");
            onDownKeyed = c(this, "isActive", "open", "_onDownKeyed");
            onLeftKeyed = c(this, "isActive", "isOpen", "_onLeftKeyed");
            onRightKeyed = c(this, "isActive", "isOpen", "_onRightKeyed");
            onQueryChanged = c(this, "_openIfActive", "_onQueryChanged");
            onWhitespaceChanged = c(this, "_openIfActive", "_onWhitespaceChanged");
            this.input.bind().onSync("focused", onFocused, this).onSync("blurred", onBlurred, this).onSync("enterKeyed", onEnterKeyed, this).onSync("tabKeyed", onTabKeyed, this).onSync("escKeyed", onEscKeyed, this).onSync("upKeyed", onUpKeyed, this).onSync("downKeyed", onDownKeyed, this).onSync("leftKeyed", onLeftKeyed, this).onSync("rightKeyed", onRightKeyed, this).onSync("queryChanged", onQueryChanged, this).onSync("whitespaceChanged", onWhitespaceChanged, this).onSync("langDirChanged", this._onLangDirChanged, this);
        }
        _.mixin(Typeahead.prototype, {
            _hacks: function hacks() {
                var $input, $menu;
                $input = this.input.$input || $("<div>");
                $menu = this.menu.$node || $("<div>");
                $input.on("blur.tt", function($e) {
                    var active, isActive, hasActive;
                    active = document.activeElement;
                    isActive = $menu.is(active);
                    hasActive = $menu.has(active).length > 0;
                    if (_.isMsie() && (isActive || hasActive)) {
                        $e.preventDefault();
                        $e.stopImmediatePropagation();
                        _.defer(function() {
                            $input.focus();
                        });
                    }
                });
                $menu.on("mousedown.tt", function($e) {
                    $e.preventDefault();
                });
            },
            _onSelectableClicked: function onSelectableClicked(type, $el) {
                this.select($el);
            },
            _onDatasetCleared: function onDatasetCleared() {
                this._updateHint();
            },
            _onDatasetRendered: function onDatasetRendered(type, dataset, suggestions, async) {
                this._updateHint();
                this.eventBus.trigger("render", suggestions, async, dataset);
            },
            _onAsyncRequested: function onAsyncRequested(type, dataset, query) {
                this.eventBus.trigger("asyncrequest", query, dataset);
            },
            _onAsyncCanceled: function onAsyncCanceled(type, dataset, query) {
                this.eventBus.trigger("asynccancel", query, dataset);
            },
            _onAsyncReceived: function onAsyncReceived(type, dataset, query) {
                this.eventBus.trigger("asyncreceive", query, dataset);
            },
            _onFocused: function onFocused() {
                this._minLengthMet() && this.menu.update(this.input.getQuery());
            },
            _onBlurred: function onBlurred() {
                if (this.input.hasQueryChangedSinceLastFocus()) {
                    this.eventBus.trigger("change", this.input.getQuery());
                }
            },
            _onEnterKeyed: function onEnterKeyed(type, $e) {
                var $selectable;
                if ($selectable = this.menu.getActiveSelectable()) {
                    this.select($selectable) && $e.preventDefault();
                }
            },
            _onTabKeyed: function onTabKeyed(type, $e) {
                var $selectable;
                if ($selectable = this.menu.getActiveSelectable()) {
                    this.select($selectable) && $e.preventDefault();
                } else if ($selectable = this.menu.getTopSelectable()) {
                    this.autocomplete($selectable) && $e.preventDefault();
                }
            },
            _onEscKeyed: function onEscKeyed() {
                this.close();
            },
            _onUpKeyed: function onUpKeyed() {
                this.moveCursor(-1);
            },
            _onDownKeyed: function onDownKeyed() {
                this.moveCursor(+1);
            },
            _onLeftKeyed: function onLeftKeyed() {
                if (this.dir === "rtl" && this.input.isCursorAtEnd()) {
                    this.autocomplete(this.menu.getTopSelectable());
                }
            },
            _onRightKeyed: function onRightKeyed() {
                if (this.dir === "ltr" && this.input.isCursorAtEnd()) {
                    this.autocomplete(this.menu.getTopSelectable());
                }
            },
            _onQueryChanged: function onQueryChanged(e, query) {
                this._minLengthMet(query) ? this.menu.update(query) : this.menu.empty();
            },
            _onWhitespaceChanged: function onWhitespaceChanged() {
                this._updateHint();
            },
            _onLangDirChanged: function onLangDirChanged(e, dir) {
                if (this.dir !== dir) {
                    this.dir = dir;
                    this.menu.setLanguageDirection(dir);
                }
            },
            _openIfActive: function openIfActive() {
                this.isActive() && this.open();
            },
            _minLengthMet: function minLengthMet(query) {
                query = _.isString(query) ? query : this.input.getQuery() || "";
                return query.length >= this.minLength;
            },
            _updateHint: function updateHint() {
                var $selectable, data, val, query, escapedQuery, frontMatchRegEx, match;
                $selectable = this.menu.getTopSelectable();
                data = this.menu.getSelectableData($selectable);
                val = this.input.getInputValue();
                if (data && !_.isBlankString(val) && !this.input.hasOverflow()) {
                    query = Input.normalizeQuery(val);
                    escapedQuery = _.escapeRegExChars(query);
                    frontMatchRegEx = new RegExp("^(?:" + escapedQuery + ")(.+$)", "i");
                    match = frontMatchRegEx.exec(data.val);
                    match && this.input.setHint(val + match[1]);
                } else {
                    this.input.clearHint();
                }
            },
            isEnabled: function isEnabled() {
                return this.enabled;
            },
            enable: function enable() {
                this.enabled = true;
            },
            disable: function disable() {
                this.enabled = false;
            },
            isActive: function isActive() {
                return this.active;
            },
            activate: function activate() {
                if (this.isActive()) {
                    return true;
                } else if (!this.isEnabled() || this.eventBus.before("active")) {
                    return false;
                } else {
                    this.active = true;
                    this.eventBus.trigger("active");
                    return true;
                }
            },
            deactivate: function deactivate() {
                if (!this.isActive()) {
                    return true;
                } else if (this.eventBus.before("idle")) {
                    return false;
                } else {
                    this.active = false;
                    this.close();
                    this.eventBus.trigger("idle");
                    return true;
                }
            },
            isOpen: function isOpen() {
                return this.menu.isOpen();
            },
            open: function open() {
                if (!this.isOpen() && !this.eventBus.before("open")) {
                    this.menu.open();
                    this._updateHint();
                    this.eventBus.trigger("open");
                }
                return this.isOpen();
            },
            close: function close() {
                if (this.isOpen() && !this.eventBus.before("close")) {
                    this.menu.close();
                    this.input.clearHint();
                    this.input.resetInputValue();
                    this.eventBus.trigger("close");
                }
                return !this.isOpen();
            },
            setVal: function setVal(val) {
                this.input.setQuery(_.toStr(val));
            },
            getVal: function getVal() {
                return this.input.getQuery();
            },
            select: function select($selectable) {
                var data = this.menu.getSelectableData($selectable);
                if (data && !this.eventBus.before("select", data.obj)) {
                    this.input.setQuery(data.val, true);
                    this.eventBus.trigger("select", data.obj);
                    this.close();
                    return true;
                }
                return false;
            },
            autocomplete: function autocomplete($selectable) {
                var query, data, isValid;
                query = this.input.getQuery();
                data = this.menu.getSelectableData($selectable);
                isValid = data && query !== data.val;
                if (isValid && !this.eventBus.before("autocomplete", data.obj)) {
                    this.input.setQuery(data.val);
                    this.eventBus.trigger("autocomplete", data.obj);
                    return true;
                }
                return false;
            },
            moveCursor: function moveCursor(delta) {
                var query, $candidate, data, payload, cancelMove;
                query = this.input.getQuery();
                $candidate = this.menu.selectableRelativeToCursor(delta);
                data = this.menu.getSelectableData($candidate);
                payload = data ? data.obj : null;
                cancelMove = this._minLengthMet() && this.menu.update(query);
                if (!cancelMove && !this.eventBus.before("cursorchange", payload)) {
                    this.menu.setCursor($candidate);
                    if (data) {
                        this.input.setInputValue(data.val);
                    } else {
                        this.input.resetInputValue();
                        this._updateHint();
                    }
                    this.eventBus.trigger("cursorchange", payload);
                    return true;
                }
                return false;
            },
            destroy: function destroy() {
                this.input.destroy();
                this.menu.destroy();
            }
        });
        return Typeahead;
        function c(ctx) {
            var methods = [].slice.call(arguments, 1);
            return function() {
                var args = [].slice.call(arguments);
                _.each(methods, function(method) {
                    return ctx[method].apply(ctx, args);
                });
            };
        }
    }();
    (function() {
        "use strict";
        var old, keys, methods;
        old = $.fn.typeahead;
        keys = {
            www: "tt-www",
            attrs: "tt-attrs",
            typeahead: "tt-typeahead"
        };
        methods = {
            initialize: function initialize(o, datasets) {
                var www;
                datasets = _.isArray(datasets) ? datasets : [].slice.call(arguments, 1);
                o = o || {};
                www = WWW(o.classNames);
                return this.each(attach);
                function attach() {
                    var $input, $wrapper, $hint, $menu, defaultHint, defaultMenu, eventBus, input, menu, typeahead, MenuConstructor;
                    _.each(datasets, function(d) {
                        d.highlight = !!o.highlight;
                    });
                    $input = $(this);
                    $wrapper = $(www.html.wrapper);
                    $hint = $elOrNull(o.hint);
                    $menu = $elOrNull(o.menu);
                    defaultHint = o.hint !== false && !$hint;
                    defaultMenu = o.menu !== false && !$menu;
                    defaultHint && ($hint = buildHintFromInput($input, www));
                    defaultMenu && ($menu = $(www.html.menu).css(www.css.menu));
                    $hint && $hint.val("");
                    $input = prepInput($input, www);
                    if (defaultHint || defaultMenu) {
                        $wrapper.css(www.css.wrapper);
                        $input.css(defaultHint ? www.css.input : www.css.inputWithNoHint);
                        $input.wrap($wrapper).parent().prepend(defaultHint ? $hint : null).append(defaultMenu ? $menu : null);
                    }
                    MenuConstructor = defaultMenu ? DefaultMenu : Menu;
                    eventBus = new EventBus({
                        el: $input
                    });
                    input = new Input({
                        hint: $hint,
                        input: $input
                    }, www);
                    menu = new MenuConstructor({
                        node: $menu,
                        datasets: datasets
                    }, www);
                    typeahead = new Typeahead({
                        input: input,
                        menu: menu,
                        eventBus: eventBus,
                        minLength: o.minLength
                    }, www);
                    $input.data(keys.www, www);
                    $input.data(keys.typeahead, typeahead);
                }
            },
            isEnabled: function isEnabled() {
                var enabled;
                ttEach(this.first(), function(t) {
                    enabled = t.isEnabled();
                });
                return enabled;
            },
            enable: function enable() {
                ttEach(this, function(t) {
                    t.enable();
                });
                return this;
            },
            disable: function disable() {
                ttEach(this, function(t) {
                    t.disable();
                });
                return this;
            },
            isActive: function isActive() {
                var active;
                ttEach(this.first(), function(t) {
                    active = t.isActive();
                });
                return active;
            },
            activate: function activate() {
                ttEach(this, function(t) {
                    t.activate();
                });
                return this;
            },
            deactivate: function deactivate() {
                ttEach(this, function(t) {
                    t.deactivate();
                });
                return this;
            },
            isOpen: function isOpen() {
                var open;
                ttEach(this.first(), function(t) {
                    open = t.isOpen();
                });
                return open;
            },
            open: function open() {
                ttEach(this, function(t) {
                    t.open();
                });
                return this;
            },
            close: function close() {
                ttEach(this, function(t) {
                    t.close();
                });
                return this;
            },
            select: function select(el) {
                var success = false, $el = $(el);
                ttEach(this.first(), function(t) {
                    success = t.select($el);
                });
                return success;
            },
            autocomplete: function autocomplete(el) {
                var success = false, $el = $(el);
                ttEach(this.first(), function(t) {
                    success = t.autocomplete($el);
                });
                return success;
            },
            moveCursor: function moveCursoe(delta) {
                var success = false;
                ttEach(this.first(), function(t) {
                    success = t.moveCursor(delta);
                });
                return success;
            },
            val: function val(newVal) {
                var query;
                if (!arguments.length) {
                    ttEach(this.first(), function(t) {
                        query = t.getVal();
                    });
                    return query;
                } else {
                    ttEach(this, function(t) {
                        t.setVal(newVal);
                    });
                    return this;
                }
            },
            destroy: function destroy() {
                ttEach(this, function(typeahead, $input) {
                    revert($input);
                    typeahead.destroy();
                });
                return this;
            }
        };
        $.fn.typeahead = function(method) {
            if (methods[method]) {
                return methods[method].apply(this, [].slice.call(arguments, 1));
            } else {
                return methods.initialize.apply(this, arguments);
            }
        };
        $.fn.typeahead.noConflict = function noConflict() {
            $.fn.typeahead = old;
            return this;
        };
        function ttEach($els, fn) {
            $els.each(function() {
                var $input = $(this), typeahead;
                (typeahead = $input.data(keys.typeahead)) && fn(typeahead, $input);
            });
        }
        function buildHintFromInput($input, www) {
            return $input.clone().addClass(www.classes.hint).removeData().css(www.css.hint).css(getBackgroundStyles($input)).prop("readonly", true).removeAttr("id name placeholder required").attr({
                autocomplete: "off",
                spellcheck: "false",
                tabindex: -1
            });
        }
        function prepInput($input, www) {
            $input.data(keys.attrs, {
                dir: $input.attr("dir"),
                autocomplete: $input.attr("autocomplete"),
                spellcheck: $input.attr("spellcheck"),
                style: $input.attr("style")
            });
            $input.addClass(www.classes.input).attr({
                autocomplete: "off",
                spellcheck: false
            });
            try {
                !$input.attr("dir") && $input.attr("dir", "auto");
            } catch (e) {}
            return $input;
        }
        function getBackgroundStyles($el) {
            return {
                backgroundAttachment: $el.css("background-attachment"),
                backgroundClip: $el.css("background-clip"),
                backgroundColor: $el.css("background-color"),
                backgroundImage: $el.css("background-image"),
                backgroundOrigin: $el.css("background-origin"),
                backgroundPosition: $el.css("background-position"),
                backgroundRepeat: $el.css("background-repeat"),
                backgroundSize: $el.css("background-size")
            };
        }
        function revert($input) {
            var www, $wrapper;
            www = $input.data(keys.www);
            $wrapper = $input.parent().filter(www.selectors.wrapper);
            _.each($input.data(keys.attrs), function(val, key) {
                _.isUndefined(val) ? $input.removeAttr(key) : $input.attr(key, val);
            });
            $input.removeData(keys.typeahead).removeData(keys.www).removeData(keys.attr).removeClass(www.classes.input);
            if ($wrapper.length) {
                $input.detach().insertAfter($wrapper);
                $wrapper.remove();
            }
        }
        function $elOrNull(obj) {
            var isValid, $el;
            isValid = _.isJQuery(obj) || _.isElement(obj);
            $el = isValid ? $(obj).first() : [];
            return $el.length ? $el : null;
        }
    })();
});

// Adobe Analytics start
var eventName, policyNo, keyPolicyNo, nri, userType;
var digitalData;
var lowerCasePageName;
adobeAnalyticsOnLoad();

// On load -page
function adobeAnalyticsOnLoad(eventName, policyNo, keyPolicyNo, nri, userType) {
    try {
    digitalData = {};
    if((window.location.href != 'https://www.hdfclife.com') && (window.location.href != 'https://www.hdfclife.com/')){
    pageName = window.location.href.split('/')[window.location.href.split('/').length - 1];
    if(pageName.includes('.')){
        lowerCasePageName = pageName.split('.')[0].replaceAll('-', ' ')
        
    } 
    else if(pageName.includes('?')){
        lowerCasePageName = pageName.split('?')[0].replaceAll('-', ' ')
    }
    else{
        lowerCasePageName = pageName.replaceAll('-', ' ')
    }

    var lowerCaseArray = lowerCasePageName.split(" ");

    for (var i = 0; i < lowerCaseArray.length; i++) {
        lowerCaseArray[i] = lowerCaseArray[i].charAt(0).toUpperCase() + lowerCaseArray[i].slice(1);
    }

    var eventName = lowerCaseArray.join(' ');
}
else{
    var eventName = 'HDFC Life Insurance Company';
}

    policyNo = policyNo ? policyNo : '';
    keyPolicyNo = keyPolicyNo ? keyPolicyNo : '';
    nri = nri ? nri : '';
    userType = userType ? userType : '';


    digitalData.policyNo = policyNo || "";
    digitalData.keyPolicyNo = keyPolicyNo || "";
    digitalData.nri = nri || "";
    digitalData.userType = userType || "";

    console.log(eventName, policyNo, keyPolicyNo, nri, userType, 'on load');
    _satellite.track("page");

    }
    catch (err) {
        console.log('err: ', err);
    }
}

// function of adobeAnalytics
function adobeAnalytics(eventName, policyNo, keyPolicyNo, nri, userType) {
    try {
        digitalData = {};
        digitalData.eventName = eventName || "";
        digitalData.policyNo = policyNo || "";
        digitalData.keyPolicyNo = keyPolicyNo || "";
        digitalData.nri = nri || "";
        digitalData.userType = userType || "";
        _satellite.track("event");
        console.log(eventName, policyNo, keyPolicyNo, nri, userType, 'click event');
          
    }
    catch (err) {
        console.log('err: ', err);
    }
}

// on click 
$(document).ready(function () {
    $('.linkAdobeAnalytics').click(function () {
        if ($(this).attr('data-eventname')) {
            eventName = $(this).attr('data-eventname');
            policyNo = policyNo ? policyNo : '';
            keyPolicyNo = keyPolicyNo ? keyPolicyNo : '';
            nri = nri ? nri : '';
            userType = userType ? userType : '';
            adobeAnalytics(eventName, policyNo, keyPolicyNo, nri, userType);
        }
    });

});

// on dropdown option select
var selectElements = document.querySelectorAll('.products-tab-select');

selectElements.forEach(function(selectElement) {
    selectElement.addEventListener('change', function() {
        var selectedOption = this.options[this.selectedIndex];
        
        if (selectedOption.getAttribute('data-eventname')) {
            var eventName = selectedOption.getAttribute('data-eventname');
            var policyNo = policyNo ? policyNo : '';
            var keyPolicyNo = keyPolicyNo ? keyPolicyNo : '';
            var nri = nri ? nri : '';
            var userType = userType ? userType : '';
            
            adobeAnalytics(eventName, policyNo, keyPolicyNo, nri, userType);
        }
    });
});
// Adobe Analytics end

// on click lemnisk tracking
$(document).ready(function () {
    $('.lemniskTrackingEventName').click(function (event) {
        try {
            // Check if the clicked element has the data-eventname attribute
            if ($(this).attr('data-eventname')) {
                event.preventDefault();
                // Get the value of data-eventname attribute
                let lemniskEventName = $(this).attr('data-eventname');
                // Get the href attribute for the redirection URL
                let redirectUrl = $(this).attr('href');
                // Check if lmSMTObj is defined and has the track function
                if (typeof lmSMTObj !== 'undefined' && typeof lmSMTObj.track === 'function') {
                    // Call the Lemnisk tracking function with the event name
                    lmSMTObj.track(lemniskEventName);
                    if (redirectUrl) {
                        setTimeout(function() {
                            window.location.href = redirectUrl;
                        }, 500);
                    }
                }
            } else {
                console.log('data-eventname attribute is missing on the clicked element');
            }
        } catch (error) {
            console.error('Error in Lemnisk tracking:', error);
        }
    });  

    // Attach blur event to the email input field
    $('.lemniskTrackingEmailInput').blur(function () {
        try {
            // Check if the email input field has the data-eventname attribute
            let lemniskEventName = $(this).attr('data-eventname');
            if (lemniskEventName) {
                // Get the value of the email input field
                let emailValue = $(this).val();

                // Check if lmSMTObj is defined and has the track function
                if (typeof lmSMTObj !== 'undefined' && typeof lmSMTObj.track === 'function') {
                    // Call the Lemnisk tracking function with the event name and email value
                    lmSMTObj.track(lemniskEventName, {}, { "email": emailValue });
                }
            }
        } catch (error) {
            console.error('Error in Lemnisk tracking:', error);
        }
    });

    // Attach click event to the talktoAdvisor button
    $('.lemniskTrackingtalktoAdvisorButton').click(function () {
        try {
            // Get the event name from the data-eventname attribute
            let lemniskEventName = $(this).attr('data-eventname');
            if (lemniskEventName) {
                // Get the category product value from the hidden input field
                let categoryProduct = $('#lemniskTrackingCategoryProduct').val();

                // Check if lmSMTObj is defined and has the track function
                if (typeof lmSMTObj !== 'undefined' && typeof lmSMTObj.track === 'function') {
                    // Call the Lemnisk tracking function with the event name and category product value
                    lmSMTObj.track(lemniskEventName, { "categoryProduct": categoryProduct });
                }
            }
        } catch (error) {
            console.error('Error in Lemnisk tracking:', error);
        }
    });

    // Handler for the scheduleCall button
    $('.lemniskTrackingscheduleCallButton').click(function () {
        try {
            // Get the event name from the data-eventname attribute
            let lemniskEventName = $(this).attr('data-eventname');
            if (lemniskEventName) {
                // Get the product value from the hidden input field
                let product = $('#lemniskTrackingProduct').val();

                // Check if lmSMTObj is defined and has the track function
                if (typeof lmSMTObj !== 'undefined' && typeof lmSMTObj.track === 'function') {
                    // Call the Lemnisk tracking function with the event name and product value
                    lmSMTObj.track(lemniskEventName, { "product": product });
                }
            }
        } catch (error) {
            console.error('Error in Lemnisk tracking:', error);
        }
    });

    // downloadsection component white btn
    try {
        $('.lemniskTrackingEventTriggerWhite').on("click", function (event) {
            if ($(this).attr('data-eventname')) {
                event.preventDefault();
                let eventName = $(this).attr('data-eventname').trim();
                let redirectUrl = $(this).attr('href');
                if (eventName) {
                    let revisedEventName = eventName.trim().toLowerCase();
                    const currentwebpage = window.location.href;
                    const currentWebPageOrigin = window.location.origin;
                    const categoryCTA = currentwebpage == currentWebPageOrigin ? "HomePage" : "product page";
                    const leadID = "";
                    const stepName = "Calculate Click";
                    if (typeof lmSMTObj !== 'undefined' && typeof lmSMTObj.track === 'function') {
                        if (revisedEventName == 'calculateclickedc2ps'.trim().toLowerCase()) {
                            let productCode = "C2PS";
                            lemniskTrackingFourField(eventName, categoryCTA, leadID, productCode, stepName);
                        }
                        if (revisedEventName == 'calculateclickedsp'.trim().toLowerCase()) {
                            let productCode = "Sanchay Plus";
                            lemniskTrackingThreeField(eventName, leadID, productCode, stepName);
                        }
                        if (redirectUrl) {
                            setTimeout(function() {
                                window.location.href = redirectUrl;
                            }, 500);
                        }
                    }
                }
            }
        });
    } catch (error) {
        console.error('An error occurred in the event handler:', error);
    }

    // downloadsection component red btn
    $('.lemniskTrackingEventTriggerRed').on("click", function (event) {
        try {
            if ($(this).attr('data-eventname')) {
                event.preventDefault();
                let eventName = $(this).attr('data-eventname').trim();
                let redirectUrl = $(this).attr('href');
                if (eventName) {
                    let revisedEventName = eventName.trim().toLowerCase();
                    const leadID = "";
                    const stepName = "Buy Now";
                    let productCode;
                    if (typeof lmSMTObj !== 'undefined' && typeof lmSMTObj.track === 'function') {
                        if (revisedEventName == 'buynowclickedsp'.trim().toLowerCase()) {
                            productCode = "Sanchay Plus";
                            lemniskTrackingThreeField(eventName, leadID, productCode, stepName);
                        }
                        if (revisedEventName == 'buynowclickedc2ps'.trim().toLowerCase()) {
                            productCode = "C2PS";
                            lemniskTrackingThreeField(eventName, leadID, productCode, stepName);
                        }
                        if (redirectUrl) {
                            setTimeout(function() {
                                window.location.href = redirectUrl;
                            }, 500);
                        }
                    }
                }
            }
        } catch (error) {
            console.error('Error in tracking event:', error);
        }
    });

    // category banner v2 
    $('.lemniskTrackingEventClickTrigger').on('click', function (e) {
        try {
            if ($(this).attr('data-eventname')) {
                e.preventDefault();
                let eventName = $(this).attr('data-eventname').trim();
                if (eventName) {
                    let revisedEventName = eventName.toLowerCase();
                    let leadID = "";
                    let productCode = "";
                    let stepName = "";
                    if (typeof lmSMTObj !== 'undefined' && typeof lmSMTObj.track === 'function') {
                        if (revisedEventName == "calculatePremiumTI".trim().toLowerCase()) {
                            productCode = "C2PS";
                            stepName = "Calculate Premium TI";
                            lemniskTrackingThreeField(eventName, leadID, productCode, stepName);
                        }
                        if (revisedEventName == "calculatePremiumSavingsPlan".trim().toLowerCase()) {
                            productCode = "Sanchay Plus";
                            stepName = "Calculate Premium SP";
                            lemniskTrackingThreeField(eventName, leadID, productCode, stepName);
                        }
                    }
                }
            }
        } catch (error) {
            console.error('An error occurred:', error);
        }
    });

    // term banner v2 calculate premium
    $('.lemniskTrackingEventNameCalPremium').on('click', function (event) {
        try {
            if ($(this).attr('data-eventname')) {
                event.preventDefault();
                let eventName = $(this).attr('data-eventname').trim();
                let redirectUrl = $(this).attr('href');
                if (eventName) {
                    let revisedEventName = eventName.toLowerCase();
                    let leadID = "";
                    let productCode = "";
                    let stepName = "";
                    if (typeof lmSMTObj !== 'undefined' && typeof lmSMTObj.track === 'function') {
                        if (revisedEventName == "calculatePremiumTI".trim().toLowerCase()) {
                            productCode = "C2PS";
                            stepName = "Calculate Premium TI";
                            lemniskTrackingThreeField(eventName, leadID, productCode, stepName);
                        }
                        if (redirectUrl) {
                            setTimeout(function() {
                                window.location.href = redirectUrl;
                            }, 500);
                        }
                    }
                }
            }
        } catch (error) {
            console.error('An error occurred:', error);
        }
    });

    $(".lemniskNameFilled").on("blur", function () {
        try {
            var eventName = $(this).data("event-name");
            if (eventName) {
                var fullName = customTrim($(this).val());
                lmSMTObj.track(eventName, {
                    "fullName": fullName
                })
            }
        } catch {
            console.log("error")
        }
    });
    $(".lemniskPhoneFilled").on("blur", function () {
        try {
            var eventName = $(this).data("event-name");
            if (eventName) {
                var phoneNumber = customTrim($(this).val());
                var countryCode = customTrim($(this).closest("form").find("input[data-id='countryCode']").val());
                lmSMTObj.track(eventName, {}, {
                    "phone": "+" + countryCode + phoneNumber
                });
            }
        } catch {
            console.log("error");
        }
    });
    
});

// Function to check if any searchString exists in the URL
function searchStringInUrl(url, searchStrings) {
    for (let searchString of searchStrings) {
        if (url.includes(searchString)) {
            return searchString;
        }
    }
    return null;
}

function isTrackingDataValid(value) {
    return value !== null && value !== undefined && value !== '';
}

// banner-form-otp & banner-form-otp-v2 cta click event
function lemniskTrackingBannerFormOtpCta(eventName, fullName, nri, leadID, product, stepName, countryPhoneCode, phone) {
    let mainObj = {};
    if (isTrackingDataValid(fullName)) mainObj.fullName = fullName;
    if (isTrackingDataValid(nri)) mainObj.NRI = nri;
    if (isTrackingDataValid(leadID)) mainObj.leadID = leadID.toString();
    if (isTrackingDataValid(product)) mainObj.product = product;
    if (isTrackingDataValid(stepName)) mainObj.stepName = stepName;
    let phoneObj = {};
    if (countryPhoneCode && phone) {
        phoneObj.phone = `+${countryPhoneCode}${phone}`;
    }
    lmSMTObj.track(eventName, mainObj, phoneObj);
}

// categoryCTA, leadID, productCode, stepName
function lemniskTrackingFourField(eventName, categoryCTA, leadID, productCode, stepName) {
    let trackingData = {};
    if (isTrackingDataValid(categoryCTA)) trackingData["categoryCTA"] = categoryCTA;
    if (isTrackingDataValid(leadID)) trackingData["leadID"] = leadID.toString();
    if (isTrackingDataValid(productCode)) trackingData["product"] = productCode;
    if (isTrackingDataValid(stepName)) trackingData["stepName"] = stepName;
    // Send tracking data
    lmSMTObj.track(eventName, trackingData);
}
// three field
function lemniskTrackingThreeField(eventName, lead, productCode, stepName) {
    let trackingData = {};
    if (isTrackingDataValid(lead)) trackingData["leadID"] = lead.toString();
    if (isTrackingDataValid(productCode)) trackingData["product"] = productCode;
    if (isTrackingDataValid(stepName)) trackingData["stepName"] = stepName;
    lmSMTObj.track(eventName, trackingData)
}
// ulip banner form cta click event 
function lemniskTrackingUlipBannerFormCta(eventName, fullName, gender, nri, dob, leadID, product, stepName, countryPhoneCode, phone, email) {
    let mainObj = {};
    if (isTrackingDataValid(fullName)) mainObj['fullName'] = fullName;
    if (isTrackingDataValid(gender)) mainObj['Gender'] = gender;
    if (isTrackingDataValid(nri)) mainObj['NRI'] = nri;
    if (isTrackingDataValid(dob)) mainObj['dob'] = dob;
    if (isTrackingDataValid(leadID)) mainObj['leadID'] = leadID.toString();
    if (isTrackingDataValid(product)) mainObj['product'] = product;
    if (isTrackingDataValid(stepName)) mainObj['stepName'] = stepName;

    let phoneObj = {};
    if (isTrackingDataValid(countryPhoneCode) && isTrackingDataValid(phone)) {
        phoneObj['phone'] = `+${countryPhoneCode}${phone}`;
    }

    if (isTrackingDataValid(email)) phoneObj['email'] = email;
    lmSMTObj.track(eventName, mainObj, phoneObj);
}

// term banner form v2
function lemniskTrackingTermBannerFormV2Cta(eventName, name, gender, dob, nri, smoker, consent, categoryProduct, leadId, product, stepName, countryCode, phone, email) {
    let mainObj = {};
    if (isTrackingDataValid(name)) mainObj['fullName'] = name;
    if (isTrackingDataValid(gender)) mainObj['Gender'] = gender;
    if (isTrackingDataValid(dob)) mainObj['dob'] = dob;
    if (isTrackingDataValid(nri)) mainObj['NRI'] = nri;
    if (isTrackingDataValid(smoker)) mainObj['Smoker'] = smoker;
    if (isTrackingDataValid(consent)) mainObj['consent'] = consent;
    if (isTrackingDataValid(categoryProduct)) mainObj['categoryProduct'] = categoryProduct;
    if (isTrackingDataValid(leadId)) mainObj['leadID'] = leadId.toString();
    if (isTrackingDataValid(product)) mainObj['product'] = product;
    if (isTrackingDataValid(stepName)) mainObj['stepName'] = stepName;

    let contactObj = {};
    if (isTrackingDataValid(countryCode) && isTrackingDataValid(phone)) {
        contactObj['phone'] = `+${countryCode}${phone}`;
    }
    if (isTrackingDataValid(email)) {
        contactObj['email'] = email;
    }

    lmSMTObj.track(eventName, mainObj, contactObj);
}
/**
 * jQuery.browser.mobile (http://detectmobilebrowser.com/)
 * jQuery.browser.mobile will be true if the browser is a mobile device
 **/



var isMobileDevice = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
var isiPad = /ipad/i.test(navigator.userAgent.toLowerCase());
var isiPhone = /iphone/i.test(navigator.userAgent.toLowerCase());
var isiPod = /ipod/i.test(navigator.userAgent.toLowerCase());
var isiDevice = /ipad|iphone|ipod/i.test(navigator.userAgent.toLowerCase());
var isAndroid = /android/i.test(navigator.userAgent.toLowerCase());
var isBlackBerry = /blackberry/i.test(navigator.userAgent.toLowerCase());
var isWebOS = /webos/i.test(navigator.userAgent.toLowerCase());
var isWindowsPhone = /windows phone/i.test(navigator.userAgent.toLowerCase());
(function ($) {

    $.fn.appTabs = function (params) {

        // merge default and user parameters
        params = $.extend({ active: 0 }, params);

        this.each(function () {
            let tabMenu = $(this).find('ul.appTabMenu');
            let tabContent = $(this).children('div');

            tabContent.each(function (index) {
                (index == params.active) ? $(this).show() : $(this).hide()
            });

            $(tabMenu).find('a').click(function (e) {
                let calprevent = $("meta[name='template']").attr("content");
                 if (calprevent == 'home-template') {
                    e.preventDefault();
                }
                else if(calprevent == 'fund-performance-page'){
                    e.preventDefault();
                }
                else if(calprevent == 'home-template22'){
                    e.preventDefault();
                }
                // var current = e.currentTarget;
                // if(!$(current).parent().parent().hasClass('annuity-mobile') ){
                let target = $(this).attr('href')
                // console.log(tabMenu.find('a'), "tabMenu bere");
                tabMenu.find('a').removeClass('active')
                $(this).addClass('active')
                tabContent.each(function (index) { $(this).hide() })
                $(target).fadeIn();
                if(window.screen.width < 768) {
                    $('.products-tab-content').hide();
                    $(`#${$(target).find(".form-select option:selected").val()}`).show();
                }
                // console.log($(this).closest('.aboutTabWrap').find('.products-tab-title-section ul li'), 'tabs li');
                // } 
            })

        });

        return this;
    };
})(jQuery);

//verticalTab
(function ($) {

    $.fn.verticalTab = function (params) {

        params = $.extend({ active: 0 }, params);

        this.each(function () {
            let self = $(this);
            let tabMenu = $(this).find('a');
            let tabContentWrap = $(this).attr('data-contentWrap');
            let tabContent = $('#' + tabContentWrap).find("[data-vid]");

            tabContent.each(function (index) {
                (index == params.active) ? $(this).show() : $(this).hide()
            });

            $(tabMenu).click(function (e) {
                e.preventDefault();
                let content = $(this).attr('href').substring(1);
                self.find('a').removeClass('active')
                $(this).addClass('active')
                $('#' + tabContentWrap).children('div').hide()
                $("[data-vid='" + content + "']").fadeIn();
            })
        });

        return this;
    };
})(jQuery);

//View More Content
(function ($) {
 
    $.fn.viewMoreCont = function (params) {

        params = $.extend({
            toggleText: ['View More', 'View Less'],
            toggleClass: 'viewLessBtn'
        }, params);

        //let iconMoreHtml = $(this).find('span').prop('outerHTML');
        let iconMoreHtml = '<span><svg width="20" height="13" viewBox="0 0 20 13" fill="none" xmlns="http://www.w3.org/2000/svg">';
        iconMoreHtml += '<rect x="0.5" y="0.5" width="19" height="12" rx="6" stroke="#ED1C24"/>'
        iconMoreHtml += '<circle cx="7.5" cy="6.5" r="1.5" fill="#ED1C24"/>'
        iconMoreHtml += '<circle cx="12.5" cy="6.5" r="1.5" fill="#ED1C24"/>'
        iconMoreHtml += '</svg></span>';

        let iconLessHtml = '<span><svg xmlns="http://www.w3.org/2000/svg" width="20" height="13" viewBox="0 0 20 13" fill="none">';
        iconLessHtml += '<rect x="0.5" y="0.5" width="19" height="12" rx="6" stroke="#ED1C24"/>';
        iconLessHtml += '<line x1="7" y1="6.5" x2="14" y2="6.5" stroke="#ED1C24" stroke-width="2" stroke-linecap="round"/>';
        iconLessHtml += '</svg></span>';

        this.each(function () {
            $(this).on('click', function (e) {
                e.preventDefault();
                let hiddenContent = $(this).attr('data-hidden');
                let viewMore = $(this).attr("data-view-text");

                // iconLessHtml = $.parseHTML(iconLessHtml)
                $(this).toggleClass(params.toggleClass);
                let viewLestTxt = iconMoreHtml ? params.toggleText[1] + iconLessHtml : params.toggleText[1] + iconMoreHtml;
                let viewMoreTxt = viewMore + iconMoreHtml;
                $(this).html($(this).hasClass(params.toggleClass) ? viewLestTxt : viewMoreTxt)
                $(this).parent().parent().find('.' + hiddenContent).slideToggle();
                if($(this).parents().hasClass('faq')){  
                        //FAQ Specific
                        if($(this).parent().parent().find('.secondQuestion').position().top < 400)
                        {
                            $('html, body').animate({
                                scrollTop: $(this).parent().parent().find('.secondQuestion').position().top + 590
                            });   
                        }else{
                            $('html, body').animate({
                                scrollTop: $(this).parent().parent().find('.secondQuestion').offset().top
                            }); 
                        }                
                }
                else if ($(this).parents().hasClass('cform')) {
                     
                       // $('html, body').animate({
                       //     scrollTop: $(this).offset().top - 10
                       // });
               }
                else{
                    $('html, body').animate({
                       scrollTop: $(this).parent().parent().find('.' + hiddenContent).offset().top - 150
                      });
                }
            //     var self = this;
            //     setTimeout(function() {
            //     theOffset = $(self).offset();
            //     $('body,html').animate({ scrollTop: theOffset.top - 250});
            // }, 310); 
            $('#download-forms-right').toggleClass("contentHide");
            })
        });
        return this;
    };
})(jQuery);


//View More Content
(function ($) {

   $.fn.viewMoreContTermPage = function (params) {
 
       params = $.extend({
           toggleText: ['View More', 'View Less'],
           toggleClass: 'viewLessBtn'
       }, params);
 
       //let iconMoreHtml = $(this).find('span').prop('outerHTML');
       let iconMoreHtml = '<span><svg width="20" height="13" viewBox="0 0 20 13" fill="none" xmlns="http://www.w3.org/2000/svg">';
       iconMoreHtml += '<rect x="0.5" y="0.5" width="19" height="12" rx="6" stroke="#ED1C24"/>'
       iconMoreHtml += '<circle cx="7.5" cy="6.5" r="1.5" fill="#ED1C24"/>'
       iconMoreHtml += '<circle cx="12.5" cy="6.5" r="1.5" fill="#ED1C24"/>'
       iconMoreHtml += '</svg></span>';
 
       let iconLessHtml = '<span><svg xmlns="http://www.w3.org/2000/svg" width="20" height="13" viewBox="0 0 20 13" fill="none">';
       iconLessHtml += '<rect x="0.5" y="0.5" width="19" height="12" rx="6" stroke="#ED1C24"/>';
       iconLessHtml += '<line x1="7" y1="6.5" x2="14" y2="6.5" stroke="#ED1C24" stroke-width="2" stroke-linecap="round"/>';
       iconLessHtml += '</svg></span>';
 
       this.each(function () {
           $(this).on('click', function (e) {
               e.preventDefault();
               let hiddenContent = $(this).attr('data-hidden');
               let viewMore = $(this).attr("data-view-text");
 
               // iconLessHtml = $.parseHTML(iconLessHtml)
               $(this).toggleClass(params.toggleClass);
               let viewLestTxt = iconMoreHtml ? params.toggleText[1] + iconLessHtml : params.toggleText[1] + iconMoreHtml;
               let viewMoreTxt = viewMore + iconMoreHtml;
               $(this).html($(this).hasClass(params.toggleClass) ? viewLestTxt : viewMoreTxt)
               $(this).parent().parent().parent().find('.' + hiddenContent).slideToggle();
               if($(this).parents().hasClass('faq')){  
                       //FAQ Specific
                       if($(this).parent().parent().find('.secondQuestion').position().top < 400)
                       {
                           $('html, body').animate({
                               scrollTop: $(this).parent().parent().find('.secondQuestion').position().top + 590
                           });   
                       }else{
                           $('html, body').animate({
                               scrollTop: $(this).parent().parent().find('.secondQuestion').position().top
                           }); 
                       }                
               }
               else if ($(this).parents().hasClass('cform')) {
                    
                      // $('html, body').animate({
                      //     scrollTop: $(this).offset().top - 10
                      // });
              }
               else{
                   $('html, body').animate({
                      scrollTop: $(this).parent().parent().parent().find('.' + hiddenContent).offset().top - 150
                     });
               }
           $('#download-forms-right').toggleClass("contentHide");
           })
       });
       return this;
   };
 })(jQuery);

//AppAccordian
(function ($) {

    $.fn.AppAccordian = function (params) {

        // merge default and user parameters
        params = $.extend({ active: 0 }, params);

        this.each(function () {
            let accordMenu = $(this).find(":header");
            let accordCont = $(this).children("div");

            //accordCont.each(function( index ) { (index == params.active) ? $(this).show() : $(this).hide() });

            $(accordMenu).find('a').click(function (e) {
                e.preventDefault();
                let self = $(this);
                let target = self.parent(":header").next('div');

                accordCont.each(function (index) {
                    $(this).not(target).slideUp();
                })
                if (!self.parent(":header").hasClass("opened")) {
                    self.parent(":header").addClass("opened")
                    target.slideDown("medium", function () {
                        $(accordMenu).not(self.parent(":header")).removeClass("opened");
                    })
                } else {
                    target.slideUp('medium', function (e) {
                        self.parent(":header").removeClass("opened");
                    });
                }
            })

        });

        return this;
    }
})(jQuery);



$(document).ready(function () {

    $('.icon-wrap').on('mouseout', function (e) {
        $('.icon-wrap').removeClass('active');
    });

    if ($(window).width() > 1024) {
        $('.icon-wrap').on('mouseover', function (e) {
            $('.icon-wrap').removeClass('active');
            $(this).addClass('active');
        });
    } else {
        $('.icon-wrap').on('click', function (e) {
            e.stopPropagation();
            if ($(this).hasClass('active')) {
                $(this).removeClass('active');
            } else {
                $('.icon-wrap').removeClass('active');
                $(this).addClass('active');
            }
        });
    }

    // $("#product-search").blur(function () {
    //     $(".product-search-autofill").css("display", "none");
    // });

    $('.custom-dropdown ul').hide();
    $('.custom-dropdown li').click(function (e) {
        //alert("xczxc");
        if ($(this).hasClass('open')) {
            $(this).removeClass('open');
            $('.custom-dropdown ul').slideUp();
        } else {
            $(this).addClass('open');
            //$('.custom-dropdown ul').slideDown();
            $(".custom-dropdown ul").slideUp();
        }
    });
    $('.custom-dropdown li').click(function (e) {
        var selValue = $(this).html();
        $('.custom-dropdown li').removeClass('active');
        $(this).addClass('active');
        $('.custom-dropdown span').html(selValue);
        $(".custom-dropdown ul").slideUp();
    });
    commonMethod();
    $('.float-contact-btn').click(function (e) {
        $(".slide-contact-info-wrap").animate({ "left": "0" }, "slow");
        e.preventDefault();
    });
    $('.close-slide-contact-info').click(function (e) {
        $(".slide-contact-info-wrap").animate({ "left": "100%" }, "slow");
        e.preventDefault();
    });


    function hideOtherDropDown(except, classRemove) {
        var popOverSec = ['.megaMenuSec', '.deskTopAccountDD', '.contactInfoPopOver', '.hamMenuWrp'];
        var classDel = (classRemove) ? classRemove : 'opened';
        var otherDropDown = popOverSec.filter(function (sec) {
            return except !== sec
        }).join();
        // console.log('otherDropDown', otherDropDown);
        // console.log('class', classDel);
        $(otherDropDown).removeClass(classDel);
    }

    //Event For Mobile Hamburger Menu
    $('.mobHamMenuLink').click(function (e) {
        e.preventDefault()
        $('.hamMenuSection').addClass('opened')

        var $hamMenus = $('.hamMenuLinks .subMenuLink')
        for (let i = 0; i < $hamMenus.length; i++) {
            if($hamMenus.eq(i).parent().find('.subMenuSection').length === 0){
                $hamMenus.eq(i).find('svg').remove();
            }         
        }
    })
    $('.hamMenuLinks .subMenuLink .menuBullet').click(function (e) {
        e.preventDefault();
        e.stopPropagation();
        
        if (e.target.tagName.toLowerCase() == 'svg') {
            e.preventDefault()
        }
        $(this).parent().siblings('.subMenuSection').addClass('opened')

        var $hamSubMenus = $('.hamMenuLinks .subMenuBC').parent().find('.hamMenuList').children('li')
        for (let i = 0; i < $hamSubMenus.length; i++) {
            if($hamSubMenus.eq(i).find('.hamSubMenu').length === 0){
                $hamSubMenus.eq(i).find('svg').remove();
            }         
        }
    })
    $('.subMenuBC > a, .closePlanMenu').click(function (e) {
        e.preventDefault();
        $(this).parents('.subMenuSection').removeClass('opened')
    })
    $('.closeHamMenu').click(function (e) {
        e.preventDefault();
        $(this).parents('.hamMenuSection').removeClass('opened')
    })



    $('.hamMenuBtnLink').on('click', function (e) {
        e.preventDefault()
        var targetDDSec = '.hamMenuWrp';
        var hasClass = $(this).hasClass('opened')
        $(this)[hasClass ? 'removeClass' : 'addClass']('opened')
        $('.blurOverlayBg')[hasClass ? 'fadeOut' : 'fadeIn']();
        // $(this).toggleClass('opened');
        $(this).siblings(targetDDSec).toggleClass('opened');
    })


    //Event for Footer Form Input Focus and Blur
    $('.singleInputForm input').on('focus', function (e) {
        $(this).parent().parent('.singleInputForm').addClass('focused');
    }).on('blur', function (e) {
        $(this).parent().parent('.singleInputForm').removeClass('focused');
    })


    $('.hamMenuWrp .appDownloadForm input').on({
        focus: function (e) {
            e.preventDefault()
            $(this).parents('.appDownloadForm').addClass('focused');
        },
        blur: function (e) {
            e.preventDefault()
            $(this).parents('.appDownloadForm').removeClass('focused');
        }
    })

    /* Added by Komal T from line 466 to 475*/
    $('.hamQuickLinkSection .appDwnldForm input').on({
        focus: function (e) {
            e.preventDefault()
            $(this).parents('.appDwnldForm').addClass('focused');
        },
        blur: function (e) {
            e.preventDefault()
            $(this).parents('.appDwnldForm').removeClass('focused');
        }
    })




    $('.aboutTabWrap').appTabs()

    //Vertical Tab
    $('.verticalTab').verticalTab()
    //Owl Carousel Function
    const initiateOwlCarosel = function (ele, options) {
        const carouselOption = Object.assign({}, options);
        $(ele).owlCarousel(carouselOption);
    }

    //Board Of Director Content Event
    $('.bodList .bodImage').on('click', function (e) {
        e.preventDefault();
        var bodContentID = $(this).attr('data-bod');
        var bodContentEl = "[data-bod='" + bodContentID + "']";
        // $(this).parent('li').siblings('li').show();

        // $(this).parent('li').hide();
        // $("ul#bodList").children("li").not("li.contentHide").show();
        $('.bodDetailContent').removeClass('contentVisible');
        $(".bodContentWrap").find(bodContentEl).addClass('contentVisible');
        $('html, body').animate({
            scrollTop: $(bodContentEl).offset().top - 250
        }, 400);
    });
    $('.bodContentClose').on('click', function (e) {
        e.preventDefault();
        var bodContentID = $(this).parent('.bodDetailContent').attr('data-bod');
        $(this).parent('.bodDetailContent').removeClass('contentVisible');
        // $('#bodList').children('li').show();
        $("ul#bodList").children("li").not("li.contentHide").show();
    });


    $('.bodTabWrap li').on('click', function (e) {
        $('.bodDetailContent').removeClass('contentVisible');
    });
    //View More Btn
    $('.viewMoreBtn').viewMoreCont();
    $('.mobArticleViewMore').viewMoreCont();
    $('.viewMoreInsure').viewMoreCont();
    $('.viewMoreBtnTermPage').viewMoreContTermPage();
    // $('.viewMoreBtn').click(function(e) {
    //   e.preventDefault();
    //   let hiddenContent = $(this).attr('data-hidden')
    //   $(this).toggleClass("viewLessBtn")
    //   $(this).text( $(this).hasClass('viewLessBtn') ? 'View Less' : 'View More') 
    //   $('.'+ hiddenContent).slideToggle()
    // })






    //For Mobile Device
    if (isMobileDevice) {
        $('.bodList .bodImage').off("click").on('click', function (e) { e.preventDefault() })
        $('.mobileContentBtn').on('click', function (e) {
            e.preventDefault()
            $(this).toggleClass("opened")
            //$(this).toggleClass("opened")
            $(this).siblings('a.bodImage').toggleClass("active")
            $(this).siblings('.bodContent').slideToggle()
        })

        //Plans Mega Menu DD
        $('.mobPlanMenuAccord').click(function (e) {
            e.preventDefault();
            $(this).toggleClass('opened');
            $(this).parent('h3').siblings('.mobPlanMenuAccordCont').slideToggle();
        })



        //Plans Mega Menu's SubMenu
    } else {
        //For Desktop Device
        /* All Plans Pointer Arrow */
        $('.megaMenuLink').each(function () {
            var allPlansOffsetLeft = $(this).offset().left;
            var allPlansMenuWidth = $(this).width();
            var allPlansArrLeft = ((allPlansOffsetLeft) + (allPlansMenuWidth / 2)) - 12;
            $(this).siblings().children("span.arrowUp").css('left', allPlansArrLeft + 'px');
          });
    }


})

function commonMethod() {
    $('.cust-accordion .accordion-head').click(function () {
        var parent = $(this).parent('.cust-accordion');
        var isOpen = $(parent).hasClass('open');
        if (isOpen) {
            $(parent).find('.accordion-content').slideUp();
            $(parent).removeClass('open');
        } else {
            $('.accordion-content').slideUp();
            $('.cust-accordion').removeClass('open');
            $(parent).find('.accordion-content').slideDown();
            $(parent).addClass('open');
        }
    });
    $('.disclaimer-sec .disclaimer-head').click(function () {
        var isOpen = $('.disclaimer-sec').hasClass('open');
        if (isOpen) {
            $('.disclaimer-sec').find('.disclaimer-cont').slideUp();
            $('.disclaimer-sec').removeClass('open');
        } else {
            $('.disclaimer-cont').slideDown();
            $('.disclaimer-sec').addClass('open');
        }
    });
    $('.cust-accordion.open .accordion-content').slideDown();
    $('.tab li').click(function () {
        var listParent = $(this).parent('ul');
        var parent = $(listParent).closest('.tab-wrap');
        $(parent).find('.tab li').removeClass('active');
        $(this).addClass('active');
        var content = $(this).attr('rel');
        $(parent).find('.tab-content > div').fadeOut();
        $(parent).find('.tab-content .' + content).fadeIn();
    });
    // $('.product-search-autofill li').click(function () {
    //     $('.product-search-autofill').fadeOut();
    //     $('.net-assessment-cont').fadeOut();
    //     $('.fund-performance-search-cont').fadeIn();
    //     $('.fund-performance-search-result .tab li').removeClass('active');
    //     $('.fund-performance-search-result .tab li.tab1').addClass('active');
    //     $('.accordion-section, .re-discover-sec').hide();
    // });
    $('.search-label-txt .search-close').click(function () {
        $('.fund-performance-search-cont').fadeOut();
        $('.net-assessment-cont').fadeIn();
        $('.accordion-section, .re-discover-sec').show();
        $('.fund-performance-search-cont').removeClass('view-product-cont-wrap');
    });
    // $(".product-search-form input").keyup(function () {
    //     var val = $(this).val();
    //     if (val.length > 0) {
    //         $('.product-search-autofill').slideDown();
    //     } else {
    //         $('.product-search-autofill').slideUp();
    //     }
    // });
    $('.search-text-right li span').click(function (e) {
        $(this).parent().remove();
    })
    $('.product-wrap a.product-view-al').click(function (e) {
        $('.net-assessment-cont').fadeOut();
        $('.fund-performance-search-cont').addClass('view-product-cont-wrap').fadeIn();
        $('.fund-performance-search-result .tab li').removeClass('active');
        var tab = $(this).attr('rel');
        $('.fund-performance-search-result .tab li.' + tab).addClass('active');
        $('.accordion-section, .re-discover-sec').hide();
        e.preventDefault();
        return;
    });
    $('.view-product-report').click(function (e) {
        var parent = $(this).parents('.product-wrap');
        $(parent).addClass('show-graph');
        $(parent).find('.product-graph-wrap').show();
        e.preventDefault();
        return;
    });
    $('.product-graph-wrap .close-product-graph').click(function (e) {
        var parent = $(this).parents('.product-wrap');
        $(parent).find('.product-graph-wrap').hide();
        $(parent).removeClass('show-graph');
        e.preventDefault();
        return;
    });
    $('.featured-post-video-ico').click(function (e) {
        $('.video-popup-wrap').fadeIn();
        e.preventDefault();
        return;
    });
    $('.video-popup-wrap .close').click(function (e) {
        $('.video-popup-wrap').fadeOut();
        e.preventDefault();
        return;
    });
    $(document).click(function (e) {
        var container = $('.custom-dropdown');
        if (!container.is(e.target) // if the target of the click isn't the container...
            && container.has(e.target).length === 0) // ... nor a descendant of the container
        {
            $(container).removeClass('open');
            $('.custom-dropdown ul').slideUp('slow');
        }
    });
    $('.product-search-form .siteButton').click(function (e) {
        $('html, body').animate({
            scrollTop: 0
        }, 100);
        $('.fund-lists-popup').fadeIn();
        e.preventDefault();
        return;
    });
    $('.close-fund-lists').click(function (e) {
        $('.fund-lists-popup').fadeOut();
    });

    //online support 1st accordion
    $(".cust-accordion").first().addClass("open");
    $(".accordion-content").first().css('display', 'block');

}

function isMobile() {
    var winWidth = $(window).width();
    if (winWidth <= 768)
        return true;
    return false;
}

// $(document).ready(function () {
//     AOS.init({ easing: "ease-in-out-sine" }),
//         setInterval(addItem, 300);
//     var itemsCounter = 1,
//         container = document.getElementById("aos-demo");
//     function addItem() {
//         var t;
//         42 < itemsCounter || ((t = document.createElement("div")).classList.add("aos-item"), t.setAttribute("data-aos", "fade-up"), (t.innerHTML = '<div class="aos-item__inner"><h3>' + itemsCounter + "</h3></div>"), itemsCounter++);
//     }
// });

$(document).ready(function () {

    $('.about-us-inner-menu').on('click', function () {
        $(".hamMenuWrp").removeClass("opened");
        $('.blurOverlayBg').hasClass("fadeOut");
        $(".hamMenuBtnLink").removeClass("opened");
        $('.subMenuSection').removeClass('opened');
        $('.hamMenuSection').removeClass('opened');
    });

    //  $('.about-us-inner-menu').on('click',function(){
    //      if (window.location.href.match(/\/(about-us\/futurance)/)){
    //         return;
    //      }else if (window.location.href.match(/\/(about-us)/)) {
    //         // var addressValue = $(this).attr("href");
    //         // alert(addressValue );
    //         setTimeout(function(){
    //             location.reload();
    //         })
    //     }
    //  });

    // $('.subMenuSection knowledge-center li a').on('click',function(){
    //      if (window.location.href.indexOf("insurance-knowledge-centre") > -1) {
    //          setTimeout(function(){
    //              location.reload();
    //          })
    //      }
    //  });
    const el = document.querySelectorAll('img');
    const observer = lozad(el); // passing a `NodeList` (e.g. `document.querySelectorAll()`) is also valid
    observer.observe();


    // const ef = document.querySelectorAll('picture');
    // const observer1 = lozad(ef);
    // observer1.observe();

    const observer2 = lozad();
    observer2.observe();
 



});

$(document).ready(function () {
    if ($(window).width() < 760) {
        $('table').css({ "width": "100%" });
    } else if ($(window).width() > 760 && $(window).width() < 1921) {
        $('table').css({ "width": "100%" });
    }
    else {
        $('table').css({ "width": "800px" });
        $('.modal table').css({ "width": "100%" });
    }
    $('table').removeAttr("width");
    $('table').removeAttr("cellpadding");
    $('table').removeAttr("cellspacing");
    $('table th,td,tr').removeAttr("width height");
    $('table th,td,tr').css({ "width": "", "height": "" });



    let calprevent = $("meta[name='template']").attr("content");
    if (calprevent == 'aboutus-page') {

    }
    else {
        $('.aboutTabWrap nav ul li.sourcepathlist:first-child').find('a').addClass("active");
    }

});

$(document).ready(function () {
    $(window).scroll(function () {
        if ($(window).scrollTop() > 50) {
            $(".stickyTermBtn").fadeIn();
        } else {
            $(".stickyTermBtn").hide();
        }
    });

    if ($(".langSwitch").length > 0) {
        var hindiUrl = $("#hinditoggle").val();

        $(".langHindi").click(function () {
            if (!location.pathname.includes("/hindi")) {
                window.location.href = hindiUrl;
            }
        });

        $(".langEng").click(function () {
            if (location.pathname.includes("/hindi")) {
                window.location.href = window.location.href.replace("/hindi", "");
            }
        });
    }

    if (location.pathname.includes("/hindi")) {
        $("#switchLanguageMob").prop("checked", true);
    } else {
        $("#switchLanguageMob").prop("checked", false);
    }

    if ($(".tabs div").length > 0 && $(".tabs div")[1].classList.contains("activeTab")) {
        var activeTab = $(".activeTab");
        var firstTabMenu = $(".appTabMenu li:first-child a:first-child");
        activeTab.find("li a:first").removeClass("active");
        activeTab.find(".bggrey:first").hide();
        $(firstTabMenu).on("click", function () {
            activeTab.find(".bggrey:eq(1)").removeClass("about-active-tab");
        });
    }
});

// FUNCTION TO SCROLL TO GIVEN ELEMENT 
function scrollToElement(element, offset) {
    offset = typeof offset !== 'undefined' ? offset : 0;
    var elementPosition = element.getBoundingClientRect().top + window.scrollY;
    window.scrollTo(0, elementPosition - offset);
}


// FUNCTION FOR SCROLLING TO ERROR MESSAGE
function scrollToError(e,targetButton,offsetValue){
      
    var allErrors = targetButton.closest('form').find('.error-txt , .error-txt1')
    for(let i=0; i<allErrors.length; i++){
        if(allErrors[i].checkVisibility() && allErrors[i].innerHTML!=''){
            scrollToElement(allErrors[i],offsetValue)
            break
        }
    }
}

// hindi pages url structure source agent code append start REDM25717

function pageSourceAgentCodeAppend() {
    var pageNameCodeArr = ['claims', 'customer-service', 'financial-tools-calculators', 'fund-performance', 'insurance-knowledge-centre', 'retirement-and-pension-plans', 'systematic-retirement-plan', 'savings-plans', 
    'sanchay-plus','term-insurance-plans','ulip-plans','c2w','health-insurance-plans','cancer-care-insurance','children-insurance-plans','youngstar-udaan','term-insurance-calculator','human-life-value-calculator','compound-interest-calculator','child-education-expense-planning-calculator','child-marriage-planning-calculator','retirement-planning-calculator','bmi-calculator','cost-of-delay-calculator','investment-returns-calculator','new-immediate-annuity-plan','life-insurance-plans','click-2-protect-super','']
    var pageName = window.location.pathname
    .replace('/hindi/', "")
    .replace('retirement-and-pension-plans/', "")
    .replace('savings-plans/', "")
    .replace('health-insurance-plans/', "")
    .replace('financial-tools-calculators/', "")
    .replace('term-insurance-plans/', "")
    .replace('children-insurance-plans/',"")
    pageName = pageName == "/hindi" ? "" : pageName; //for hindi hompage only
    const url = new URL(window.location.href);

    if (window.location.pathname.includes('hindi')) {
        if (pageNameCodeArr.includes(pageName)) {
            url.searchParams.set('agentcode', '760642');
            url.searchParams.set('source', pageName);
            window.history.replaceState(null, null, url);
        }
        //pageNameCodeArr.includes(pageName) ? (url.searchParams.set('agentcode', '760642'),url.searchParams.set('source', pageName)) : (url.searchParams.set('agentcode', '760642'),url.searchParams.set('source', ""));
    }
}


$(window).on('load','',function(){
    pageSourceAgentCodeAppend();
});
// $(window).load(function () {
//     pageSourceAgentCodeAppend();
// });
    // hindi pages url structure source agent code append end REDM25717

//************SANITIZATION FUNCTION START************/

function sanitize(string) {
    if (typeof string == "string") {
      const map = {
        "<": "&lt;",
        ">": "&gt;",
        '"': "&quot;",
        "'": "&#x27;",
        "/": "&sol;",
        "\\": "&bsol;",
        ";": "&semi;",
        ":": "&colon;",
        "(": "&lpar;", 
        ")": "&rpar;",
        "[": "&lsqb;",
        "]": "&rsqb;",
        "{": "&lcub;",
        "}": "&rcub;",
      };
      var reg = /[<>"']/gi;
      return string.replace(reg, function (match) {
        return map[match];
      });
    } else {
      return string;
    }
  };

//************SANITIZATION FUNCTION END************/

// CUSTOM TRIM FUNCTION BECAUSE THE .trim() FUNCTION IS DEPRECATED (START)//

function customTrim(string) {
    if (typeof string === 'string'){
        return string.replace(/^\s+|\s+$/g , '');
    }else{
        return string
    }
}

// CUSTOM TRIM FUNCTION BECAUSE THE .trim() FUNCTION IS DEPRECATED (END)//
//mFilter event script start

function mFilterEventScript(uniqueId) {
    try {
        (function (m, f, i, l, t, e, r) {
            m[t] = m[t] || function () { (m[t].q = m[t].q || []).push(arguments) }, m[t].l = 1 * new Date();
            e = f.createElement(l); e.async = 1; e.id = "mfilterit-event-tag"; e.src = i;
            r = f.getElementsByTagName(l)[0]; r.parentNode.insertBefore(e, r);
        })(window, document, "https://script.mfilterit.net/v3/e/client/web.hdfclifev3.cpv.js", "script", "mfe");
        mfe("mf_package_name", "web.hdfclifev3.cpv");
        mfe("mf_tracking_type", "conversion");
        mfe("mf_order_id", "{'"+uniqueId+"'}");
        mfe("mf_order_amount", "{ORDER-AMOUNT}");
        mfe("mf_customer_publisher_name", "{YOUR-PUBLISHER-NAME}");
        console.log('mFilter event script executed');
    } catch (error) {
        console.log(error);
    }
}    

//mFilter event script end

(function($){

    // FUNCTION TO TOGGLE LOADER 
    $.fn.toggleLoader = function(options){

        var settings = $.extend({
            loaderText: "Please wait... Data is Loading"
        },options)

        var loaderHtml = `
                            <div style="visibility: visible;" class="customloader rdmore">
                                <div class="rdmore-inner">
                                    <button class="draw"></button>
                                    <p class="rdmore-loader-text">${settings.loaderText}</p>
                                    <div class="cardcontainer">
                                        <img class="galleryImg" data-src="/content/dam/hdfclifeinsurancecompany/hdfclogo.png" src="/content/dam/hdfclifeinsurancecompany/hdfclogo.png" alt="HDFC Logo"
                                            title="HDFC Logo" width="50" height="50">
                                    </div>
                                </div>
                            </div>
                        `;

        return this.each(function(){
            if($(this).children('.rdmore').length > 0 && $(this).children('.rdmore').css('display') != 'none'){
                $(this).children('.rdmore').css('display','none');
            }else if($(this).children('.rdmore').length > 0 && $(this).children('.rdmore').css('display') == 'none'){
                $(this).children('.rdmore').css('display','block');
            }else{
                $(this).css('position','relative');
                $(this).append(loaderHtml);
            }
        })
    }

    // FUNCTION TO TOGGLE API FAILURE MESSAGE
    $.fn.toggleApiFailMsg = function(options){

        var settings = $.extend({
            failureMsg: "Oops! Something went wrong."
        },options)

        var failureScreenHtml = `
                            <div class="api-container api-fail-container">
                                <p class="api-response-msg">${settings.failureMsg}</p>
                                <img class="close-icon" onclick="$(this).closest('.api-fail-container').css('display','none')" src="/content/dam/hdfclifeinsurancecompany/images/home-images/pop-close.png" alt="close-icon">
                            </div>
                        `;

        return this.each(function(){
            if($(this).children('.api-fail-container').length > 0 && $(this).children('.api-fail-container').css('display') != 'none'){
                $(this).children('.api-fail-container').css('display','none');
            }else if($(this).children('.api-fail-container').length > 0 && $(this).children('.api-fail-container').css('display') == 'none'){
                $(this).children('.api-fail-container').css('display','flex');
            }else{
                $(this).css('position','relative');
                $(this).append(failureScreenHtml);
            }
        })
    }

    // FUNCTION TO TOGGLE API SUCCESS MESSAGE
    $.fn.toggleApiSuccessMsg = function(options){

        var settings = $.extend({
            successMsg: "Thank you for your interest, please continue with the next steps."
        },options)

        var successScreenHtml = `
                            <div class="api-container api-success-container">
                                <p class="api-response-msg" style="line-height: 1.5;">${settings.successMsg}</p>
                                <img class="close-icon" onclick="$(this).closest('.api-success-container').css('display','none')" src="/content/dam/hdfclifeinsurancecompany/images/home-images/pop-close.png" alt="close-icon">
                            </div>
                        `;

        return this.each(function(){
            if($(this).children('.api-success-container').length > 0 && $(this).children('.api-success-container').css('display') != 'none'){
                $(this).children('.api-success-container').css('display','none');
            }else if($(this).children('.api-success-container').length > 0 && $(this).children('.api-success-container').css('display') == 'none'){
                $(this).children('.api-success-container').css('display','flex');
            }else{
                $(this).css('position','relative');
                $(this).append(successScreenHtml);
            }
        })
    }    

}(jQuery))


// READMORE READLESS START

$(document).ready(function () {
    $(".ReadMore").click(function (e) {
            e.preventDefault();
            $(this).hide();
            $(this).siblings($('.HideText')).show();
        });

    $(".ReadLess").click(function (e) {
            e.preventDefault();
            $(this).parent().hide();
            $(this).parent().siblings($(".ReadMore")).show();

            var self = $(this).parent().parent();
              theOffset = $(self).offset();
              $('body,html').animate({ scrollTop: theOffset.top - 150});
          
        //     var self = $(this);
        //   setTimeout(function() {
        //       theOffset = $(self).offset();
        //       $('body,html').animate({ scrollTop: theOffset.top - $(this).parent().parent()[0].scrollHeight});
        //   }, 310);
        });
    });

// READMORE READLESS END

// FUNCTION TO USE ALPHANUMERIC IN UPPERCASE
$(".uppercaseLetters").bind('keyup', function (e) {
    var ths = $(this);
    ths.val(ths.val().toUpperCase());
 
  });


// 31940 Tooltip addition on category lead forms Start
$(document).ready(function () {
    var fullNameToolTipContent = document.getElementById("form-toolTip-FullName");
    var dobToolTipContent = document.getElementById("form-toolTip-Dob");
    var mobileOTPToolTipContent = document.getElementById("form-toolTip-mobileOTP");
    // console.log(fullNameToolTip.value);
    // console.log(dobToolTipContent.value);
    
    var dobToolTip = document.querySelectorAll(".tooltipForDob");
    dobToolTip.forEach(element => {
        element.addEventListener('focus', function (e) {
            //     console.log(this)
    
            var tooltipDiv = document.createElement("div");
            tooltipDiv.className = "global-tooltip";
    
            // Set the content of the tooltipDiv to the value from dobToolTipContent
            tooltipDiv.innerHTML = dobToolTipContent.value;
    
            this.parentNode.appendChild(tooltipDiv);
            
        });
        element.addEventListener('blur', function (e) {
            var tooltipToRemove = this.parentNode.querySelector('.global-tooltip');
            if (tooltipToRemove) {
                tooltipToRemove.remove();
            }
        });
    });
    
    var fullNameToolTip = document.querySelectorAll(".tooltipForFullName");
    fullNameToolTip.forEach(element => {
        element.addEventListener('focus', function (e) {
            //     console.log(this)
    
            var tooltipDiv = document.createElement("div");
            tooltipDiv.className = "global-tooltip";
    
            // Set the content of the tooltipDiv to the value from fullNameToolTipContent
            tooltipDiv.innerHTML = fullNameToolTipContent.value;
    
            this.parentNode.appendChild(tooltipDiv);
            
        });
        element.addEventListener('blur', function (e) {
            var tooltipToRemove = this.parentNode.querySelector('.global-tooltip');
            if (tooltipToRemove) {
                tooltipToRemove.remove();
            }
        });
    });
    
    var mobileOTPToolTip = document.querySelectorAll(".tooltipForMobileOTP");
    mobileOTPToolTip.forEach(element => {
        element.addEventListener('focus', function (e) {
            //     console.log(this)
    
            var tooltipDiv = document.createElement("div");
            tooltipDiv.className = "global-tooltip";
    
            // Set the content of the tooltipDiv to the value from mobileOTPToolTipContent
            tooltipDiv.innerHTML = mobileOTPToolTipContent.value;
    
            this.parentNode.appendChild(tooltipDiv);
            
        });
        element.addEventListener('blur', function (e) {
            var tooltipToRemove = this.parentNode.querySelector('.global-tooltip');
            if (tooltipToRemove) {
                tooltipToRemove.remove();
            }
        });
    });
    
    // Mobile OTP tooltip for pop up & Sanchay Plus forms (to fix the alignment issue)
    var mobileOTPPopUpToolTip = document.querySelectorAll(".tooltipForMobileOTPPopUp");
    mobileOTPPopUpToolTip.forEach(element => {
        element.addEventListener('focus', function (e) {
            //     console.log(this)
    
            var tooltipDiv = document.createElement("div");
            tooltipDiv.className = "global-tooltip-mobileOtp";
    
            // Set the content of the tooltipDiv to the value from mobileOTPToolTipContent
            tooltipDiv.innerHTML = mobileOTPToolTipContent.value;
    
            this.parentNode.appendChild(tooltipDiv);
            
        });
        element.addEventListener('blur', function (e) {
            var tooltipToRemove = this.parentNode.querySelector('.global-tooltip-mobileOtp');
            if (tooltipToRemove) {
                tooltipToRemove.remove();
            }
        });
    });
    
    // Mobile NRI tooltip Start
    
    document.querySelectorAll(".tooltipForMobileOTPNriYes").forEach((element) => {
        element.addEventListener("focus", function () {
            handleTooltipMobileNriOtpYes(this);
        });
    
        element.addEventListener("blur", function () {
            const form = this.closest("form");
            if (!form) return;
    
            const tooltipToRemove = this.parentNode.querySelector(".global-tooltip");
            if (tooltipToRemove) {
                tooltipToRemove.remove();
            }
        });
    });
    
    function handleTooltipMobileNriOtpYes(inputElement) {
        const form = inputElement.closest("form");
        if (!form) return;
        const countryCodeField = form.querySelector('[data-id="countryCode"]');
        const countryCode = countryCodeField?.value || "";
    
        if (countryCode === "91") {
            if (!inputElement.parentNode.querySelector(".global-tooltip")) {
                const tooltipDiv = document.createElement("div");
                tooltipDiv.className = "global-tooltip";
                tooltipDiv.innerHTML = mobileOTPToolTipContent.value;
                inputElement.parentNode.appendChild(tooltipDiv);
            }
        } else {
            const tooltipToRemove = inputElement.parentNode.querySelector(".global-tooltip");
            if (tooltipToRemove) {
                tooltipToRemove.remove();
            }
        }
    }
    
    // Update country code input to work within its form only
    document.querySelectorAll('[data-id="countryCode"]').forEach((countryCodeField) => {
        countryCodeField.addEventListener("input", function () {
            const form = this.closest("form");
            if (!form) return;
    
            form.querySelectorAll(".tooltipForMobileOTPNriYes").forEach((inputElement) => {
                handleTooltipMobileNriOtpYes(inputElement);
            });
        });
    });
    
    });
    
    // 31940 Tooltip addition on category lead forms End

function validateIndianPhoneNumber(phoneNumber) {
    const pattern = /^[0]?[6789]\d{9}$/;
    return pattern.test(phoneNumber) && !notAllowedNumbersArray.includes(Number(phoneNumber));
}

function toggleCountryCodeField(parent, selectElem) {
    var noNriBannerForm = $(parent).find('#no_nriBannerForm');
    var countryCodeList = $(parent).find('.countryCode-list'); 
    var select2Containers = $(parent).find('.select2-container'); 
    const code = $(parent).find('#code'); 

    if (noNriBannerForm.hasClass('valid')) {
        countryCodeList.css('display', 'none');
        select2Containers.each(function() {
            $(this).css('display', 'none');
        });
        code.css('display', 'block');
    } else {
        code.css('display', 'none');
        countryCodeList.css('display', 'block');
        select2Containers.each(function() {
            $(this).css('display', 'block');
        });

        // IntersectionObserver to initialize select2 when the element becomes visible
        const observer = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    $(selectElem).each(function() {
                        if (!$(this).hasClass('select2-hidden-accessible')) {
                            $(this).select2({
                                dropdownParent: $(this).closest('.mobileNo_wrap'),
                                templateResult: function(item) {
                                    return item.text;
                                },
                                templateSelection: function(item) {
                                    if (item.id) {
                                        return item.text.split(' - ')[0];
                                    }
                                    return item.text;
                                }
                            }).on('select2:open', function() {
                                $('.select2-search__field').attr('placeholder', 'Search Country...');
                            });
                        }
                    });
                    observer.unobserve(entry.target);
                }
            });
        }, { threshold: 0.1 });

        $(selectElem).each(function() {
            observer.observe(this);
        });
    }
}


var stored;
function countryResidenceApi(selectElem, flag) {
    var $parentEle = $(selectElem);
    if (!flag) {
        // var apiEndPoint = 'https://beta-api.hdfclife.tech/api/country/get';
        var apiEndPoint = 'https://api.hdfclife.com/api/country/get';
        fetch(apiEndPoint)
            .then(response => {
                return response.json();
            })
            .then(data => {
                stored = data;
                data.response.forEach(function (country) {
                    $parentEle.append(`<option value="${country.country_code}">${country.country_code} - ${country.country_name}</option>`);
                });
                // $parentEle.trigger('change');
                $parentEle.val('91').trigger('change');
            })
            .catch(error => {
                console.error('Error:', error);
            });
    } else {
        $parentEle.html("");
        stored.response.forEach(function (country) {
            $parentEle.append(`<option value="${country.country_code}">${country.country_code} - ${country.country_name}</option>`);
        });
        $parentEle.val('91').trigger('change');
    }
}


// ************ kc universal lead form feasibility globally ***************//

document.addEventListener('DOMContentLoaded', function () {
    var viewportWidth = document.documentElement.clientWidth || document.body.clientWidth;
    if (viewportWidth <= 767) {
        const firstH2 = document.querySelector('.allinone h2');
        const formElement = document.querySelector('.universalLeadForm');

        if (firstH2 && formElement) {
            const container = document.createElement('div');
            container.classList.add('helloWorld');
            formElement.classList.add('dsp-n');
            container.appendChild(formElement);

            const parentLi = firstH2.closest('li');
            if (parentLi) {
                parentLi.parentNode.insertBefore(container, parentLi);
            } else {
                firstH2.parentNode.insertBefore(container, firstH2);
            }
            formElement.classList.remove('dsp-n');
        }
        else {
            if (formElement) {
                formElement.classList.add('dsp-n');
            }
        }
    }
});
var arr;

function isFormValid(form) {
  arr = [];
  form.find("[data-validation]").each(function (index, val) {
    if ($(this).is(':visible')) {
      $(this).trigger('input');
      var valid = $(this).parents().hasClass("valid");
      arr.push(valid);
    }
  });
  var formValid;
  if (arr.includes(false)) {
    formValid = false;
  } else {
    formValid = true;
  }
  if (formValid) {
    form.addClass("validForm");
    return true;
  } else {
    try {
      form.removeClass("validForm");
      return false;
    } catch (error) {
      console.log(error);
    }
  }
}

var validationobj = {
  search: searchValidation,
  fullname: nameValidation,
  firstname: firstNameValidation,
  newfirstname: newfirstNameValidation,
  firstnamewithsinglespace: firstnamewithsinglespaceValidation,
  lastname: lastNameValidation,
    alphaNumMaxLength: alphaNumMaxLengthValidation,
    lifeServiceAlphaNumMaxLength: lifeServiceAlphaNumMaxLengthValidation,
  numericMax8: numericMaxLength8Validation, 
  lifeServiceNumericMax8: lifeServicePopNumericMaxLength8Validation, 
    currentAge: currentAgeValidation,
  rcCurrentAge: rcCurrentAgeValidation,
  childAge: childAgeValidation,
  notEmpty: notEmptyValidation,
monthlyExpenseNotGreater : monthlyExpenseNotGreater,  
  textAreaNotEmpty: textAreaNotEmptyValidation,
    retireAge: retiredAgeValidation,
  rcRetireAge: rcRetiredAgeValidation,
  dropdown: dropdownValidation,
  newdropdown: newDropdownValidation,
  emailaddress: emailaddressValidation,
  emailaddressCustom: emailaddressCustomValidation,
  mobileNo: mobileNumberValidation,
  mobileNo14: mobileNumberValidation14,
  mobileNo14opti: mobileNumberValidation14Opti,
  countrycode:countrycodeNumberValidation,
  countrycodeopti:countrycodeNumberValidationOpti,
  internationalNumber:internationalNumberValidation,
  folioId: folioIdValidation,
  city: cityvalidation,
  state: stateValidation,
  applicationNo: applicationNoValidation,
  policyNo: policyNoValidation,
  policyNoFund: policyNoFundValidation,
  policyNoOptional:policyNoOptionalValidation,
  claimReferenceNo: claimReferenceNoValidation,
  // pancardno: panCardValidation,
  heightFt: heightvalidationFt,
  heightInch: heightvalidationInch,
  hra:hraValidation,
  weight: weightvalidation,
  // categoryExpense: categoryExpenseValidation,
  // country: countryValidation,
  // bankaccountnumber: bankAccountNumber,
  // ifsccode: ifscCode,
  // bankname: bankName,
  // branchname: branchName,
  // searchlocation: searchLocation,
  // claimid: claimValidation,
  // details: detailsvalidation,
  // commonFiled: commonFileldValidation,
  // numberLetters: numberLettersValid,
  // policyHolderLoan: policyHolderLoanNoValid,
  // groupPolicyOwnername: groupPolicyValidation,
  // relationshipwithinsured: relationshipwithinsuredvalidation,
  // upiid: upiIdValidation,
  // policycustomername: policycustomernameValidation,
  // query: queryvalidation,
  // area: areavalidation,
  // customeramount: customeramountvalidation,
  // agentnamelicensecode: agentnamelicensecodevalidation,
  // minimumIncome: minimumIncomeValidation,
  // mostlyExpanses: mostlyExpansesValidation,
  // userenteramount: useramountValidation,
  futureyear: futureYearValidation,
  // policyterm: policyTermValidation,
  // loannoofyear: loannoOfYearValidation,
  // calenderyear: calenderYearValidation,
  // optionalmobileNo: optioanalmobileNumberValidation
  annualrateReturn: annualrateReturnValidation,
  referenceNumber: referenceNumberValidation,
  policyApplication: policyApplicationValidation,
  memberName: membernameValidation,
  relmember:  relationwithmemberValidation,
  placeofdeath: placeofdeathValidation,
  pincodeno: pincodeValidation,
  policyUnclaimed: policyNoUnclaimedValidation,
  panNumber: panNumberValidation,
  panNumberPosp: panNumberPospValidation,
  dobUnclaimed: dobUnclaimedValidation,
  address: addressValidation,
  companyname: companynameValidation,
  loanaccountNumber: loanaccountnumberValidation,
  coiNumber: coinumberValidation,
  landlineNumber: landlinenumberValidation,
  stdCode: stdCodeValidation,
  caseReference: caseReferenceValidation,
  lifeCoverAmount: lifeCoverAmountValidation,
  codAge: codAgeValidation,
  forInvestmentReturn: forInvestmentReturnValidtion,
  forInvestmentReturnInvest: forInvestmentReturnInvestValidtion,
  rateOfReturn: rateOfReturnValidation,
  itNpsAmount: itNpsAmountValidation,
  dob: dobValidation,
  hindiFirstName: hindiFirstNameValidation,
  hindiDob: hindiDobValidation,
  hindiMobileNumber: hindiMobileNumberValidation,
  hindiEmail: hindiEmailAddressValidation
  // pptAndTerm: pptAndTermValidation,
};
var notAllowedNumbersArray =
  [    
      7070700707,
      8889988899,
      8555666666,
      9858888888,
      8065656565,
      7007601255,
      8989899999,
      9989998040,
      9000000000,
      9898898989,
      8888888888,
      9999999999,
      9111111111,
      9777777777,
      9890098900,
      8989999999,
      9888888888,
      9999955555,
      9999995555,
      7777777777,
      9899999999,
      9999900000,
      9898989898,
      9898989888,
      8787878787,
      9999999991,
      9999999995,
      9999999992,
      9999999990,
      9898999999,
      9999908765,
      6999999999,
      9999988888,
      8999999999,
      9898988888,
      8998989898,
      9890000000,
      9898899889,
      9000000001,
      9811111111,
      6666666666,
      9999099990,
      8989898989,
      9555555555,
      9000000009,
      9222222222,
      9877777777,
      9699999999,
      9666666666,
      7999999999,
      8585858585,
      9820098200,
      8000000000,
      9800000000,
      7878787878,
      9999999989,
      9898988988,
      9999000099,
      8888888889,
      9099999999,
      9999999996,
      9999999998,
      9123456789,
      9999999919,
      9898989999,
      9999911111,
      9900990099,
      7676767676,
      9999998888,
      9900000000,
      8888999900,
      9898889898,
      7000000000,
      9889898989,
      9999966666,
      9999999988,
      9999999958,
      9999999898,
      9898998989,
      9999999997,
      9797979797,
      8888899999,
      9977997799,
      6565656565,
      9999999909,
      9000000008,
      9960000000,
      9858585858,
      9999999993,
      9999999900,
      9988877888,
      1111111111,
      9898959898,
      9999000000,
      9998888999,
      8888800000,
      9898998999,
      8056565656,
      9988889999,
      9711111111,
      9999912345,
      7788778877,
      9100000000,
      8999989999,
      8888888855,
      8899999999,
      9999999922,
      9988998899,
      9191919191,
      9977777777,
      9999990000,
      8080808080,
      9999922222,
      9000090000,
      9200000000,
      9998888888,
      8888888880,
      9999999966,
      9856666666,
      1234567890,
      8989898888,
      8988888888,
      6777777777,
      9820000000,
      9700000000,
      9494949494,
      8777777777,
      0000000000
  ]

//WILL RETURN CURRENT ELEMENTS
function returnValidationElements(event) {
  var ele =
    event.currentTarget.closest(".form-group,.ta-val-fn") || event.currentTarget.parentElement;
  var value = event.currentTarget.value;
  var fvc = event.currentTarget.closest(".form-group") || ele;
  return {
    ele,
    value,
    fvc
  };
}

// search validation

function searchValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[A-Za-z0-9\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
  if (!pattern.test(currentValue)) {
    $(currentElement).siblings(".search-error").text("Please enter alphanumeric characters");
    // $(currentElement).find(".error-txt").text("Field should contain minimum 3 and max 50 characters");
    fvc.classList.remove("valid");
  } else {
    $(currentElement).siblings(".search-error").text("");
    fvc.classList.add("valid");
  }
}
//  else {
//   $(currentElement).siblings(".search-error").text("Sorry! You have not searched anything.");
//   fvc.classList.remove("valid");
// }
}

// name validation

function nameValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
  if (!pattern.test(currentValue)) {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").removeClass("d-none");
    $(currentElement).find(".error-txt").text("Please enter valid name");
    // $(currentElement).find(".error-txt").text("Field should contain minimum 3 and max 50 characters");
    fvc.classList.remove("valid");
  } else if (currentValue.length < 3 || currentValue.length > 50)  {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Field should contain minimum 3 and max 50 characters");
    fvc.classList.remove("valid");
  } else {
    $(currentElement).find(".error-txt").text("");
    fvc.classList.add("valid");
  }
} else {
  $(currentElement).find(".error-txt").addClass("d-block");
  $(currentElement).find(".error-txt").text("Please enter valid name");
  fvc.classList.remove("valid");
}
}

// first name validation

function firstNameValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid first name");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter first name");
    fvc.classList.remove("valid");
  }
}

// last name validation

function lastNameValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid last name");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter last name");
    fvc.classList.remove("valid");
  }
}

function numericMaxLength8Validation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[0-9\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue.length < 6 && currentValue.length != 8) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid business code");
      fvc.classList.remove("valid");
    }else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid business code");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter business code");
    fvc.classList.remove("valid");
  }
}

function lifeServicePopNumericMaxLength8Validation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern12 = /^[0-9\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue.length < 4 && currentValue.length != 8) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid Policy Id");
      fvc.classList.remove("valid");
    }else if (!pattern12.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid Policy Id");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter Policy Id");
    fvc.classList.remove("valid");
  }
}

function numericMaxLength10Validation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[0-9\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue.length != 10) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid lead id");
      fvc.classList.remove("valid");
    }else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid lead id");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter lead id");
    fvc.classList.remove("valid");
  }
}


function firstnamewithsinglespaceValidation(event){
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value.trim();
  var fvc = _obj.fvc;

  var pattern = /^(?!.*([A-Za-z])\1{2})[A-Za-z]{3,30}(?:\s[A-Za-z]{0,29})?$/
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) { 
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid name");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter name");
    fvc.classList.remove("valid");
  }

}


// application number validation

function applicationNoValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  policyNo = $("input[name=policyNumber]").val();

  if(policyNo==""){
    var pattern = /^.{1,13}$/;
    if (currentValue !== "" && currentValue != undefined) {
      if (currentValue.length != 13) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Field should contain 13 Numeric Characters");
        fvc.classList.remove("valid");
      } else if (!pattern.test(currentValue)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Field should contain 13 Numeric Characters");
        fvc.classList.remove("valid");
      } else {
        $(currentElement).find(".error-txt").text("");
        fvc.classList.add("valid");
      }
    } else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("Please enter valid application number");
      fvc.classList.remove("valid");
    }
  }else{
    $(currentElement).find(".error-txt").text("");
    fvc.classList.add("valid");    
  }
}

// policy no validation

function policyNoValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z0-9]{8,}$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue.length != 8) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Field should contain 8 Alphanumeric Characters");
      fvc.classList.remove("valid");
    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Field should contain 8 Alphanumeric Characters");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter valid policy number");
    fvc.classList.remove("valid");
  }
}

function policyNoFundValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z0-9]{8,}$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue.length != 8) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Field should contain 8 Alphanumeric Characters");
      fvc.classList.remove("valid");
    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Field should contain 8 Alphanumeric Characters");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter valid policy number");
    fvc.classList.remove("valid");
  }
}



function policyNoOptionalValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  applicationData = $("input[name=applicationNumber]").val();

  if(applicationData==""){
    var pattern = /^.{1,8}$/;
    if (currentValue !== "" && currentValue != undefined) {
      if (currentValue.length != 8) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Field should contain 8 Numeric Characters");
        fvc.classList.remove("valid");
      } else if (!pattern.test(currentValue)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Field should contain 8 Numeric Characters");
        fvc.classList.remove("valid");
      } else {
        $(currentElement).find(".error-txt").text("");
        fvc.classList.add("valid");
      }
    } else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("Please enter valid policy number");
      fvc.classList.remove("valid");
    }
  }else{
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
  }
}


// Policy number unclaimed dues validation

function policyNoUnclaimedValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  applicationData = $("input[name=applicationNumber]").val();
  panNumber = $("input[name=pan_no]").val();

  if(applicationData=="" || panNumber == ""){
    var pattern = /^.{1,8}$/;
    if (currentValue !== "" && currentValue != undefined) {
      if (!(currentValue.length >= 4 && currentValue.length <= 8)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Field should contain 4 - 8 Numeric Characters");
        fvc.classList.remove("valid");
      } else if (!pattern.test(currentValue)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Field should contain 8 Numeric Characters");
        fvc.classList.remove("valid");
      } else {
        $(currentElement).find(".error-txt").text("");
        $(currentElement).find(".error-txt").removeClass("d-block");
        fvc.classList.add("valid");
      }
    } else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("Please enter policy number");
      fvc.classList.remove("valid");
    }
  }else{
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
  }
}


// Pan Number Validation

function panNumberValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  policyNoUnclaimed = $("input[name=policy_id]").val();

  if(policyNoUnclaimed == ""){
    var pattern = /^([a-zA-Z]){5}([0-9]){4}([a-zA-Z]){1}?$/;
    if (currentValue !== "" && currentValue != undefined) {
      if ((currentValue.length < 10)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Pan number should contain 10 characters");
        fvc.classList.remove("valid");
      } else if(!pattern.test(currentValue)){
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Please enter valid pan number");
        fvc.classList.remove("valid");
      } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
      }
    }
    else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter pan number");
      fvc.classList.remove("valid");
    }
  }else{
    $(currentElement).find(".error-txt").text("");
    fvc.classList.add("valid");  
      }
}

//Dob Unclaimed Validation

function dobUnclaimedValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var pattern = /^\d{4}\-(0?[1-9]|1[012])\-(0?[1-9]|[12][0-9]|3[01])$/ ;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid Date");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter date");
    fvc.classList.remove("valid");
  }
}


// reference no validation

function referenceNumberValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z0-9]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue.length != 9) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Field should contain 9 Alpha-Numeric Characters");
      fvc.classList.remove("valid");
    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Field should contain 9 Alpha-Numeric Characters");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter valid reference number");
    fvc.classList.remove("valid");
  }
}

// policy or application no validation

function policyApplicationValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z0-9]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue.length < 8 || currentValue.length > 13) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Field should contain between 8 to 13 Alpha-Numeric Characters");
      fvc.classList.remove("valid");
    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Field should contain between 8 to 13 Alpha-Numeric Characters");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter valid policy or application number");
    fvc.classList.remove("valid");
  }
}

// Pan Number Validation

function panNumberPospValidation(event) {
  //GET ALL ELEMENTS
  // debugger
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  $('.pan-agree-checkbox-error-txt').css('display','none');
  $('.pan-non-agree-checkbox-error-txt').css('display','none');
    var pattern = /^[A-Z]{5}[0-9]{4}[A-Z]$/;
    if (currentValue !== "" && currentValue != undefined) {
      if ((currentValue.length < 10)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Please enter valid pan number");
        fvc.classList.remove("valid");
      } else if(!pattern.test(currentValue)){
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Please enter valid pan number");
        fvc.classList.remove("valid");
      } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
      }
    }
    else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter pan number");
      fvc.classList.remove("valid");
    }
}

// claim Reference validation

function claimReferenceNoValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z0-9-]*$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid claim reference number");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter valid claim reference number");
    fvc.classList.remove("valid");
  }
}

// current age validation
var currentAgeVal, retireAgeVal;

function currentAgeValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  currentAgeVal = currentValue;
  var fvc = _obj.fvc;
  if (retireAgeVal < currentAgeVal) {
    // currentAgeVal = currentValue
    // $('#retire-age').val('');
    $('#retire-age').trigger('input');
  }
  var pattern = /^[0-9]{2,3}$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue) || Number(currentValue) < 18 || Number(currentValue) > 65) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Min: 18 yrs, Max: 65 yrs");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Min: 18 yrs, Max: 65 yrs");
    fvc.classList.remove("valid");
  }
}

// retirement age validation
function retiredAgeValidation(event) {
  if (!currentAgeVal) {
    currentAgeVal = 18
  } else if (currentAgeVal < 18 || currentAgeVal > 65) {
    currentAgeVal = 18;
  }
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  retireAgeVal = currentValue
  var pattern = /^[0-9]{2,3}$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue) || Number(currentValue) < Number(currentAgeVal) || Number(currentValue) > 75) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Min: " + currentAgeVal + " yrs, Max: 75 yrs");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Min: " + currentAgeVal + " yrs, Max: 75 yrs");
    fvc.classList.remove("valid");
  }
}



// current age validation
var rcCurrentAgeVal, rcRetireAgeVal;

function rcCurrentAgeValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  rcCurrentAgeVal = currentValue;
  rcCurrentAgeVal = parseInt(rcCurrentAgeVal);
  rcCurrentAgeVal += 10;
  var fvc = _obj.fvc;
  if (rcRetireAgeVal < rcCurrentAgeVal) {
    // rcCurrentAgeVal = currentValue
    // $('#retire-age').val('');
    $('#retirement-calc-form #retirementAge').trigger('input');
  }
  var pattern = /^[0-9]{2,3}$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue) || Number(currentValue) < 18 || Number(currentValue) > 50) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Min: 18 yrs, Max 50 yrs");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Min: 18 yrs, Max 50 yrs");
    fvc.classList.remove("valid");
  }
}

// retirement age validation
function rcRetiredAgeValidation(event) {
  if (!rcCurrentAgeVal) {
    rcCurrentAgeVal = 40
  } else if (rcCurrentAgeVal < 40 || rcCurrentAgeVal > 60) {
    rcCurrentAgeVal = 40;
  }
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  rcRetireAgeVal = currentValue
  var pattern = /^[0-9]{2,3}$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue) || Number(currentValue) < Number(rcCurrentAgeVal) || Number(currentValue) > 60) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Min: " + rcCurrentAgeVal + " yrs, Max: 60 yrs");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Min: " + rcCurrentAgeVal + " yrs, Max: 60 yrs");
    fvc.classList.remove("valid");
  }
}

//Not empty validation
function notEmptyValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  if (currentValue != "" && currentValue != undefined) {
    $(currentElement).find(".error-txt").text("");
    fvc.classList.add("valid");
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required!");
    fvc.classList.remove("valid");
  }
}

//Text area not empty validation
function textAreaNotEmptyValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  if (currentValue != "" && currentValue != undefined) {
    $(currentElement).find(".error-txt").text("");
    fvc.classList.add("valid");
  } else {
    //$(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required!");
        fvc.classList.remove("valid");
  }
}

//Monthly Expense not greater than Annual Income Validation

function monthlyExpenseNotGreater(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var annInc = Number( $('#annual-income')[0].value.replace(/,/g , ""));
  var monExp = Number($('#monthly-expenses')[0].value.replace(/,/g , ""));
  if(annInc < monExp){
    fvc.classList.remove("valid");
      $('#monthly-expenses')[0].nextElementSibling.innerText = "";
      $('#monthly-expenses')[0].nextElementSibling.nextElementSibling.innerText = "Monthly Expense can't be more than Annual Income";
  }
  else{
    fvc.classList.add("valid");
    $('#monthly-expenses')[0].nextElementSibling.nextElementSibling.innerText = "";
    $(currentElement).find(".error-txt").removeClass("d-block");
    $(currentElement).find(".error-txt").addClass("d-none");
  }

  // if (currentValue) {
  //   $(currentElement).find(".error-txt").text("");
  //   $(currentElement).find(".error-txt").removeClass("d-block");
  //   fvc.classList.add("valid");
  // } else {
  //   $(currentElement).find(".error-txt").addClass("d-block");
  //   $(currentElement).find(".error-txt").text("This field is required!");
  //   fvc.classList.remove("valid");
  // }
}

// DROPDOWN VALIDATION
function dropdownValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  if (currentValue) {
    $(currentElement).find(".error-txt").text("");
    fvc.classList.add("valid");
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please select value");
    fvc.classList.remove("valid");
  }
}

// New Dropdown Validation
function newDropdownValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  if (currentValue) {
    $(currentElement).find(".error-txt").text("");
    $(currentElement).find(".error-txt").removeClass("d-block");
    fvc.classList.add("valid");
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please select value");
    fvc.classList.remove("valid");
  }
}

//email address
function emailaddressValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  //
  if (currentValue !== "") {
    //var pattern = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;

    // var pattern = /^([a-zA-Z])+([a-zA-Z0-9_.+-])+\@(([a-zA-Z])+\.+?(com|co|in|org|net|edu|info|gov|vekomy))\.?(in|org|net|edu|info|gov)?$/;
    // var pattern = /^([a-zA-Z])+([a-zA-Z0-9_.-])+\@(([a-zA-Z0-9])+\.+?(com|co|in|org|net|edu|info|gov|vekomy))\.?(in|org|net|edu|info|gov)?$/;
    var pattern = /^[\w-\.]+@([A-Za-z-]+\.)+[A-Za-z-]{2,4}$/g;

    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("Please enter valid e-mail id");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter valid e-mail id");
    fvc.classList.remove("valid");
  }
}

// Email validation to block specific usernames
function emailaddressCustomValidation(event) {
  // GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value.trim().toLowerCase(); // Trim and lowercase for consistency
  var fvc = _obj.fvc;

  // List of blocked usernames (before "@")
  var blockedUsernames = [
    "na", "abc", "ab", "test", "dhee", "av", 
    "a", "xyz", "n", "nish", "abcd", "s", "ram"
  ];

  // Email pattern for general format validation
  var pattern = /^[\w-\.]+@([A-Za-z-]+\.)+[A-Za-z-]{2,4}$/g;

  if (currentValue !== "") {
    if (!pattern.test(currentValue)) {
      // Invalid email format
      showError(currentElement, "Please enter a valid email address");
      fvc.classList.remove("valid");
      return;
    }

    // Extract username from email (before "@")
    var username = currentValue.split("@")[0];

    // Check if the username is blocked
    if (blockedUsernames.includes(username)) {
      showError(currentElement, "Please enter a valid email address");
      fvc.classList.remove("valid");
    } else {
      // Valid email
      clearError(currentElement);
      fvc.classList.add("valid");
    }
  } else {
    // Empty input field
    showError(currentElement, "Please enter a valid email address");
    fvc.classList.remove("valid");
  }
}

// Helper function to show error messages
function showError(element, message) {
  $(element).find(".error-txt").addClass("d-block").text(message);
}

// Helper function to clear error messages
function clearError(element) {
  $(element).find(".error-txt").removeClass("d-block").text("");
}

// mobile number validation for 10 to 14
function mobileNumberValidation14(event) {
  //GET ALL ELEMENTS
    
  
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var blockSpecificNumbers = event.currentTarget.dataset.blockspecificnumbers

  var pattern = /^[0]?[123456789]\d{5}|[123456789]\d{14}$/;
  if (currentValue !== "") {
    if (currentValue.length < 6 && currentValue.length > 14 ) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    }else if (blockSpecificNumbers && notAllowedNumbersArray.includes(Number(currentValue))){
      // BLOCK SPECIFIC NUMBER FOR SANCHAY PLUS OTP REQUIREMENT
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    }else {
        $(currentElement).find(".error-txt").text("");
        fvc.classList.add("valid");
      }
  } else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("Please enter mobile number");
      fvc.classList.remove("valid");
  }
}

// mobile number validation for 10 to 14 for opti lead
function mobileNumberValidation14Opti(event) {
  //GET ALL ELEMENTS
  // debugger
  
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var blockSpecificNumbers = event.currentTarget.dataset.blockspecificnumbers

  var pattern = /^[0]?[123456789]\d{5}|[123456789]\d{14}$/;
  if (currentValue !== "") {
    if (currentValue.length < 6 && currentValue.length > 14 ) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    }else if (blockSpecificNumbers && notAllowedNumbersArray.includes(Number(currentValue))){
      // BLOCK SPECIFIC NUMBER FOR SANCHAY PLUS OTP REQUIREMENT
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    }else {
        $(currentElement).find(".error-txt").text("");
        // fvc.classList.add("valid");
        var inputElement = document.querySelector('.newBannerFormV2 #code'); 
        var inputElementOptiSavings = document.querySelector('.ulipFormV3 #code');
        if (inputElement && inputElement.value.length == 0) {
          var event = new Event('input');  
          inputElement.dispatchEvent(event);
        }else if (inputElementOptiSavings && inputElementOptiSavings.value.length == 0) {
            var event = new Event('input');  
            inputElementOptiSavings.dispatchEvent(event);
        }else{
             fvc.classList.add("valid");
        }
      }
  } else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("Please enter mobile number");
      fvc.classList.remove("valid");
  }
}



// mobile number validation
function mobileNumberValidation(event) {
  //GET ALL ELEMENTS
    
  
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var blockSpecificNumbers = event.currentTarget.dataset.blockspecificnumbers

  var pattern = /^[0]?[6789]\d{9}$/;
  if (currentValue !== "") {
    if (currentValue.length != 10) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    }else if (blockSpecificNumbers && notAllowedNumbersArray.includes(Number(currentValue))){
      // BLOCK SPECIFIC NUMBER FOR SANCHAY PLUS OTP REQUIREMENT
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    }else {
        $(currentElement).find(".error-txt").text("");
        fvc.classList.add("valid");
      }
  } else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("Please enter mobile number");
      fvc.classList.remove("valid");
  }
}

// folioId-ClientId Validation
function folioIdValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^([IN]{2}[0-9]{14})|([0-9]{7})$/;
  if (currentValue !== "") {
    if (currentValue.length < 6) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid ID");
      fvc.classList.remove("valid");

    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid ID");
      fvc.classList.remove("valid");

    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter valid ID");
    fvc.classList.remove("valid");
  }
}


//state validation
var isStateSelect;

function stateValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  isStateSelect = currentValue;
  if (currentValue == "" || currentValue == undefined) {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").removeClass("d-none");
    $(currentElement).find(".error-txt").text("Please enter state name");
    fvc.classList.remove("valid");
  } else {
    $(currentElement).find(".error-txt").text("");
    fvc.classList.add("valid");
  }
}

//city validation
function cityvalidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  if (currentValue !== "" && currentValue != undefined) {
    if (isStateSelect == "" || !isStateSelect) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement)
        .find(".error-txt")
        .text("Please select the state first");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter city name");
    fvc.classList.remove("valid");
  }
}

//weight validation
function weightvalidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  currentValue = currentValue.toString().slice(0,3);
  var firstDigit = currentValue.toString().slice(0,1)
  var fvc = _obj.fvc;

  // var pattern = /^\d{1,3}$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (firstDigit==0 || (currentValue < 1 || currentValue > 200)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Invalid value (Enter a value between 1 and 200)");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required!");
    fvc.classList.remove("valid");
  }
}

//for investment validation
function forInvestmentReturnValidtion(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[1-9][0-9]?$|^99$/;
  if (currentValue !== "" && currentValue != undefined && currentValue !== "0" && currentValue !== "00") {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Value should be between 1 and 99");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Value should be between 1 and 99");
    fvc.classList.remove("valid");
  }
}

//for investment return calc invest field validation
function forInvestmentReturnInvestValidtion(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^(1000|[1-9]\d{3,8}|999999999)$/;
  if (currentValue !== "" && currentValue != undefined && currentValue !== "0" && currentValue !== "00") {
    if (!pattern.test(currentValue.replaceAll(",",""))) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Value should be between 1000 and 999999999");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Value should be between 1000 and 999999999");
    fvc.classList.remove("valid");
  }
}

//expecte rate of return validation
function rateOfReturnValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var pattern = /^([1-9]|[12]\d|3[0-0])$/;
  if (currentValue !== "" && currentValue != undefined && currentValue !== "0" && currentValue !== "00") {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Value should be between 1 and 30");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Value should be between 1 and 30");
    fvc.classList.remove("valid");
  }
}


//heightFeet validation
function heightvalidationFt(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  currentValue = currentValue.toString().slice(0,1)
  var fvc = _obj.fvc;
  // var pattern = /^(\d{1}|10)$/;
  // var pattern = /^[4-7]$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue < 4  || currentValue > 6) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Invalid value (Enter a value between 4 and 6)");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required!");
    fvc.classList.remove("valid");
  }
}


//heightInch validation
function heightvalidationInch(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  currentValue = currentValue.toString().slice(0,2)
  var fvc = _obj.fvc;
  // var pattern = /^[0-11]$/;

  if (currentValue != undefined) {
    // if (!pattern.test(currentValue)) {
    if (currentValue < 0 ||  currentValue > 11) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Invalid value (Enter a value between 0 and 11)");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required!");
    fvc.classList.remove("valid");
  }
}


function futureYearValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  //
  // var pattern = /^[0-9]{1,4}$/;
  var pattern = /^([5-9]|[1-9][0-9])$/;

  if (currentValue !== "" && currentValue != undefined && currentValue > 4 && currentValue < 100) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid year");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
    
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Enter Year between 5-99");
    fvc.classList.remove("valid");
  }
}


// hra validation

function hraValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  currentValue = currentValue.replaceAll(",","")

  var minAmnt,maxAmnt, error
  if (currentValue.length > 0) {
    minAmnt = 1000;
    maxAmnt = 10000000;
    error = "Please enter a value within the given range 1K to 1Cr";
  }
  if (currentValue !== "" && currentValue != undefined) {
    // THE BELOW CONDITIONAL MAKES SURE THAT 0 IS AN ACCEPTABLE INPUT FOR DEARNESS ALLOWANCE
    // if(event.currentTarget.name == 'dearnessAllowance' && currentValue == 0){
    //BELOW CODE MAKES SURE THAT VALIDATION IS SKIPED FOR DEARNESS ALLOWANCE 
    if(event.currentTarget.name == 'dearnessAllowance'){
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
      return 
    }
    if (currentValue < minAmnt || currentValue > maxAmnt) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text(error);
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    // THE BELOW CONDITIONAL MAKES SURE THAT DEARNESS ALLOWANCE IS NOT A REQUIRED FIELD
    if(event.currentTarget.name != 'dearnessAllowance'){
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("This field is required");
      fvc.classList.remove("valid");
    }else{
      $(currentElement).find(".error-txt").addClass("d-none");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  }
}


// annualrateReturn validation

function annualrateReturnValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var annualRateCompound = $(currentElement).find('input[name=annual_rate_returns]')
  var rateReturnChildMrg = $(currentElement).find('input[name=ror_child_mrg]')
  var rateInflationChildMrg = $(currentElement).find('input[name=roi_child_mrg]')
  var incomeGrowthRate = $(currentElement).find('input[name=income_growth_rate]')
  // console.log(childAgeInput,'childAgeInput',childMrgAgeInput,'childMrgAgeInput');
  var pattern, error
  if (annualRateCompound.length > 0) {
    pattern = /^(3[0]|[1-9]|[1-2][0-9])$/;
    error = "Value should be between 1 and 30";
  } else if (rateReturnChildMrg.length > 0) {
    // pattern = /^(\d|[1][0-9]|2[0-5])$/;
    pattern =/^(0?[1-9]|[1-9]|1\d|2[0-5])$/
    error = "Value should be between 1 and 25";
  } else if(rateInflationChildMrg.length > 0){
    pattern = /^(0?[1-9]|[1-4][0-9]|50)$/;
    error = "Value should be between 1 and 50";
  }
   else if(incomeGrowthRate.length > 0){
    pattern = /^([4-9]|1[0-4])$/;
    error = "Value should be between 4 and 14";
  }else {
    pattern = /^(\d|[1][0-9]|2[0-5])$/;
    error = "Value should be between 0 and 25";
  }
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text(error);
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required");
    fvc.classList.remove("valid");
  }
}

//child age validation
function childAgeValidation(event) {
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value.replaceAll(",","");
  var isMarriageAge = currentElement.firstElementChild.id=='marriageAge'
  var childAge = $('#childAge').val()
  var fvc = _obj.fvc;
  var maxAge = event.currentTarget.max
  var minAge = event.currentTarget.min
  var error = `Please enter a value within the given range (${minAge} to ${maxAge})`

  if (currentValue !== "" && currentValue != undefined) {
    // THIS IS FOR MARRIAGE AGE TO MAKE SURE MARRIAGE AGE IS NOT GREATER THAN CHILD AGE
    if(isMarriageAge){
      if (currentValue < Number(minAge) ||  currentValue > Number(maxAge)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text(error);
        fvc.classList.remove("valid");
      }
      else if(parseInt(currentValue) <= parseInt(childAge)){
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text('Marriage age should be greater than child age');
        fvc.classList.remove("valid");
      }else{
        $(currentElement).find(".error-txt").text("");
        $(currentElement).find(".error-txt").removeClass("d-block");
        fvc.classList.add("valid");
      }

    // THIS IS FOR CHILD AGE
    }else{
      if (currentValue < Number(minAge) ||  currentValue > Number(maxAge)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text(error);
        fvc.classList.remove("valid");
      } else {
        $(currentElement).find(".error-txt").text("");
        $(currentElement).find(".error-txt").removeClass("d-block");
        fvc.classList.add("valid");
      }
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required!");
    fvc.classList.remove("valid");
  }
}

// membername validation

function membernameValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

      var pattern = /^[a-zA-Z\s]+$/;
    if (currentValue !== "" && currentValue != undefined) {
      if (!pattern.test(currentValue)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Please enter valid member name");
        fvc.classList.remove("valid");
      } else {
        $(currentElement).find(".error-txt").text("");
                fvc.classList.add("valid");
              }
    } else {
              $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").text("Please enter member name");
        fvc.classList.remove("valid");
      }
}


// relationwithmember validation

function relationwithmemberValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter only characters");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter realtionship with member");
    fvc.classList.remove("valid");
  }
}

// Place of Death validation

function placeofdeathValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z]+(?:[\s-][a-zA-Z]+)*$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid Place name");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter Death of Place");
    fvc.classList.remove("valid");
  }
}


// Pincode validation

function pincodeValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[1-9]{1}[0-9]{2}\s{0,1}[0-9]{3}$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid pincode");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter Pincode");
    fvc.classList.remove("valid");
  }
}


// Address validation

function addressValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^(\w*\s*[\#\-\,\/\.\(\)\&]*)+/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid Address");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter Address");
    fvc.classList.remove("valid");
  }
}


// companyname validation

function companynameValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  // memberName = $("input[name=member_name]");

  // if(memberName.val()==''){
    var pattern = /^[a-zA-Z]([a-zA-Z0-9.-_,]|[- @.#&!()\'])[^<>]*$/;
    if (currentValue !== "" && currentValue != undefined) {
      if (!pattern.test(currentValue)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Please enter valid company name");
        fvc.classList.remove("valid");
      } else {
        $(currentElement).find(".error-txt").text("");
        $(currentElement).find(".error-txt").removeClass("d-block");
        fvc.classList.add("valid");
        // ADDED TO REMOVE ERROR TEXT ON THE UNCLAIMED POLICYHOLDER PAGE (GROUP FORM)
        // if(memberName.length){
        //   memberName.parent().find('.error-txt').text('');
        //   memberName.parent().find('.error-txt').removeClass("d-block");
        //   memberName.parent().addClass("valid");
        // }
      }
    } else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("Please enter Company name");
      fvc.classList.remove("valid");
    }
  // }else{
  //   $(currentElement).find(".error-txt").text("");
  //   fvc.classList.add("valid");  
  // }
}


// Loan Account Number validation

function loanaccountnumberValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var pattern = /^[^<>]{4,20}$/
  // // console.log(event.currentTarget.dataset.groupclaim)
  // if(event.currentTarget.dataset.groupclaim == 'groupClaim'){
  //   pattern = /^[a-zA-Z0-9\_\-]{4,20}$/;
  // }else{
  //   pattern = /^\d{8,18}$/;
  // }

  // var pattern = /^\d{9,18}$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid Loan account number");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter Loan account number");
    fvc.classList.remove("valid");
  }
}


// COI Number validation

function coinumberValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var pattern = /^[^<>]{4,20}$/

  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid COI number");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter COI number");
    fvc.classList.remove("valid");
  }
}


// Landline Number validation

function landlinenumberValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /[0-9]{8}/g;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid contact number");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter contact number");
    fvc.classList.remove("valid");
  }
}


// STD Code validation

function stdCodeValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /[0-9]{3}/g;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".stdError").addClass("d-block");
      $(currentElement).find(".stdError").removeClass("d-none");
      $(currentElement).find(".stdError").text("Please enter valid STD code");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".stdError").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".stdError").addClass("d-block");
    $(currentElement).find(".stdError").text("Please enter STD code");
    fvc.classList.remove("valid");
  }
}

// Case Reference Validation
function caseReferenceValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^([IN]{2}[0-9]{14})|([0-9]{7})$/;
  if (currentValue !== "") {
    if (currentValue.length < 11) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid Case Reference");
      fvc.classList.remove("valid");

    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid Case Reference");
      fvc.classList.remove("valid");

    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter valid Case Reference");
    fvc.classList.remove("valid");
  }
}


// lifeCoverAmountValidation validation

function lifeCoverAmountValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  currentValue = currentValue.replaceAll(",","")
  var c2plLifeCover = $(currentElement).find('input[name=lifeCover]')
  var ulipPremium = $(currentElement).find('input[name=premium]')
  var nps_1b = $(currentElement).find('input[name=nps_1b]')
  var interestPaid = $(currentElement).find('input[name=interest_paid]')
  // console.log(childAgeInput,'childAgeInput',childMrgAgeInput,'childMrgAgeInput');
  var minAmnt,maxAmnt, error
  if (c2plLifeCover.length > 0) {
    minAmnt = 2500000;
    maxAmnt = 500000000;
    error = "Please enter a value within the given range 25L to 50Cr";
  } else if (ulipPremium.length > 0 ) {
    var minAmount = $(ulipPremium).attr('data-min-amount')
    // console.log(parseInt(minAmount),'minAmount');
    minAmnt = parseInt(minAmount);
    maxAmnt = 999999999;
    error = "Minimum amount is "+minAmnt ;
  } else if (nps_1b.length > 0) {
    minAmnt = 0;
    maxAmnt = 50000;
    error = "Maximum of Rs 50,000 per annum allowed";
  } else if(interestPaid.length > 0){
    minAmnt = 0;
    maxAmnt = 200000;
    error = "Please enter a value within the given range (Rs.0 to Rs.200000)";
  }

  // var pattern = /^[a-zA-Z\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue < minAmnt || currentValue > maxAmnt) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text(error);
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required");
    fvc.classList.remove("valid");
  }
}

// COD-age validation
var codSetAge
function codAgeValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  // codSetAge = dayjs().diff(parseInt(currentValue), 'years');
  // codSetAge = $(currentElement).find('#scdate').data('age');
  if (currentValue !== "" && currentValue != undefined) {
    if (!currentValue) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Age should be between 21-65 years");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required");
    fvc.classList.remove("valid");
  }
}

// itNpsAmountValidation validation

function itNpsAmountValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  currentValue = currentValue.replaceAll(",","")
  var basicSalary = $("#income-tax-form input[name=basic_salary]").val().replaceAll(",","")
  var nps_1 = $(currentElement).find('input[name=nps_1]')
  var nps_2 = $(currentElement).find('input[name=nps_2]')
  // console.log(childAgeInput,'childAgeInput',childMrgAgeInput,'childMrgAgeInput');
  var minAmnt,maxAmnt, error
  if (nps_1.length > 0 || nps_2.length > 0) {
    minAmnt = 0;
    maxAmnt = (basicSalary * 10) / 100;
    error = "Please enter a value within the given range (Rs."+minAmnt+" to Rs."+maxAmnt+")";
  } 

  // var pattern = /^[a-zA-Z\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue < minAmnt || currentValue > maxAmnt) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text(error);
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required");
    fvc.classList.remove("valid");
  }
}


// International Number validation

function internationalNumberValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var maxValue = event.currentTarget.max
  var minValue = event.currentTarget.min
  var blockSpecificNumbers = event.currentTarget.dataset.blockspecificnumbers


  var pattern = new RegExp (`^([0-9])\\d{${minValue},${maxValue}}$`);
  // var pattern = /^([0-9])\d{1,10}$/;
  // var pattern1 = new RegExp ("/^([0-9])\d{{"+minValue+"},13}$/");
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    }
    else if (blockSpecificNumbers && notAllowedNumbersArray.includes(Number(currentValue))){
      // BLOCK SPECIFIC NUMBER FOR SANCHAY PLUS OTP REQUIREMENT
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
     }
     else {
        $(currentElement).find(".error-txt").text("");
       $(currentElement).find(".error-txt").removeClass("d-block");
       fvc.classList.add("valid");

      } 
    }
   
  else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter mobile number");
    fvc.classList.remove("valid");
  }

}

// first name validation

function newfirstNameValidation(event) {
//GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^(?=.{3,20}$)(([a-zA-z\s])\2?(?!\2))+$/;
  if (currentValue !== "" && currentValue != undefined) {
if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid name");
      fvc.classList.remove("valid");
    } else {
        $(currentElement).find(".error-txt").text("");
        $(currentElement).find(".error-txt").removeClass("d-block");
        fvc.classList.add("valid");
            }
  } else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("Please enter name");
      fvc.classList.remove("valid");
  }
}


// Mobile  Number Country Code validation

function countrycodeNumberValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^(?!0+$|\+?0+$)(\+?\d{1,3}|\d{1,4})$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt1").addClass("d-block");
      $(currentElement).find(".error-txt1").removeClass("d-none");
      $(currentElement).find(".error-txt1").text("Please enter valid country code");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt1").text("");
      $(currentElement).find(".error-txt1").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt1").addClass("d-block");
    $(currentElement).find(".error-txt1").text("Please enter country code");
    fvc.classList.remove("valid");
  }
}


//Mobile  Number Country Code validation for optilead

function countrycodeNumberValidationOpti(event) {
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^(?!0+$|\+?0+$)(\+?\d{1,3}|\d{1,4})$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt1").addClass("d-block");
      $(currentElement).find(".error-txt1").removeClass("d-none");
      $(currentElement).find(".error-txt1").text("Please enter valid country code");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt1").text("");
      $(currentElement).find(".error-txt1").removeClass("d-block");
      // fvc.classList.add("valid");
      var inputElement = document.querySelector('.newBannerFormV2 #phone');
      var inputElementOptiSavings = document.querySelector('.ulipFormV3 #phone');
      if (inputElement && inputElement.value.length == 0) {
        var event = new Event('input');  
        inputElement.dispatchEvent(event);
      }else if (inputElementOptiSavings && inputElementOptiSavings.value.length == 0) {
          var event = new Event('input');  
          inputElementOptiSavings.dispatchEvent(event);
      }else{
         fvc.classList.add("valid");
      }
    }
  } else {
    $(currentElement).find(".error-txt1").addClass("d-block");
    $(currentElement).find(".error-txt1").text("Please enter country code");
    fvc.classList.remove("valid");
  }
}

// Date validation

function dobValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var pattern = /^\d{2}\/\d{2}\/\d{4}$/ ;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid Date");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter date");
    fvc.classList.remove("valid");
  }
}

// DOB hindi validation

function hindiDobValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var pattern = /^\d{2}\/\d{2}\/\d{4}$/ ;
    
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("कृपया सही जन्म तिथि दर्ज करें");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("कृपया जन्म तिथि दर्ज करें");
    fvc.classList.remove("valid");
  }
}

// Hindi first name validation

function hindiFirstNameValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^(?=.{3,20}$)(([a-zA-z\s])\2?(?!\2))+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("कृपया सही नाम दर्ज करें");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("कृपया नाम दर्ज करें");
    fvc.classList.remove("valid");
  }
}

// Hindi Email Validation

function hindiEmailAddressValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  //
  if (currentValue !== "") {
    //var pattern = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;

    // var pattern = /^([a-zA-Z])+([a-zA-Z0-9_.+-])+\@(([a-zA-Z])+\.+?(com|co|in|org|net|edu|info|gov|vekomy))\.?(in|org|net|edu|info|gov)?$/;
    //var pattern = /^([a-zA-Z])+([a-zA-Z0-9_.-])+\@(([a-zA-Z]+\.)?(com|co|in|org|net|edu|info|gov|vekomy))\.?(in|org|net|edu|info|gov)?$/;
    var pattern = /^[\w-\.]+@([A-Za-z-]+\.)+[A-Za-z-]{2,4}$/g;

    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("कृपया सही ईमेल दर्ज करें");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("कृपया ईमेल दर्ज करें");
    fvc.classList.remove("valid");
  }
}

// Hindi mobile number validation
function hindiMobileNumberValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[0]?[6789]\d{9}$/;
  if (currentValue !== "") {
    if (currentValue.length != 10) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("कृपया सही मोबाइल नंबर दर्ज करें");
      fvc.classList.remove("valid");
    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("कृपया सही मोबाइल नंबर दर्ज करें");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("कृपया मोबाइल नंबर दर्ज करें");
    fvc.classList.remove("valid");
  }
}

// APLHA NUMBERIC CHARACTERS WITH CUSTOM LENGTH
function alphaNumMaxLengthValidation(event) {
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var maxLength = event.currentTarget.dataset.maxlength ? event.currentTarget.dataset.maxlength : '20';
  var minlength = event.currentTarget.dataset.minlength ? event.currentTarget.dataset.minlength : '1';
  var fieldName = event.currentTarget.dataset.fieldname;
  var validMsg = fieldName ? `Please enter valid ${fieldName}` : `Please enter only alpha numeric characters`;
  var requiredMsg = fieldName ? `Please enter ${fieldName}` : `This field is required!`

  var pattern = new RegExp (`^[\\w\\d]{${minlength},${maxLength}}$`);
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text(validMsg);
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text(requiredMsg);
    fvc.classList.remove("valid");
  }
}

function lifeServiceAlphaNumMaxLengthValidation(event) {
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var maxLength = event.currentTarget.dataset.maxlength ? event.currentTarget.dataset.maxlength : '20';
  var minlength = event.currentTarget.dataset.minlength ? event.currentTarget.dataset.minlength : '1';

  var pattern = new RegExp (`^[\\w\\d]{${minlength},${maxLength}}$`);
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid Client Id");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter Client Id");
    fvc.classList.remove("valid");
  }
}



// input function
$(document).ready(function () {

  
  //The regular expression /[^\d]/g is used to find all characters in a given string that are not digits (0-9)
  $(".digitsOnly").on("input", function (e) {
    $(this).attr('data-comma-separation') ? $(this).val($(this).val().replace(/[^0-9,]/g, '')) : $(this).val($(this).val().replace(/[^\d]/g, ''));
    //$(this).val($(this).val().replace(/[^\d]/g, ''))
  });

  //Validation for floating number accept

  $(".digitsWithDecimal").on("input", function (e) {
    $(this).val($(this).val().replace(/[^0-9\.]/g, ''));
  });

  // BELOW FUNCTION REMOVES EMOJIS AND '<','>' SCRIPT BRACKETS FROM ALL INPUT FIELDS
  $('input[type=text], input[type=number]').on('input', function(event){
      var pattern  = /^$|^(?!\s)[a-zA-Z0-9,.;:_@.#&!-/()'\s-]+$/;
      var value = $(this).val();
      if(!(pattern.test(value))){
        $(this).val('');
        var emojiError = $(this).parent().find('.error-txt')
        emojiError.text('');
        emojiError.removeClass('d-block');
      }
  })

  // ATTACHING APPROPRIATE VALIDATION FUNCTIONS TO INPUT FIELDS
  $("[data-validation]").on("input", function (event) {
    var validation = $(this).attr("data-validation");
    if ($(event.currentTarget).is(':visible')) {
      validationobj[validation](event);
    }
  });
});
var addBtn;
var pwaSection;

$(document).ready(function(){
    addBtn = document.querySelector('.add-button');
    pwaSection = document.querySelector('.pwaSection');
    pwaSection.style.display = 'none';
});

let deferredPrompt;

 var isMobileBoolean;
 var mobileDevice = window.matchMedia("(max-width: 768px)");

 if (mobileDevice.matches) { // If media query matches
    isMobileBoolean = true;
  } else {
    isMobileBoolean = false;;
  }

window.addEventListener('beforeinstallprompt', (e) => {

    if(isMobileBoolean){
      // console.log("beforeinstallprompt", e);
      // Prevent Chrome 67 and earlier from automatically showing the prompt
      e.preventDefault();
      // Stash the event so it can be triggered later.
      deferredPrompt = e;
      // Update UI to notify the user they can add to home screen
      pwaSection.style.display = 'block';
    
      addBtn.addEventListener('click', (e) => {
        // hide our user interface that shows our A2HS button
        pwaSection.parentElement.style.display = 'none';
        // Show the prompt
        deferredPrompt.prompt();
        // Wait for the user to respond to the prompt
        deferredPrompt.userChoice.then((choiceResult) => {
            if (choiceResult.outcome === 'accepted') {
              console.log('User accepted the A2HS prompt');
            } else {
              console.log('User dismissed the A2HS prompt');
            }
            deferredPrompt = null;
          });
      });
    } 
  });
dataLayer = [{
    'pageName': window.location.pathname + window.location.hash,
    'userType': 'Guest',
}];

function productBox(e) {
    const currClickedEleName = e.innerHTML;
    dataLayer.push({ 'event': 'productBox', 'planName': currClickedEleName });
}

function moreMenuLink(e) {
    const currClickedEleName = e.previousElementSibling.previousElementSibling.innerHTML;
    dataLayer.push({ 'event': 'productBox', 'planName': currClickedEleName });
}

function categoryBox(e) {
    const clickedCategory = e.innerText;
    dataLayer.push({ 'event': 'productBox', 'planName': clickedCategory });
}

function downloadPdf() {
    const productName = $('.product-title').data("product-name");
    const pdfName = $(this).attr("data-pdf-link");
    const sectionName = $(this).attr("data-section-name");
    dataLayer.push({ 'event': 'pdfDownload', 'pdfName': pdfName, 'sectionName': sectionName, 'productName': productName });
}

function formSuccess() {
    dataLayer.push({ 'event': 'formSubmitSuccess', 'buttonName': 'pass CTA name', 'leadCounts': 'pass 1', 'leadId': 'pass lead id', 'quoteId': 'pass the quoteid', 'applicationId': 'pass the application ID' });
}

function formFailure() {
    dataLayer.push({ 'event': 'formSubmitFailed', 'buttonName': 'pass CTA name', 'errorDescription': 'pass the description of error occured', 'errorCounts': 'pass total number of error fields counts if applicable', 'applicationId': 'pass the application ID' });
}

function searchResult() {
    dataLayer.push({ 'event': 'searchResultClicked', 'searchResultClick': 'pass the search result that is clicked' });
}

function buttonClicked(e) {

    buttonName = $(this).attr("data-button-name");
    tabName = $(this).attr("data-tab-name");
    sectionName = $(this).attr("data-section-name");
    productName = $(this).attr("data-product-name");

    dataLayer.push({
        'event': 'ctaClick',
        'buttonName': buttonName,
        'tabName': tabName,
        'sectionName': sectionName,
        'productName': productName
    });
}

function videoClicked() {
    dataLayer.push({
        'event': 'videoClick',
        'videoName': 'pass the name of the video',
        'productName': 'pass the name of the plan for which video is related'
    });
}

function calculateClicked() {
    dataLayer.push({
        'event': 'calculatorClick',
        'planName': 'pass the recommended plan name ',
        'annualIncome': 'pass the annual income',
        'monthlyExpense': 'pass the monthly expense',
        'existingCover': 'pass the existing insurance cover',
        'educationQualification': 'pass the qualification of user'
    });
}

function contactClicked() {
    dataLayer.push({
        'event': 'contactClick',
        'contactMethod': 'pass the name of the contact like emailcall',
        'contactSection': 'pass the section name like online buy support,NRI services',
        'contactPostion': 'pass the position like top navigation'
    });
}

function iconClicked() {
    dataLayer.push({
        'event': 'iconClick',
        'iconName': 'pass the name of the icon like login,contact,share',
        'iconPosition': 'pass the position of the icon like header, footer',
        'sectionName': 'pass the section name'
    });
}

function genericLink() {
    dataLayer.push({
        'event': 'linkClick',
        'linkName': 'pass the link name',
        'tabName': 'Pass the tab name',
        'sectionName': 'pass the section name',
        'productName': 'pass the product name'
    });
}

function getCallBack(planName, productName) {

    dataLayer.push({
        'event': 'callFormSubmit',
        'planName': planName,
        'productName': productName
    });
}



function supportDataLayer(contactMethod, contactSection, contactPostion) {
    dataLayer.push({ 
    'event': 'contactClick', 
    'contactMethod': contactMethod,
    'contactSection': contactSection, 
    'contactPostion': contactPostion
 });
}

function linkDatalayer(linkName,tabName,sectionName,productName){
    dataLayer.push({
    'event':'linkClick',
    'linkName':linkName,
    'tabName': tabName,
    'sectionName': sectionName,
    'productName': productName
});
}

$(document).ready(function () {

    $('.chat-icon-container').on('click', function () {
        dataLayer.push({ 'event': 'chatWithUs' });
    });


    $('.toggleBtnClick').on('click', function () {

        buttonName = $(this).attr('data-button-name');
        tabName = $(this).parent().parent().find('h3').text();
        if (tabName = ' ') {
            tabName = $('body').find('a.product-calculate-btn').attr("data-tab-name");
        }

        dataLayer.push({
            'event': 'ctaClick',
            'buttonName': buttonName,
            'tabName': tabName
        });

    });

    $(".searchLinkClick").on('click', function () {

        linkName = $(this).innerHTML();
        dataLayer.push({
            'event': 'searchResultClicked',
            'searchResultClick': linkName
        });
    })


    var downloadPdfClick = document.querySelectorAll('.downloadPdfClick');
    downloadPdfClick.forEach(function (element) {
        element.addEventListener('click', function (event) {

            buttonName = element.getAttribute("data-button-name");
            sectionName = element.getAttribute("data-section-name");
            productName = element.getAttribute("data-product-name");
            pdfName = element.getAttribute("data-pdf-name");

            dataLayer.push({
                'event': 'pdfDownload',
                'pdfName': pdfName,
                'sectionName': sectionName,
                'productName': productName
            });
        })
    })


    var dataLayerBtnClick = document.querySelectorAll('.dataLayerBtnClick');
    dataLayerBtnClick.forEach(function (element) {
        element.addEventListener('click', function (event) {

            buttonName = element.getAttribute("data-button-name");
            tabName = element.getAttribute("data-tab-name");
            // if(tabName == null){
            //     tabName = $(this).parents().find('.products-tab-title-section ul li').hasClass("active").attr("data-tab-name");
            // }
            sectionName = element.getAttribute("data-section-name");
            // if(sectionName == null){
            //     sectionName = $(this).parent().parent().find('h4').text();
            // }
            productName = element.getAttribute("data-product-name");
            // if(productName == null){
            //     productName = $('body').find('h1.product-title').attr("data-product-name");
            // }
            dataLayer.push({
                'event': 'ctaClick',
                'buttonName': buttonName,
                'tabName': tabName,
                'sectionName': sectionName,
                'productName': productName

            });
        })
    })

    var dataLayerVideoClick = document.querySelectorAll('.videoBtnDataLayer');
    dataLayerVideoClick.forEach(function (element) {
        element.addEventListener('click', function (event) {

            videoName = element.getAttribute("data-video-name");
            productName = element.getAttribute("data-product-name");

            dataLayer.push({
                'event': 'videoClick',
                'videoName': videoName,
                'productName': productName
            });
        })
    })


    var supportedLinks = document.querySelectorAll('a[data-support]');
    supportedLinks.forEach(function (element) {
        element.addEventListener('click', function (event) {
            supportDataLayer(event.currentTarget.dataset.support, event.currentTarget.dataset.section, event.currentTarget.dataset.position)
        });
    })

    // Generic Button Click Events Across the Website Start
    var btnClickDataLayer = document.querySelectorAll('.siteButton');
    btnClickDataLayer.forEach(function (element) {
        element.addEventListener('click', function (event) {
            buttonName = element.innerText ? element.innerText : '';
            tabName = document.querySelector('.active') ? document.querySelector('.active').innerText : '';
            sectionName = element.getAttribute("data-section-name");
            productName = document.getElementById('page-name').value;
            // console.log(document.getElementsByTagName('section').className)
            
            dataLayer.push({
                'event':'ctaClick',
                'buttonName':buttonName,
                'tabName':tabName,
                'sectionName':'',
                'productName':productName
            });

        })
    })
    // Generic Button Click Events Across the Website End

    // Button click event for Branch Locator Start
    var branchLocatorDataLayer = document.querySelectorAll('.hdfc-office-locations');
    branchLocatorDataLayer.forEach(function (element) {
        element.addEventListener('click', function (event) {
            buttonName = element.innerText ? element.innerText : '';
            tabName = document.querySelector('.sourcepathlist .active') ? document.querySelector('.sourcepathlist .active').innerText : '';
            sectionName = element.getAttribute("data-section-name");
            productName = document.getElementById('page-name').value;
            // console.log(document.getElementsByTagName('section').className)
            
            dataLayer.push({
                'event':'ctaClick',
                'buttonName':buttonName,
                'tabName':tabName,
                'sectionName':'',
                'productName':productName
            });

        })
    })
    // Button click event for Branch Locator End

    // Button click event for Toggle Image SCB Button Start
    var scbDataLayer = document.querySelectorAll('.scb-data-layer');
    scbDataLayer.forEach(function (element) {
        element.addEventListener('click', function (event) {
            buttonName = element.innerText ? element.innerText : '';
            tabName = document.querySelector('.sourcepathlist .active') ? document.querySelector('.sourcepathlist .active').innerText : '';
            sectionName = element.getAttribute("data-section-name");
            productName = document.getElementById('page-name').value;
            // console.log(document.getElementsByTagName('section').className)
            
            dataLayer.push({
                'event':'ctaClick',
                'buttonName':buttonName,
                'tabName':tabName,
                'sectionName':'',
                'productName':productName
            });

        })
    })
    // Button click event for Toggle Image SCB Button End

    // product-benefits-cards-data-layer Start
    var pbcDataLayer = document.querySelectorAll('.product-benefits-cards-data-layer');
    pbcDataLayer.forEach(function (element) {
        element.addEventListener('click', function (event) {
            buttonName = element.innerText ? element.innerText : '';
            tabName = document.querySelector('.sourcepathlist .active') ? document.querySelector('.sourcepathlist .active').innerText : '';
            sectionName = element.getAttribute("data-section-name");
            productName = document.getElementById('page-name').value;
            // console.log(document.getElementsByTagName('section').className)
            
            dataLayer.push({
                'event':'ctaClick',
                'buttonName':buttonName,
                'tabName':tabName,
                'sectionName':'',
                'productName':productName
            });

        })
    })
    // product-benefits-cards-data-layer End

    // elig-data-layer Start
    var eligDataLayer = document.querySelectorAll('.elig-data-layer');
    eligDataLayer.forEach(function (element) {
        element.addEventListener('click', function (event) {
            buttonName = element.innerText ? element.innerText : '';
            tabName = document.querySelector('.sourcepathlist .active') ? document.querySelector('.sourcepathlist .active').innerText : '';
            sectionName = element.getAttribute("data-section-name");
            productName = document.getElementById('page-name').value;
            // console.log(document.getElementsByTagName('section').className)
            
            dataLayer.push({
                'event':'ctaClick',
                'buttonName':buttonName,
                'tabName':tabName,
                'sectionName':'',
                'productName':productName
            });

        })
    })
    // elig-data-layer End

    // cal-data-layer Start
    var calDataLayer = document.querySelectorAll('.cal-data-layer');
    calDataLayer.forEach(function (element) {
        element.addEventListener('click', function (event) {
            buttonName = element.innerText ? element.innerText : '';
            tabName = document.querySelector('.sourcepathlist .active') ? document.querySelector('.sourcepathlist .active').innerText : '';
            sectionName = element.getAttribute("data-section-name");
            productName = document.getElementById('page-name').value;
            // console.log(document.getElementsByTagName('section').className)
            
            dataLayer.push({
                'event':'ctaClick',
                'buttonName':buttonName,
                'tabName':tabName,
                'sectionName':'',
                'productName':productName
            });

        })
    })
    // cal-data-layer End

    // btn-white-data-layer Start
    var btnWhiteDataLayer = document.querySelectorAll('.btn-white-data-layer');
    btnWhiteDataLayer.forEach(function (element) {
        element.addEventListener('click', function (event) {
            buttonName = element.innerText ? element.innerText : '';
            tabName = document.querySelector('.sourcepathlist .active') ? document.querySelector('.sourcepathlist .active').innerText : '';
            sectionName = element.getAttribute("data-section-name");
            productName = document.getElementById('page-name').value;
            // console.log(document.getElementsByTagName('section').className)
            
            dataLayer.push({
                'event':'ctaClick',
                'buttonName':buttonName,
                'tabName':tabName,
                'sectionName':'',
                'productName':productName
            });

        })
    })
    // btn-white-data-layer End
    var linkdata = document.querySelectorAll('a[data-support]');

    

    //Icon Clicked DataLayer start

    var iconClicked = document.querySelectorAll('a[data-icon]');
    iconClicked.forEach(function (element) {
        element.addEventListener('click', function (event) {
            
            iconName = element.getAttribute("data-icon-name");
            iconPosition = element.getAttribute("data-position");
            sectionName = element.getAttribute("data-section-name");
            
            dataLayer.push({
                'event':'iconClick',
                'iconName':iconName,
                'iconPosition':iconPosition,
                'sectionName':sectionName
            });

        })
    })
    //Icon Clicked DataLayer end
    

    //Link Clicked DataLayer start

    // var linkClicked = document.querySelectorAll('a');
    // linkClicked.forEach(function (element) {
    //     element.addEventListener('click', function (event) {
            
    //         linkName = element.getAttribute("href");
    //         tabName = "";
    //         sectionName = "";
    //         productName = "";
            
    //         dataLayer.push({
    //             'event':'linkClick',
    //             'linkName': linkName,
    //             'tabName': tabName,
    //             'sectionName': sectionName,
    //             'productName': productName
    //         });

    //     })
    // })
    //Link Clicked DataLayer end

        // Banner Click Data layer
        var bannerTag = document.querySelectorAll('.bannerClick');
        bannerTag.forEach(function (element) {
            element.addEventListener('click', function (event) {
                var bannerLocation = '';
                var bannerCategory = event.currentTarget.getAttribute('data-categoryName');
                var bannerName = event.currentTarget.querySelector('img').getAttribute('alt');
                var urlObject = new URL(window.location.href);
                var path = urlObject.pathname;
    
                // only for local system
                if (window.location.href.includes('localhost')) {
                    path = path.replace('/content/hdfclifeinsurancecompany/in/en', "/").replace(".html", "");
                } 
    
                if (path == '/') {
                    bannerLocation = 'home page'
                } else {
                    bannerLocation = path.replaceAll("/", "").replaceAll("-", " ");
                }
              
    
                dataLayer.push({
                    'event': 'select_banner',
                    'banner_location': bannerLocation,
                    'banner_category': bannerCategory,
                    'banner_name': bannerName,
                    'userID': ''
                });
    
            })
        });
        // End of Banner Click Data layer
});

// Form Submission - Successful Start

function formSubmissionSuccess(btnName) {
    dataLayer.push({
        'event':'formSubmitSuccess',
        'buttonName':btnName,
        'leadId': '',
        'leadCounts':'1',
        'quoteId': '',
        'applicationId': ''
    });
}
// Form Submission - Successful End

// Form Submission - Failed Start

function formSubmissionFailed(btnName, err) {
    dataLayer.push({
        'event':'formSubmitFailed',
        'buttonName':btnName,
        'errorDescription': err,
        'errorCounts':'',
        'applicationId': ''
    });
}
// Form Submission - Failed End


// Lead Popup Category Page start here

function leadPopUpDataLayer(btnName, productName){
    dataLayer.push({
        'event': 'popUp_formSubmit',
        'event_category':'Form Submmision',
        'event_action':btnName,
        'event_label':' Pop Up Form Submitted',       
        'productName':productName
    });
}
// Lead Popup Category Page end here

//Home logo click

var HomeLogoClick = document.querySelectorAll('.logodl');
HomeLogoClick.forEach(function (element) {
        element.addEventListener('click', function (event) {
            dataLayer.push({
                event: "ctaClick",
                buttonName: "homebuttonLogo",
                productName: "Home Page",
                pagePath:'/'
            });
        })
    })

// KC Recommended Button Data Layer start
var recommendbtn = document.querySelectorAll('.recommended-form-submit');
recommendbtn.forEach(function (element) {
    element.addEventListener('click', function (event) {
        event_action = document.getElementById('type_of_query').value;
        event_label = document.getElementById('type_of_subquery').value;
        
        dataLayer.push({
            'event':'cta_dropdown',
            'event_category':'Reccomended to me',
            'event_action':event_action,
            'event_label':event_label
        });

    })
})

// End of KC Recommended Button Data Layer

// Iwantto Proceed Button Data layer
var proceedbtn = document.querySelectorAll('.ProceedButton');
proceedbtn.forEach(function (element) {
    element.addEventListener('click', function (event) {
        if($('#Desktop').is(':visible')){
            event_label = document.querySelector('#Desktop option:checked').text;
        }
        else{
            event_label = document.querySelector('#Mobile option:checked').text;
        }
        dataLayer.push({

          'event': 'cta_dropdown', 
          'event_category':'I Want To', 
          'event_action':'Proceed',
          'event_label':event_label
        });

    })
})
// End of Iwantto Proceed Button Data layer
let parts = window.location.pathname.split('/');
let lastItem = parts[parts.length - 1];
let isPageAllowed = (lastItem != "aggregator" && lastItem !="digital-alliance" && lastItem != "search-result");

$(document).ready(function(){
    
    
    var url = new URL(window.location);
    let params = new URLSearchParams(url.search.slice(1));
    

    var dataAttribution = document.querySelectorAll('a[data-attribution]');
    dataAttribution.forEach(function(element){

        if(element.href!="" && isPageAllowed){
            
            checkParams(params, element);
        }

    });


    var maDataAttribution = document.querySelectorAll('a[href^="http"], a[href^="/"]');
    maDataAttribution.forEach(function (element){

        if(element.href!="" && isPageAllowed){

            checkParams(params, element);
        }

    })
    
})


function checkParams(params, element){
    
        
    linkURL = new URL(element.href);
    linkOrigin = linkURL.origin+linkURL.pathname;
    let linkParams = new URLSearchParams(linkURL.search.slice(1));

    if(params==""){

        element.href = linkURL;

    }else{        

        if(params.has("source")){
            var sourceCode = params.get("source");  
            linkParams.delete("source");  
            linkParams.delete("sourcecode");    
            linkParams.delete("source-code");                
            params.set("source", sourceCode);
        }
        if(params.has("source-code")){
            var sourceCode = params.get("source-code");
            linkParams.delete("source");  
            linkParams.delete("sourcecode");    
            linkParams.delete("source-code");  
            params.set("source-code", sourceCode);
        }
        if(params.has("sourcecode")){
            var sourceCode = params.get("sourcecode");  
            linkParams.delete("source");  
            linkParams.delete("sourcecode");    
            linkParams.delete("source-code");
            params.set("sourcecode", sourceCode);
        }

        if(params.has("agentcode")){
            var agentCode = params.get("agentcode");
            linkParams.delete("agentcode");             
            linkParams.delete("agent-code");        
            params.set("agentcode", agentCode);
        }

        if(params.has("agent-code")){
            var agentCode = params.get("agent-code");
            linkParams.delete("agentcode");         
            linkParams.delete("agent-code");            
            params.set("agent-code", agentCode);
        }
        if(params.has("utm_medium")){
            var utmMedium = params.get("utm_medium");
            linkParams.delete("utm_medium");            
            params.set("utm_medium", utmMedium);
        }
        if(params.has("utm_source")){
            var utmSource = params.get("utm_source");
            linkParams.delete("utm_source");            
            params.set("utm_source", utmSource);
        }

        if(linkParams==""){
            element.href = linkOrigin+"?"+params;
        }else{
            if(lastItem != "aggregator" || lastItem !="digital-alliance"){
                return;
            }
            element.href = linkOrigin+"?"+linkParams+"&"+params;
        }

    }
}
/*! lozad.js - v1.16.0 - 2020-09-06
* https://github.com/ApoorvSaxena/lozad.js
* Copyright (c) 2020 Apoorv Saxena; Licensed MIT */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});
$(document).ready(function () {
    // const filteredEmailFields = $('[data-validation="emailaddress"]').not('.emailAuto, .emailFooter, .emailAddress');
    const filteredEmailFields = $('[data-validation="emailaddress"], [data-validation="emailaddressCustom"]').not('.emailAuto, .emailFooter, .emailAddress');


    // Append the ul to each email field's parent
    filteredEmailFields.each(function (index) {
        let ul = $('<ul>', {
            id: 'autoEmailSuggestionList-' + index,
            class: 'autoEmailSuggestionList',
            css: { display: 'none' }
        });
        const email = $(this);
        const parent = email.parent();
        // Check if the parent has position set to relative or if it has no position property
        const position = parent.css('position');
        if (position !== 'relative') {
            parent.css({ position: 'relative' });
        }

        $(this).closest(".modal-dialog").css({ "overflow": "unset" });
        $(this).closest(".modal-content").css({ "border-radius": "10px" });

        parent.append(ul);

    });

    filteredEmailFields.autoEmail([
        // "aol.com",
        // "facebook.com",
        "gmail.com",
        // "googlemail.com",
        // "google.com",
        "hotmail.com",
        // "hotmail.com",
        // "mac.com",
        // "me.com",
        // "mail.com",
        // "msn.com",
        // "live.com",
        "rediff.com",
        "yahoo.com",
        "yahoo.co.in"
    ]);
});

(function ($) {
    $.fn.autoEmail = function (domains) {
        return this.each(function (index) {
            var $this = $(this);
            var $suggestionList = $('#autoEmailSuggestionList-' + index);

            function addListeners() {
                var $results = $suggestionList.find('li');
                $results.first().addClass("highlighted");
                $results.click(function () {
                    $this.val($(this).text());
                    $this.focus();
                    $suggestionList.hide();
                    $this.trigger('input');
                });
                $results.mouseenter(function () {
                    $(this).addClass("highlighted");
                    $(this).siblings().removeClass("highlighted");
                });

                $suggestionList.show();
            }

            // check for autocomplete after each key
            $this.keyup(function (e) {
                if (e.keyCode == 40 || e.keyCode == 38) {
                    // if user clicks down or up arrow
                    var $highlighted = $suggestionList.find('.highlighted');
                    var $newHighlight;
                    if (e.keyCode == 40) {
                        // down arrow
                        $newHighlight = $highlighted.next();
                        if (!$newHighlight.length) {
                            $newHighlight = $suggestionList.find('li').first();
                        }
                    } else if (e.keyCode == 38) {
                        // up arrow
                        $newHighlight = $highlighted.prev();
                        if (!$newHighlight.length) {
                            $newHighlight = $suggestionList.find('li').last();
                        }
                    }
                    $highlighted.removeClass("highlighted");
                    $newHighlight.addClass("highlighted");
                }
                else if (e.keyCode == 13) {
                    var $selected = $suggestionList.find('.highlighted');
                    if ($selected.length && $suggestionList.is(':visible')) {
                        $this.val($selected.text());
                        $suggestionList.hide();
                        $this.trigger('input');
                        e.preventDefault();
                    }
                }

                else {
                    var exactMatches = [];
                    var errorMatches = [];

                    $suggestionList.empty();
                    $suggestionList.hide();

                    // get substring to try appending with autocomplete email
                    var emailsDirty = $(this).val().split("@");
                    if (emailsDirty.length < 2 || emailsDirty[0] == "") {
                        return;
                    }
                    var emailDomain = emailsDirty[1]; //get the text after @

                    if (emailDomain.length === 0) {
                        exactMatches.push(
                            // domains[1],
                            // domains[2],
                            // domains[5],
                            // domains[6],
                            // domains[12]
                            ...domains
                        );
                    } else {
                        for (var i = 0; i < domains.length; i++) {
                            var testString = domains[i].substr(0, emailDomain.length);
                            if (emailDomain === testString) {
                                exactMatches.push(domains[i]);
                            } else if (
                                getEditDistance(emailDomain, testString) < 2 &&
                                emailDomain.length > 1
                            ) {
                                errorMatches.push(domains[i]);
                            }
                        }
                    }

                    if (exactMatches.length > 0) {
                        for (var i = 0; i < exactMatches.length; i++) {
                            // take first domain match for autocomplete
                            var subStr = exactMatches[i].substr(
                                emailDomain.length,
                                exactMatches[i].length
                            );

                            // insert exact match into list
                            $suggestionList.append(
                                "<li class='emailSuggestionListItem'>" + $this.val() + "<span class='suggestion-end'>" + subStr + "</span></li>"
                            );
                        }
                        addListeners();
                    }
                    // else if (errorMatches.length > 0) {
                    //     for (var i = 0; i < errorMatches.length; i++) {
                    //         // take first domain match for autocomplete
                    //         var subStr = errorMatches[i].substr(
                    //             emailDomain.length,
                    //             errorMatches[i].length
                    //         );

                    //         // insert error corrected match into list
                    //         $suggestionList.append(
                    //             "<li>" + emailsDirty[0] + "@<b>" + errorMatches[i] + "</b></li>"
                    //         );
                    //     }
                    //     addListeners();
                    // }
                    // } 
                }
            });

            // Prevent form submission on enter key when suggestion list is visible
            $this.on('keydown', function (e) {
                if (e.keyCode == 13 && $suggestionList.is(':visible')) {
                    e.preventDefault();
                }
            });

            // Hide suggestion list when clicking outside
            $(document).on('click', function (e) {
                if (!$(e.target).closest($this).length && !$(e.target).closest($suggestionList).length) {
                    $suggestionList.hide();
                }
            });
        });
    };
})(jQuery);

// Compute the edit distance between the two given strings
function getEditDistance(a, b) {
    if (a.length === 0) return b.length;
    if (b.length === 0) return a.length;

    var matrix = [];

    // increment along the first column of each row
    var i;
    for (i = 0; i <= b.length; i++) {
        matrix[i] = [i];
    }

    // increment each column in the first row
    var j;
    for (j = 0; j <= a.length; j++) {
        matrix[0][j] = j;
    }

    // Fill in the rest of the matrix
    for (i = 1; i <= b.length; i++) {
        for (j = 1; j <= a.length; j++) {
            if (b.charAt(i - 1) == a.charAt(j - 1)) {
                matrix[i][j] = matrix[i - 1][j - 1];
            } else {
                matrix[i][j] = Math.min(
                    matrix[i - 1][j - 1] + 1, // substitution
                    Math.min(
                        matrix[i][j - 1] + 1, // insertion
                        matrix[i - 1][j] + 1
                    )
                ); // deletion
            }
        }
    }

    return matrix[b.length][a.length];
}


const upperCaseInputs = document.querySelector('[data-transFormUppercase="uppercase"]');
if (upperCaseInputs) {
upperCaseInputs.addEventListener('input', function() {
  const uppercasedValue = this.value.toUpperCase(); 
  this.value = uppercasedValue; 
  console.log(uppercasedValue); 
});
}
$(document).ready(function (){
    var $emptyModal = $('#_emptyModal'); 
    var $crossIcon = $('.emptymodal .closeIcon'); 
    var isEditMode = $emptyModal.data('wcmmode') != 'DISABLED';
    if(!isEditMode && $emptyModal.length != 0){
        $emptyModal.modal({
            'backdrop' : 'static',
            'show' : true
        })
    }

    $crossIcon.each(function() {
        $(this).on("click", function() {
            var modalId = $(this).closest(".modal.fade").attr("id");
            $(`#${modalId}`).modal('hide');
        })
    })
});
(function(_global) {

    var headerApiObj = (function(){
        var headerApiList = {};
        function getPageRating(requestObject) {
            return new Promise(function(resolve, reject) {
                apiUtility.GET_PAGE_RATING(requestObject).then(function(res){
                    resolve(res);
                }).catch(function(err) {
                    reject(err);
                })
            })
        }

        function getAppLink(requestObject) {
            return new Promise(function(resolve, reject) {
                apiUtility.GET_APP_LINK(requestObject).then(function(res) {
                    resolve(res);
                }).catch(function(err) {
                    reject(err);
                })
            })
        }
        headerApiList.getPageRating = getPageRating;
        headerApiList.getAppLink = getAppLink;
        return jsHelper.freezeObject(headerApiList);
    })();
    _global.jsHelper.defineReadOnlyObjProp(_global, 'headerAPiObj', headerApiObj);

})(window || document || {})
var currentMegaMenuLink;
$(document).ready(function() {
      
    var reqObj = {
        "data" : {},
        "host": "www.hdfclife.com"
    };
    var category = $('input[name=categories]').val();
    var slug = $('input[name=pageslug]').val();
    // var currentPageName = $('input[name=currentPageCategory]').val();
    // var currentPageNameSplit = currentPageName.split('/');
    // var currentPageCategory = currentPageNameSplit.length - 2;
    // var categories = category != '' ? category : currentPageCategory;
    var categories = category;
    var categoriesArr = [];
    categoriesArr.push(categories);
    reqObj["data"]["categories"] = JSON.stringify(categoriesArr);
    reqObj["data"]["slug"] = slug;
    $( ".megaMenuLink" ).click(function() {
        getRating(reqObj);
      });

    var subscribeMessageHeaderHide = document.querySelectorAll('.message-success-applink-header');
    $('.mobileNumber').focus(function(e) {
        $(subscribeMessageHeaderHide).hide();
    })

    var subscribeMessageHeaderMobHide = document.querySelectorAll('.message-success-applink-header-mob');
    $('.mobileNumber').focus(function(e) {
        $(subscribeMessageHeaderMobHide).hide();
    })

    // var appLinkBtn = document.getElementById('appLinkHeaderBtn');
    // appLinkBtn.addEventListener('submit',function(){  
    // })
})
    
// $("#appLinkHeaderBtn").on("click", function(e) {
//     e.preventDefault();
//     console.log('formsubmit event: ',e);
// });

$('.appLinkHeaderBtn').on('click', function(e) {
    e.preventDefault();
    var form = $(this).parents('form');
    var isValid = isFormValid(form);
    if (isValid) {
        var _this = $(this).parents('form');
        var mobileNumber = _this.find('input[name=mobileNumber]').val();        
        var appLinkReqObj = {
            "phone": mobileNumber,
            "ndfc_flag": true
        }
        
        getAppLinkHeader(appLinkReqObj);
        $('.appLink').trigger('reset');
    }
});

$('.app-link').on('paste keyup', function(e){
    $(this).val($(this).val().replace(/[^\d]/g, ''));
});

$(".getAppLinkCheckHeader").on('click', function () {
    if ($(this).is(":checked")) {
        $(".checkAppLinkHeaderError").css("display", "none");
        $("#downloadLinkHeader").removeAttr("disabled", "disabled");
    } else {
        $(".checkAppLinkHeaderError").css("display", "block");
        $(".checkAppLinkHeaderError").html("First please authorize HDFC Life to contact you, by checking the checkbox below");
        $("#downloadLinkHeader").attr("disabled", "disabled");
        $(".message-success-applink-header-mob").css("display", "none");
    }
});

function getRating(reqObj) {
    headerAPiObj.getPageRating(reqObj).then(function(res) {
        renderPageRating(res);
        if(res.statusCode == 200){
            $(".countStars").text("(" + res.responseJson.rating + " / 5)" );
        }
    }).catch(function(err) {
        console.log('err: ', err);
    })
}

function getAppLinkHeader(appLinkReqObj) {
    headerAPiObj.getAppLink(appLinkReqObj).then(function(res) {
        renderSuccessMessage(res, appLinkReqObj);
    }).catch(function(err) {
        console.log('err: ', err);
        formSubmissionFailed('appLinkHeaderBtn-header-data-layer', err)
    })
}

function renderPageRating(res) {
    if (res.statusCode === 200) {
        var pageHeaderRating = document.getElementById('svgHeaderRating');
        var starHeaderCounter = 5;
        var ratingHeader = res.responseJson.rating;
        var increment = 0;
        var svgImgFilled = '<use xlink:href="#stars-full-star" />';
        var svgHalfFilled = '<use xlink:href="#stars-half-star" />';
        var svgImgUnFilled = '<use xlink:href="#stars-empty-star" />';        
        var decNumber = ratingHeader.toString().split('.');
        
        if(ratingHeader <= 4) {


            if(ratingHeader % 1 != 0){
                while(increment < decNumber[0]) {
                    pageHeaderRating.innerHTML += svgImgFilled;
                    increment++;
                }
                
                pageHeaderRating.innerHTML += svgHalfFilled;
                
            }else{
                while(increment < ratingHeader) {
                    pageHeaderRating.innerHTML += svgImgFilled;
                    increment++;
                }
            }
            
            if(decNumber[1]){
                while(starHeaderCounter > (ratingHeader+1)) {
                    pageHeaderRating.innerHTML += svgImgUnFilled;
                    starHeaderCounter--;
                }
            }else{
                while(starHeaderCounter > ratingHeader) {
                    pageHeaderRating.innerHTML += svgImgUnFilled;
                    starHeaderCounter--;
                }
            }

            $(".countStars").text("(" + res.responseJson.rating + " / 5)" );

        }else if(ratingHeader >= 4 && ratingHeader <=5){


            if(ratingHeader % 1 != 0){
                while(increment < (decNumber[0])) {
                    pageHeaderRating.innerHTML += svgImgFilled;
                    increment++;
                }
                
                pageHeaderRating.innerHTML += svgHalfFilled;
                
            }else{
                while(increment < ratingHeader) {
                    pageHeaderRating.innerHTML += svgImgFilled;
                    increment++;
                }
            }
            $(".countStars").text("(" + res.responseJson.rating + " / 5)" );
        }
    } else {
        document.getElementsByClassName('ratingStarLabel').style.display = 'none';
        console.log('no page rating available');
    }
}

function renderSuccessMessage(res, appLinkReqObj) {
    if (res.statusCode == 200) {
        var isMobile
        var mediaQuery = window.matchMedia("(max-width: 768px)");
        isMobile = mediaQuery.matches ? true : false;
        if (isMobile) {
            $('.message-success-applink-header-mob').css({ 'display': 'block' });
            $('.message-success-applink-header-mob').text('Link sent to mobile number ' + appLinkReqObj['phone']);
            formSubmissionSuccess('subscribeButton-data-layer');
        } else {
            $('.message-success-applink-header').css({ 'display': 'block' });
            $('.message-success-applink-header').text('Link sent to mobile number ' + appLinkReqObj['phone']);
        }
    } else {
        console.log('error');
    }
}
// Header Js
var searchTerm = "";
var basepathVal = "";
var basepdfpathVal = "";
$(window).ready(function () {
    $(document).on('click', '.calculate-btn', function () {
        $('.let-us-calculate-section').slideUp();
        $('.calculator-section').slideDown();
        $('html, body').animate({
            scrollTop: $(".calculator-section").offset().top - ($('.headerWrap').height() + 20)
        }, 100);
    });
    $(document).on('click', '.close-icon', function () {
        $('.let-us-calculate-section').slideDown();
        $('.calculator-section').slideUp();
        $('.calculate-bottom-section').slideUp();
    });
    // click on dropdown for category
    //  $(".searchDropdown").click(function (e) {
    //        e.preventDefault(),
    //        $(this).toggleClass("opened"),
    //        $(this).parent().find(".searchSelectOption-container").toggleClass("opened")
    //});
    // When User Click on Search Icon
    $('#searchIconBtn, #searchHeaderBtn').click(function (e) {
        //e.preventDefault();
        var defaultSearchCategory = $('#searchBoxCategory label').text().trim();
        searchPageRedirect(defaultSearchCategory);
    });
    $('.mobile-search-icon').click(function (e) {
                
        // console.log("In search function");
        var defaultSearchCategory = $('#searchBoxCategory label').text().trim();
        searchPageRedirect(defaultSearchCategory);
    });
    $('#productSearch, #searchInputHeader').keypress(function (e) {
        //e.preventDefault();
          
        var key = e.which;
        if (key == 13) {
              
            var defaultSearchCategory = $('#searchBoxCategory label').text().trim();
            searchPageRedirect(defaultSearchCategory);
        }
        
    });
    $('#productSearch, #searchInputHeader').on('input', function(){
        var patternGlobal = /^[A-Za-z0-9\s]+$/;
        if ($('#productSearch').val() != "") {
            searchTerm = $('#productSearch').val().trim();
        } else {
            searchTerm = $('#searchInputHeader').val().trim();
        }
    
        if(!(patternGlobal.test(searchTerm))){
            $(this).val('');
        }
    })
    // Get Dropdown Value
    $('#searchHeaderOption li, #searchMobileSelect li').click(function () {
        basepathVal = $(this).attr('data-basepath');
        basepdfpathVal = $(this).attr('data-basepath');
    });

    if($('.new-hdfc-life-insurance-header .mobileHeader').is(':visible') && $('.new-hdfc-life-insurance-header .deskTopHeader').is(':hidden')){
        $(".new-hdfc-life-insurance-header .mobSearchBtn").click(function (t) {
            t.preventDefault(),
              $(".mobHeaderSearchWrp").fadeIn(),
              $(".mobAccountDD").removeClass("opened");
          })
          $(".new-hdfc-life-insurance-header .mobSearchClose").click(function (t) {
            t.preventDefault(), $(".mobHeaderSearchWrp").fadeOut();
          })
            
        }

    if($('.new-hdfc-life-insurance-header .menuslideList').length == 1){
        $('.new-hdfc-life-insurance-header .swiffy-slider button.prevBtn').css('display','none');
        $('.new-hdfc-life-insurance-header .swiffy-slider button.nextBtn').css('display','none');
    }



});


function searchPageRedirect(defaultSearchCat) {
    // escAnalyze();
    if ($('#productSearch').val() != "") {
        searchTerm = htmlEntities($('#productSearch').val().trim());
    } else {
        searchTerm = htmlEntities($('#searchInputHeader').val().trim());
    }

    function htmlEntities(searchTerm) {
        return String(searchTerm).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
    }
    dataLayer.push({ 'event': 'searchTermEntered', 'searchTerm': searchTerm });
    if (window.location.host == 'stg1-website.hdfclife.tech' || window.location.host == 'www.hdfclife.com') {
        if (escAnalyze()) {
            if (defaultSearchCat == "All") {
                window.location.href = "/search-result.html?ishome=1&fulltext=" + decodeURIComponent(searchTerm) + "&path=" + "/content/hdfclifeinsurancecompany/in/en&pdfpath=&escalation=" + low;
            } else if (basepdfpathVal != "" && defaultSearchCat == "Documents") {
                window.location.href = "/search-result.html?ishome=1&fulltext=" + decodeURIComponent(searchTerm) + "&path=" + basepathVal + "&pdfpath=" + basepdfpathVal + "&escalation=" + low;
            } else {
                window.location.href = "/search-result.html?ishome=1&fulltext=" + decodeURIComponent(searchTerm) + "&path=" + basepathVal + "&pdfpath=" + "&escalation=" + low;
            }
        } else {
            if (defaultSearchCat == "All") {
                window.location.href = "/search-result.html?ishome=1&fulltext=" + decodeURIComponent(searchTerm) + "&path=" + "/content/hdfclifeinsurancecompany/in/en&pdfpath=";
            } else if (basepdfpathVal != "" && defaultSearchCat == "Documents") {
                window.location.href = "/search-result.html?ishome=1&fulltext=" + decodeURIComponent(searchTerm) + "&path=" + basepathVal + "&pdfpath=" + basepdfpathVal;
            } else {
                window.location.href = "/search-result.html?ishome=1&fulltext=" + decodeURIComponent(searchTerm) + "&path=" + basepathVal + "&pdfpath=";
            }
        }
    } else {
        if (escAnalyze()) {
            if (defaultSearchCat == "All") {
                window.location.href = "/content/hdfclifeinsurancecompany/in/en/search-result.html?ishome=1&fulltext=" + decodeURIComponent(searchTerm) + "&path=" + "/content/hdfclifeinsurancecompany/in/en&pdfpath=&escalation=" + low;
            } else if (basepdfpathVal != "" && defaultSearchCat == "Documents") {
                window.location.href = "/content/hdfclifeinsurancecompany/in/en/search-result.html?ishome=1&fulltext=" + decodeURIComponent(searchTerm) + "&path=" + basepathVal + "&pdfpath=" + basepdfpathVal + "&escalation=" + low;
            } else {
                window.location.href = "/content/hdfclifeinsurancecompany/in/en/search-result.html?ishome=1&fulltext=" + decodeURIComponent(searchTerm) + "&path=" + basepathVal + "&pdfpath=" + "&escalation=" + low;
            }
        } else {
            if (defaultSearchCat == "All") {
                window.location.href = "/content/hdfclifeinsurancecompany/in/en/search-result.html?ishome=1&fulltext=" + decodeURIComponent(searchTerm) + "&path=" + "/content/hdfclifeinsurancecompany/in/en&pdfpath=";
            } else if (basepdfpathVal != "" && defaultSearchCat == "Documents") {
                window.location.href = "/content/hdfclifeinsurancecompany/in/en/search-result.html?ishome=1&fulltext=" + decodeURIComponent(searchTerm) + "&path=" + basepathVal + "&pdfpath=" + basepdfpathVal;
            } else {
                window.location.href = "/content/hdfclifeinsurancecompany/in/en/search-result.html?ishome=1&fulltext=" + decodeURIComponent(searchTerm) + "&path=" + basepathVal + "&pdfpath=";
            }
        }
    }
}
// (function($){
//     $(window).on("load",function(){            
//         $("#content-3").mCustomScrollbar({
//             scrollButtons:{enable:true},
//             theme:"light-thick", 
//         }); 
//     });
// })(jQuery);
// Not happy
// Escalations
// Escalate
// Not satisfied
// Complain
// Complaint
// Dissatisfaction
// Dissatisfied
// Unsatisfied
// Unhappy
var escalationSet = ['not happy', 'escalations', 'escalation', 'escalate', 'not satisfied', 'complain', 'complaint', 'dissatisfaction', 'dissatisfied', 'unsatisfied', 'unhappy'];
var low = "";
function escAnalyze() {
    low = searchTerm.toLowerCase();
    return escalationSet.includes(low);
}



$(document).ready(function(){
    if(window.screen.width < 1160){
        $('.hamMenuList > li > a').on('click', function (e) {
            if ($(this).parent().find('.hamSubMenu').length > 0) {
                e.preventDefault();
            }
            $(this).toggleClass('opened');
            $(this).siblings('.hamSubMenu').slideToggle();
        })
    }
    $('.new-hdfc-life-insurance-header .deskTopHeaderWrap .megaMenuSec .swiffy-slider button').css('display','none');
    $('.megaMenuLink, .megaMenuSec').hover(
        function(){
            $('.blurOverlayBg').css('display','block')
            $(this).parent().children('.megaMenuSec').children('.megaMenuLinkSec').children('.swiffy-slider').children('button').css('display','block');
            $(this).addClass('activeMenu');
            $('.contactInfoPopOver').hasClass('opened') ? $('.contactInfoPopOver').removeClass('opened') : $('.contactInfoPopOver')
            $('.hamMenuBtnLink').hasClass('opened') ? $('.hamMenuBtnLink').removeClass('opened') : $('.hamMenuBtnLink')
            $('.accountDropDown').hasClass('opened') ? $('.accountDropDown').removeClass('opened') : $('.accountDropDown')
            $('.hamMenuWrp').hasClass('opened') ? $('.hamMenuWrp').removeClass('opened') : $('.hamMenuWrp')
        },
        function(){
            if($('.new-hdfc-life-insurance-header .siteSearchInput').hasClass('expand')){
                $('.blurOverlayBg').css('display','block');
            }
            else{
                $('.blurOverlayBg').css('display','none');
                $(this).parent().children('.megaMenuSec').children('.megaMenuLinkSec').children('.swiffy-slider').children('button').css('display','none');
            }
            $(this).removeClass('activeMenu');
        }
    )

    $(document).click(function(e){
        if (!$('.megaMenuLink').hasClass('activeMenu') && !$('.megaMenuSec').hasClass('activeMenu') && !$('.searchBtnIcon').hasClass('active') && !$('.new-hdfc-life-insurance-header .siteSearchInput').hasClass('expand') && !$('.accountIcon').hasClass('active') && !$('.headerContactIconlink').hasClass('active') && !$('.hamMenuBtnLink').hasClass('opened') && !$('.new-hdfc-life-insurance-header .headerLoginIcon .accountIcon').hasClass('active')&& !$('.new-hdfc-life-insurance-header .headerLoginIcon .deskTopAccountDD').hasClass('opened') && !$('.new-hdfc-life-insurance-header .headerContactIcon .headerContactIconlink').hasClass('active')&& !$('.new-hdfc-life-insurance-header .headerContactIcon .contactInfoPopOver').hasClass('opened')
        
        //  && (e.target != $('.accountIcon') || e.target != $('.headerContactIconlink') || e.target != $('.hamMenuBtnLink') )
        ) { $('.blurOverlayBg').css('display','none');
          }
          else if($('.accountIcon').hasClass('active') && $('.headerContactIconlink').hasClass('active') && $('.hamMenuBtnLink').hasClass('opened')){
            $('.blurOverlayBg').css('display','block');
          }
    })

    $('.megaMenuSec').click(function(event){
            $('.blurOverlayBg').css('display','block');
        })

     //Event for Search Icon
     $('.searchBtnIcon').click(function(e) {
        e.preventDefault();
        $('.siteSearchInput').toggleClass('expand');
        var hasClass = $(this).hasClass('active')
        $(this)[hasClass ? 'removeClass' : 'addClass']('active')
        $('.blurOverlayBg')[hasClass ? 'fadeOut' : 'fadeIn']();
    });
    $('.searchSelectBox').click(function(e) {
        e.preventDefault()
        $(this).toggleClass('opened');
        $(this).parent().find('.searchSelectOption-container').toggleClass('opened');
    })
    $('.searchSelectOption li').click(function(e) {
        e.preventDefault();
        var option = $(this).attr('data-option')
        var label = $(this).text()
        $('.searchSelectBox').find('label').html(label);
        $('.searchSelect').removeClass('opened');
        $('.searchNativeSelect').val(option)
    })

    $(document).click(function(e) {
        e.stopPropagation();
        //Hide Account DropDown

        var accountDropDown = $(".deskTopAccountDD");
        var accountIcon = $(".accountIcon")
        if ((!accountDropDown.is(e.target) && accountDropDown.has(e.target).length === 0) && (!accountIcon.is(e.target) && accountIcon.has(e.target).length === 0)) {
            accountDropDown.removeClass('opened');
            accountIcon.removeClass('active');
            //$(".blurOverlayBg").fadeOut();
        }

        //Hide Contact Info PopOver 
        var contactInfoPopOver = $(".contactInfoPopOver");
        var headerContactIcon = $('.headerContactIcon a');
        if ((!contactInfoPopOver.is(e.target) && contactInfoPopOver.has(e.target).length === 0) && (!headerContactIcon.is(e.target) && headerContactIcon.has(e.target).length === 0)) {
            contactInfoPopOver.removeClass('opened');
            headerContactIcon.removeClass('active');
            //$(".blurOverlayBg").fadeOut();
        }

        //Hide HeaderSearch  
        var headerSearch = $(".siteSearchInput");
        var searchBtnIcon = $('.searchBtnIcon');
        var formSearch = $('.siteSearchForm')
        if ((!headerSearch.is(e.target) && headerSearch.has(e.target).length === 0)) {
            headerSearch.removeClass('expand');
            searchBtnIcon.removeClass('active');
            $('.navBarWrap').show()
                // setTimeout(function() { 
                //   headerSearch.removeClass('expand');
                //   $('.navBarWrap').show() 
                // },300)
        }



        //Hide HeaderSearch  Dropdown
        var headerSearchDD = $(".searchSelectOption");
        if ((!headerSearchDD.is(e.target) && headerSearchDD.has(e.target).length === 0)) {
            headerSearchDD.removeClass('opened');
            $('.searchSelect').removeClass('opened')
        }
        var headersearchSelect = $(".searchSelect");
        if ((!headersearchSelect.is(e.target) && headersearchSelect.has(e.target).length === 0)) {
            // headerSearchDD.removeClass('opened');
            $('.searchSelectBox').removeClass('opened')
            $('.searchSelectOption-container').removeClass('opened')
        }
        //All Plans Megamenu
        var megaMenuSec = $(".megaMenuSec");
        var megaMenuLink = $(".megaMenuLink");
        if (((!megaMenuSec.is(e.target) && megaMenuSec.has(e.target).length === 0)) && ((!megaMenuLink.is(e.target) && megaMenuLink.has(e.target).length === 0))) {
            megaMenuSec.removeClass('opened');
            $('.deskTopHeader .megaMenuLink').removeClass('opened')
        }

        //All Plans Megamenu
        var hamMenuWrp = $(".hamMenuWrp");
        var hamMenuBtnLink = $(".hamMenuBtnLink");
        if ((!hamMenuWrp.is(e.target) && hamMenuWrp.has(e.target).length === 0) && (!hamMenuBtnLink.is(e.target) && hamMenuBtnLink.has(e.target).length === 0)) {
            hamMenuWrp.removeClass('opened');
            $('.deskTopHeader .hamMenuBtnLink').removeClass('opened');
        }

        var parentElement = e.target.parentElement;
        var ishamMenuWrp = $(parentElement).hasClass('hamMenuWrp');
        var isParenthamMenuWrp = $(parentElement).parents().hasClass('hamMenuWrp');
        // Blur Effect Hide
       //  if ((!accountIcon.is(e.target) && accountIcon.has(e.target).length === 0) &&
       //      (!headerContactIcon.is(e.target) && headerContactIcon.has(e.target).length === 0) &&
       //      (!formSearch.is(e.target) && formSearch.has(e.target).length === 0) &&
       //      (!searchBtnIcon.is(e.target) && searchBtnIcon.has(e.target).length === 0) &&
       //      ((!megaMenuLink.is(e.target) && megaMenuLink.has(e.target).length === 0)) &&
       //      (!hamMenuBtnLink.is(e.target) && hamMenuBtnLink.has(e.target).length === 0)
       //  ) {
       //      $(".blurOverlayBg").fadeOut();
       //  }
    });

    $(document).click(function(c) {
        $(".megaMenuLink").hasClass("activeMenu") || $(".megaMenuSec").hasClass("activeMenu") || $(".searchBtnIcon").hasClass("active") || $(".accountIcon").hasClass("active") || $(".headerContactIconlink").hasClass("active") || $(".hamMenuBtnLink").hasClass("opened") || $('.new-hdfc-life-insurance-header .siteSearchInput').hasClass('expand')|| $('.new-hdfc-life-insurance-header .headerLoginIcon .accountIcon').hasClass('active')|| $('.new-hdfc-life-insurance-header .headerLoginIcon .deskTopAccountDD').hasClass('opened') || $('.new-hdfc-life-insurance-header .headerContactIcon .headerContactIconlink').hasClass('active')|| $('.new-hdfc-life-insurance-header .headerContactIcon .contactInfoPopOver').hasClass('opened') ? $(".accountIcon").hasClass("active") && $(".headerContactIconlink").hasClass("active") && $(".hamMenuBtnLink").hasClass("opened") && $(".blurOverlayBg").css("display", "block") : $(".blurOverlayBg").css("display", "none")
    });

    function hideOtherDropDown(except, classRemove) {
        var popOverSec = ['.megaMenuSec', '.deskTopAccountDD', '.contactInfoPopOver', '.hamMenuWrp'];
        var classDel = (classRemove) ? classRemove : 'opened';
        var otherDropDown = popOverSec.filter(function(sec) {
            return except !== sec
        }).join();
        $(otherDropDown).removeClass(classDel);
    }
    //Event for Account PopOver
    $('.accountIcon').click(function(e) {
        e.preventDefault();
        var targetDDSec = '.deskTopAccountDD';
        // $(this).toggleClass('active');
        var hasClass = $(this).siblings('.deskTopAccountDD').hasClass('opened');
        $(this)[hasClass ? 'removeClass' : 'addClass']('active')
        $('.blurOverlayBg')[hasClass ? 'fadeOut' : 'fadeIn']();
        $(targetDDSec).toggleClass('opened')
    });
         //Event for Contact PopOver
         $('.headerContactIcon a').click(function(e) {
            // e.preventDefault();
            var targetDDSec = '.contactInfoPopOver';
            var hasClass = $(this).siblings('.contactInfoPopOver').hasClass('opened');
            $(this)[hasClass ? 'removeClass' : 'addClass']('active')
            $('.blurOverlayBg')[hasClass ? 'fadeOut' : 'fadeIn']();
            $(targetDDSec).toggleClass('opened')
        });
   
    $('.accountButtonIcon').click(function(e) {
        e.preventDefault()
        $(this).toggleClass('active');
        $('.mobAccountDD').toggleClass('opened');
    });
    $('.accountMenuLink').click(function(e) {
        e.preventDefault()
        $(this).toggleClass("opened");
        $(this).parent('li').siblings('li').find('.accountMenuLink').removeClass("opened")
        $(this).parent('li').siblings('li').find('.accountSubMenu').slideUp()
        $(this).siblings('.accountSubMenu').slideToggle();
    })

    
        
});

// var clientID = document.getElementById("scheduleCallOpt");
//       function myfunc2() {
//         var link = document.createElement('link');
//         link.rel = 'stylesheet';
//         link.href = "/etc.clientlibs/hdfclifeinsurancecompany/components/Product-Optimization/schedule-a-call-op/clientlib.css";
//         document.head.appendChild(link);
//         console.log(link);

//         var script = document.createElement('script');
//         script.src = "/etc.clientlibs/hdfclifeinsurancecompany/components/Product-Optimization/schedule-a-call-op/clientlib.js";
//         document.body.appendChild(script);
//         console.log(script); 
//         clientID.removeEventListener("click", myfunc2);
//       }
//     clientID.addEventListener("click", myfunc2);

(function(_global) {
    var subscribeApiObj = (function() {
        var subscribeApiList = {};
        function getSubscribeTo (requestObject) {
            return new Promise(function(resolve, reject) {
                apiUtility.SUBSCRIBE(requestObject).then(function(res) {
                    resolve(res);
                }).catch(function(err) {
                    reject(err);
                });
            })
        }

        function getAppLink (requestObject) {
            return new Promise(function(resolve, reject) {
                apiUtility.GET_APP_LINK(requestObject).then(function(res) {
                    resolve(res);
                }).catch(function(err) {
                    reject(err);
                });
            })
        }

        subscribeApiList.getSubscribeTo = getSubscribeTo;
        subscribeApiList.getAppLink = getAppLink;
        
        return jsHelper.freezeObject(subscribeApiList);
    })();
    _global.jsHelper.defineReadOnlyObjProp(_global, 'subscribeApiObj', subscribeApiObj);
})(window || document || {})

$(document).ready(function() {
    $('#stayUpdated').on('submit', function(e) {
        e.preventDefault();
        var form = $(this);
        var isValid = isFormValid(form);
          
        if (isValid) {
            var _this = $(this);
            var emailId = _this.find('input[name=email]').val();        
            var reqObj = {
                "email": emailId,
                "ndfc_flag": true,
                "subscription_type": "article",
            }
            
            getSubscription(reqObj);
            $('#stayUpdated').trigger('reset');
        }
    });

    $('#getAppLinkFooter').on('submit', function(e) {
        e.preventDefault();
        var form = $(this);
        var isValid = isFormValid(form);
        if (isValid) {
            var _this = $(this);
            var mobileNumber = _this.find('input[name=mobileNumber]').val();        
            var appLinkReqObj = {
                "phone": mobileNumber,
                "ndfc_flag": true
            }
            
            getAppLink(appLinkReqObj);
            $('#getAppLinkFooter').trigger('reset');
        }
    });

    var subscribeMessageEmailHide = document.querySelectorAll('.message-success-subscribe');
    $('.emailAddress').focus(function(e) {
        $(subscribeMessageEmailHide).hide();
    })

    var subscribeMessageHide = document.querySelectorAll('.message-success-applink');
    $('.appLink').focus(function(e) {
        $(subscribeMessageHide).hide();
    })

    
if (isMobile()) {
    $('footer .popularMenuList.menuSecList ul').css('display', 'none');
    $('footer .popularMenuList.menuSecList.open ul').css('display', 'block');
    $('footer .wrapper.footerMenuSec .productMenuSec .productMenuWrp').css('display', 'none');
    $('footer .wrapper.footerMenuSec .productMenuSec.open .productMenuWrp').css('display', 'block');
    var $allAccordions = $('.mobileAccordion');
    $('.hdfc-life-insurance-footer .footerMobileAccordion').click(function (e) {
        var $parent = $(this).parent();
        var thisAccordion = $parent.find('.mobileAccordion');
        if ($parent.hasClass('open')) {
            thisAccordion.slideUp();
            $parent.removeClass('open');
        } else {
            closeAllAccordions();
            thisAccordion.slideDown();
            $parent.addClass('open');
        }
        // for delay scroll to top
        setTimeout(function () {
            scrollToElement($parent[0],90)
        }, 500);
    });

    function closeAllAccordions() {
        $allAccordions.each(function (index, element) {
            var $element = $(element);
            $element.parent().removeClass('open');
            $element.slideUp();
        })
    }

    $allMenuSecAccordions = $('.hdfc-life-insurance-footer .productMenuWrp .menuSecList')
    $('.hdfc-life-insurance-footer .menuBullet').click(function (e) {
        var $parent = $(this).closest('.menuSecList');
        var thisAccordion = $parent.find('.menuSecListSection')
        if ($parent.hasClass('open')) {
            thisAccordion.slideUp();
            $parent.removeClass('open');
        } else {
            closeAllMenuSecAccordions();
            thisAccordion.slideDown();
            $parent.addClass('open');
        }

        // for delay scroll to top
        setTimeout(function () {
            scrollToElement($parent[0],90)
        }, 500);
    });

    function closeAllMenuSecAccordions() {
        $allMenuSecAccordions.each(function (index, element) {
            var $element = $(element);
            $element.removeClass('open');
            $element.find('.menuSecListSection').slideUp();
        })
    }
}
});

$('.app-link').on('paste keyup', function(e){
    $(this).val($(this).val().replace(/[^\d]/g, ''));
});

$(".subscribeCheck").on('click', function () {
    if ($(this).is(":checked")) {
        $(".checkSubscribeError").css("display", "none");
        $("#subscribeButton").removeAttr("disabled", "disabled");
    } else {
        $(".checkSubscribeError").css("display", "block");
        $(".checkSubscribeError").html("First please authorize HDFC Life to contact you, by checking the checkbox above");
        $("#subscribeButton").attr("disabled", "disabled");
        $(".message-success-subscribe").css("display", "none");
    }
});

$(".getAppLinkCheck").on('click', function () {
    if ($(this).is(":checked")) {
        $(".checkAppLinkError").css("display", "none");
        $("#appButton").removeAttr("disabled", "disabled");
    } else {
        $(".checkAppLinkError").css("display", "block");
        $(".checkAppLinkError").html("First please authorize HDFC Life to contact you, by checking the checkbox above");
        $("#appButton").attr("disabled", "disabled");
        $(".message-success-applink").css("display", "none");
    }
});

function getSubscription(reqObj) {
    subscribeApiObj.getSubscribeTo(reqObj).then(function(res) {
        renderSuccessMsg(res)
    }).catch(function(err) {
        console.log(err);
        formSubmissionFailed('subscribeButton-data-layer', err)
    })
}

function getAppLink(appLinkReqObj) {
    subscribeApiObj.getAppLink(appLinkReqObj).then(function(res) {
        renderAppLinkSuccessMsg(res, appLinkReqObj)
    }).catch(function(err) {
        console.log(err);
        formSubmissionFailed('appButton-footer-data-layer', err)
    })
}
function renderSuccessMsg(res) {
    if(res.statusCode == 201) {
        $('.message-success-subscribe').css({'display' : 'block', 'color': '#ed1c24', 'fontSize': '12px'});
        formSubmissionSuccess('subscribeButton-data-layer');
    } else {
        formSubmissionFailed('subscribeButton-data-layer');
    }
}

function renderAppLinkSuccessMsg(res, appLinkReqObj) {
    if(res.statusCode == 200) {
        $('.message-success-applink').css({'display' : 'block'});
        $('.message-success-applink').text('Link sent to mobile number '+appLinkReqObj['phone']);
        formSubmissionSuccess('appButton-footer-data-layer');
    } else {
    }
}
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).dayjs=e()}(this,(function(){"use strict";var t=1e3,e=6e4,n=36e5,r="millisecond",i="second",s="minute",u="hour",a="day",o="week",f="month",h="quarter",c="year",d="date",l="Invalid Date",$=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,M={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],n=t%100;return"["+t+(e[(n-20)%10]||e[n]||e[0])+"]"}},m=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},v={s:m,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return(e<=0?"+":"-")+m(r,2,"0")+":"+m(i,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),i=e.clone().add(r,f),s=n-i<0,u=e.clone().add(r+(s?-1:1),f);return+(-(r+(n-i)/(s?i-u:u-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:f,y:c,w:o,d:a,D:d,h:u,m:s,s:i,ms:r,Q:h}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},g="en",D={};D[g]=M;var p=function(t){return t instanceof _},S=function t(e,n,r){var i;if(!e)return g;if("string"==typeof e){var s=e.toLowerCase();D[s]&&(i=s),n&&(D[s]=n,i=s);var u=e.split("-");if(!i&&u.length>1)return t(u[0])}else{var a=e.name;D[a]=e,i=a}return!r&&i&&(g=i),i||!r&&g},w=function(t,e){if(p(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new _(n)},O=v;O.l=S,O.i=p,O.w=function(t,e){return w(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var _=function(){function M(t){this.$L=S(t.locale,null,!0),this.parse(t)}var m=M.prototype;return m.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(O.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match($);if(r){var i=r[2]-1||0,s=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},m.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},m.$utils=function(){return O},m.isValid=function(){return!(this.$d.toString()===l)},m.isSame=function(t,e){var n=w(t);return this.startOf(e)<=n&&n<=this.endOf(e)},m.isAfter=function(t,e){return w(t)<this.startOf(e)},m.isBefore=function(t,e){return this.endOf(e)<w(t)},m.$g=function(t,e,n){return O.u(t)?this[e]:this.set(n,t)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(t,e){var n=this,r=!!O.u(e)||e,h=O.p(t),l=function(t,e){var i=O.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?i:i.endOf(a)},$=function(t,e){return O.w(n.toDate()[t].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},y=this.$W,M=this.$M,m=this.$D,v="set"+(this.$u?"UTC":"");switch(h){case c:return r?l(1,0):l(31,11);case f:return r?l(1,M):l(0,M+1);case o:var g=this.$locale().weekStart||0,D=(y<g?y+7:y)-g;return l(r?m-D:m+(6-D),M);case a:case d:return $(v+"Hours",0);case u:return $(v+"Minutes",1);case s:return $(v+"Seconds",2);case i:return $(v+"Milliseconds",3);default:return this.clone()}},m.endOf=function(t){return this.startOf(t,!1)},m.$set=function(t,e){var n,o=O.p(t),h="set"+(this.$u?"UTC":""),l=(n={},n[a]=h+"Date",n[d]=h+"Date",n[f]=h+"Month",n[c]=h+"FullYear",n[u]=h+"Hours",n[s]=h+"Minutes",n[i]=h+"Seconds",n[r]=h+"Milliseconds",n)[o],$=o===a?this.$D+(e-this.$W):e;if(o===f||o===c){var y=this.clone().set(d,1);y.$d[l]($),y.init(),this.$d=y.set(d,Math.min(this.$D,y.daysInMonth())).$d}else l&&this.$d[l]($);return this.init(),this},m.set=function(t,e){return this.clone().$set(t,e)},m.get=function(t){return this[O.p(t)]()},m.add=function(r,h){var d,l=this;r=Number(r);var $=O.p(h),y=function(t){var e=w(l);return O.w(e.date(e.date()+Math.round(t*r)),l)};if($===f)return this.set(f,this.$M+r);if($===c)return this.set(c,this.$y+r);if($===a)return y(1);if($===o)return y(7);var M=(d={},d[s]=e,d[u]=n,d[i]=t,d)[$]||1,m=this.$d.getTime()+r*M;return O.w(m,this)},m.subtract=function(t,e){return this.add(-1*t,e)},m.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||l;var r=t||"YYYY-MM-DDTHH:mm:ssZ",i=O.z(this),s=this.$H,u=this.$m,a=this.$M,o=n.weekdays,f=n.months,h=function(t,n,i,s){return t&&(t[n]||t(e,r))||i[n].slice(0,s)},c=function(t){return O.s(s%12||12,t,"0")},d=n.meridiem||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r},$={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:O.s(a+1,2,"0"),MMM:h(n.monthsShort,a,f,3),MMMM:h(f,a),D:this.$D,DD:O.s(this.$D,2,"0"),d:String(this.$W),dd:h(n.weekdaysMin,this.$W,o,2),ddd:h(n.weekdaysShort,this.$W,o,3),dddd:o[this.$W],H:String(s),HH:O.s(s,2,"0"),h:c(1),hh:c(2),a:d(s,u,!0),A:d(s,u,!1),m:String(u),mm:O.s(u,2,"0"),s:String(this.$s),ss:O.s(this.$s,2,"0"),SSS:O.s(this.$ms,3,"0"),Z:i};return r.replace(y,(function(t,e){return e||$[t]||i.replace(":","")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(r,d,l){var $,y=O.p(d),M=w(r),m=(M.utcOffset()-this.utcOffset())*e,v=this-M,g=O.m(this,M);return g=($={},$[c]=g/12,$[f]=g,$[h]=g/3,$[o]=(v-m)/6048e5,$[a]=(v-m)/864e5,$[u]=v/n,$[s]=v/e,$[i]=v/t,$)[y]||v,l?g:O.a(g)},m.daysInMonth=function(){return this.endOf(f).$D},m.$locale=function(){return D[this.$L]},m.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=S(t,e,!0);return r&&(n.$L=r),n},m.clone=function(){return O.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},M}(),T=_.prototype;return w.prototype=T,[["$ms",r],["$s",i],["$m",s],["$H",u],["$W",a],["$M",f],["$y",c],["$D",d]].forEach((function(t){T[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),w.extend=function(t,e){return t.$i||(t(e,_,w),t.$i=!0),w},w.locale=S,w.isDayjs=p,w.unix=function(t){return w(1e3*t)},w.en=D[g],w.Ls=D,w.p={},w}));

// **************DAYJS DEPENDENCIES*************//

//LOCALEDATA.JS START//
!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(n="undefined"!=typeof globalThis?globalThis:n||self).dayjs_plugin_localeData=e()}(this,function(){"use strict";return function(n,e,t){function r(n,e,t,r,o){var n=n.name?n:n.$locale(),e=i(n[e]),t=i(n[t]),u=e||t.map(function(n){return n.substr(0,r)});if(!o)return u;var a=n.weekStart;return u.map(function(n,e){return u[(e+(a||0))%7]})}function o(){return t.Ls[t.locale()]}function u(n,e){return n.formats[e]||n.formats[e.toUpperCase()].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(n,e,t){return e||t.slice(1)})}var e=e.prototype,i=function(n){return n&&(n.indexOf?n:n.s)};e.localeData=function(){return function(){var e=this;return{months:function(n){return n?n.format("MMMM"):r(e,"months")},monthsShort:function(n){return n?n.format("MMM"):r(e,"monthsShort","months",3)},firstDayOfWeek:function(){return e.$locale().weekStart||0},weekdays:function(n){return n?n.format("dddd"):r(e,"weekdays")},weekdaysMin:function(n){return n?n.format("dd"):r(e,"weekdaysMin","weekdays",2)},weekdaysShort:function(n){return n?n.format("ddd"):r(e,"weekdaysShort","weekdays",3)},longDateFormat:function(n){return u(e.$locale(),n)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}}.bind(this)()},t.localeData=function(){var e=o();return{firstDayOfWeek:function(){return e.weekStart||0},weekdays:function(){return t.weekdays()},weekdaysShort:function(){return t.weekdaysShort()},weekdaysMin:function(){return t.weekdaysMin()},months:function(){return t.months()},monthsShort:function(){return t.monthsShort()},longDateFormat:function(n){return u(e,n)},meridiem:e.meridiem,ordinal:e.ordinal}},t.months=function(){return r(o(),"months")},t.monthsShort=function(){return r(o(),"monthsShort","months",3)},t.weekdays=function(n){return r(o(),"weekdays",null,null,n)},t.weekdaysShort=function(n){return r(o(),"weekdaysShort","weekdays",3,n)},t.weekdaysMin=function(n){return r(o(),"weekdaysMin","weekdays",2,n)}}});
//LOCALEDATA.JS END//

//LOCALIZEDFORMAT.JS START//
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).dayjs_plugin_localizedFormat=t()}(this,function(){"use strict";var i={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(e,t,o){var t=t.prototype,n=t.format;o.en.formats=i,t.format=function(e){void 0===e&&(e="YYYY-MM-DDTHH:mm:ssZ");var r,t=this.$locale().formats,e=(r=void 0===t?{}:t,e.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(e,t,o){var n=o&&o.toUpperCase();return t||r[o]||i[o]||r[n].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(e,t,o){return t||o.slice(1)})}));return n.call(this,e)}}});
//LOCALIZEDFORMAT.JS END//

//ISOWEEK.JS START//
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).dayjs_plugin_isoWeek=t()}(this,function(){"use strict";var n="day";return function(e,t,s){function a(e){return e.add(4-e.isoWeekday(),n)}t=t.prototype;t.isoWeekYear=function(){return a(this).year()},t.isoWeek=function(e){if(!this.$utils().u(e))return this.add(7*(e-this.isoWeek()),n);var t=a(this),i=(i=this.isoWeekYear(),i=4-(e=(this.$u?s.utc:s)().year(i).startOf("year")).isoWeekday(),4<e.isoWeekday()&&(i+=7),e.add(i,n));return t.diff(i,"week")+1},t.isoWeekday=function(e){return this.$utils().u(e)?this.day()||7:this.day(this.day()%7?e:e-7)};var d=t.startOf;t.startOf=function(e,t){var i=this.$utils(),s=!!i.u(t)||t;return"isoweek"===i.p(e)?s?this.date(this.date()-(this.isoWeekday()-1)).startOf("day"):this.date(this.date()-1-(this.isoWeekday()-1)+7).endOf("day"):d.bind(this)(e,t)}}});
//ISOWEEK.JS END//

//WEEKDAY.JS START//
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).dayjs_plugin_weekday=t()}(this,function(){"use strict";return function(e,t){t.prototype.weekday=function(e){var t=this.$locale().weekStart||0,i=this.$W,t=(i<t?i+7:i)-t;return this.$utils().u(e)?t:this.subtract(t,"day").add(e,"day")}}});
//WEEKDAY.JS END//

//ARRAYSUPPORT.JS START//
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).dayjs_plugin_arraySupport=t()}(this,function(){"use strict";return function(e,t,n){var t=t.prototype,o=t.parse;t.parse=function(e){e.date=function(e){var t=e.date,e=e.utc;return Array.isArray(t)?e?t.length?new Date(Date.UTC.apply(null,t)):new Date:1===t.length?n(String(t[0])).toDate():new(Function.prototype.bind.apply(Date,[null].concat(t))):t}.bind(this)(e),o.bind(this)(e)}}});
//ARRAYSUPPORT.JS END//

//BADMUTABLE.JS START//
!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t="undefined"!=typeof globalThis?globalThis:t||self).dayjs_plugin_badMutable=i()}(this,function(){"use strict";return function(t,i){i=i.prototype;i.$g=function(t,i,n){return this.$utils().u(t)?this[i]:this.$set(n,t)},i.set=function(t,i){return this.$set(t,i)};var n=i.startOf;i.startOf=function(t,i){return this.$d=n.bind(this)(t,i).toDate(),this.init(),this};var e=i.add;i.add=function(t,i){return this.$d=e.bind(this)(t,i).toDate(),this.init(),this};var s=i.locale;i.locale=function(t,i){return t?(this.$L=s.bind(this)(t,i).$L,this):this.$L};var o=i.daysInMonth;i.daysInMonth=function(){return o.bind(this.clone())()};var r=i.isSame;i.isSame=function(t,i){return r.bind(this.clone())(t,i)};var u=i.isBefore;i.isBefore=function(t,i){return u.bind(this.clone())(t,i)};var f=i.isAfter;i.isAfter=function(t,i){return f.bind(this.clone())(t,i)}}});
//BADMUTABLE.JS END//

//WEEKOFYEAR.JS START//
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).dayjs_plugin_weekOfYear=t()}(this,function(){"use strict";var f="week",s="year";return function(e,t,n){t=t.prototype;t.week=function(e){if(null!==(e=void 0===e?null:e))return this.add(7*(e-this.week()),"day");var t=this.$locale().yearStart||1;if(11===this.month()&&25<this.date()){var i=n(this).startOf(s).add(1,s).date(t),e=n(this).endOf(f);if(i.isBefore(e))return 1}t=n(this).startOf(s).date(t).startOf(f).subtract(1,"millisecond"),t=this.diff(t,f,!0);return t<0?n(this).startOf("week").week():Math.ceil(t)},t.weeks=function(e){return this.week(e=void 0===e?null:e)}}});
//WEEKOFYEAR.JS END//


dayjs.extend(window.dayjs_plugin_localeData);
dayjs.extend(window.dayjs_plugin_localizedFormat);
dayjs.extend(window.dayjs_plugin_isoWeek);
dayjs.extend(window.dayjs_plugin_arraySupport);
dayjs.extend(window.dayjs_plugin_badMutable);
/**
 * @version: 3.1
 * @author: Dan Grossman http://www.dangrossman.info/
 * @copyright: Copyright (c) 2012-2019 Dan Grossman. All rights reserved.
 * @license: Licensed under the MIT license. See http://www.opensource.org/licenses/mit-license.php
 * @website: http://www.daterangepicker.com/
 */ !(function (t, e) {
    if ("function" == typeof define && define.amd)
    define(["dayjs", "jquery"], function (t, a) {
      return (
        a.fn || (a.fn = {}),
        "function" != typeof t &&
          t.hasOwnProperty("default") &&
          (t = t.default),
        e(t, a)
      );
    });
  else if ("object" == typeof module && module.exports) {
    var a = "undefined" != typeof window ? window.jQuery : void 0;
    a || (a = require("jquery")).fn || (a.fn = {});
    var i =
      "undefined" != typeof window && void 0 !== window.dayjs
        ? window.dayjs
        : require("dayjs");
    module.exports = e(i, a);
  } else t.daterangepicker = e(t.dayjs, t.jQuery);
})("undefined" != typeof window ? window : this, function (t, e) {
  var a = function (a, i, s) {
    if (
      ((this.parentEl = "body"),
      (this.element = e(a)),
      (this.startDate = t().startOf("day")),
      (this.endDate = t().endOf("day")),
      (this.minDate = !1),
      (this.maxDate = !1),
      (this.maxSpan = !1),
      (this.autoApply = !1),
      (this.singleDatePicker = !1),
      (this.showDropdowns = !1),
      (this.minYear = t().subtract(100, "year").format("YYYY")),
      (this.maxYear = t().add(100, "year").format("YYYY")),
      (this.showWeekNumbers = !1),
      (this.showISOWeekNumbers = !1),
      (this.showCustomRangeLabel = !0),
      (this.timePicker = !1),
      (this.timePicker24Hour = !1),
      (this.timePickerIncrement = 1),
      (this.timePickerSeconds = !1),
      (this.linkedCalendars = !0),
      (this.autoUpdateInput = !0),
      (this.alwaysShowCalendars = !1),
      (this.ranges = {}),
      (this.opens = "right"),
      this.element.hasClass("pull-right") && (this.opens = "left"),
      (this.drops = "down"),
      this.element.hasClass("dropup") && (this.drops = "up"),
      (this.buttonClasses = "btn btn-sm"),
      (this.applyButtonClasses = "btn-primary"),
      (this.cancelButtonClasses = "btn-default"),
      (this.locale = {
        direction: "ltr",
        format: t.localeData().longDateFormat("L"),
        separator: " - ",
        applyLabel: "Apply",
        cancelLabel: "Cancel",
        weekLabel: "W",
        customRangeLabel: "Custom Range",
        daysOfWeek: t.weekdaysMin(),
        monthNames: t.monthsShort(),
        firstDay: t.localeData().firstDayOfWeek(),
      }),
      (this.callback = function () {}),
      (this.isShowing = !1),
      (this.leftCalendar = {}),
      (this.rightCalendar = {}),
      ("object" != typeof i || null === i) && (i = {}),
      "string" == typeof (i = e.extend(this.element.data(), i)).template ||
        i.template instanceof e ||
        (i.template =
          '<div class="daterangepicker"><div class="ranges"></div><div class="drp-calendar left"><div class="calendar-table"></div><div class="calendar-time"></div></div><div class="drp-calendar right"><div class="calendar-table"></div><div class="calendar-time"></div></div><div class="drp-buttons"><span class="drp-selected"></span><button class="cancelBtn" type="button"></button><button class="applyBtn" disabled="disabled" type="button"></button> </div></div>'),
      (this.parentEl =
        i.parentEl && e(i.parentEl).length ? e(i.parentEl) : e(this.parentEl)),
      (this.container = e(i.template).appendTo(this.parentEl)),
      "object" == typeof i.locale &&
        ("string" == typeof i.locale.direction &&
          (this.locale.direction = i.locale.direction),
        "string" == typeof i.locale.format &&
          (this.locale.format = i.locale.format),
        "string" == typeof i.locale.separator &&
          (this.locale.separator = i.locale.separator),
        "object" == typeof i.locale.daysOfWeek &&
          (this.locale.daysOfWeek = i.locale.daysOfWeek.slice()),
        "object" == typeof i.locale.monthNames &&
          (this.locale.monthNames = i.locale.monthNames.slice()),
        "number" == typeof i.locale.firstDay &&
          (this.locale.firstDay = i.locale.firstDay),
        "string" == typeof i.locale.applyLabel &&
          (this.locale.applyLabel = i.locale.applyLabel),
        "string" == typeof i.locale.cancelLabel &&
          (this.locale.cancelLabel = i.locale.cancelLabel),
        "string" == typeof i.locale.weekLabel &&
          (this.locale.weekLabel = i.locale.weekLabel),
        "string" == typeof i.locale.customRangeLabel))
    ) {
      var n,
        r,
        o,
        h = document.createElement("textarea");
      h.innerHTML = i.locale.customRangeLabel;
      var l = h.value;
      this.locale.customRangeLabel = l;
    }
    if (
      (this.container.addClass(this.locale.direction),
      "string" == typeof i.startDate &&
        (this.startDate = t(i.startDate, this.locale.format)),
      "string" == typeof i.endDate &&
        (this.endDate = t(i.endDate, this.locale.format)),
      "string" == typeof i.minDate &&
        (this.minDate = t(i.minDate, this.locale.format)),
      "string" == typeof i.maxDate &&
        (this.maxDate = t(i.maxDate, this.locale.format)),
      "object" == typeof i.startDate && (this.startDate = t(i.startDate)),
      "object" == typeof i.endDate && (this.endDate = t(i.endDate)),
      "object" == typeof i.minDate && (this.minDate = t(i.minDate)),
      "object" == typeof i.maxDate && (this.maxDate = t(i.maxDate)),
      this.minDate &&
        this.startDate.isBefore(this.minDate) &&
        (this.startDate = this.minDate.clone()),
      this.maxDate &&
        this.endDate.isAfter(this.maxDate) &&
        (this.endDate = this.maxDate.clone()),
      "string" == typeof i.applyButtonClasses &&
        (this.applyButtonClasses = i.applyButtonClasses),
      "string" == typeof i.applyClass &&
        (this.applyButtonClasses = i.applyClass),
      "string" == typeof i.cancelButtonClasses &&
        (this.cancelButtonClasses = i.cancelButtonClasses),
      "string" == typeof i.cancelClass &&
        (this.cancelButtonClasses = i.cancelClass),
      "object" == typeof i.maxSpan && (this.maxSpan = i.maxSpan),
      "object" == typeof i.dateLimit && (this.maxSpan = i.dateLimit),
      "string" == typeof i.opens && (this.opens = i.opens),
      "string" == typeof i.drops && (this.drops = i.drops),
      "boolean" == typeof i.showWeekNumbers &&
        (this.showWeekNumbers = i.showWeekNumbers),
      "boolean" == typeof i.showISOWeekNumbers &&
        (this.showISOWeekNumbers = i.showISOWeekNumbers),
      "string" == typeof i.buttonClasses &&
        (this.buttonClasses = i.buttonClasses),
      "object" == typeof i.buttonClasses &&
        (this.buttonClasses = i.buttonClasses.join(" ")),
      "boolean" == typeof i.showDropdowns &&
        (this.showDropdowns = i.showDropdowns),
      "number" == typeof i.minYear && (this.minYear = i.minYear),
      "number" == typeof i.maxYear && (this.maxYear = i.maxYear),
      "boolean" == typeof i.showCustomRangeLabel &&
        (this.showCustomRangeLabel = i.showCustomRangeLabel),
      "boolean" == typeof i.singleDatePicker &&
        ((this.singleDatePicker = i.singleDatePicker),
        this.singleDatePicker && (this.endDate = this.startDate.clone())),
      "boolean" == typeof i.timePicker && (this.timePicker = i.timePicker),
      "boolean" == typeof i.timePickerSeconds &&
        (this.timePickerSeconds = i.timePickerSeconds),
      "number" == typeof i.timePickerIncrement &&
        (this.timePickerIncrement = i.timePickerIncrement),
      "boolean" == typeof i.timePicker24Hour &&
        (this.timePicker24Hour = i.timePicker24Hour),
      "boolean" == typeof i.autoApply && (this.autoApply = i.autoApply),
      "boolean" == typeof i.autoUpdateInput &&
        (this.autoUpdateInput = i.autoUpdateInput),
      "boolean" == typeof i.linkedCalendars &&
        (this.linkedCalendars = i.linkedCalendars),
      "function" == typeof i.isInvalidDate &&
        (this.isInvalidDate = i.isInvalidDate),
      "function" == typeof i.isCustomDate &&
        (this.isCustomDate = i.isCustomDate),
      "boolean" == typeof i.alwaysShowCalendars &&
        (this.alwaysShowCalendars = i.alwaysShowCalendars),
      0 != this.locale.firstDay)
    )
      for (var c = this.locale.firstDay; c > 0; )
        this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift()), c--;
    if (
      void 0 === i.startDate &&
      void 0 === i.endDate &&
      e(this.element).is(":text")
    ) {
      var d = e(this.element).val(),
        m = d.split(this.locale.separator);
      (n = r = null),
        2 == m.length
          ? ((n = t(m[0], this.locale.format)),
            (r = t(m[1], this.locale.format)))
          : this.singleDatePicker &&
            "" !== d &&
            ((n = t(d, this.locale.format)), (r = t(d, this.locale.format))),
        null !== n && null !== r && (this.setStartDate(n), this.setEndDate(r));
    }
    if ("object" == typeof i.ranges) {
      for (o in i.ranges) {
        (n =
          "string" == typeof i.ranges[o][0]
            ? t(i.ranges[o][0], this.locale.format)
            : t(i.ranges[o][0])),
          (r =
            "string" == typeof i.ranges[o][1]
              ? t(i.ranges[o][1], this.locale.format)
              : t(i.ranges[o][1])),
          this.minDate &&
            n.isBefore(this.minDate) &&
            (n = this.minDate.clone());
        var f = this.maxDate;
        if (
          (this.maxSpan &&
            f &&
            n.clone().add(this.maxSpan).isAfter(f) &&
            (f = n.clone().add(this.maxSpan)),
          f && r.isAfter(f) && (r = f.clone()),
          !(
            (this.minDate &&
              r.isBefore(this.minDate, this.timepicker ? "minute" : "day")) ||
            (f && n.isAfter(f, this.timepicker ? "minute" : "day"))
          ))
        ) {
          var h = document.createElement("textarea");
          h.innerHTML = o;
          var l = h.value;
          this.ranges[l] = [n, r];
        }
      }
      var p = "<ul>";
      for (o in this.ranges)
        p += '<li data-range-key="' + o + '">' + o + "</li>";
      this.showCustomRangeLabel &&
        (p +=
          '<li data-range-key="' +
          this.locale.customRangeLabel +
          '">' +
          this.locale.customRangeLabel +
          "</li>"),
        (p += "</ul>"),
        this.container.find(".ranges").prepend(p);
    }
    "function" == typeof s && (this.callback = s),
      this.timePicker ||
        ((this.startDate = this.startDate.startOf("day")),
        (this.endDate = this.endDate.endOf("day")),
        this.container.find(".calendar-time").hide()),
      this.timePicker && this.autoApply && (this.autoApply = !1),
      this.autoApply && this.container.addClass("auto-apply"),
      "object" == typeof i.ranges && this.container.addClass("show-ranges"),
      this.singleDatePicker &&
        (this.container.addClass("single"),
        this.container.find(".drp-calendar.left").addClass("single"),
        this.container.find(".drp-calendar.left").show(),
        this.container.find(".drp-calendar.right").hide(),
        !this.timePicker &&
          this.autoApply &&
          this.container.addClass("auto-apply")),
      ((void 0 === i.ranges && !this.singleDatePicker) ||
        this.alwaysShowCalendars) &&
        this.container.addClass("show-calendar"),
      this.container.addClass("opens" + this.opens),
      this.container.find(".applyBtn, .cancelBtn").addClass(this.buttonClasses),
      this.applyButtonClasses.length &&
        this.container.find(".applyBtn").addClass(this.applyButtonClasses),
      this.cancelButtonClasses.length &&
        this.container.find(".cancelBtn").addClass(this.cancelButtonClasses),
      this.container.find(".applyBtn").html(this.locale.applyLabel),
      this.container.find(".cancelBtn").html(this.locale.cancelLabel),
      this.container
        .find(".drp-calendar")
        .on("click.daterangepicker", ".prev", e.proxy(this.clickPrev, this))
        .on("click.daterangepicker", ".next", e.proxy(this.clickNext, this))
        .on(
          "mousedown.daterangepicker",
          "td.available",
          e.proxy(this.clickDate, this)
        )
        .on(
          "mouseenter.daterangepicker",
          "td.available",
          e.proxy(this.hoverDate, this)
        )
        .on(
          "change.daterangepicker",
          "select.yearselect",
          e.proxy(this.monthOrYearChanged, this)
        )
        .on(
          "change.daterangepicker",
          "select.monthselect",
          e.proxy(this.monthOrYearChanged, this)
        )
        .on(
          "change.daterangepicker",
          "select.hourselect,select.minuteselect,select.secondselect,select.ampmselect",
          e.proxy(this.timeChanged, this)
        ),
      this.container
        .find(".ranges")
        .on("click.daterangepicker", "li", e.proxy(this.clickRange, this)),
      this.container
        .find(".drp-buttons")
        .on(
          "click.daterangepicker",
          "button.applyBtn",
          e.proxy(this.clickApply, this)
        )
        .on(
          "click.daterangepicker",
          "button.cancelBtn",
          e.proxy(this.clickCancel, this)
        ),
      this.element.is("input") || this.element.is("button")
        ? this.element.on({
            "click.daterangepicker": e.proxy(this.show, this),
            "focus.daterangepicker": e.proxy(this.show, this),
            "keyup.daterangepicker": e.proxy(this.elementChanged, this),
            "keydown.daterangepicker": e.proxy(this.keydown, this),
          })
        : (this.element.on("click.daterangepicker", e.proxy(this.toggle, this)),
          this.element.on(
            "keydown.daterangepicker",
            e.proxy(this.toggle, this)
          )),
      this.updateElement();
  };
  return (
    (a.prototype = {
      constructor: a,
      setStartDate: function (e) {
        "string" == typeof e && (this.startDate = t(e, this.locale.format)),
          "object" == typeof e && (this.startDate = t(e)),
          this.timePicker || (this.startDate = this.startDate.startOf("day")),
          this.timePicker &&
            this.timePickerIncrement &&
            this.startDate.minute(
              Math.round(this.startDate.minute() / this.timePickerIncrement) *
                this.timePickerIncrement
            ),
          this.minDate &&
            this.startDate.isBefore(this.minDate) &&
            ((this.startDate = this.minDate.clone()),
            this.timePicker &&
              this.timePickerIncrement &&
              this.startDate.minute(
                Math.round(this.startDate.minute() / this.timePickerIncrement) *
                  this.timePickerIncrement
              )),
          this.maxDate &&
            this.startDate.isAfter(this.maxDate) &&
            ((this.startDate = this.maxDate.clone()),
            this.timePicker &&
              this.timePickerIncrement &&
              this.startDate.minute(
                Math.floor(this.startDate.minute() / this.timePickerIncrement) *
                  this.timePickerIncrement
              )),
          this.isShowing || this.updateElement(),
          this.updateMonthsInView();
      },
      setEndDate: function (e) {
        "string" == typeof e && (this.endDate = t(e, this.locale.format)),
          "object" == typeof e && (this.endDate = t(e)),
          this.timePicker || (this.endDate = this.endDate.endOf("day")),
          this.timePicker &&
            this.timePickerIncrement &&
            this.endDate.minute(
              Math.round(this.endDate.minute() / this.timePickerIncrement) *
                this.timePickerIncrement
            ),
          this.endDate.isBefore(this.startDate) &&
            (this.endDate = this.startDate.clone()),
          this.maxDate &&
            this.endDate.isAfter(this.maxDate) &&
            (this.endDate = this.maxDate.clone()),
          this.maxSpan &&
            this.startDate.clone().add(this.maxSpan).isBefore(this.endDate) &&
            (this.endDate = this.startDate.clone().add(this.maxSpan)),
          (this.previousRightTime = this.endDate.clone()),
          this.container
            .find(".drp-selected")
            .html(
              this.startDate.format(this.locale.format) +
                this.locale.separator +
                this.endDate.format(this.locale.format)
            ),
          this.isShowing || this.updateElement(),
          this.updateMonthsInView();
      },
      isInvalidDate: function () {
        return !1;
      },
      isCustomDate: function () {
        return !1;
      },
      updateView: function () {
        this.timePicker &&
          (this.renderTimePicker("left"),
          this.renderTimePicker("right"),
          this.endDate
            ? this.container
                .find(".right .calendar-time select")
                .prop("disabled", !1)
                .removeClass("disabled")
            : this.container
                .find(".right .calendar-time select")
                .prop("disabled", !0)
                .addClass("disabled")),
          this.endDate &&
            this.container
              .find(".drp-selected")
              .html(
                this.startDate.format(this.locale.format) +
                  this.locale.separator +
                  this.endDate.format(this.locale.format)
              ),
          this.updateMonthsInView(),
          this.updateCalendars(),
          this.updateFormInputs();
      },
      updateMonthsInView: function () {
        if (this.endDate) {
          if (
            !this.singleDatePicker &&
            this.leftCalendar.month &&
            this.rightCalendar.month &&
            (this.startDate.format("YYYY-MM") ==
              this.leftCalendar.month.format("YYYY-MM") ||
              this.startDate.format("YYYY-MM") ==
                this.rightCalendar.month.format("YYYY-MM")) &&
            (this.endDate.format("YYYY-MM") ==
              this.leftCalendar.month.format("YYYY-MM") ||
              this.endDate.format("YYYY-MM") ==
                this.rightCalendar.month.format("YYYY-MM"))
          )
            return;
          (this.leftCalendar.month = this.startDate.clone().date(2)),
            this.linkedCalendars ||
            (this.endDate.month() == this.startDate.month() &&
              this.endDate.year() == this.startDate.year())
              ? (this.rightCalendar.month = this.startDate
                  .clone()
                  .date(2)
                  .add(1, "month"))
              : (this.rightCalendar.month = this.endDate.clone().date(2));
        } else
          this.leftCalendar.month.format("YYYY-MM") !=
            this.startDate.format("YYYY-MM") &&
            this.rightCalendar.month.format("YYYY-MM") !=
              this.startDate.format("YYYY-MM") &&
            ((this.leftCalendar.month = this.startDate.clone().date(2)),
            (this.rightCalendar.month = this.startDate
              .clone()
              .date(2)
              .add(1, "month")));
        this.maxDate &&
          this.linkedCalendars &&
          !this.singleDatePicker &&
          this.rightCalendar.month > this.maxDate &&
          ((this.rightCalendar.month = this.maxDate.clone().date(2)),
          (this.leftCalendar.month = this.maxDate
            .clone()
            .date(2)
            .subtract(1, "month")));
      },
      updateCalendars: function () {
        if (this.timePicker) {
          var t, e, a;
          if (this.endDate) {
            if (
              ((t = parseInt(
                this.container.find(".left .hourselect").val(),
                10
              )),
              isNaN(
                (e = parseInt(
                  this.container.find(".left .minuteselect").val(),
                  10
                ))
              ) &&
                (e = parseInt(
                  this.container.find(".left .minuteselect option:last").val(),
                  10
                )),
              (a = this.timePickerSeconds
                ? parseInt(this.container.find(".left .secondselect").val(), 10)
                : 0),
              !this.timePicker24Hour)
            ) {
              var i = this.container.find(".left .ampmselect").val();
              "PM" === i && t < 12 && (t += 12),
                "AM" === i && 12 === t && (t = 0);
            }
          } else if (
            ((t = parseInt(
              this.container.find(".right .hourselect").val(),
              10
            )),
            isNaN(
              (e = parseInt(
                this.container.find(".right .minuteselect").val(),
                10
              ))
            ) &&
              (e = parseInt(
                this.container.find(".right .minuteselect option:last").val(),
                10
              )),
            (a = this.timePickerSeconds
              ? parseInt(this.container.find(".right .secondselect").val(), 10)
              : 0),
            !this.timePicker24Hour)
          ) {
            var i = this.container.find(".right .ampmselect").val();
            "PM" === i && t < 12 && (t += 12),
              "AM" === i && 12 === t && (t = 0);
          }
          this.leftCalendar.month.hour(t).minute(e).second(a),
            this.rightCalendar.month.hour(t).minute(e).second(a);
        }
        this.renderCalendar("left"),
          this.renderCalendar("right"),
          this.container.find(".ranges li").removeClass("active"),
          null != this.endDate && this.calculateChosenLabel();
      },
      renderCalendar: function (a) {
        var i,
          s,
          n = "left" == a ? this.leftCalendar : this.rightCalendar,
          r = n.month.month(),
          o = n.month.year(),
          h = n.month.hour(),
          l = n.month.minute(),
          c = n.month.second(),
          d = t([o, r]).daysInMonth(),
          m = t([o, r, 1]),
          f = t([o, r, d]),
          p = t(m).subtract(1, "month").month(),
          u = t(m).subtract(1, "month").year(),
          D = t([u, p]).daysInMonth(),
          g = m.day(),
          n = [];
        (n.firstDay = m), (n.lastDay = f);
        for (var y = 0; y < 6; y++) n[y] = [];
        var k = D - g + this.locale.firstDay + 1;
        k > D && (k -= 7), g == this.locale.firstDay && (k = D - 6);
        for (
          var v = t([u, p, k, 12, l, c]), y = 0, i = 0, s = 0;
          y < 42;
          y++, i++, v = t(v).add(24, "hour")
        )
          y > 0 && i % 7 == 0 && ((i = 0), s++),
            (n[s][i] = v.clone().hour(h).minute(l).second(c)),
            v.hour(12),
            this.minDate &&
              n[s][i].format("YYYY-MM-DD") ==
                this.minDate.format("YYYY-MM-DD") &&
              n[s][i].isBefore(this.minDate) &&
              "left" == a &&
              (n[s][i] = this.minDate.clone()),
            this.maxDate &&
              n[s][i].format("YYYY-MM-DD") ==
                this.maxDate.format("YYYY-MM-DD") &&
              n[s][i].isAfter(this.maxDate) &&
              "right" == a &&
              (n[s][i] = this.maxDate.clone());
        "left" == a
          ? (this.leftCalendar.calendar = n)
          : (this.rightCalendar.calendar = n);
        var b = "left" == a ? this.minDate : this.startDate,
          C = this.maxDate;
        "left" == a ? this.startDate : this.endDate, this.locale.direction;
        var Y = '<table class="table-condensed">';
        (Y += "<thead>"),
          (Y += "<tr>"),
          (this.showWeekNumbers || this.showISOWeekNumbers) &&
            (Y += "<th></th>"),
          (!b || b.isBefore(n.firstDay)) &&
          (!this.linkedCalendars || "left" == a)
            ? (Y += '<th class="prev available"><span></span></th>')
            : (Y += "<th></th>");
        var _ =
          this.locale.monthNames[n[1][1].month()] + n[1][1].format(" YYYY");
        if (this.showDropdowns) {
          for (
            var $ = n[1][1].month(),
              P = n[1][1].year(),
              w = (C && C.year()) || this.maxYear,
              x = (b && b.year()) || this.minYear,
              M = P == x,
              S = P == w,
              B = '<select class="monthselect">',
              I = 0;
            I < 12;
            I++
          )
            (!M || (b && I >= b.month())) && (!S || (C && I <= C.month()))
              ? (B +=
                  "<option value='" +
                  I +
                  "'" +
                  (I === $ ? " selected='selected'" : "") +
                  ">" +
                  this.locale.monthNames[I] +
                  "</option>")
              : (B +=
                  "<option value='" +
                  I +
                  "'" +
                  (I === $ ? " selected='selected'" : "") +
                  " disabled='disabled'>" +
                  this.locale.monthNames[I] +
                  "</option>");
          B += "</select>";
          for (var L = '<select class="yearselect">', A = x; A <= w; A++)
            L +=
              '<option value="' +
              A +
              '"' +
              (A === P ? ' selected="selected"' : "") +
              ">" +
              A +
              "</option>";
          (L += "</select>"), (_ = B + L);
        }
        if (
          ((Y += '<th colspan="5" class="month">' + _ + "</th>"),
          (!C || C.isAfter(n.lastDay)) &&
          (!this.linkedCalendars || "right" == a || this.singleDatePicker)
            ? (Y += '<th class="next available"><span></span></th>')
            : (Y += "<th></th>"),
          (Y += "</tr>"),
          (Y += "<tr>"),
          (this.showWeekNumbers || this.showISOWeekNumbers) &&
            (Y += '<th class="week">' + this.locale.weekLabel + "</th>"),
          e.each(this.locale.daysOfWeek, function (t, e) {
            Y += "<th>" + e + "</th>";
          }),
          (Y += "</tr>"),
          (Y += "</thead>"),
          (Y += "<tbody>"),
          null == this.endDate && this.maxSpan)
        ) {
          var E = this.startDate.clone().add(this.maxSpan).endOf("day");
          (!C || E.isBefore(C)) && (C = E);
        }
        for (var s = 0; s < 6; s++) {
          (Y += "<tr>"),
            this.showWeekNumbers
              ? (Y += '<td class="week">' + n[s][0].week() + "</td>")
              : this.showISOWeekNumbers &&
                (Y += '<td class="week">' + n[s][0].isoWeek() + "</td>");
          for (var i = 0; i < 7; i++) {
            var O = [];
            n[s][i].isSame(new Date(), "day") && O.push("today"),
              n[s][i].isoWeekday() > 5 && O.push("weekend"),
              n[s][i].month() != n[1][1].month() && O.push("off", "ends"),
              this.minDate &&
                n[s][i].isBefore(this.minDate, "day") &&
                O.push("off", "disabled"),
              C && n[s][i].isAfter(C, "day") && O.push("off", "disabled"),
              this.isInvalidDate(n[s][i]) && O.push("off", "disabled"),
              n[s][i].format("YYYY-MM-DD") ==
                this.startDate.format("YYYY-MM-DD") &&
                O.push("active", "start-date"),
              null != this.endDate &&
                n[s][i].format("YYYY-MM-DD") ==
                  this.endDate.format("YYYY-MM-DD") &&
                O.push("active", "end-date"),
              null != this.endDate &&
                n[s][i] > this.startDate &&
                n[s][i] < this.endDate &&
                O.push("in-range");
            var W = this.isCustomDate(n[s][i]);
            !1 !== W &&
              ("string" == typeof W
                ? O.push(W)
                : Array.prototype.push.apply(O, W));
            for (var j = "", H = !1, y = 0; y < O.length; y++)
              (j += O[y] + " "), "disabled" == O[y] && (H = !0);
            H || (j += "available"),
              (Y +=
                '<td class="' +
                j.replace(/^\s+|\s+$/g, "") +
                '" data-title="r' +
                s +
                "c" +
                i +
                '">' +
                n[s][i].date() +
                "</td>");
          }
          Y += "</tr>";
        }
        (Y += "</tbody>"),
          (Y += "</table>"),
          this.container
            .find(".drp-calendar." + a + " .calendar-table")
            .html(Y);
      },
      renderTimePicker: function (t) {
        if ("right" != t || this.endDate) {
          var e,
            a,
            i,
            s = this.maxDate;
          if (
            (this.maxSpan &&
              (!this.maxDate ||
                this.startDate
                  .clone()
                  .add(this.maxSpan)
                  .isBefore(this.maxDate)) &&
              (s = this.startDate.clone().add(this.maxSpan)),
            "left" == t)
          )
            (a = this.startDate.clone()), (i = this.minDate);
          else if ("right" == t) {
            (a = this.endDate.clone()), (i = this.startDate);
            var n = this.container.find(".drp-calendar.right .calendar-time");
            if (
              "" != n.html() &&
              (a.hour(
                isNaN(a.hour())
                  ? n.find(".hourselect option:selected").val()
                  : a.hour()
              ),
              a.minute(
                isNaN(a.minute())
                  ? n.find(".minuteselect option:selected").val()
                  : a.minute()
              ),
              a.second(
                isNaN(a.second())
                  ? n.find(".secondselect option:selected").val()
                  : a.second()
              ),
              !this.timePicker24Hour)
            ) {
              var r = n.find(".ampmselect option:selected").val();
              "PM" === r && 12 > a.hour() && a.hour(a.hour() + 12),
                "AM" === r && 12 === a.hour() && a.hour(0);
            }
            a.isBefore(this.startDate) && (a = this.startDate.clone()),
              s && a.isAfter(s) && (a = s.clone());
          }
          e = '<select class="hourselect">';
          for (
            var o = this.timePicker24Hour ? 0 : 1,
              h = this.timePicker24Hour ? 23 : 12,
              l = o;
            l <= h;
            l++
          ) {
            var c = l;
            this.timePicker24Hour ||
              (c = a.hour() >= 12 ? (12 == l ? 12 : l + 12) : 12 == l ? 0 : l);
            var d = a.clone().hour(c),
              m = !1;
            i && d.minute(59).isBefore(i) && (m = !0),
              s && d.minute(0).isAfter(s) && (m = !0),
              c != a.hour() || m
                ? m
                  ? (e +=
                      '<option value="' +
                      l +
                      '" disabled="disabled" class="disabled">' +
                      l +
                      "</option>")
                  : (e += '<option value="' + l + '">' + l + "</option>")
                : (e +=
                    '<option value="' +
                    l +
                    '" selected="selected">' +
                    l +
                    "</option>");
          }
          (e += "</select> "), (e += ': <select class="minuteselect">');
          for (var l = 0; l < 60; l += this.timePickerIncrement) {
            var f = l < 10 ? "0" + l : l,
              d = a.clone().minute(l),
              m = !1;
            i && d.second(59).isBefore(i) && (m = !0),
              s && d.second(0).isAfter(s) && (m = !0),
              a.minute() != l || m
                ? m
                  ? (e +=
                      '<option value="' +
                      l +
                      '" disabled="disabled" class="disabled">' +
                      f +
                      "</option>")
                  : (e += '<option value="' + l + '">' + f + "</option>")
                : (e +=
                    '<option value="' +
                    l +
                    '" selected="selected">' +
                    f +
                    "</option>");
          }
          if (((e += "</select> "), this.timePickerSeconds)) {
            e += ': <select class="secondselect">';
            for (var l = 0; l < 60; l++) {
              var f = l < 10 ? "0" + l : l,
                d = a.clone().second(l),
                m = !1;
              i && d.isBefore(i) && (m = !0),
                s && d.isAfter(s) && (m = !0),
                a.second() != l || m
                  ? m
                    ? (e +=
                        '<option value="' +
                        l +
                        '" disabled="disabled" class="disabled">' +
                        f +
                        "</option>")
                    : (e += '<option value="' + l + '">' + f + "</option>")
                  : (e +=
                      '<option value="' +
                      l +
                      '" selected="selected">' +
                      f +
                      "</option>");
            }
            e += "</select> ";
          }
          if (!this.timePicker24Hour) {
            e += '<select class="ampmselect">';
            var p = "",
              u = "";
            i &&
              a.clone().hour(12).minute(0).second(0).isBefore(i) &&
              (p = ' disabled="disabled" class="disabled"'),
              s &&
                a.clone().hour(0).minute(0).second(0).isAfter(s) &&
                (u = ' disabled="disabled" class="disabled"'),
              a.hour() >= 12
                ? (e +=
                    '<option value="AM"' +
                    p +
                    '>AM</option><option value="PM" selected="selected"' +
                    u +
                    ">PM</option>")
                : (e +=
                    '<option value="AM" selected="selected"' +
                    p +
                    '>AM</option><option value="PM"' +
                    u +
                    ">PM</option>"),
              (e += "</select>");
          }
          this.container.find(".drp-calendar." + t + " .calendar-time").html(e);
        }
      },
      updateFormInputs: function () {
        this.singleDatePicker ||
        (this.endDate &&
          (this.startDate.isBefore(this.endDate) ||
            this.startDate.isSame(this.endDate)))
          ? this.container.find("button.applyBtn").prop("disabled", !1)
          : this.container.find("button.applyBtn").prop("disabled", !0);
      },
      move: function () {
        var t,
          a = { top: 0, left: 0 },
          i = this.drops,
          s = e(window).width();
        switch (
          (this.parentEl.is("body") ||
            ((a = {
              top: this.parentEl.offset().top - this.parentEl.scrollTop(),
              left: this.parentEl.offset().left - this.parentEl.scrollLeft(),
            }),
            (s = this.parentEl[0].clientWidth + this.parentEl.offset().left)),
          i)
        ) {
          case "auto":
            (t =
              this.element.offset().top + this.element.outerHeight() - a.top) +
              this.container.outerHeight() >=
              this.parentEl[0].scrollHeight &&
              ((t =
                this.element.offset().top -
                this.container.outerHeight() -
                a.top),
              (i = "up"));
            break;
          case "up":
            t =
              this.element.offset().top - this.container.outerHeight() - a.top;
            break;
          default:
            t = this.element.offset().top + this.element.outerHeight() - a.top;
        }
        this.container.css({ top: 0, left: 0, right: "auto" });
        var n = this.container.outerWidth();
        if (
          (this.container.toggleClass("drop-up", "up" == i),
          "left" == this.opens)
        ) {
          var r = s - this.element.offset().left - this.element.outerWidth();
          n + r > e(window).width()
            ? this.container.css({ top: t, right: "auto", left: 9 })
            : this.container.css({ top: t, right: r, left: "auto" });
        } else if ("center" == this.opens) {
          var o =
            this.element.offset().left -
            a.left +
            this.element.outerWidth() / 2 -
            n / 2;
          o < 0
            ? this.container.css({ top: t, right: "auto", left: 9 })
            : o + n > e(window).width()
            ? this.container.css({ top: t, left: "auto", right: 0 })
            : this.container.css({ top: t, left: o, right: "auto" });
        } else {
          var o = this.element.offset().left - a.left;
          o + n > e(window).width()
            ? this.container.css({ top: t, left: "auto", right: 0 })
            : this.container.css({ top: t, left: o, right: "auto" });
        }
      },
      show: function (t) {
        this.isShowing ||
          ((this._outsideClickProxy = e.proxy(function (t) {
            this.outsideClick(t);
          }, this)),
          e(document)
            .on("mousedown.daterangepicker", this._outsideClickProxy)
            .on("touchend.daterangepicker", this._outsideClickProxy)
            .on(
              "click.daterangepicker",
              "[data-toggle=dropdown]",
              this._outsideClickProxy
            )
            .on("focusin.daterangepicker", this._outsideClickProxy),
          e(window).on(
            "resize.daterangepicker",
            e.proxy(function (t) {
              this.move(t);
            }, this)
          ),
          (this.oldStartDate = this.startDate.clone()),
          (this.oldEndDate = this.endDate.clone()),
          (this.previousRightTime = this.endDate.clone()),
          this.updateView(),
          this.container.show(),
          this.move(),
          this.element.trigger("show.daterangepicker", this),
          (this.isShowing = !0));
      },
      hide: function (t) {
        this.isShowing &&
          (this.endDate ||
            ((this.startDate = this.oldStartDate.clone()),
            (this.endDate = this.oldEndDate.clone())),
          (this.startDate.isSame(this.oldStartDate) &&
            this.endDate.isSame(this.oldEndDate)) ||
            this.callback(
              this.startDate.clone(),
              this.endDate.clone(),
              this.chosenLabel
            ),
          this.updateElement(),
          e(document).off(".daterangepicker"),
          e(window).off(".daterangepicker"),
          this.container.hide(),
          this.element.trigger("hide.daterangepicker", this),
          (this.isShowing = !1));
      },
      toggle: function (t) {
        this.isShowing ? this.hide() : this.show();
      },
      outsideClick: function (t) {
        var a = e(t.target);
        "focusin" == t.type ||
          a.closest(this.element).length ||
          a.closest(this.container).length ||
          a.closest(".calendar-table").length ||
          (this.hide(),
          this.element.trigger("outsideClick.daterangepicker", this));
      },
      showCalendars: function () {
        this.container.addClass("show-calendar"),
          this.move(),
          this.element.trigger("showCalendar.daterangepicker", this);
      },
      hideCalendars: function () {
        this.container.removeClass("show-calendar"),
          this.element.trigger("hideCalendar.daterangepicker", this);
      },
      clickRange: function (t) {
        var e = t.target.getAttribute("data-range-key");
        if (((this.chosenLabel = e), e == this.locale.customRangeLabel))
          this.showCalendars();
        else {
          var a = this.ranges[e];
          (this.startDate = a[0]),
            (this.endDate = a[1]),
            this.timePicker ||
              (this.startDate.startOf("day"), this.endDate.endOf("day")),
            this.alwaysShowCalendars || this.hideCalendars(),
            this.clickApply();
        }
      },
      clickPrev: function (t) {
        e(t.target).parents(".drp-calendar").hasClass("left")
          ? (this.leftCalendar.month.subtract(1, "month"),
            this.linkedCalendars &&
              this.rightCalendar.month.subtract(1, "month"))
          : this.rightCalendar.month.subtract(1, "month"),
          this.updateCalendars();
      },
      clickNext: function (t) {
        e(t.target).parents(".drp-calendar").hasClass("left")
          ? this.leftCalendar.month.add(1, "month")
          : (this.rightCalendar.month.add(1, "month"),
            this.linkedCalendars && this.leftCalendar.month.add(1, "month")),
          this.updateCalendars();
      },
      hoverDate: function (t) {
        if (e(t.target).hasClass("available")) {
          var a = e(t.target).attr("data-title"),
            i = a.substr(1, 1),
            s = a.substr(3, 1),
            n = e(t.target).parents(".drp-calendar").hasClass("left")
              ? this.leftCalendar.calendar[i][s]
              : this.rightCalendar.calendar[i][s],
            r = this.leftCalendar,
            o = this.rightCalendar,
            h = this.startDate;
          this.endDate ||
            this.container.find(".drp-calendar tbody td").each(function (t, a) {
              if (!e(a).hasClass("week")) {
                var i = e(a).attr("data-title"),
                  s = i.substr(1, 1),
                  l = i.substr(3, 1),
                  c = e(a).parents(".drp-calendar").hasClass("left")
                    ? r.calendar[s][l]
                    : o.calendar[s][l];
                (c.isAfter(h) && c.isBefore(n)) || c.isSame(n, "day")
                  ? e(a).addClass("in-range")
                  : e(a).removeClass("in-range");
              }
            });
        }
      },
      clickDate: function (t) {
        if (e(t.target).hasClass("available")) {
          var a = e(t.target).attr("data-title"),
            i = a.substr(1, 1),
            s = a.substr(3, 1),
            n = e(t.target).parents(".drp-calendar").hasClass("left")
              ? this.leftCalendar.calendar[i][s]
              : this.rightCalendar.calendar[i][s];
          if (this.endDate || n.isBefore(this.startDate, "day")) {
            if (this.timePicker) {
              var r = parseInt(
                this.container.find(".left .hourselect").val(),
                10
              );
              if (!this.timePicker24Hour) {
                var o = this.container.find(".left .ampmselect").val();
                "PM" === o && r < 12 && (r += 12),
                  "AM" === o && 12 === r && (r = 0);
              }
              var h = parseInt(
                this.container.find(".left .minuteselect").val(),
                10
              );
              isNaN(h) &&
                (h = parseInt(
                  this.container.find(".left .minuteselect option:last").val(),
                  10
                ));
              var l = this.timePickerSeconds
                ? parseInt(this.container.find(".left .secondselect").val(), 10)
                : 0;
              n = n.clone().hour(r).minute(h).second(l);
            }
            (this.endDate = null), this.setStartDate(n.clone());
          } else if (!this.endDate && n.isBefore(this.startDate))
            this.setEndDate(this.startDate.clone());
          else {
            if (this.timePicker) {
              var r = parseInt(
                this.container.find(".right .hourselect").val(),
                10
              );
              if (!this.timePicker24Hour) {
                var o = this.container.find(".right .ampmselect").val();
                "PM" === o && r < 12 && (r += 12),
                  "AM" === o && 12 === r && (r = 0);
              }
              var h = parseInt(
                this.container.find(".right .minuteselect").val(),
                10
              );
              isNaN(h) &&
                (h = parseInt(
                  this.container.find(".right .minuteselect option:last").val(),
                  10
                ));
              var l = this.timePickerSeconds
                ? parseInt(
                    this.container.find(".right .secondselect").val(),
                    10
                  )
                : 0;
              n = n.clone().hour(r).minute(h).second(l);
            }
            this.setEndDate(n.clone()),
              this.autoApply &&
                (this.calculateChosenLabel(), this.clickApply());
          }
          this.singleDatePicker &&
            (this.setEndDate(this.startDate),
            !this.timePicker && this.autoApply && this.clickApply()),
            this.updateView(),
            t.stopPropagation();
        }
      },
      calculateChosenLabel: function () {
        var t = !0,
          e = 0;
        for (var a in this.ranges) {
          if (this.timePicker) {
            var i = this.timePickerSeconds
              ? "YYYY-MM-DD HH:mm:ss"
              : "YYYY-MM-DD HH:mm";
            if (
              this.startDate.format(i) == this.ranges[a][0].format(i) &&
              this.endDate.format(i) == this.ranges[a][1].format(i)
            ) {
              (t = !1),
                (this.chosenLabel = this.container
                  .find(".ranges li:eq(" + e + ")")
                  .addClass("active")
                  .attr("data-range-key"));
              break;
            }
          } else if (
            this.startDate.format("YYYY-MM-DD") ==
              this.ranges[a][0].format("YYYY-MM-DD") &&
            this.endDate.format("YYYY-MM-DD") ==
              this.ranges[a][1].format("YYYY-MM-DD")
          ) {
            (t = !1),
              (this.chosenLabel = this.container
                .find(".ranges li:eq(" + e + ")")
                .addClass("active")
                .attr("data-range-key"));
            break;
          }
          e++;
        }
        t &&
          (this.showCustomRangeLabel
            ? (this.chosenLabel = this.container
                .find(".ranges li:last")
                .addClass("active")
                .attr("data-range-key"))
            : (this.chosenLabel = null),
          this.showCalendars());
      },
      clickApply: function (t) {
        this.hide(), this.element.trigger("apply.daterangepicker", this);
      },
      clickCancel: function (t) {
        (this.startDate = this.oldStartDate),
          (this.endDate = this.oldEndDate),
          this.hide(),
          this.element.trigger("cancel.daterangepicker", this);
      },
      monthOrYearChanged: function (t) {
        var a = e(t.target).closest(".drp-calendar").hasClass("left"),
          i = this.container.find(".drp-calendar." + (a ? "left" : "right")),
          s = parseInt(i.find(".monthselect").val(), 10),
          n = i.find(".yearselect").val();
        !a &&
          (n < this.startDate.year() ||
            (n == this.startDate.year() && s < this.startDate.month())) &&
          ((s = this.startDate.month()), (n = this.startDate.year())),
          this.minDate &&
            (n < this.minDate.year() ||
              (n == this.minDate.year() && s < this.minDate.month())) &&
            ((s = this.minDate.month()), (n = this.minDate.year())),
          this.maxDate &&
            (n > this.maxDate.year() ||
              (n == this.maxDate.year() && s > this.maxDate.month())) &&
            ((s = this.maxDate.month()), (n = this.maxDate.year())),
          a
            ? (this.leftCalendar.month.month(s).year(n),
              this.linkedCalendars &&
                (this.rightCalendar.month = this.leftCalendar.month
                  .clone()
                  .add(1, "month")))
            : (this.rightCalendar.month.month(s).year(n),
              this.linkedCalendars &&
                (this.leftCalendar.month = this.rightCalendar.month
                  .clone()
                  .subtract(1, "month"))),
          this.updateCalendars();
      },
      timeChanged: function (t) {
        var a = e(t.target).closest(".drp-calendar"),
          i = a.hasClass("left"),
          s = parseInt(a.find(".hourselect").val(), 10),
          n = parseInt(a.find(".minuteselect").val(), 10);
        isNaN(n) &&
          (n = parseInt(a.find(".minuteselect option:last").val(), 10));
        var r = this.timePickerSeconds
          ? parseInt(a.find(".secondselect").val(), 10)
          : 0;
        if (!this.timePicker24Hour) {
          var o = a.find(".ampmselect").val();
          "PM" === o && s < 12 && (s += 12), "AM" === o && 12 === s && (s = 0);
        }
        if (i) {
          var h = this.startDate.clone();
          h.hour(s),
            h.minute(n),
            h.second(r),
            this.setStartDate(h),
            this.singleDatePicker
              ? (this.endDate = this.startDate.clone())
              : this.endDate &&
                this.endDate.format("YYYY-MM-DD") == h.format("YYYY-MM-DD") &&
                this.endDate.isBefore(h) &&
                this.setEndDate(h.clone());
        } else if (this.endDate) {
          var l = this.endDate.clone();
          l.hour(s), l.minute(n), l.second(r), this.setEndDate(l);
        }
        this.updateCalendars(),
          this.updateFormInputs(),
          this.renderTimePicker("left"),
          this.renderTimePicker("right");
      },
      elementChanged: function () {
        if (this.element.is("input") && this.element.val().length) {
          var e = this.element.val().split(this.locale.separator),
            a = null,
            i = null;
          2 === e.length &&
            ((a = t(e[0], this.locale.format)),
            (i = t(e[1], this.locale.format))),
            (this.singleDatePicker || null === a || null === i) &&
              (i = a = t(this.element.val(), this.locale.format)),
            a.isValid() &&
              i.isValid() &&
              (this.setStartDate(a), this.setEndDate(i), this.updateView());
        }
      },
      keydown: function (t) {
        (9 === t.keyCode || 13 === t.keyCode) && this.hide(),
          27 === t.keyCode &&
            (t.preventDefault(), t.stopPropagation(), this.hide());
      },
      updateElement: function () {
        if (this.element.is("input") && this.autoUpdateInput) {
          var t = this.startDate.format(this.locale.format);
          this.singleDatePicker ||
            (t +=
              this.locale.separator + this.endDate.format(this.locale.format)),
            t !== this.element.val() && this.element.val(t).trigger("change");
        }
      },
      remove: function () {
        this.container.remove(),
          this.element.off(".daterangepicker"),
          this.element.removeData();
      },
    }),
    (e.fn.daterangepicker = function (t, i) {
      var s = e.extend(!0, {}, e.fn.daterangepicker.defaultOptions, t);
      return (
        this.each(function () {
          var t = e(this);
          t.data("daterangepicker") && t.data("daterangepicker").remove(),
            t.data("daterangepicker", new a(t, s, i));
        }),
        this
      );
    }),
    a
  );
});

var popUpFormLead_thisParent;
var popUpFormLead_tbtkey;
var popUpFormLead_reqObjForOtp;
var popUpFormLead_urlSearchParamsData;
var popUpFormLead_redirectHeaders;

$(document).ready(function () {
  // datepicker initialization
  var today = new Date();
  var currentFormat = 'DD/MM/YYYY'
  $('.popUpLeadForm #dateBirth').daterangepicker(
    {
      autoUpdateInput: false,
      autoApply: true,
      singleDatePicker: true,
      parentEl: '.popUpLeadForm',
      showDropdowns: true,
      startDate: "1985-01-01",
      minYear: 1951,
      minDate: "1951-01-01",
      maxDate: today.getFullYear().toString() + "-12-31",
      maxYear: today.getFullYear(),
      locale: {
        format: "YYYY-MM-DD",
        separator: " - ",
      },
    },
    function (start, end, label) {
      // CALLBACK TO FORMAT THE SELECTED DATE
      var formattedDate = start.format(currentFormat);
      $('.popUpLeadForm #dateBirth').val(formattedDate);
      // FUNCTION FOR VALIDATION
      popUpLeadValidateDOB(start);
    }
  );

  $('.popUpLeadForm input[name="dateBirth"]').on('apply.daterangepicker', function (ev, picker) {
    var selectedDate = picker.startDate.format(currentFormat);
    if (picker.startDate.isSame("1985-01-01")) {
      $(this).val(selectedDate);
    }
    popUpLeadValidateDOB(picker.startDate);
  });


  var $code = $('.popUpLeadForm #code');
  var $mobile10 = $('.popUpLeadForm .mobileNo10');
  var $mobile14 = $('.popUpLeadForm .mobileNo14');
  var $phone = $('.popUpLeadForm .mobileNo10 , .popUpLeadForm .mobileNo14');

   // Function to handle the display and validation logic
   function updateFormState(isNRI) {
      var $code = $('.popUpLeadForm #code');
      var $mobile10 = $('.popUpLeadForm .mobileNo10');
      var $mobile14 = $('.popUpLeadForm .mobileNo14');
      var $phone = $('.popUpLeadForm .mobileNo10, .popUpLeadForm .mobileNo14');
      
      if (isNRI) {
        $code.removeAttr('readonly').val('');
        $code.parent().removeClass('valid');
        $phone.hide();
        $mobile14.show();
        $phone.val('');
      } else {
        $code.attr('readonly', 'readonly').val('91');
        $code.parent().removeClass('valid');
        $phone.hide();
        $mobile10.show();
        $phone.val('');
        $code.siblings('.error-txt1').removeClass('d-block').addClass('d-none');
      }
    }

    // Event handler for NRI option selection
    $('.popUpLeadForm #yes_nriBannerForm, .popUpLeadForm #no_nriBannerForm').click(function () {
      var isNRI = $(this).attr('id') === 'yes_nriBannerForm'; 
      updateFormState(isNRI);
      $(this).addClass('valid').siblings().removeClass('valid');
    });

    if ($('.popUpLeadForm #yes_nriBannerForm').hasClass('valid')) {
      updateFormState(true);
    } else if ($('.popUpLeadForm #no_nriBannerForm').hasClass('valid')) {
      updateFormState(false);
    }
});

function ulipHeaderRequest(url) {

  var headersReq = {
      "agent-code": "00488538",
      "source-code": "HDFC_Life_tech_failure",
      "content-type": "application/x-www-form-urlencoded; charset=UTF-8"
  }

  var browserUrl = new URL(url);
  var browserUrlParams = sanitize(new URLSearchParams(browserUrl.search.slice(1)));


  if (browserUrlParams.has("source")) {
      headersReq["source-code"] = browserUrlParams.get("source");
  }
  if (browserUrlParams.has("source-code")) {
      headersReq["source-code"] = browserUrlParams.get("source-code");
  }
  if (browserUrlParams.has("sourcecode")) {
      headersReq["source-code"] = browserUrlParams.get("sourcecode");
  }
  if (browserUrlParams.has("agentcode")) {
      headersReq["agent-code"] = browserUrlParams.get("agentcode");
  }
  if (browserUrlParams.has("agent-code")) {
      headersReq["agent-code"] = browserUrlParams.get("agent-code");
  }
  if (browserUrlParams.has("agent-token")) {
      headersReq["agent-token"] = browserUrlParams.get("agent-token");
  }
  if (browserUrlParams.has("utm_adgroupid")) {
      headersReq["adgroup"] = browserUrlParams.get("utm_adgroupid");
  }
  if (browserUrlParams.has("campaign-date")) {
      headersReq["campaign-date"] = browserUrlParams.get("campaign-date");
  }
  if (browserUrlParams.has("utm_campaignid")) {
      headersReq["campaign-id"] = browserUrlParams.get("utm_campaignid");
  }
  if (browserUrlParams.has("agent-code")) {
      headersReq["agent-code"] = browserUrlParams.get("agent-code");
  }
  if (browserUrlParams.has("gclid")) {
      headersReq["gclid"] = browserUrlParams.get("gclid");
  }

  if (browserUrlParams.has("matchtype")) {
      headersReq["match-type"] = browserUrlParams.get("matchtype");
  }
  if (browserUrlParams.has("pid")) {
      headersReq["pid"] = browserUrlParams.get("pid");
  }
  if (browserUrlParams.has("prod")) {
      headersReq["prod"] = browserUrlParams.get("prod");
  }
  if (browserUrlParams.has("spid")) {
      headersReq["spid"] = browserUrlParams.get("spid");
  }
  if (browserUrlParams.has("utm_campaign")) {
      headersReq["utm-campaign"] = browserUrlParams.get("utm_campaign");
  }
  if (browserUrlParams.has("utm_content")) {
      headersReq["utm-content"] = browserUrlParams.get("utm_content");
  }
  if (browserUrlParams.has("spid")) {
      headersReq["spid"] = browserUrlParams.get("spid");
  }
  if (browserUrlParams.has("utm_medium")) {
      headersReq["utm-medium"] = browserUrlParams.get("utm_medium");
  }
  if (browserUrlParams.has("utm_source")) {
      headersReq["utm-source"] = browserUrlParams.get("utm_source");
  }
  if (browserUrlParams.has("utm_term")) {
      headersReq["utm-term"] = browserUrlParams.get("utm_term");
  }
  if (browserUrlParams.has("vid")) {
      headersReq["vid"] = browserUrlParams.get("vid");
  }


  return headersReq;

}


function splitName(nameString) {
  nameString = nameString.trim();
  var isFullname = nameString.includes(' ');
  if (!isFullname) {
      return {
          fname: nameString,
          lname: ''
      }
  }
  var firstNameEndIndex = nameString.indexOf(' ');
  return {
      fname: nameString.substring(0, firstNameEndIndex),
      lname: nameString.substring(firstNameEndIndex + 1)
  }
}

function asteriskEmailPhoneUlip(thisParent){
  var phone = thisParent.find('.mobileNo10').val().trim()
  var asteriskPhone = '91 ' + phone.slice(0,1) + '*******' + phone.slice(8)
  thisParent.find('[data-id = "asteriskPhone"]').html(asteriskPhone)
}

// generate lead api
function sendReq(reqObj, requestHeaders, redirectHeaders) {
  var $parentElement = $('.popUpLeadForm');
  $parentElement.toggleLoader();
  popUpLeadFormApiObj.litePages(reqObj, requestHeaders).then(function (res) {
      var successMsg = $parentElement.find('#apiSuccessMsg').val();
      $parentElement.toggleLoader();
      $parentElement.toggleApiSuccessMsg();
    // datalayer-lemnisk
    const eventName = $('#lemniskEventNameUlipForm').val();
    const name = $("#fnameBannerForm").val().trim();
    const isNriLemniskChecked = $('#yes_nriBannerForm').hasClass('valid');
    const isNriLemnisk = isNriLemniskChecked ? 'Yes' : 'No';
    const genderLemnisk =  res.responseJson.response.gender ==  "GEN_M" ? "Male" : "Female";
    const lemniskDob = $('#dateBirth').val();
    const formattedDate  = lemniskDob.split('/').reverse().join('-');
    const lemniskEmail = res.responseJson.response.email;
    // const lemniskTrackingCategoryProduct = "Savings Plan";
    const lemniskTrackingLeadId = res.responseJson.response.id;
    const lemniskTrackingProduct = "Sanchay Plus";
    const lemniskTrackingstepName = "Calculate Premium SLF";
    const countryPhoneCode = $('#code').val().trim();
    const phone = res.responseJson.response.phone;
    lemniskTrackingUlipBannerFormCta(eventName, name, genderLemnisk, isNriLemnisk, formattedDate, lemniskTrackingLeadId, lemniskTrackingProduct, lemniskTrackingstepName, countryPhoneCode, phone, lemniskEmail);
      if(successMsg){
        $parentElement.find(".api-response-msg").text(successMsg);
      }
      renderLiteSuccessMessageUlipForm(res, redirectHeaders);
  }).catch(function (err) {
      console.log('error: ', err);
      $parentElement.toggleLoader();
      $parentElement.toggleApiFailMsg();
      formSubmissionFailed('lite-page-data-layer', err);
  })
}

function popUpLeadValidateDOB(dateString) {
  var $dateInput = $('.popUpLeadForm #dateBirth');
  var $formGroup = $dateInput.closest('.form-field');
  var $errorTxt = $dateInput.siblings('.error-txt');
  if (!dateString || !dayjs(dateString).isValid()) {
    $formGroup.removeClass('valid');
    $errorTxt.html("Please enter Date of Birth");
    return;
  }
  var dtDOB = dayjs(dateString);
  var dtCurrent = dayjs();
  var yearsDiff = dtCurrent.diff(dtDOB, 'year');
  dtDOB.add(yearsDiff, 'year');
  if (yearsDiff < 18 || (yearsDiff === 18 && dtCurrent.isBefore(dtDOB, 'day'))) {
    $formGroup.removeClass('valid');
    $errorTxt.html("Age should be between 18-65 years");
    return;
  }
  if (yearsDiff > 65 || (yearsDiff === 65 && dtCurrent.isAfter(dtDOB, 'day'))) {
    $formGroup.removeClass('valid');
    $errorTxt.html("Age should be between 18-65 years");
    return;
  }
  $formGroup.addClass('valid');
  $errorTxt.html("");
}

// GENERATE LEAD API
function sendPopUpLeadFormLite(reqObj, requestHeaders, redirectHeaders) {
  var $parentElement = $('.popUpLeadForm');
  $parentElement.toggleLoader();
  popUpLeadFormApiObj.litePages(reqObj, requestHeaders).then(function (res) {
    var successMsg = $parentElement.find('#apiSuccessMsg').val();
    var lead_id = res.responseJson.response.lead_number
    var leadApiResponse = res
    popUpFormLead_thisParent.find('[data-id = "verifyOtp"]').data('leadId', lead_id)
    popUpFormLead_thisParent.find('[data-id = "verifyOtp"]').data('leadApiResponse', leadApiResponse)
    // datalayer-lemnisk
    const eventName = $('#lemniskEventNameUlipForm').val();
    const name = $("#fnameBannerForm").val().trim();
    const isNriLemniskChecked = $('#yes_nriBannerForm').hasClass('valid');
    const isNriLemnisk = isNriLemniskChecked ? 'Yes' : 'No';
    // const lemniskTrackingCategoryProduct = "Savings Plan";
    const lemniskTrackingLeadId = res.responseJson.response.id;
    const lemniskTrackingProduct = "Sanchay Plus";
    const lemniskTrackingstepName = "Calculate Premium SLF";
    const countryPhoneCode = $('#code').val().trim();
    const genderLemnisk =  res.responseJson.response.gender ==  "GEN_M" ? "Male" : "Female";
    const lemniskDob = $('#dateBirth').val();
    const formattedDate  = lemniskDob.split('/').reverse().join('-');
    const lemniskEmail = res.responseJson.response.email;
    const phone = res.responseJson.response.phone;
    lemniskTrackingUlipBannerFormCta(eventName, name, genderLemnisk, isNriLemnisk, formattedDate, lemniskTrackingLeadId, lemniskTrackingProduct, lemniskTrackingstepName, countryPhoneCode, phone, lemniskEmail);
    $parentElement.toggleLoader();
    if (popUpFormLead_tbtkey && !(popUpFormLead_thisParent.find('#code').val() == '91' && validateIndianPhoneNumber(phone))) {
      $parentElement.toggleApiSuccessMsg();
      if (successMsg) {
        $parentElement.find(".api-response-msg").text(successMsg);
      }
      renderLiteSuccessMessageUlipForm(res, redirectHeaders);
    } else {
      sendOtpReqUlip(popUpFormLead_reqObjForOtp, $parentElement)
    }
  }).catch(function (err) {
    console.log('error: ', err);
    $parentElement.toggleLoader();
    $parentElement.toggleApiFailMsg();
    formSubmissionFailed('lite-page-data-layer', err);
  })
}

// SEND OTP API
function sendOtpReqUlip(reqObj, popUpFormLead_thisParent) {
  popUpFormLead_thisParent.toggleLoader()
  sendOtpApiPopUpLeadForm.sendOtp(reqObj).then(function (res) {
      // ENCODE EMAIL N PHONE
      asteriskEmailPhoneUlip(popUpFormLead_thisParent)
      // RESET THE OTP SCREEN AND THE ERROR MESSAGES
      popUpFormLead_thisParent.find('.error-msg').addClass('dsp-n')
      popUpFormLead_thisParent.find('[data-id = "successMsg"]').removeClass('dsp-n')
      popUpFormLead_thisParent.find('[data-id = "failureMsg"]').addClass("dsp-n");
      // HIDE SUCCESS MESSAGE AFTER 10 SECONDS
      setTimeout(function(){
          popUpFormLead_thisParent.find('[data-id = "successMsg"]').addClass('dsp-n')
      },10000)
      popUpFormLead_thisParent.find('.otp-input input').each(function(){
          $(this).val('')
      })
      popUpFormLead_thisParent.find('.otp-input input').removeClass('border-red')
      popUpFormLead_thisParent.find('[data-id = "otpOverlay"]').addClass('dsp-n')
      // SHOW THE OTP SCREEN AND HIDE THE FORM
      popUpFormLead_thisParent.find('.form-holder').addClass('dsp-n')
      popUpFormLead_thisParent.find('.otp-screen-container').removeClass('dsp-n')
      popUpFormLead_thisParent.toggleLoader()
      // popUpFormLead_thisParent.find(".rdmore").css("display", "none");
      var elementTop = popUpFormLead_thisParent.find('.otp-screen-container').offset().top;
      window.scrollTo({
        top: elementTop - 200,
        behavior: 'smooth' // For smooth scrolling
      });
  }).catch(function (err) {
      popUpFormLead_thisParent.toggleLoader()
      var err = JSON.parse(err)
      if (err.detail) {
        //REMOVING SUCCESS MESSAGE
        popUpFormLead_thisParent.find('[data-id = "successMsg"]').addClass("dsp-n");
        //SETTING THE APPROPRIATE ERROR MESSAGE
        popUpFormLead_thisParent.find(".error-red").addClass("dsp-n");
        popUpFormLead_thisParent.find('[data-id = "tryLaterMsg"]').html(sanitize(err.detail));
        popUpFormLead_thisParent.find('[data-id = "tryLaterMsg"]').removeClass("dsp-n");
        popUpFormLead_thisParent.find('[data-id = "failureMsg"]').removeClass("dsp-n");
        // ENCODE EMAIL N PHONE
        asteriskEmailPhoneUlip(popUpFormLead_thisParent);
        // SHOW THE OTP SCREEN AND HIDE THE FORM
        popUpFormLead_thisParent.find(".form-holder1").addClass("dsp-n");
        popUpFormLead_thisParent.find(".otp-screen-container").removeClass("dsp-n");
        popUpFormLead_thisParent.find(".otpoption").css("z-index", 0);
        popUpFormLead_thisParent.find('[data-id = "otpOverlay"]').removeClass("dsp-n");
        
      //   popUpFormLead_thisParent.find(".rdmore").css("display", "none");
      }
  })
}

// VERIFY OTP API
function verifyOtpReqUlip(reqObj,headers,popUpFormLead_redirectHeaders,popUpFormLead_thisParent) {
  popUpFormLead_thisParent.toggleLoader();
  verifyOtpApiPopUpLeadForm.verifyOtp(reqObj).then(function (res) {
      // popUpFormLead_thisParent.find(".rdmore").css("display", "none");
      var successMsg = popUpFormLead_thisParent.find('#apiSuccessMsg').val();
      popUpFormLead_thisParent.find('.otp-input input').removeClass('border-red')
      popUpFormLead_thisParent.find('.error-msg').addClass('dsp-n')
      // SHOW OTP SUCCESS MESSAGE
      popUpFormLead_thisParent.find('[data-id = "successMsg"]').removeClass('dsp-n')
      popUpFormLead_thisParent.find('[data-id = "otpSentMsg"]').addClass('dsp-n')
      popUpFormLead_thisParent.find('[data-id = "redirectionMsg"]').removeClass('dsp-n')
      // SHOW OTP SUCCESS IMAGE
      popUpFormLead_thisParent.find('[data-id = "mainForm"]').addClass('dsp-n')
      popUpFormLead_thisParent.find('[data-id = "successImg"]').removeClass('dsp-n')
      // REDIRECT TO OPS
      var leadApiResponse = popUpFormLead_thisParent.find('[data-id = "verifyOtp"]').data().leadApiResponse
      popUpFormLead_thisParent.toggleLoader();
      popUpFormLead_thisParent.toggleApiSuccessMsg();
      if (successMsg) {
        popUpFormLead_thisParent.find(".api-response-msg").text(successMsg);
      }
      localStorage.setItem("backFromOPS", true)
      renderLiteSuccessMessageUlipForm(leadApiResponse, popUpFormLead_redirectHeaders);
  }).catch(function (err) {
      // popUpFormLead_thisParent.find(".rdmore").css("display", "none");
      popUpFormLead_thisParent.toggleLoader();
      popUpFormLead_thisParent.toggleApiFailMsg();
      var err = JSON.parse(err)
      popUpFormLead_thisParent.find('.error-red').addClass('dsp-n')
      popUpFormLead_thisParent.find('.otp-input input').addClass('border-red')
      if(err.detail.slice(0,49) == "You have entered incorrect OTP more than 5 times."){
          popUpFormLead_thisParent.find('[data-id = "tryLaterMsg"]').html(err.detail)
          popUpFormLead_thisParent.find('[data-id = "tryLaterMsg"]').removeClass('dsp-n')
          popUpFormLead_thisParent.find('[data-id = "otpOverlay"]').removeClass("dsp-n");
          popUpFormLead_thisParent.find('.otp-input input').blur()
          popUpFormLead_thisParent.toggleApiFailMsg();
      }else if(err.detail === "Incorrect OTP entered.") {
          popUpFormLead_thisParent.find('[data-id = "invalidOtpMsg"]').removeClass('dsp-n')
          popUpFormLead_thisParent.toggleApiFailMsg();
      }
      popUpFormLead_thisParent.find('.error-msg').addClass('dsp-n')
      popUpFormLead_thisParent.find('[data-id = "failureMsg"]').removeClass('dsp-n')
  })
}
(function (_global) {
    var popUpLeadFormApiObj = (function () {
        var litePagesApi = {};
        function litePages(requestObject, headers) {
            return new Promise(function (resolve, reject) {
                apiUtility.LITE_PAGES(requestObject, headers).then(function (res) {
                    resolve(res);
                }).catch(function (err) {
                    reject(err);
                })
            })
        }

        litePagesApi.litePages = litePages;

        return jsHelper.freezeObject(litePagesApi);
    })();
    _global.jsHelper.defineReadOnlyObjProp(_global, 'popUpLeadFormApiObj', popUpLeadFormApiObj);
})(window || document || {});

// *************************SEND OTP API START*****************************
(function (_global) {
    var sendOtpApiPopUpLeadForm = (function () {
        var sendOtpApi = {};
        function sendOtp(requestObject, headers) {
            return new Promise(function (resolve, reject) {
                apiUtility.SEND_OTP(requestObject, headers).then(function (res) {
                    resolve(res);
                }).catch(function (err) {
                    reject(err);
                })
            })
        }

        sendOtpApi.sendOtp = sendOtp;

        return jsHelper.freezeObject(sendOtpApi);
    })();
    _global.jsHelper.defineReadOnlyObjProp(_global, 'sendOtpApiPopUpLeadForm', sendOtpApiPopUpLeadForm);
})(window || document || {});

// *************************SEND OTP API END*****************************

// *************************VERIFY OTP API START*****************************
(function (_global) {
    var verifyOtpApiPopUpLeadForm = (function () {
        var verifyOtpApi = {};
        function verifyOtp(requestObject, headers) {
            return new Promise(function (resolve, reject) {
                apiUtility.VERIFY_OTP(requestObject, headers).then(function (res) {
                    resolve(res);
                }).catch(function (err) {
                    reject(err);
                })
            })
        }

        verifyOtpApi.verifyOtp = verifyOtp;

        return jsHelper.freezeObject(verifyOtpApi);
    })();
    _global.jsHelper.defineReadOnlyObjProp(_global, 'verifyOtpApiPopUpLeadForm', verifyOtpApiPopUpLeadForm);
})(window || document || {})

// *************************VERIFY OTP API END*****************************
$(document).ready(function () {
    $('.popUpLeadForm #submitResult').on('click', function (e) {
        e.preventDefault();
        var $this = $(this);
        var form = $this.closest("form");
        var dob = form.find('#dateBirth').val();
        var yyyy_mm_dd = dob.split('/').reverse().join('-');
        popUpLeadValidateDOB(yyyy_mm_dd);
        var dobFormGroup = form.find("#dateBirth").closest('.form-field');
        var isDobValid = dobFormGroup.hasClass('valid');
        var isValid = isFormValid(form) && isDobValid;
        if (!isValid) {
            return scrollToError(e, $this, 200);
        }
        var productCode = form.find('#ulipProductCode').val().trim();
        var name = form.find("#fnameBannerForm").val().trim();
        var splittedName = splitName(name);
        var fname = splittedName.fname;
        var lname = splittedName.lname;
        var formattedDate = dayjs(yyyy_mm_dd).format('DD-MMM-YYYY');
        var gender = form.find('#ulipMaleBannerForm').hasClass('valid') ? 'GEN_M' : 'GEN_F';
        var annualIncome = form.find('#annualIncome').find(':selected').val();
        var isNriChecked = form.find('#yes_nriBannerForm').hasClass('valid');
        var isNri = isNriChecked ? 'Y' : 'N';
        if (form.find('#yesBannerForm').length > 0) {
            var isSmokerChecked = form.find('#yesBannerForm').hasClass('valid');
            var isSmoker = isSmokerChecked ? 'Y' : 'N';
        }
        var tebt = isNriChecked ? true : false;
        var countryPhoneCode = form.find('#code').val().trim();
        var localPhone = form.find('.mobileNo10').val().trim();
        var isdPhone = form.find('.mobileNo14').val().trim();
        var phone = isNriChecked ? isdPhone : localPhone;
        var email = form.find('#email').val().trim();
        var investingFor = form.find('#investingFor').find(':selected').val() ?? "";
        var ndnc = true;
        var reqObj = {
            first_name: fname,
            last_name: lname,
            country_phone_code: countryPhoneCode,
            phone: phone,
            email: email,
            gender: gender,
            dob: formattedDate,
            is_nri: isNri,
            product_code: productCode,
            send_lead_to_tebt: tebt,
            ndnc_flag: ndnc,
            lead_relationship: investingFor,
            // is_smoker: isSmoker,
            annual_income: annualIncome
        }

        if (form.find('#yesBannerForm').length > 0) {
            reqObj["is_smoker"] = isSmoker
        }

        var requestHeaders = ulipHeaderRequest(form.find('#ulipOpsUrl').val().trim())
        var browserUrl = new URL(window.location);
        var browserUrlParams = sanitize(new URLSearchParams(browserUrl.search.slice(1)));
        var redirectHeaders = sanitize(browserUrlParams.toString());
        sendReq(reqObj, requestHeaders, redirectHeaders);
    })
    // gender
    $('.popUpLeadForm #ulipMaleBannerForm, .popUpLeadForm #ulipFemaleBannerForm').click(function (e) {
        if (!$(this).hasClass('valid')) {
            $(this).addClass('valid');
            $(this).siblings().removeClass('valid');
        }
    })
    // smoker
    $('.popUpLeadForm #yesBannerForm, .popUpLeadForm #noBannerForm').click(function (e) {
        if (!$(this).hasClass('valid')) {
            $(this).addClass('valid');
            $(this).siblings().removeClass('valid');
        }
    })
    // checkbox
    $('.popUpLeadForm #ulip-agree-checkbox').on('change', function () {
        var $this = $(this);
        var $errorTxt = $this.siblings('.error-txt');
        var $sumitBtn = $this.closest('form').find('#submitResult');
        var $otpSumitBtn = $this.closest('form').find('[data-id="sendOtp"]');
        if ($this.is(':checked')) {
            $this.addClass('valid');
            $errorTxt.addClass('dsp-n');
            $sumitBtn.removeAttr('disabled');
            $otpSumitBtn.removeAttr('disabled');
        }
        else {
            $this.removeClass('valid');
            $errorTxt.removeClass('dsp-n');
            $sumitBtn.attr('disabled', 'true');
            $otpSumitBtn.attr('disabled', 'true');
        }
    })

    /* BTN EVENT TO TRIGGER THE LEAD GENERATION API N THE SEND OTP API */
    $('.popUpLeadForm [data-id = "sendOtp"], .popUpLeadForm [data-id = "resendOtp"]').on('click', function (e) {
        e.preventDefault();
        var $this = $(this);
        popUpFormLead_thisParent = $this.closest(".newForm");
        var form = popUpFormLead_thisParent.find("form");
        var dob = form.find('#dateBirth').val();
        var yyyy_mm_dd = dob.split('/').reverse().join('-');
        popUpLeadValidateDOB(yyyy_mm_dd); //trigger the validate function to get the appropriate error message
        var dobFormGroup = form.find("#dateBirth").closest('.form-field');
        var isDobValid = dobFormGroup.hasClass('valid');
        var isValid = isFormValid(form) && isDobValid;
        if (!isValid) {
            return scrollToError(e, $this, 200);
        }
        var productCode = form.find('#ulipProductCode').val().trim();
        var name = form.find("#fnameBannerForm").val().trim();
        var splittedName = splitName(name);
        var fname = splittedName.fname;
        var lname = splittedName.lname;
        var formattedDate = dayjs(yyyy_mm_dd).format('DD-MMM-YYYY');
        var gender = form.find('#ulipMaleBannerForm').hasClass('valid') ? 'GEN_M' : 'GEN_F';
        var isNriChecked = form.find('#yes_nriBannerForm').hasClass('valid');
        var isNri = isNriChecked ? 'Y' : 'N';
        if (form.find('#yesBannerForm').length > 0) {
            var isSmokerChecked = form.find('#yesBannerForm').hasClass('valid');
            var isSmoker = isSmokerChecked ? 'Y' : 'N';
        }
        var tebt = isNriChecked ? true : false;
        popUpFormLead_tbtkey = isNriChecked ? true : false;
        var annualIncome = form.find('#annualIncome').find(':selected').val();
        var countryPhoneCode = form.find('#code').val().trim();
        var localPhone = form.find('.mobileNo10').val().trim();
        var isdPhone = form.find('.mobileNo14').val().trim();
        var phone = isNriChecked ? isdPhone : localPhone;
        var email = form.find('#email').val().trim();
        var investingFor = form.find('#investingFor').find(':selected').val() ?? "";
        var ndnc = true;
        var reqObj = {
            first_name: fname,
            last_name: lname,
            country_phone_code: countryPhoneCode,
            phone: phone,
            email: email,
            gender: gender,
            dob: formattedDate,
            is_nri: isNri,
            product_code: productCode,
            send_lead_to_tebt: tebt,
            ndnc_flag: ndnc,
            lead_relationship: investingFor,
            // is_smoker: isSmoker,
            annual_income: annualIncome
        }

        if (form.find('#yesBannerForm').length > 0) {
            reqObj["is_smoker"] = isSmoker
        }

        popUpFormLead_reqObjForOtp = {
            otp_type: "LEAD_CREATION",
            unique_param: countryPhoneCode + phone,
            phone: phone,
            email: email,
            first_name: fname,
            last_name: lname,
            country_code: countryPhoneCode,
        };

        var requestHeaders = ulipHeaderRequest(form.find('#ulipOpsUrl').val().trim())
        var browserUrl = new URL(window.location);
        var browserUrlParams = sanitize(new URLSearchParams(browserUrl.search.slice(1)));
        popUpFormLead_urlSearchParamsData = sanitize(new URLSearchParams(browserUrl.search.slice(1)));
        var redirectHeaders = sanitize(browserUrlParams.toString());
        popUpFormLead_redirectHeaders = sanitize(browserUrlParams.toString());
        sendPopUpLeadFormLite(reqObj, requestHeaders, redirectHeaders);
    })

    /* BTN EVENT TO TRIGGER THE VERIFY OTP API */
    $('.popUpLeadForm [data-id = "verifyOtp"]').on('click', function (e) {
        e.preventDefault();
        popUpFormLead_thisParent = $(this).closest('.popUpLeadForm')
        popUpFormLead_tbtkey = popUpFormLead_thisParent.find('[data-id = "nriyes"]').is(':checked')
        verifyPhone = popUpFormLead_thisParent.find('.mobileNo14').val().trim() || popUpFormLead_thisParent.find('.mobileNo10').val().trim();
        var countryCode = popUpFormLead_thisParent.find('#code').val().trim().replace('+', '')
        // FETCHING OTP FROM ALL THE OTP FIELDS AND CONCAT IT
        var otp = ''
        popUpFormLead_thisParent.find('.otp-input input').each(function () {
            otp += $(this).val().toString()
        })
        // CREATING THE REQUEST OBJECT
        var reqObjVerifyOtp = {
            otp: otp,
            otp_type: "LEAD_CREATION",
            unique_param: countryCode + verifyPhone,
            lead_id: popUpFormLead_thisParent.find('[data-id = "verifyOtp"]').data().leadId,
        };

        // TRIGGER THE VERIFY OTP API
        if (otp.length == 6) {
            // popUpFormLead_thisParent.find(".rdmore").css("display", "block");
            verifyOtpReqUlip(reqObjVerifyOtp, popUpFormLead_urlSearchParamsData, popUpFormLead_redirectHeaders, popUpFormLead_thisParent)
        } else {
            popUpFormLead_thisParent.find('.error-red').addClass('dsp-n')
            popUpFormLead_thisParent.find('[data-id = "incompleteOtpMsg"]').removeClass('dsp-n')
            popUpFormLead_thisParent.find('.otp-input input').addClass('border-red')
            popUpFormLead_thisParent.find('[data-id = "successMsg"]').addClass('dsp-n')
            popUpFormLead_thisParent.find('[data-id = "failureMsg"]').removeClass('dsp-n')
        }
    })

    // BTN EVENT FOR BACK BUTTON
    $('.popUpLeadForm #backBtn').on('click', function (e) {
        popUpFormLead_thisParent = $(this).closest('.popUpLeadForm')
        // SHOW THE FORM AND HIDE THE OTP SCREEN 
        popUpFormLead_thisParent.find('.otp-screen-container').addClass('dsp-n')
        popUpFormLead_thisParent.find('.form-holder').removeClass('dsp-n')
    })

    window.addEventListener('pageshow', function (e) {
        if (localStorage.getItem("backFromOPS")) {
            localStorage.removeItem("backFromOPS");
            window.location.reload(true);
        }
    });
});

// otp input
$(document).ready(function () {
    $(".otp-input input").on("keyup", function (event) {
        if (event.key === "Backspace" && this.value.length === 0) {
            $(this).prev().trigger("focus");
        } else if (event.key == 'ArrowLeft') {
            $(this).prev().trigger("focus");
        } else if (event.key == 'ArrowRight') {
            $(this).next().trigger("focus");
        } else if (event.key !== "Backspace" && this.value.length === this.maxLength) {
            $(this).next().trigger("focus");
        }
    });

    // TO PREVENT FROM INPUTING ALPHABETS
    $(".otp-input input").on("input", function (event) {
        this.value = this.value.replace(/[^0-9]/g, "");
    });

    // TO PREVENT THE BACKSPACE GLITCH
    $('.otp-input input').on('click', function (e) {
        $(this)[0].setSelectionRange($(this).val().length, $(this).val().length)
    })

    $('.otp-input input').on('focus', function (e) {
        $(this)[0].setSelectionRange($(this).val().length, $(this).val().length)
    })
});


///////disclaimer
$('.popUpLeadForm .dropDown').on('click', function () {
    $(this).toggleClass('rotate-180');
    if ($('label[for="ulip-agree-checkbox"]').hasClass('active__Label')) {
        $('label[for="ulip-agree-checkbox"]').removeClass('active__Label')
    }
    else {
        $('label[for="ulip-agree-checkbox"]').addClass('active__Label')
    }
})
function renderLiteSuccessMessageUlipForm(res, redirectHeaders) {
    formSubmissionSuccess('subscribe-data-layer');

    var ocp = res.responseJson.response.ocp_url;

    var directUrl = ocp + '&' + redirectHeaders;
    window.location.href = directUrl;
}
// $('#fnameBannerForm').val('hello world ');
// $('#dateBirth').val('11/11/2001');
// $('#indianMobile').val('9817141417');
// $('#email').val('hello@gmail.com');
const closeIcon = document.getElementById("modalCloseIcon");
const modalContainer = document.querySelector(".popUpLeadForm .newForm");
closeIcon.addEventListener("click", function (e) {
    e.preventDefault();
    var modalId = $(this).closest(".modal.fade").attr("id");
    $(`#${modalId}`).modal('hide');
});

$( document ).ready(function() {
    // Jquery element
    var $tabContainer = $('.scrollabletabsv2 .tabs-container');
    
    var width = $tabContainer.width();
    var scrollWidth = $tabContainer[0].scrollWidth;
    if (scrollWidth > width){
        $tabContainer.addClass('pb-15');
    }
});
var contentWrapperTop = $('.scrollcontentWrapper').offset().top;
var $tabs = $(".scrolltabs li a");
var $nextButton = $(".scrollableTabsNext");
var $prevButton = $(".scrollableTabsPrevious");

$prevButton.hide();

function removeActiveClasses() {
    $tabs.removeClass("active");
};

function addActiveClass(tab) {
    $(tab).addClass("active");
    $(tab).get(0).scrollIntoView({ inline: "nearest" }); 
    // $(tab).get(0).scrollIntoView({ behavior: "smooth", inline: "nearest" });
};

function scrollToSection(section) {
    var offsetTop = $(section).offset().top - 160;
    $("html, body").animate({
        scrollTop: offsetTop
    }, 500);
};

function scrollToTab($tab) {
    var position = $tab.position();
    var scroll = $('.scrolltabs').scrollLeft();
    $('.scrolltabs').animate({
        'scrollLeft': scroll + position.left - 30
    }, 200);
};

function toggleButton(tab) {
    if ($(tab).parents('li').is(':last-child')) {
        $nextButton.hide();
    } else {
        $nextButton.show();
    }

    if ($(tab).parents('li').is(':first-child')) {
        $prevButton.hide();
    } else {
        $prevButton.show();
    }
}

function currentSectionId() {
    var current = "";
    $tabs.each(function () {
        var sectionId = $(this).attr("href")
        if ($(sectionId).length === 1) {
            var sectionTop = $(sectionId).offset().top - 200;
            var sectionHeight = $(this).outerHeight();
            if ($(window).scrollTop() >= sectionTop) {
                current = sectionId;
            }
        }
    });
    return current;
}
// show scroll tab on scroll
$(window).scroll(function () {
    var currentScroll = $(this).scrollTop();
    var current = currentSectionId();
    if (currentScroll === 0) {
        $('.scroll-tabs').fadeOut();
        $('.scrollcontentWrapper').css({
            position: 'static',
            opacity: '0',
            display: 'none'
        });
    } else if (current) {
        $('.scroll-tabs').fadeIn();
        $('.scrollcontentWrapper').css({
            position: 'fixed',
            top: '68px',
            left: '0',
            opacity: '1',
            display: 'block'
        });
    } else {
        $('.scroll-tabs').fadeOut();
        $('.scrollcontentWrapper').css({
            position: 'static',
            opacity: '0',
            display: 'none'
        });
    }
});

// Highlight tab based on scroll position
$(window).on("scroll", function () {
    var current = currentSectionId();
    removeActiveClasses();
    if (current) {
        var activeTab = $(`.scrolltabs li a[href="${current}"]`);
        if (activeTab.length) {
            toggleButton(`.scrolltabs li a[href="${current}"]`)
            addActiveClass(`.scrolltabs li a[href="${current}"]`);
        }
    }
});

// Next functionality
$nextButton.on("click", function () {
    var currentIndex = $tabs.index($(".scrolltabs li a.active"));
    var nextIndex = (currentIndex + 1) % $tabs.length;
    $tabs.eq(nextIndex).click();
    scrollToTab($tabs.eq(nextIndex));
});

// Previous functionality
$prevButton.on("click", function () {
    var currentIndex = $tabs.index($(".scrolltabs li a.active"));
    var prevIndex = (currentIndex - 1 + $tabs.length) % $tabs.length;
    $tabs.eq(prevIndex).click();
    scrollToTab($tabs.eq(prevIndex));
});

// Add click event listener to each tab
$tabs.each(function (index) {
    $(this).on("click", function () {
        toggleButton(this)
        removeActiveClasses();
        addActiveClass(this);
        scrollToSection($(this).attr("href"));
    });
});
var stickyContainer = document.querySelector(".termStickyButton .sticky__container")
window.addEventListener("scroll", function() {
    if (window.scrollY > 500) {
        stickyContainer.style.display = "grid";
    } else {
        stickyContainer.style.display = "none";
    }
});

$(document).ready(function(){


    function createIframe($iframeWrapper){
        var targetVideo = $iframeWrapper.data('video');
        var targetId = $iframeWrapper.attr('id');
        var allIframeAttributes = {
            'id': `iframe-${targetId}`,
            'src' : targetVideo,
            'allowfullscreen' : true,
            'allowscriptaccess' : 'always',
            'frameborder' : '0',
            'allow' : 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'
        }
        // create the iframe element
        var iframe = document.createElement('iframe')
        // set all the necessary attributes to the iframe
        for(var key in allIframeAttributes){
            iframe.setAttribute(key, allIframeAttributes[key])
        }
        return iframe;
    }
    
    function injectIframe($iframeWrapper){
        var iframe = createIframe($iframeWrapper);
        var youtubeIcon = $iframeWrapper.find('.youtube_icon');
        youtubeIcon.replaceWith(iframe);
    }
    
    $('.whatistiYoutube .iframe-wrapper').on('click',function(){
        var elements = document.getElementsByClassName("image-replace");
        Array.from(elements).forEach(function(ele) {
            ele.style.display = "none";
        });
               
        $this = $(this);
        injectIframe($this);
        // create video player
        var targetIframeId = $this.find('iframe').attr('id');
        new YT.Player(targetIframeId,{
            events:{
                'onReady' : onPlayerReady
            }
        });
        // unbinding click event to avoid injecting multiple iframes
        $this.off('click')
    });

    var cardContentViews = document.querySelectorAll('.whatistiYoutube .content-view');

for (var i = 0; i < cardContentViews.length; i++) {
  var contentView = cardContentViews[i];
  var descriptionHeight = contentView.offsetHeight;

  if (descriptionHeight > 40) {
    contentView.classList.add("overflowContent");
    if (contentView.nextElementSibling) {
      contentView.nextElementSibling.classList.add("showButton");
    }
  }
}
        
});

    

var cardContentViewLabels = document.querySelectorAll('.whatistiYoutube .content-view-label');

cardContentViewLabels.forEach(function(label) {
  label.addEventListener('click', function() {
    var contentView = this.closest('.whatistiYoutubeContentWrapper').querySelector('.whatistiYoutubeContent');
    if (contentView) {
      contentView.classList.toggle('slideDetails');
    }

    var currentText = this.textContent;
    if (currentText.indexOf('More') !== -1) {
      this.textContent = '...Show Less';
    } else {
      setTimeout(() => {
      this.textContent = '...Read More';
    }, 500)
    }
  });
});

document.addEventListener("DOMContentLoaded", function() {
    const newTermAccordionisMobile = window.matchMedia("(max-width: 768px)").matches;
    const newTermAccordionHeader = document.querySelectorAll('.newTermAccordion .accordion-header');

        newTermAccordionHeader.forEach(function(title) {
            title.addEventListener('click', function () {
                if (newTermAccordionisMobile) {
                    if (this.closest(".accordion-item").classList.contains('active')) {
                        this.closest(".accordion-item").classList.remove('active');
                    } else {
                        this.closest(".accordion-item").classList.add('active');
                    }
                }
            });
        });
});

// star rating
(function(_global) {
    var pageViewApiObjv2 = (function(){
        var pageViewApiList = {};
        function getDownloadSectionPageRating(requestObject) {
            return new Promise(function(resolve, reject) {
                apiUtility.GET_CAT_PAGE_RATING(requestObject).then(function(res){
                    resolve(res);
                }).catch(function(err) {
                    reject(err);
                })
            })
        }
        pageViewApiList.getDownloadSectionPageRating = getDownloadSectionPageRating;
        return jsHelper.freezeObject(pageViewApiList);
    })();
    _global.jsHelper.defineReadOnlyObjProp(_global, 'pageViewApiObjv2', pageViewApiObjv2);

})(window || document || {});

// view count
// (function(_global) {
//     var pageViewCountApiObj = (function(){
//         var pageViewApiList = {};
//         function getDownloadSectionViewCount(requestObject) {
//             return new Promise(function(resolve, reject) {
//                 apiUtility.VIEW_COUNT(requestObject).then(function(res){
//                     resolve(res);
//                 }).catch(function(err) {
//                     reject(err);
//                 })
//             })
//         }
//         pageViewApiList.getDownloadSectionViewCount = getDownloadSectionViewCount;
//         return jsHelper.freezeObject(pageViewApiList);
//     })();
//     _global.jsHelper.defineReadOnlyObjProp(_global, 'pageViewCountApiObj', pageViewCountApiObj);

// })(window || document || {});
var catSlugWrapper = document.querySelectorAll(".termCardCore .catSlugInput");
var starRatingWrap = document.querySelectorAll(".termCardCore .star-rating");
var catSlugObjStar = {};
var catSlugObjView = {};
var promises = [];
var reqObjCore = {
    "host": "www.hdfclife.com"
};

if (catSlugWrapper.length != 0) {
    catSlugWrapper.forEach(function (element) {
        var categoriesCompo = element.querySelector("input[name='categoriesCompo']").value;
        var pageslugCompo = element.querySelector("input[name='pageslugCompo']").value;

        if (catSlugObjStar[categoriesCompo]) {
            catSlugObjStar[categoriesCompo][pageslugCompo] = 0
            catSlugObjView[categoriesCompo][pageslugCompo] = 0
        } else {
            catSlugObjStar[categoriesCompo] = {
                [pageslugCompo]: 0
            }
            catSlugObjView[categoriesCompo] = {
                [pageslugCompo]: 0
            }
        }
    });
}


for (const key in catSlugObjStar) {
    reqObjCore["categories"] = JSON.stringify([key]);
    reqObjCore["slugs"] = JSON.stringify(Object.keys(catSlugObjStar[key]));
    promises.push(starRatingApiCall(reqObjCore));
    // promises.push(viewCountApiCall(reqObjCore));
}

function starRatingApiCall(reqObj) {
    return pageViewApiObjv2.getDownloadSectionPageRating(reqObj).then(function (res) {
        var ratingRes = res.responseJson.ratings;
        var category = res.responseJson.categories[0];
        for (const key in ratingRes) {
            catSlugObjStar[category][key] = ratingRes[key]
        }
    }).catch(function (err) {
        console.log('err: ', err);
    })
}

// function viewCountApiCall(reqObj) {
//     return pageViewCountApiObj.getDownloadSectionViewCount(reqObj).then(function (res) {
//         var ratingRes = res.responseJson.view_count;
//         var category = res.responseJson.categories[0];
//         for (const key in ratingRes) {
//             catSlugObjView[category][key] = ratingRes[key]
//         }
//     }).catch(function (err) {
//         console.log('err: ', err);
//     })
// }

Promise.allSettled(promises)
    .then(function() {
        starRatingWrap.forEach(function (element) {
            var slugCategory = element.previousElementSibling;
            var category = slugCategory.querySelector("input[name='categoriesCompo']").value;
            var slug = slugCategory.querySelector("input[name='pageslugCompo']").value;
            // renderViewRating(element, catSlugObjStar[category][slug], catSlugObjView[category][slug])
            renderViewRating(element, catSlugObjStar[category][slug])
        });
    }).catch(function(err) {
        console.error('Error processing API calls: ', err);
    });
function renderViewRating(element, rating, view) {
    if(rating == 0) {
        // if (view !== "0") {
        //     element.innerHTML = `
        //         <p class="view">${view}</p>
        //     `
        // }
    } else {
        element.innerHTML = `
            <p class="star">${rating}</p>
            <img src="/content/dam/hdfclifeinsurancecompany/icons/star-filled.svg" alt="star">
        `;
        // if (view !== "0") {
        //     element.innerHTML += `
        //         <p>|</p>
        //         <p class="view">${view}</p>
        //     `
        // }
    }
}
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).dayjs=e()}(this,(function(){"use strict";var t=1e3,e=6e4,n=36e5,r="millisecond",i="second",s="minute",u="hour",a="day",o="week",f="month",h="quarter",c="year",d="date",l="Invalid Date",$=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,M={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],n=t%100;return"["+t+(e[(n-20)%10]||e[n]||e[0])+"]"}},m=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},v={s:m,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return(e<=0?"+":"-")+m(r,2,"0")+":"+m(i,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),i=e.clone().add(r,f),s=n-i<0,u=e.clone().add(r+(s?-1:1),f);return+(-(r+(n-i)/(s?i-u:u-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:f,y:c,w:o,d:a,D:d,h:u,m:s,s:i,ms:r,Q:h}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},g="en",D={};D[g]=M;var p=function(t){return t instanceof _},S=function t(e,n,r){var i;if(!e)return g;if("string"==typeof e){var s=e.toLowerCase();D[s]&&(i=s),n&&(D[s]=n,i=s);var u=e.split("-");if(!i&&u.length>1)return t(u[0])}else{var a=e.name;D[a]=e,i=a}return!r&&i&&(g=i),i||!r&&g},w=function(t,e){if(p(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new _(n)},O=v;O.l=S,O.i=p,O.w=function(t,e){return w(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var _=function(){function M(t){this.$L=S(t.locale,null,!0),this.parse(t)}var m=M.prototype;return m.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(O.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match($);if(r){var i=r[2]-1||0,s=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},m.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},m.$utils=function(){return O},m.isValid=function(){return!(this.$d.toString()===l)},m.isSame=function(t,e){var n=w(t);return this.startOf(e)<=n&&n<=this.endOf(e)},m.isAfter=function(t,e){return w(t)<this.startOf(e)},m.isBefore=function(t,e){return this.endOf(e)<w(t)},m.$g=function(t,e,n){return O.u(t)?this[e]:this.set(n,t)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(t,e){var n=this,r=!!O.u(e)||e,h=O.p(t),l=function(t,e){var i=O.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?i:i.endOf(a)},$=function(t,e){return O.w(n.toDate()[t].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},y=this.$W,M=this.$M,m=this.$D,v="set"+(this.$u?"UTC":"");switch(h){case c:return r?l(1,0):l(31,11);case f:return r?l(1,M):l(0,M+1);case o:var g=this.$locale().weekStart||0,D=(y<g?y+7:y)-g;return l(r?m-D:m+(6-D),M);case a:case d:return $(v+"Hours",0);case u:return $(v+"Minutes",1);case s:return $(v+"Seconds",2);case i:return $(v+"Milliseconds",3);default:return this.clone()}},m.endOf=function(t){return this.startOf(t,!1)},m.$set=function(t,e){var n,o=O.p(t),h="set"+(this.$u?"UTC":""),l=(n={},n[a]=h+"Date",n[d]=h+"Date",n[f]=h+"Month",n[c]=h+"FullYear",n[u]=h+"Hours",n[s]=h+"Minutes",n[i]=h+"Seconds",n[r]=h+"Milliseconds",n)[o],$=o===a?this.$D+(e-this.$W):e;if(o===f||o===c){var y=this.clone().set(d,1);y.$d[l]($),y.init(),this.$d=y.set(d,Math.min(this.$D,y.daysInMonth())).$d}else l&&this.$d[l]($);return this.init(),this},m.set=function(t,e){return this.clone().$set(t,e)},m.get=function(t){return this[O.p(t)]()},m.add=function(r,h){var d,l=this;r=Number(r);var $=O.p(h),y=function(t){var e=w(l);return O.w(e.date(e.date()+Math.round(t*r)),l)};if($===f)return this.set(f,this.$M+r);if($===c)return this.set(c,this.$y+r);if($===a)return y(1);if($===o)return y(7);var M=(d={},d[s]=e,d[u]=n,d[i]=t,d)[$]||1,m=this.$d.getTime()+r*M;return O.w(m,this)},m.subtract=function(t,e){return this.add(-1*t,e)},m.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||l;var r=t||"YYYY-MM-DDTHH:mm:ssZ",i=O.z(this),s=this.$H,u=this.$m,a=this.$M,o=n.weekdays,f=n.months,h=function(t,n,i,s){return t&&(t[n]||t(e,r))||i[n].slice(0,s)},c=function(t){return O.s(s%12||12,t,"0")},d=n.meridiem||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r},$={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:O.s(a+1,2,"0"),MMM:h(n.monthsShort,a,f,3),MMMM:h(f,a),D:this.$D,DD:O.s(this.$D,2,"0"),d:String(this.$W),dd:h(n.weekdaysMin,this.$W,o,2),ddd:h(n.weekdaysShort,this.$W,o,3),dddd:o[this.$W],H:String(s),HH:O.s(s,2,"0"),h:c(1),hh:c(2),a:d(s,u,!0),A:d(s,u,!1),m:String(u),mm:O.s(u,2,"0"),s:String(this.$s),ss:O.s(this.$s,2,"0"),SSS:O.s(this.$ms,3,"0"),Z:i};return r.replace(y,(function(t,e){return e||$[t]||i.replace(":","")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(r,d,l){var $,y=O.p(d),M=w(r),m=(M.utcOffset()-this.utcOffset())*e,v=this-M,g=O.m(this,M);return g=($={},$[c]=g/12,$[f]=g,$[h]=g/3,$[o]=(v-m)/6048e5,$[a]=(v-m)/864e5,$[u]=v/n,$[s]=v/e,$[i]=v/t,$)[y]||v,l?g:O.a(g)},m.daysInMonth=function(){return this.endOf(f).$D},m.$locale=function(){return D[this.$L]},m.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=S(t,e,!0);return r&&(n.$L=r),n},m.clone=function(){return O.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},M}(),T=_.prototype;return w.prototype=T,[["$ms",r],["$s",i],["$m",s],["$H",u],["$W",a],["$M",f],["$y",c],["$D",d]].forEach((function(t){T[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),w.extend=function(t,e){return t.$i||(t(e,_,w),t.$i=!0),w},w.locale=S,w.isDayjs=p,w.unix=function(t){return w(1e3*t)},w.en=D[g],w.Ls=D,w.p={},w}));

// **************DAYJS DEPENDENCIES*************//

//LOCALEDATA.JS START//
!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(n="undefined"!=typeof globalThis?globalThis:n||self).dayjs_plugin_localeData=e()}(this,function(){"use strict";return function(n,e,t){function r(n,e,t,r,o){var n=n.name?n:n.$locale(),e=i(n[e]),t=i(n[t]),u=e||t.map(function(n){return n.substr(0,r)});if(!o)return u;var a=n.weekStart;return u.map(function(n,e){return u[(e+(a||0))%7]})}function o(){return t.Ls[t.locale()]}function u(n,e){return n.formats[e]||n.formats[e.toUpperCase()].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(n,e,t){return e||t.slice(1)})}var e=e.prototype,i=function(n){return n&&(n.indexOf?n:n.s)};e.localeData=function(){return function(){var e=this;return{months:function(n){return n?n.format("MMMM"):r(e,"months")},monthsShort:function(n){return n?n.format("MMM"):r(e,"monthsShort","months",3)},firstDayOfWeek:function(){return e.$locale().weekStart||0},weekdays:function(n){return n?n.format("dddd"):r(e,"weekdays")},weekdaysMin:function(n){return n?n.format("dd"):r(e,"weekdaysMin","weekdays",2)},weekdaysShort:function(n){return n?n.format("ddd"):r(e,"weekdaysShort","weekdays",3)},longDateFormat:function(n){return u(e.$locale(),n)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}}.bind(this)()},t.localeData=function(){var e=o();return{firstDayOfWeek:function(){return e.weekStart||0},weekdays:function(){return t.weekdays()},weekdaysShort:function(){return t.weekdaysShort()},weekdaysMin:function(){return t.weekdaysMin()},months:function(){return t.months()},monthsShort:function(){return t.monthsShort()},longDateFormat:function(n){return u(e,n)},meridiem:e.meridiem,ordinal:e.ordinal}},t.months=function(){return r(o(),"months")},t.monthsShort=function(){return r(o(),"monthsShort","months",3)},t.weekdays=function(n){return r(o(),"weekdays",null,null,n)},t.weekdaysShort=function(n){return r(o(),"weekdaysShort","weekdays",3,n)},t.weekdaysMin=function(n){return r(o(),"weekdaysMin","weekdays",2,n)}}});
//LOCALEDATA.JS END//

//LOCALIZEDFORMAT.JS START//
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).dayjs_plugin_localizedFormat=t()}(this,function(){"use strict";var i={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(e,t,o){var t=t.prototype,n=t.format;o.en.formats=i,t.format=function(e){void 0===e&&(e="YYYY-MM-DDTHH:mm:ssZ");var r,t=this.$locale().formats,e=(r=void 0===t?{}:t,e.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(e,t,o){var n=o&&o.toUpperCase();return t||r[o]||i[o]||r[n].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(e,t,o){return t||o.slice(1)})}));return n.call(this,e)}}});
//LOCALIZEDFORMAT.JS END//

//ISOWEEK.JS START//
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).dayjs_plugin_isoWeek=t()}(this,function(){"use strict";var n="day";return function(e,t,s){function a(e){return e.add(4-e.isoWeekday(),n)}t=t.prototype;t.isoWeekYear=function(){return a(this).year()},t.isoWeek=function(e){if(!this.$utils().u(e))return this.add(7*(e-this.isoWeek()),n);var t=a(this),i=(i=this.isoWeekYear(),i=4-(e=(this.$u?s.utc:s)().year(i).startOf("year")).isoWeekday(),4<e.isoWeekday()&&(i+=7),e.add(i,n));return t.diff(i,"week")+1},t.isoWeekday=function(e){return this.$utils().u(e)?this.day()||7:this.day(this.day()%7?e:e-7)};var d=t.startOf;t.startOf=function(e,t){var i=this.$utils(),s=!!i.u(t)||t;return"isoweek"===i.p(e)?s?this.date(this.date()-(this.isoWeekday()-1)).startOf("day"):this.date(this.date()-1-(this.isoWeekday()-1)+7).endOf("day"):d.bind(this)(e,t)}}});
//ISOWEEK.JS END//

//WEEKDAY.JS START//
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).dayjs_plugin_weekday=t()}(this,function(){"use strict";return function(e,t){t.prototype.weekday=function(e){var t=this.$locale().weekStart||0,i=this.$W,t=(i<t?i+7:i)-t;return this.$utils().u(e)?t:this.subtract(t,"day").add(e,"day")}}});
//WEEKDAY.JS END//

//ARRAYSUPPORT.JS START//
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).dayjs_plugin_arraySupport=t()}(this,function(){"use strict";return function(e,t,n){var t=t.prototype,o=t.parse;t.parse=function(e){e.date=function(e){var t=e.date,e=e.utc;return Array.isArray(t)?e?t.length?new Date(Date.UTC.apply(null,t)):new Date:1===t.length?n(String(t[0])).toDate():new(Function.prototype.bind.apply(Date,[null].concat(t))):t}.bind(this)(e),o.bind(this)(e)}}});
//ARRAYSUPPORT.JS END//

//BADMUTABLE.JS START//
!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t="undefined"!=typeof globalThis?globalThis:t||self).dayjs_plugin_badMutable=i()}(this,function(){"use strict";return function(t,i){i=i.prototype;i.$g=function(t,i,n){return this.$utils().u(t)?this[i]:this.$set(n,t)},i.set=function(t,i){return this.$set(t,i)};var n=i.startOf;i.startOf=function(t,i){return this.$d=n.bind(this)(t,i).toDate(),this.init(),this};var e=i.add;i.add=function(t,i){return this.$d=e.bind(this)(t,i).toDate(),this.init(),this};var s=i.locale;i.locale=function(t,i){return t?(this.$L=s.bind(this)(t,i).$L,this):this.$L};var o=i.daysInMonth;i.daysInMonth=function(){return o.bind(this.clone())()};var r=i.isSame;i.isSame=function(t,i){return r.bind(this.clone())(t,i)};var u=i.isBefore;i.isBefore=function(t,i){return u.bind(this.clone())(t,i)};var f=i.isAfter;i.isAfter=function(t,i){return f.bind(this.clone())(t,i)}}});
//BADMUTABLE.JS END//

//WEEKOFYEAR.JS START//
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).dayjs_plugin_weekOfYear=t()}(this,function(){"use strict";var f="week",s="year";return function(e,t,n){t=t.prototype;t.week=function(e){if(null!==(e=void 0===e?null:e))return this.add(7*(e-this.week()),"day");var t=this.$locale().yearStart||1;if(11===this.month()&&25<this.date()){var i=n(this).startOf(s).add(1,s).date(t),e=n(this).endOf(f);if(i.isBefore(e))return 1}t=n(this).startOf(s).date(t).startOf(f).subtract(1,"millisecond"),t=this.diff(t,f,!0);return t<0?n(this).startOf("week").week():Math.ceil(t)},t.weeks=function(e){return this.week(e=void 0===e?null:e)}}});
//WEEKOFYEAR.JS END//


dayjs.extend(window.dayjs_plugin_localeData);
dayjs.extend(window.dayjs_plugin_localizedFormat);
dayjs.extend(window.dayjs_plugin_isoWeek);
dayjs.extend(window.dayjs_plugin_arraySupport);
dayjs.extend(window.dayjs_plugin_badMutable);
var isMobileDevice = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

//INITIALIZING DATERANGEPICKER TO THE DATEOFBIRTH FIELD
$(function () {
  var today = new Date();
  var currentFormat = "DD-MM-YYYY";
  $('input[name="birthday-cod"]').daterangepicker(
    {
      autoUpdateInput: false,
      singleDatePicker: true,
      showDropdowns: true,
      startDate: "1985-01-01",
      minYear: 1950,
      minDate: "1950-01-01",
      maxDate: dayjs().format("YYYY-MM-DD"),
      maxYear: today.getFullYear(),
      locale: {
        format: "YYYY-MM-DD",
        separator: " - ",
      },
    },
    function (start, end, label) {
      // CALLBACK TO FORMAT THE SELECTED DATE
      var formattedDate = start.format(currentFormat);
      $('input[name="birthday-cod"]').val(formattedDate);
      // FUNCTION FOR VALIDATION
      ValidateDOB(formattedDate);
    }
  );
});

//CHECKING LIFECOVER AMOUNT ON INPUT TO ALLOW ONLY NUMBERS
(function ($, window, document) {
  $("#lifeCover").on("input", function (event) {
    var lifeCoverTextField = event.target;
    var regex = new RegExp(/[^0-9]/);
    var value = lifeCoverTextField.value.replaceAll(",", "");
    if (value.match(regex)) {
      lifeCoverTextField.value = "";
      return false;
    }
  });
})(window.jQuery, window, document);
//////////////////////////////////////////////////

(function ($, window, document) {
  // $('.getCalculated').click(function() {
  //     $('.calculate-bottom-section').slideDown();
  //     $('html, body').animate({
  //         //scrollTop: $(".calculate-bottom-section").offset().top
  //         scrollTop: $(".calculate-bottom-section").offset().top - ($('.headerWrap').height() + 20)
  //     }, 300);
  // });

  function n(e) {
    // return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    return Number(e).toLocaleString("en-IN");
  }

  try {
    if (isMobileDevice) {
      $(".contentGridBlock").owlCarousel({
        items: 1,
        navContainer: "#gridCarouselNav",
        dotsContainer: "#gridCarouselDot",
        margin: 10,
      });
    }
  } catch (owlError) {
    console.log("Error in owl caraosel " + owlError);
  }

  //Category Accordian
  $(document).on("change", ".range-slider-input", function () {
    var e = $(this),
      t = e.val();
    i = n((t = t.replace(/\D/g, "")));
    // console.log(i,'i',t,'t');
    e.val($("<div/>").html(i).text()),
      e.closest(".slider-parent").find(".range-slider").val(t).change();
  });
})(window.jQuery, window, document);


(function (_global) {

    // $.ajax({
    //     type: "GET",
    //     url: "https://api.hdfclife.com/api/calculator/get-c2pl-premium-range/?gender=GEN_M&is_smoker=n&sum_assured=7500000&term=10&ppt=8&ppt_option=Limited&plan_option=life%20protect&age=24&frequency=annual",
    //     // data: "text",
    //     dataType: "json",
    //     success: function (response) {
    //         console.log(response,'response');
    //     }
    // });

    var c2plCalcObj = (function () {
      var c2plCalcApi = {};
      /***************** Fund Performance NAV product list **************/
      function c2plCalcDetails(c2plObj) {
        return new Promise(function (resolve, reject) {
          apiUtility.C2PL_CALCULATOR(c2plObj).then(function (res) {
            resolve(res);
          }).catch(function (err) {
            reject(err);
          })
        })
      }

  
      c2plCalcApi.c2plCalcDetails = c2plCalcDetails;
  
      return jsHelper.freezeObject(c2plCalcApi);
    })();
    _global.jsHelper.defineReadOnlyObjProp(_global, 'c2plCalcObj', c2plCalcObj);
  
  })(window || document || {})
  
var tobacco, gender, sumAssured, dateSelected, age;
var isMakeBoxPresent;
$(function () {
  $("#calculateResult").click(function (e) {
    e.preventDefault();
    var form = $(".codCalcForm");
    var isValid = isFormValid(form);
    var reqObj = {
      gender: gender,
      is_smoker: tobacco,
      sum_assured: sumAssured,
      dob: dateSelected,
    };

    if (isValid) {
      if (isMakeBoxPresent) {
        $(".calculateBMISec").parent().removeClass("makebox");
        // $("#rdmore").css("top", $(".calculateBMISec").offset().top - 139 + "px");
      }
      // $(".mainPageSec").css("height", window.innerHeight + 20 + "px");
      // $("#rdmore").css("height", window.innerHeight + "px");
      // $(".calculateBMISec").css("display", "none");
      $("#rdmore").css("display", "block");
      document.getElementById("rdmore").scrollIntoView();
      getC2plValues(reqObj);
    }
  });
});

$(document).ready(function () {
  isMakeBoxPresent = $(".calculateBMISec").parent().hasClass("makebox");
  dateSelected = $("#scdate").val(); //DOB onload value
  age = dayjs().diff(dateSelected, "years");
  dateSelected = dayjs(dateSelected, "DD-MM-YYYY").format("DD-MMM-YYYY");
  // console.log(dateSelected,'dateSelected');
  sumAssured = $("#lifeCover").val().replaceAll(",", ""); //sum assured onload value
  gender = $("input[name='gender']:checked").val();
  tobacco = $("input[name='tobacco']:checked").val();
  // DOB changed
  $('input[name="birthday-cod"]').on(
    "apply.daterangepicker",
    function (ev, picker) {
      dateSelected = picker.startDate.format("DD-MMM-YYYY");
      var years = dayjs().diff(picker.startDate, "years");
      age = dayjs().diff(picker.startDate, "years");
      $('input[name="birthday-cod"]').attr("data-age", years);
      $('input[name="birthday-cod"]').trigger("input");
      if (age >= 65) {
        $("#calculateResult").attr("disabled", "true");
        // $('#scdate').after(`<p class="below-65">Sorry ! We offer this product upto the age of 65 only.</p>`)
      } else if (age < 18) {
        $("#calculateResult").attr("disabled", "true");
        $("#scdate")
          .siblings(".error-txt")
          .html("Age should be between 18-65 years");
        $("#scdate").siblings(".error-txt").show();
      } else {
        $("#scdate").siblings(".error-txt").empty();
        $("#calculateResult").removeAttr("disabled");
        $("#scdate").siblings(".below-60").remove();
      }
    }
  );

  function n(e) {
    // return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    return Number(e).toLocaleString("en-IN");
  }
  function numberWithCommas(x) {
    return Number(x).toLocaleString("en-IN");
  }

  $(".lifeCover").rangeslider({
    polyfill: false,
    fillClass: "rangeslider__fill",
    rangeClass: "rangeslider",
    handleClass: "rangeslider__handle",
    onInit: function (position, value) {
      $(".lifeCover").siblings(".live-range-val").css("left", `${position}px`);
    },
    onSlideEnd: function (position, value) {
      const computedValue = n(value);
      const currency = `&#x20B9; ${computedValue}`;
      const left = $(".lifeCover")
        .closest("#range-slider-wrapper")
        .find(".rangeslider__handle")
        .css("left");
      $(".lifeCover").siblings(".live-range-val").css("left", left);
      $("#lifeCover").val($("<div/>").html(computedValue).text());
      sumAssured = value;
    },
    onSlide: function (position, value) {
      const computedValue = n(value);
      $(".lifeCover").siblings(".live-range-val").css("left", `${position}px`);
      $(".lifeCover").siblings(".live-range-val").text(computedValue);
    },
  });

  // sum assured value on input change
  $(document).on("change", ".range-slider-input", function () {
    sumAssured = $(this).val().replaceAll(",", "");
  });

  $('input[name="gender"]').on("change", function () {
    gender = $("input[name='gender']:checked").val();
  });
  $('input[name="tobacco"]').on("change", function () {
    tobacco = $("input[name='tobacco']:checked").val();
  });
});

function renderC2plCalc(result, obj) {
  if (result.statusCode == 200) {
    // console.log(result,obj,'result,obj');
    showTable();
    var data = result.responseJson.response;
    var cod = result.responseJson.response.cost_of_delay;
    // console.log(data,'result',cod);
    $("#premium-amount, #one-yr-cost,#table-body").empty();
    $("#premium-amount").html(
      `<strong><span class="rupeesSymbol">₹</span> ${cod[0].premium.toLocaleString(
        "en-IN"
      )}<sup>1</sup></strong> <small>annually</small>`
    );
    if (data.age == 64) {
      $("#one-yr-cost").html(
        `We offer this product upto the age of 60 years. So buy the policy now to avail the benefits of insurance policy.`
      );
      $(".buy-txt-birth").hide();
    } else if (data.upcoming_birthday == true) {
      $("#age-txt, #date-string, #prem-per").empty();
      $(".buy-txt-birth").show();
      $("#date-string").html(getDateString(obj.dob));
      $("#age-txt").html(data.age + 1);
      if (data.annual_saving) {
        $("#prem-per").html(data.annual_saving);
      }
    } else {
      $(".buy-txt-birth").hide();
      $("#one-yr-cost").html(
        `Buying 1 year from now will cost you <strong><span class="rupeesSymbol">₹</span>${cod[1].extra.toLocaleString(
          "en-IN"
        )}<sup>2</sup></strong> more over the policy term`
      );
    }
    $.each(cod, function (index, value) {
      $("#table-body").append(`
      <tr>
        <td>
          ${
            index == 0
              ? '<span class="highlight">At </span>present'
              : index == 1
              ? '<span class="highlight">' + index + " year </span>later"
              : '<span class="highlight">' + index + " years </span>later"
          } 
        </td>
        <td>
          <span class="rupeesSymbol">₹ </span>${value.premium.toLocaleString(
            "en-IN"
          )}
        </td>
        <td>
        ${value.term}
        </td>
        <td>
          <span class="rupeesSymbol">₹ </span>${value.total_premium.toLocaleString(
            "en-IN"
          )}
        </td>
        <td>
        ${
          value.extra <= 0
            ? "-"
            : '<span class="rupeesSymbol">₹ </span>' +
              value.extra.toLocaleString("en-IN")
        }
        </td>
      </tr>
      `);
      document.getElementById("calculateResult").scrollIntoView();
    });
  }
  return false;
}

function getDateString(dateString) {
  var today = new Date();
  var birthDate = new Date(dateString);
  var dd = String(birthDate.getDate());
  var mm = String(birthDate.getMonth());
  var months = [
    "January",
    "February",
    "March",
    "April",
    "May",
    "June",
    "July",
    "August",
    "September",
    "October",
    "November",
    "December",
  ];
  var year = today.getFullYear();
  return (today = appendText(dd) + " " + months[mm] + " " + year);
}

function appendText(num) {
  var suffix = "th";
  if (num == 0) suffix = "";
  if (num % 10 == 1 && num % 100 != 11) suffix = "st";
  if (num % 10 == 2 && num % 100 != 12) suffix = "nd";
  if (num % 10 == 3 && num % 100 != 13) suffix = "rd";
  return num + suffix;
}

function todayAndYearAgoDate(bool, num) {
  var today = new Date();
  var dd = String(today.getDate()).padStart(2, "0");
  var mm = String(today.getMonth() + 1).padStart(2, "0"); //January is 0!
  var yyyy = bool ? today.getFullYear() : String(today.getFullYear() - num);
  return (today = yyyy + "-" + mm + "-" + dd);
}

function showTable() {
  $(".calculate-bottom-section").slideDown();
  $(".calculateBMISec").css("display", "block");
  $("#rdmore").css("display", "none");
  $(".mainPageSec").css("height", "unset");
  if (isMakeBoxPresent) {
    $(".calculateBMISec").parent().addClass("makebox");
  }
  $("html, body").animate(
    {
      //scrollTop: $(".calculate-bottom-section").offset().top
      // scrollTop: $(".calculate-bottom-section").offset().top - ($('.headerWrap').height() + 20)
    },
    300
  );
}

function getC2plValues(c2plObj) {
  c2plCalcObj
    .c2plCalcDetails(c2plObj)
    .then((result) => {
      renderC2plCalc(result, c2plObj);
    })
    .catch((err) => {
      console.log(err, "c2pl error");
    });
}

//Date Picker Validation
function ValidateDOB(dateString) {
  var parts = dateString.split("-");
  var dtDOB = new Date(parts[1] + "-" + parts[0] + "-" + parts[2]);
  var dtCurrent = new Date();
  if (dtCurrent.getFullYear() - dtDOB.getFullYear() < 18) {
    $("#calculateResult").attr("disabled", "true");
    $("#scdate").siblings(".error-txt2").html("Age should be as 18-65 years");
    $("#scdate").parent().removeClass("valid");
    return false;
  } else if (dtCurrent.getFullYear() - dtDOB.getFullYear() > 65) {
    $("#calculateResult").attr("disabled", "true");
    $("#scdate")
      .siblings(".error-txt2")
      .html("Sorry ! We offer this product upto the age of 65 only.");
    $("#scdate").parent().removeClass("valid");
    return false;
  }

  //FINAL CONDITIONAL CHECKING IN CASE THE YEAR DIFFERENCE IS EXACTLY 18 THEN WE NEED TO CHECK
  //MONTHS AND DATES TO FIND OUT IF THE CUSTOMER IS 18 YEARS OLD
  if (dtCurrent.getFullYear() - dtDOB.getFullYear() == 18) {
    //CD: 11/06/2018 and DB: 15/07/2000. Will turned 18 on 15/07/2018.
    if (dtCurrent.getMonth() < dtDOB.getMonth()) {
      $("#calculateResult").attr("disabled", "true");
      $("#scdate").siblings(".error-txt2").html("Age should be as 18-65 years");
      $("#scdate").parent().removeClass("valid");
      return false;
    }
    if (dtCurrent.getMonth() == dtDOB.getMonth()) {
      //CD: 11/06/2018 and DB: 15/06/2000. Will turned 18 on 15/06/2018.
      if (dtCurrent.getDate() < dtDOB.getDate()) {
        $("#calculateResult").attr("disabled", "true");
        $("#scdate")
          .siblings(".error-txt2")
          .html("Age should be as 18-65 years");
        $("#scdate").parent().removeClass("valid");
        return false;
      }
    }
  }

  if (dtCurrent.getFullYear() - dtDOB.getFullYear() == 65) {
    //CD: 11/06/2018 and DB: 15/07/2000. Will turned 18 on 15/07/2018.
    if (dtCurrent.getMonth() > dtDOB.getMonth()) {
      $("#calculateResult").attr("disabled", "true");
      $("#scdate")
        .siblings(".error-txt2")
        .html("Sorry ! We offer this product upto the age of 65 only.");
      $("#scdate").parent().removeClass("valid");
      return false;
    }
    if (dtCurrent.getMonth() == dtDOB.getMonth()) {
      //CD: 11/06/2018 and DB: 15/06/2000. Will turned 18 on 15/06/2018.
      if (dtCurrent.getDate() > dtDOB.getDate()) {
        $("#calculateResult").attr("disabled", "true");
        $("#scdate")
          .siblings(".error-txt2")
          .html("Sorry ! We offer this product upto the age of 65 only.");
        $("#scdate").parent().removeClass("valid");
        return false;
      }
    }
  }

  $("#calculateResult").removeAttr("disabled");
  $("#scdate").siblings(".error-txt2").html("");
  $("#scdate").parent().addClass("valid");
  return true;
}


var cardContentViews = document.querySelectorAll('.twocolumncardlayout .content-view');

for (var i = 0; i < cardContentViews.length; i++) {
  var contentView = cardContentViews[i];
  var descriptionHeight = contentView.offsetHeight;

  if (descriptionHeight > 40) {
    contentView.classList.add("overflowContent");
    if (contentView.nextElementSibling) {
      contentView.nextElementSibling.classList.add("showButton");
    }
  }
}

var cardContentViewLabels = document.querySelectorAll('.twocolumncardlayout .content-view-label');

cardContentViewLabels.forEach(function(label) {
  label.addEventListener('click', function() {
    var contentView = this.previousElementSibling;
    if (contentView) {
      contentView.classList.toggle('slideDetails');
    }

    var currentText = this.textContent;
    if (currentText.indexOf('More') !== -1) {
      this.textContent = '...Read Less';
    } else {
      setTimeout(() => {
        this.textContent = '...Read More';
      }, 500)
    }
  });
});

$('.pointerCard .cmp-teaser__description').each(function() {
    var descriptionHeight = $(this).height();
    if(descriptionHeight > 40 ) {
        $(this).addClass("overflowContent");
        $(this).siblings(".cmp-teaser__action-container").addClass("showButton");
    }
});

$('.pointerCard.desktopOverflowContent .cmp-teaser__description').each(function() {
        $(this).removeClass("overflowContent");
        $(this).siblings(".cmp-teaser__action-container").removeClass("showButton");
});

$('.pointerCard.desktopOverflowContent .cmp-teaser__description').each(function() {
    var descriptionHeight = $(this).height();
    if(descriptionHeight > 100 ) {
        $(this).addClass("overflowContent");
        $(this).siblings(".cmp-teaser__action-container").addClass("showButton");
    } else {
        $(this).removeClass("overflowContent");
        $(this).siblings(".cmp-teaser__action-container").removeClass("showButton");
    }
});
$('.pointerCard .cmp-teaser__action-container .cmp-teaser__action-link').on('click', function(event) {
    event.preventDefault();
    var $description = $(this).closest(".cmp-teaser__content").find(".cmp-teaser__description");
    $description.toggleClass("slideDetails");
    if($(this).text().includes("More")) {
        $(this).text("Read Less")
    } else {
        setTimeout(()=> {
            $(this).text("...Read More")
        }, 500);
    }
})


/***********************************************category platform section js start****************************************************** */
$(document).ready(function (){
    //Modal Box
    // let plateformvideoid = $('body nav ul li').hasClass('active').find('.platformVideoBtn').attr("data-modaltarget");
    // $(plateformvideoid).on('click', function(e) {
    //     e.preventDefault();
    //     var videoId = $(".videoWrapper").attr("data-");
        
    // });

    var dataLayerVideoModal = document.querySelectorAll('.videoBtnDataLayer');
    dataLayerVideoModal.forEach(function(element){
        element.addEventListener('click',function(event){
              
            videoId = document.querySelector('.videoWrapper').getAttribute("data-video-id");
            $(".videoWrapper").children("iframe").attr("src", "https://www.youtube.com/embed/"+videoId);
            return false;
        })
    })

    

    $(".modalCloseBtn").click(function(t) {
        let self = $(this);
        self.parents('.modalBoxContainer').fadeOut();
        t.preventDefault(), $(".videoWrapper").children("iframe").attr("src", "");
        return false;
    });

    $("a[data-modalTarget]").on('click', function(e) {
        e.preventDefault();
        let self = $(this);
        let modalTarget = self.attr('data-modalTarget');
        $('#' + modalTarget).fadeIn();
        $('html','body').css("overflow", "hidden");
    });
function createIframe($iframeWrapper){
    var targetVideo = $iframeWrapper.data('video');
    var targetId = $iframeWrapper.attr('id');
    var allIframeAttributes = {
        'id': `iframe-${targetId}`,
        'src' : targetVideo,
        'allowfullscreen' : true,
        'allowscriptaccess' : 'always',
        'frameborder' : '0',
        'allow' : 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'
    }
    // create the iframe element
    var iframe = document.createElement('iframe')
    // set all the necessary attributes to the iframe
    for(var key in allIframeAttributes){
        iframe.setAttribute(key, allIframeAttributes[key])
    }
    return iframe;
}

function injectIframe($iframeWrapper){
    var iframe = createIframe($iframeWrapper);
    var youtubeIcon = $iframeWrapper.find('.youtube_icon');
    youtubeIcon.replaceWith(iframe);
}

$('.platformSection .iframe-wrapper').on('click',function(){
    var elements = document.getElementsByClassName("image-replace");
    Array.from(elements).forEach(function(ele) {
        ele.style.display = "none";
    });
    
    $this = $(this);
    injectIframe($this);
    $this.off('click')
});

});

/********************************************************************************category platform section js end************************************************ */
/***********************************************************category faq js start*************************************************** */
var apiSuccessMsg;
var formDatamap = {};
var defaultSuccessMessage = "Thank You. Our team will contact you for financial planning consultation shortly."
$(document).ready(function () {
  if ($('#successMessage').length > 0) {
    apiSuccessMsg = $('#successMessage').val().trim();
  }
  apiSuccessMsg = apiSuccessMsg == "" ? defaultSuccessMessage : apiSuccessMsg;
  //Category Accordian
  $('.faqV3 .accordMenuContWrp .tabAccordMenu > a').on('click', function (e) {
    var parent = $(this).parents('.accordMenuContWrp');
    var $parentEL = $(this).parents('.container');
    var isOpen = $(parent).hasClass('opened');
    var self = this;
    setTimeout(function () {
      theOffset = $(self).offset();
      $('body,html').animate({ scrollTop: theOffset.top - 250 });
    }, 310);
    if (isOpen) {
      parent.removeClass('opened');
      parent.find('.tabAccordMenu').removeClass('opened');
      parent.find('.tabAccordContent').slideUp('medium');

    } else {
      $parentEL.find('.accordMenuContWrp').removeClass('opened');
      $parentEL.find('.accordMenuContWrp').find('.tabAccordMenu').removeClass('opened');
      $parentEL.find('.accordMenuContWrp').find('.tabAccordContent').slideUp('medium');
      $(parent).addClass('opened');
      $(parent).find('.tabAccordMenu').addClass('opened');
      $(parent).find('.tabAccordContent').slideDown('medium');
    }
    e.preventDefault()

  })

  $('.tabAccordContent table').wrap('<div class="tableResp"></div>');

  $('.textBox textarea').click(function (e) {
    $(this).addClass('backWhite');
  })

  $('.textBox textarea').blur(function (e) {
    $(this).removeClass('backWhite');
  })

  $('textarea').keyup(function () {
    // debugger;
    var counter = 0;
    counter = Number(this.value.length)
    $(this).siblings('p').children('span.counterTextArea')[0].innerText = counter + "/3000";
  });
});

function customerConcerns(event, custTextData) {

  var phonneNo = localStorage.getItem("phoneno");
  localStorage.removeItem("phoneno");

  var dob = localStorage.getItem("dob");
  localStorage.removeItem("dob");

  if (jsHelper.isDef(localStorage.getItem("policyId"))) {
    var policyId = localStorage.getItem("policyId");
    localStorage.removeItem("policyId");
  }

  if (jsHelper.isDef(localStorage.getItem("emailID"))) {
    var clientemailID = localStorage.getItem("emailID");
    localStorage.removeItem("emailID");

  }


  var reqObj = {
    "phone": lifeServiceData.phoneNo,
    "country_code": "91",
    "customer_concern": custTextData,
    "dob": GetDate(lifeServiceData.dob),
    "policy_id": lifeServiceData.policyId,
    "email": lifeServiceData.email,
    "is_nri": false
  }

  if ($('.textBox .error-txt').text() == "" && $('.textBox textarea').val() != "") {
    $(event.currentTarget).closest('.textBox').toggleLoader();
    // Customer Concerns API call start
    var headers = headerRequest(window.location);
    customerConcernsApiObjV3 .customerConcerns(reqObj, headers).then(function (res) {
      $(event.currentTarget).closest('.textBox').toggleLoader()
      $(event.currentTarget).closest('.textBox').toggleApiSuccessMsg({ successMsg: apiSuccessMsg })
      $(".textBox textarea").val("");
      $('.textBox .counterTextArea').text('0/3000');
      $('.consernSubmit')[0].setAttribute('disabled', 'disabled');
      console.log(res);
    }).catch(function (err) {
      $(event.currentTarget).closest('.textBox').toggleLoader()
      $(event.currentTarget).closest('.textBox').toggleApiFailMsg()
      console.log(err);
    })
  } else {
    //textAreaNotEmptyValidation();
    $('.error-txt').text("This field is required!")
  }
}

function headerRequest(url) {

  var headersReq = {
    "agent-code": "00488538",
    "source-code": "HDFC_Life_tech_failure",
    "content-type": "application/x-www-form-urlencoded; charset=UTF-8"
  }

  var browserUrl = new URL(url);
  var browserUrlParams = new URLSearchParams(browserUrl.search.slice(1));


  if (browserUrlParams.has("source")) {
    headersReq["source-code"] = browserUrlParams.get("source");
  }
  if (browserUrlParams.has("source-code")) {
    headersReq["source-code"] = browserUrlParams.get("source-code");
  }
  if (browserUrlParams.has("sourcecode")) {
    headersReq["source-code"] = browserUrlParams.get("sourcecode");
  }
  if (browserUrlParams.has("agentcode")) {
    headersReq["agent-code"] = browserUrlParams.get("agentcode");
  }
  if (browserUrlParams.has("agent-code")) {
    headersReq["agent-code"] = browserUrlParams.get("agent-code");
  }
  if (browserUrlParams.has("agent-token")) {
    headersReq["agent-token"] = browserUrlParams.get("agent-token");
  }
  if (browserUrlParams.has("utm_adgroupid")) {
    headersReq["adgroup"] = browserUrlParams.get("utm_adgroupid");
  }
  if (browserUrlParams.has("campaign-date")) {
    headersReq["campaign-date"] = browserUrlParams.get("campaign-date");
  }
  if (browserUrlParams.has("utm_campaignid")) {
    headersReq["campaign-id"] = browserUrlParams.get("utm_campaignid");
  }
  if (browserUrlParams.has("agent-code")) {
    headersReq["agent-code"] = browserUrlParams.get("agent-code");
  }
  if (browserUrlParams.has("gclid")) {
    headersReq["gclid"] = browserUrlParams.get("gclid");
  }

  if (browserUrlParams.has("matchtype")) {
    headersReq["match-type"] = browserUrlParams.get("matchtype");
  }
  if (browserUrlParams.has("pid")) {
    headersReq["pid"] = browserUrlParams.get("pid");
  }
  if (browserUrlParams.has("prod")) {
    headersReq["prod"] = browserUrlParams.get("prod");
  }
  if (browserUrlParams.has("spid")) {
    headersReq["spid"] = browserUrlParams.get("spid");
  }
  if (browserUrlParams.has("utm_campaign")) {
    headersReq["utm-campaign"] = browserUrlParams.get("utm_campaign");
  }
  if (browserUrlParams.has("utm_content")) {
    headersReq["utm-content"] = browserUrlParams.get("utm_content");
  }
  if (browserUrlParams.has("spid")) {
    headersReq["spid"] = browserUrlParams.get("spid");
  }
  if (browserUrlParams.has("utm_medium")) {
    headersReq["utm-medium"] = browserUrlParams.get("utm_medium");
  }
  if (browserUrlParams.has("utm_source")) {
    headersReq["utm-source"] = browserUrlParams.get("utm_source");
  }
  if (browserUrlParams.has("utm_term")) {
    headersReq["utm-term"] = browserUrlParams.get("utm_term");
  }
  if (browserUrlParams.has("vid")) {
    headersReq["vid"] = browserUrlParams.get("vid");
  }


  return headersReq;

}
/************************************************************category faq js end****************************************** */
(function(_global) {

    var customerConcernsApiObjV3  = (function() {
        var customerConcernsApi = {};
        function customerConcerns(requestObject, headers) {
            return new Promise(function(resolve, reject) {
                apiUtility.CUSTOMER_CONCERNS(requestObject, headers).then(function(res){
                    resolve(res);
                }).catch(function(err) {
                    reject(err);
                })
            })
        }

        customerConcernsApi.customerConcerns = customerConcerns;

        return jsHelper.freezeObject(customerConcernsApi);
    })();
    _global.jsHelper.defineReadOnlyObjProp(_global, 'customerConcernsApiObjV3 ', customerConcernsApiObjV3 );

})(window || document || {});
$(document).ready(function () {
    $('.consernSubmit').on('click', function (e) {
        var customerConcernsData = $(this).parent().find('textarea').val();
        customerConcerns(e, customerConcernsData)
    })
});
var contentViews = document.querySelectorAll('.cardswithnumbers .content-view');

for (var i = 0; i < contentViews.length; i++) {
  var contentView = contentViews[i];
  var descriptionHeight = contentView.offsetHeight;

  if (descriptionHeight > 40) {
    contentView.classList.add("overflowContent");
    if (contentView.nextElementSibling) { 
      contentView.nextElementSibling.classList.add("showButton");
    }
  }
}

const contentViewLabels = document.querySelectorAll('.cardswithnumbers .content-view-label');

contentViewLabels.forEach(function(label) {
  label.addEventListener('click', function() {
    const contentView = this.previousElementSibling;
    if (contentView) {
      contentView.classList.toggle('slideDetails');
    }

    const currentText = this.textContent;
    if (currentText.indexOf('More') !== -1) {
      this.textContent = 'Read Less';
    } else {
      setTimeout(() => {
        this.textContent = '...Read More';
      }, 500)
    }
  });
});

$(document).ready(function(){

    var colors = ['#FFEAEB', '#D3E8FA', '#DCE0FF'];
    var allVideoPlayers = [];

    function changeWallColor($button){
        var wall = $button.closest('.tv-main').find('.path1');
        var buttonIndex = $button.data('index');
        var colorIndex = buttonIndex % 3;
        wall.css({fill : colors[colorIndex]});
    }

    function showIframeWrapper($button){
        var allIframeWrappers = $button.closest('.tv-frame').find('.iframe-wrapper');
        allIframeWrappers.addClass('dsp-n');
        var buttonIndex = $button.data('index');
        var targetIframeWrapper = $button.closest('.tv-frame').find('.iframe-wrapper').eq(buttonIndex);
        targetIframeWrapper.removeClass('dsp-n');
    }

    $('.video-btn').on('click',function(){
        var $this = $(this);
        changeWallColor($this);
        showIframeWrapper($this);
        pauseOtherVideos();
    })

    function pauseOtherVideos(){
        allVideoPlayers.forEach(function(player){
            var targetIframeWrapper = player.g.parentElement;
            var isIframeVisible = !targetIframeWrapper.classList.contains('dsp-n');
            if(isIframeVisible){
                return false;
            }
            player.pauseVideo();
        })
    }

    function createIframe($iframeWrapper){
        var targetVideo = $iframeWrapper.data('video');
        var targetId = $iframeWrapper.attr('id');
        var allIframeAttributes = {
            'id': `iframe-${targetId}`,
            'src' : targetVideo,
            'allowfullscreen' : true,
            'allowscriptaccess' : 'always',
            'frameborder' : '0',
            'allow' : 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'
        }
        // create the iframe element
        var iframe = document.createElement('iframe')
        // set all the necessary attributes to the iframe
        for(var key in allIframeAttributes){
            iframe.setAttribute(key, allIframeAttributes[key])
        }
        return iframe;
    }

    function injectIframe($iframeWrapper){
        var iframe = createIframe($iframeWrapper);
        var youtubeIcon = $iframeWrapper.find('.youtube_icon');
        youtubeIcon.replaceWith(iframe);
    }

    function onPlayerReady(event){
        var targetPlayer = event.target;
        allVideoPlayers.push(targetPlayer);
        pauseOtherVideos();
    }

    $('.whatisti .iframe-wrapper').on('click',function(){
        var elements = document.getElementsByClassName("image-replace");
        Array.from(elements).forEach(function(ele) {
            ele.style.display = "none";
        });
        
        $this = $(this);
        injectIframe($this);
        // create video player
        var targetIframeId = $this.find('iframe').attr('id');
        new YT.Player(targetIframeId,{
            events:{
                'onReady' : onPlayerReady
            }
        });
        // unbinding click event to avoid injecting multiple iframes
        $this.off('click')
    })

});

/***********************************************************category faq js start*************************************************** */
var apiSuccessMsg;
var formDatamap = {};
var defaultSuccessMessage = "Thank You. Our team will contact you for financial planning consultation shortly."
$(document).ready(function() {
  if ($('#successMessage').length > 0) {
    apiSuccessMsg = $('#successMessage').val().trim();
  }
  apiSuccessMsg = apiSuccessMsg == "" ? defaultSuccessMessage : apiSuccessMsg;
    //Category Accordian
    $('.faq .accordMenuContWrp .tabAccordMenu > a').on('click', function(e) {
        // e.preventDefault()
        // let wrap = $(this).parent(":header").parent('div')
        // let menu = $(this).parent(":header")
        // let content = $(this).parent(":header").next('div')
        // if (!menu.hasClass("opened")) {
        //     menu.addClass("opened")
        //     wrap.addClass("opened")
        //     content.slideDown('medium')
        // } else {
        //     wrap.removeClass("opened")
        //     content.slideUp('medium', function(e) {
        //         menu.removeClass("opened");
        //     });
        // }
      
        var parent = $(this).parents('.accordMenuContWrp');
        var $parentEL = $(this).parents('.container');
        var isOpen = $(parent).hasClass('opened');
        var self = this;
            setTimeout(function() {
                theOffset = $(self).offset();
                $('body,html').animate({ scrollTop: theOffset.top - 250});
            }, 310); 
        if (isOpen) {
          parent.removeClass('opened');
          parent.find('.tabAccordMenu').removeClass('opened');
          parent.find('.tabAccordContent').slideUp('medium');

        } else {
          $parentEL.find('.accordMenuContWrp').removeClass('opened');
          $parentEL.find('.accordMenuContWrp').find('.tabAccordMenu').removeClass('opened');
          $parentEL.find('.accordMenuContWrp').find('.tabAccordContent').slideUp('medium');
          $(parent).addClass('opened');
          $(parent).find('.tabAccordMenu').addClass('opened');
          $(parent).find('.tabAccordContent').slideDown('medium');
        }
        e.preventDefault()

    })

    $('.tabAccordContent table').wrap('<div class="tableResp"></div>');

  $('.textBox textarea').click(function (e) {
    $(this).addClass('backWhite');
  })

  $('.textBox textarea').blur(function (e) {
    $(this).removeClass('backWhite');
  })

  $('textarea').keyup(function () {
      
    var counter = 0;
    counter = Number(this.value.length)
    $(this).siblings('p').children('span.counterTextArea')[0].innerText = counter + "/3000";
  });

  // $('.consernSubmit').click(function(){
  //   var storedConcern = $(this).siblings('textarea')[0].value;
  //   $(this).siblings('textarea')[0].value = "";
  // })

});

function customerConcerns(event, custTextData) {

  var phonneNo = localStorage.getItem("phoneno");
  localStorage.removeItem("phoneno");

  var dob = localStorage.getItem("dob");
  localStorage.removeItem("dob");

  if (jsHelper.isDef(localStorage.getItem("policyId"))) {
    var policyId = localStorage.getItem("policyId");
    localStorage.removeItem("policyId");
  }

    // if (jsHelper.isDef(localStorage.getItem("clientId"))) {
    //   var clientId = localStorage.getItem("clientId");
    //   localStorage.removeItem("clientId");

    // }

  if (jsHelper.isDef(localStorage.getItem("emailID"))) {
    var clientemailID = localStorage.getItem("emailID");
    localStorage.removeItem("emailID");

  }


  var reqObj = {
    "phone": lifeServiceData.phoneNo,
    "country_code": "91",
    "customer_concern": custTextData,
    "dob": GetDate(lifeServiceData.dob),
    "policy_id": lifeServiceData.policyId,
    "email" : lifeServiceData.email,
    "is_nri" : false
  }

  if ($('.textBox .error-txt').text() == "" && $('.textBox textarea').val() != "") {
    $(event.currentTarget).closest('.textBox').toggleLoader();
    // Customer Concerns API call start
    var headers = headerRequest(window.location);
    customerConcernsApiObj.customerConcerns(reqObj, headers).then(function (res) {
      $(event.currentTarget).closest('.textBox').toggleLoader()
      $(event.currentTarget).closest('.textBox').toggleApiSuccessMsg({ successMsg: apiSuccessMsg })
      $(".textBox textarea").val("");
      $('.textBox .counterTextArea').text('0/3000');
      $('.consernSubmit')[0].setAttribute('disabled', 'disabled');
      console.log(res);
    }).catch(function (err) {
      $(event.currentTarget).closest('.textBox').toggleLoader()
      $(event.currentTarget).closest('.textBox').toggleApiFailMsg()
      console.log(err);
    })
  } else {
    //textAreaNotEmptyValidation();
    $('.error-txt').text("This field is required!")
  }
}

function headerRequest(url) {

  var headersReq = {
      "agent-code": "00488538",
      "source-code": "HDFC_Life_tech_failure",
      "content-type": "application/x-www-form-urlencoded; charset=UTF-8"
  }

  var browserUrl = new URL(url);
  var browserUrlParams = new URLSearchParams(browserUrl.search.slice(1));


  if (browserUrlParams.has("source")) {
      headersReq["source-code"] = browserUrlParams.get("source");
  }
  if (browserUrlParams.has("source-code")) {
      headersReq["source-code"] = browserUrlParams.get("source-code");
  }
  if (browserUrlParams.has("sourcecode")) {
      headersReq["source-code"] = browserUrlParams.get("sourcecode");
  }
  if (browserUrlParams.has("agentcode")) {
      headersReq["agent-code"] = browserUrlParams.get("agentcode");
  }
  if (browserUrlParams.has("agent-code")) {
      headersReq["agent-code"] = browserUrlParams.get("agent-code");
  }
  if (browserUrlParams.has("agent-token")) {
      headersReq["agent-token"] = browserUrlParams.get("agent-token");
  }
  if (browserUrlParams.has("utm_adgroupid")) {
      headersReq["adgroup"] = browserUrlParams.get("utm_adgroupid");
  }
  if (browserUrlParams.has("campaign-date")) {
      headersReq["campaign-date"] = browserUrlParams.get("campaign-date");
  }
  if (browserUrlParams.has("utm_campaignid")) {
      headersReq["campaign-id"] = browserUrlParams.get("utm_campaignid");
  }
  if (browserUrlParams.has("agent-code")) {
      headersReq["agent-code"] = browserUrlParams.get("agent-code");
  }
  if (browserUrlParams.has("gclid")) {
      headersReq["gclid"] = browserUrlParams.get("gclid");
  }

  if (browserUrlParams.has("matchtype")) {
      headersReq["match-type"] = browserUrlParams.get("matchtype");
  }
  if (browserUrlParams.has("pid")) {
      headersReq["pid"] = browserUrlParams.get("pid");
  }
  if (browserUrlParams.has("prod")) {
      headersReq["prod"] = browserUrlParams.get("prod");
  }
  if (browserUrlParams.has("spid")) {
      headersReq["spid"] = browserUrlParams.get("spid");
  }
  if (browserUrlParams.has("utm_campaign")) {
      headersReq["utm-campaign"] = browserUrlParams.get("utm_campaign");
  }
  if (browserUrlParams.has("utm_content")) {
      headersReq["utm-content"] = browserUrlParams.get("utm_content");
  }
  if (browserUrlParams.has("spid")) {
      headersReq["spid"] = browserUrlParams.get("spid");
  }
  if (browserUrlParams.has("utm_medium")) {
      headersReq["utm-medium"] = browserUrlParams.get("utm_medium");
  }
  if (browserUrlParams.has("utm_source")) {
      headersReq["utm-source"] = browserUrlParams.get("utm_source");
  }
  if (browserUrlParams.has("utm_term")) {
      headersReq["utm-term"] = browserUrlParams.get("utm_term");
  }
  if (browserUrlParams.has("vid")) {
      headersReq["vid"] = browserUrlParams.get("vid");
  }


  return headersReq;

}
/************************************************************category faq js end****************************************** */
(function(_global) {

    var customerConcernsApiObj = (function() {
        var customerConcernsApi = {};
        function customerConcerns(requestObject, headers) {
            return new Promise(function(resolve, reject) {
                apiUtility.CUSTOMER_CONCERNS(requestObject, headers).then(function(res){
                    resolve(res);
                }).catch(function(err) {
                    reject(err);
                })
            })
        }

        customerConcernsApi.customerConcerns = customerConcerns;

        return jsHelper.freezeObject(customerConcernsApi);
    })();
    _global.jsHelper.defineReadOnlyObjProp(_global, 'customerConcernsApiObj', customerConcernsApiObj);

})(window || document || {});
$(document).ready(function () {
    $('.consernSubmit').on('click', function (e) {
        var customerConcernsData = $(this).parent().find('textarea').val();
        customerConcerns(e, customerConcernsData)
    })
});

document.addEventListener("DOMContentLoaded", function() {
    const termaccordionisMobile = window.innerWidth <= 991;

    // Open first accordion in mobile view, and first row in desktop view
    const termaccordions = document.querySelectorAll('.termaccordion .accordion .collapse');
    termaccordions.forEach((termaccordion, index) => {
        if (termaccordionisMobile) {
            if (index === 0) {
                termaccordion.classList.add('show');
            }
        } else {
            if (index < 4) {
                termaccordion.classList.add('show');
            }
        }
    });

    // Toggle function for accordion headers
    document.querySelectorAll('.termaccordion .card-header').forEach(header => {
        header.addEventListener('click', function() {
            this.classList.toggle('collapsed');
        });
    });
});

/* $( document ).ready(function() {
    $('.new-articles-carousel ul').owlCarousel({
        responsiveClass: true,
        responsive: {
            0: {
                items: 1,
                // autoWidth: true,
                loop: false,
                center: false,
                nav: true,
                dots: false,
                margin: 10,
                // navContainer: '#mobSocialCarouselNav',
                // dotsContainer: '#mobSocialCarouselDot'
            },
            600: {
                items: 2,
                autoWidth: true,
                loop: false,
                center: false,
                margin: 10,
                dots: false,
                nav: true,
                // navContainer: '#mobSocialCarouselNav',
                // dotsContainer: '#mobSocialCarouselDot'
            },
            1000: {
                items: 3,
                autoWidth: true,
                loop: false,
                center: false,
                margin: 24,
                dots: false,
                nav: true,
                // navContainer: '#mobSocialCarouselNav',
                // dotsContainer: '#mobSocialCarouselDot'
            },
            1200: {
                items: 3,
                loop: false,
                center: false,
                margin: 24,
                dots: false,
                nav: true,
            }
        }
        });
  }); */
$( document ).ready(function() {
    $('.customerTestimonials ul').owlCarousel({
        responsiveClass: true,
        responsive: {
            0: {
                items: 1,
                // autoWidth: true,
                loop: false,
                center: false,
                nav: true,
                dots: false,
                margin: 10,
                // navContainer: '#mobSocialCarouselNav',
                // dotsContainer: '#mobSocialCarouselDot'
            },
            600: {
                items: 2,
                autoWidth: true,
                loop: false,
                center: false,
                margin: 10,
                dots: false,
                nav: true,
                // navContainer: '#mobSocialCarouselNav',
                // dotsContainer: '#mobSocialCarouselDot'
            },
            1000: {
                items: 3,
                autoWidth: true,
                loop: false,
                center: false,
                margin: 24,
                dots: false,
                nav: true,
                // navContainer: '#mobSocialCarouselNav',
                // dotsContainer: '#mobSocialCarouselDot'
            },
            1200: {
                items: 3,
                loop: false,
                center: false,
                margin: 24,
                dots: false,
                nav: true,
            }
        }
        });
  });
$(document).ready(function () {
    $('.tapvideo').click(function (e) {
        e.preventDefault();
        $('#yt-player').children('iframe').attr('src', 'https://www.youtube.com/embed/rVtiZXQhugM');
    });
    $('.close-icon1').click(function (e) {
        e.preventDefault();
        $('#yt-player').children('iframe').attr('src', '');
    });

    // const observer = lozad(); // lazy loads elements with default selector as '.lozad'
    // observer.observe();

});
$(document).on('click', '.calculate-btn', function () {
    $('.let-us-calculate-section').slideUp();
    $('.calculator-section').slideDown();
    $('html, body').animate({
        scrollTop: $(".calculator-section").offset().top - ($('.headerWrap').height() + 20)
    }, 100);
});
$(document).on('click', '.close-icon', function () {
    $('.let-us-calculate-section').slideDown();
    $('.calculator-section').slideUp();
    $('.calculate-bottom-section').slideUp();
});


/***********************************************************common toggle image with text js end********************************************** */
var feedbackContainer = document.querySelector('.ratingSubmitForm .feedback-container');
var submitRating = document.querySelector('.ratingSubmitForm .submit__rating');
var submitPopup = document.querySelector('.ratingSubmitForm .submit__popup');
var ratingLabels = document.querySelectorAll('.ratingSubmitForm .star-rating-label');
var errorText = document.querySelector(".ratingSubmitForm .error-txt");

var ratingInputs = document.querySelectorAll('.ratingSubmitForm .star-rating input');
var ratingValue = document.querySelector('.ratingSubmitForm .rating-value');
var submitButton = document.querySelector(".ratingSubmitForm #submit__button");
var defaultMessage = document.querySelector(".ratingSubmitForm input[name='defaultMessage']").value;
var oneStarMessage = document.querySelector(".ratingSubmitForm input[name='oneStarMessage']").value;
var twoStarMessage = document.querySelector(".ratingSubmitForm input[name='twoStarMessage']").value;
var threeStarMessage = document.querySelector(".ratingSubmitForm input[name='threeStarMessage']").value;
var fourStarMessage = document.querySelector(".ratingSubmitForm input[name='fourStarMessage']").value;
var fiveStarMessage = document.querySelector(".ratingSubmitForm input[name='fiveStarMessage']").value;

var reqObj = {
    "feedback": defaultMessage
}

submitPopup.style.height = submitRating.offsetHeight + "px";

switch (defaultMessage) {
    case fiveStarMessage:
        removeStar(5)
        break;
    case fourStarMessage:
        removeStar(4)
        break;
    case threeStarMessage:
        removeStar(3)
        break;
    case twoStarMessage:
        removeStar(2)
        break;
    case oneStarMessage:
        removeStar(1)
        break;
    default:
        removeStar(0)
}

function removeStar(rating) {
    ratingLabels.forEach(function(label, index) {
        if (index < rating) {
            label.classList.add("checked")
        } else {
            label.classList.remove("checked")
        }
    });
}

// star rating submission
function submissionAPICall(reqObj) {
    $('.ratingSubmitForm .feedback-container').toggleLoader();
    const currentPage = window.location.pathname;
    const storageKey = `reviewSubmitted_${currentPage.replace(/\//g, '_')}`;
    starRatingSubmissionApiObj.starRatingSubmission(reqObj)
        .then(function (res) {
            $('.ratingSubmitForm .feedback-container').toggleLoader();
            localStorage.setItem(storageKey, true);
            submitRating.style.display = "none";
            submitPopup.style.display = "flex";
        }).catch(function (error) {
            console.log("reqObj", reqObj)
            $('.ratingSubmitForm .feedback-container').toggleLoader();
            $('.ratingSubmitForm .feedback-container').toggleApiFailMsg();
        })
}
// *************************RATING SUBMISSION*****************************
(function(_global) {
    var starRatingSubmissionApiObj = (function() {
        var starRatingSubmissionApi = {};
        function starRatingSubmission(requestObject,headers) {
            return new Promise(function(resolve,reject) {
                apiUtility.RATING_SUBMISSION(requestObject,headers).then(function(res) {
                    resolve(res);
                }).catch(function(err) {
                    reject(err);
                })
            })
        }

        starRatingSubmissionApi.starRatingSubmission = starRatingSubmission;

        return jsHelper.freezeObject(starRatingSubmissionApi);
    })();
    _global.jsHelper.defineReadOnlyObjProp(_global, 'starRatingSubmissionApiObj', starRatingSubmissionApiObj);
})(window || document || {});
window.addEventListener("pageshow", function() {
    const currentPage = window.location.pathname;
    const storageKey = `reviewSubmitted_${currentPage.replace(/\//g, '_')}`;
    if(localStorage.getItem(storageKey)){
        submitRating.style.display = "none";
        submitPopup.style.display = "flex";
    }
});

ratingLabels.forEach(label => {
    label.addEventListener('click', function() {
        switch (label.previousElementSibling.value) {
            case '5':
                ratingValue.textContent = fiveStarMessage;
                reqObj.feedback = fiveStarMessage;
                break;
            case '4':
                ratingValue.textContent = fourStarMessage;
                reqObj.feedback = fourStarMessage;
                break;
            case '3':
                ratingValue.textContent = threeStarMessage;
                reqObj.feedback = threeStarMessage;
                break;
            case '2':
                ratingValue.textContent = twoStarMessage;
                reqObj.feedback = twoStarMessage;
                break;
            case '1':
                ratingValue.textContent = oneStarMessage;
                reqObj.feedback = oneStarMessage;
                break;
            default:
                ratingValue.textContent = defaultMessage;
                reqObj.feedback = defaultMessage;
        }
        errorText.classList.add('d-none');
        removeStar(label.previousElementSibling.value);
    });

    label.addEventListener('mouseover', function() {
        switch (label.previousElementSibling.value) {
            case '5':
                ratingValue.textContent = fiveStarMessage;
                reqObj.feedback = fiveStarMessage;
                break;
            case '4':
                ratingValue.textContent = fourStarMessage;
                reqObj.feedback = fourStarMessage;
                break;
            case '3':
                ratingValue.textContent = threeStarMessage;
                reqObj.feedback = threeStarMessage;
                break;
            case '2':
                ratingValue.textContent = twoStarMessage;
                reqObj.feedback = twoStarMessage;
                break;
            case '1':
                ratingValue.textContent = oneStarMessage;
                reqObj.feedback = oneStarMessage;
                break;
            default:
                ratingValue.textContent = defaultMessage;
                reqObj.feedback = defaultMessage;
        }
        errorText.classList.add('d-none');
        removeStar(label.previousElementSibling.value);
    });
    
    label.addEventListener('mouseleave', function() {
        var isChecked = false;
        var checkedValue = 0;
        var labelMessage = ""
        ratingLabels.forEach(label => {
            if(label.previousElementSibling.checked) {
                isChecked = true;
                checkedValue = label.previousElementSibling.value;
                labelMessage = label.getAttribute("data-message")
            }
        });
        if(isChecked) {
            removeStar(checkedValue);
            ratingValue.textContent = labelMessage;
            reqObj.feedback = labelMessage;
        } else {
            switch (defaultMessage) {
                case fiveStarMessage:
                    removeStar(5);
                    ratingValue.textContent = fiveStarMessage;
                    reqObj.feedback = fiveStarMessage;
                    break;
                case fourStarMessage:
                    removeStar(4);
                    ratingValue.textContent = fourStarMessage;
                    reqObj.feedback = fourStarMessage;
                    break;
                case threeStarMessage:
                    removeStar(3);
                    ratingValue.textContent = threeStarMessage;
                    reqObj.feedback = threeStarMessage;
                    break;
                case twoStarMessage:
                    removeStar(2);
                    ratingValue.textContent = twoStarMessage;
                    reqObj.feedback = twoStarMessage;
                    break;
                case oneStarMessage:
                    removeStar(1);
                    ratingValue.textContent = oneStarMessage;
                    reqObj.feedback = oneStarMessage;
                    break;
                default:
                    removeStar(0);
                    ratingValue.textContent = defaultMessage;
                    reqObj.feedback = defaultMessage;
            }
        }

    });
});

submitButton.addEventListener("click", function() {
    if(reqObj.feedback) {
        errorText.classList.add('d-none');
        submissionAPICall(reqObj)
    } else {
        errorText.classList.remove('d-none');
    }
});
/*****************************************common disclaimer js start*************************************** */

$( document ).ready(function() {
    $('.disclaimer-sec .disclaimer-head').click(function() {  
        var isOpen = $('.disclaimer-sec').hasClass('open');
        if (isOpen) {
            $('.disclaimer-sec').find('.disclaimer-cont').slideUp();
            $('.disclaimer-sec').removeClass('open');
        } else {
            $('.disclaimer-cont').slideDown();
            $('.disclaimer-sec').addClass('open');
        }
    });   
});

/**********************************common disclaimer js end***************************************************** */
/**
 * Simple, lightweight, usable local autocomplete library for modern browsers
 * Because there weren’t enough autocomplete scripts in the world? Because I’m completely insane and have NIH syndrome? Probably both. :P
 * @author Lea Verou http://leaverou.github.io/awesomplete
 * MIT license
 */

(function () {

    var _ = function (input, o) {
        var me = this;

        // Keep track of number of instances for unique IDs
        _.count = (_.count || 0) + 1;
        this.count = _.count;

        // Setup

        this.isOpened = false;

        this.input = $(input);
        this.input.setAttribute("autocomplete", "off");
        this.input.setAttribute("aria-expanded", "false");
        this.input.setAttribute("aria-owns", "awesomplete_list_" + this.count);
        this.input.setAttribute("role", "combobox");

        // store constructor options in case we need to distinguish
        // between default and customized behavior later on
        this.options = o = o || {};

        configure(this, {
            minChars: 2,
            maxItems: 10,
            autoFirst: false,
            data: _.DATA,
            filter: _.FILTER_CONTAINS,
            sort: o.sort === false ? false : _.SORT_BYLENGTH,
            container: _.CONTAINER,
            item: _.ITEM,
            replace: _.REPLACE,
            tabSelect: false,
            listLabel: "Results List"
        }, o);

        this.index = -1;

        // Create necessary elements

        this.container = this.container(input);

        this.ul = $.create("ul", {
            hidden: "hidden",
            role: "listbox",
            id: "awesomplete_list_" + this.count,
            inside: this.container,
            "aria-label": this.listLabel
        });

        this.status = $.create("span", {
            className: "visually-hidden",
            role: "status",
            "aria-live": "assertive",
            "aria-atomic": true,
            inside: this.container,
            textContent: this.minChars != 0 ? ("Type " + this.minChars + " or more characters for results.") : "Begin typing for results."
        });

        // Bind events

        this._events = {
            input: {
                "input": this.evaluate.bind(this),
                "blur": this.close.bind(this, { reason: "blur" }),
                "keydown": function (evt) {
                    var c = evt.keyCode;

                    // If the dropdown `ul` is in view, then act on keydown for the following keys:
                    // Enter / Esc / Up / Down
                    if (me.opened) {
                        if (c === 13 && me.selected) { // Enter
                            evt.preventDefault();
                            me.select(undefined, undefined, evt);
                        }
                        else if (c === 9 && me.selected && me.tabSelect) {
                            evt.preventDefault();
                            me.select(undefined, undefined, evt);
                        }
                        else if (c === 27) { // Esc
                            me.close({ reason: "esc" });
                        }
                        else if (c === 38 || c === 40) { // Down/Up arrow
                            evt.preventDefault();
                            me[c === 38 ? "previous" : "next"]();
                        }
                    }
                }
            },
            form: {
                "submit": this.close.bind(this, { reason: "submit" })
            },
            ul: {
                // Prevent the default mousedowm, which ensures the input is not blurred.
                // The actual selection will happen on click. This also ensures dragging the
                // cursor away from the list item will cancel the selection
                "mousedown": function (evt) {
                    evt.preventDefault();
                },
                // The click event is fired even if the corresponding mousedown event has called preventDefault
                "click": function (evt) {
                    var li = evt.target;

                    if (li !== this) {

                        while (li && !/li/i.test(li.nodeName)) {
                            li = li.parentNode;
                        }

                        if (li && evt.button === 0) {  // Only select on left click
                            evt.preventDefault();
                            me.select(li, evt.target, evt);
                        }
                    }
                }
            }
        };

        $.bind(this.input, this._events.input);
        $.bind(this.input.form, this._events.form);
        $.bind(this.ul, this._events.ul);

        if (this.input.hasAttribute("list")) {
            this.list = "#" + this.input.getAttribute("list");
            this.input.removeAttribute("list");
        }
        else {
            this.list = this.input.getAttribute("data-list") || o.list || [];
        }

        _.all.push(this);
    };

    _.prototype = {
        set list(list) {
            if (Array.isArray(list)) {
                this._list = list;
            }
            else if (typeof list === "string" && list.indexOf(",") > -1) {
                this._list = list.split(/\s*,\s*/);
            }
            else { // Element or CSS selector
                list = $(list);

                if (list && list.children) {
                    var items = [];
                    slice.apply(list.children).forEach(function (el) {
                        if (!el.disabled) {
                            var text = el.textContent.trim();
                            var value = el.value || text;
                            var label = el.label || text;
                            if (value !== "") {
                                items.push({ label: label, value: value });
                            }
                        }
                    });
                    this._list = items;
                }
            }

            if (document.activeElement === this.input) {
                this.evaluate();
            }
        },

        get selected() {
            return this.index > -1;
        },

        get opened() {
            return this.isOpened;
        },

        close: function (o) {
            if (!this.opened) {
                return;
            }

            this.input.setAttribute("aria-expanded", "false");
            this.ul.setAttribute("hidden", "");
            this.isOpened = false;
            this.index = -1;

            this.status.setAttribute("hidden", "");

            $.fire(this.input, "awesomplete-close", o || {});
        },

        open: function () {
            this.input.setAttribute("aria-expanded", "true");
            this.ul.removeAttribute("hidden");
            this.isOpened = true;

            this.status.removeAttribute("hidden");

            if (this.autoFirst && this.index === -1) {
                this.goto(0);
            }

            $.fire(this.input, "awesomplete-open");
        },

        destroy: function () {
            //remove events from the input and its form
            $.unbind(this.input, this._events.input);
            $.unbind(this.input.form, this._events.form);

            // cleanup container if it was created by Awesomplete but leave it alone otherwise
            if (!this.options.container) {
                //move the input out of the awesomplete container and remove the container and its children
                var parentNode = this.container.parentNode;

                parentNode.insertBefore(this.input, this.container);
                parentNode.removeChild(this.container);
            }

            //remove autocomplete and aria-autocomplete attributes
            this.input.removeAttribute("autocomplete");
            this.input.removeAttribute("aria-autocomplete");

            //remove this awesomeplete instance from the global array of instances
            var indexOfAwesomplete = _.all.indexOf(this);

            if (indexOfAwesomplete !== -1) {
                _.all.splice(indexOfAwesomplete, 1);
            }
        },

        next: function () {
            var count = this.ul.children.length;
            this.goto(this.index < count - 1 ? this.index + 1 : (count ? 0 : -1));
        },

        previous: function () {
            var count = this.ul.children.length;
            var pos = this.index - 1;

            this.goto(this.selected && pos !== -1 ? pos : count - 1);
        },

        // Should not be used, highlights specific item without any checks!
        goto: function (i) {
            var lis = this.ul.children;

            if (this.selected) {
                lis[this.index].setAttribute("aria-selected", "false");
            }

            this.index = i;

            if (i > -1 && lis.length > 0) {
                lis[i].setAttribute("aria-selected", "true");

                this.status.textContent = lis[i].textContent + ", list item " + (i + 1) + " of " + lis.length;

                this.input.setAttribute("aria-activedescendant", this.ul.id + "_item_" + this.index);

                // scroll to highlighted element in case parent's height is fixed
                this.ul.scrollTop = lis[i].offsetTop - this.ul.clientHeight + lis[i].clientHeight;

                $.fire(this.input, "awesomplete-highlight", {
                    text: this.suggestions[this.index]
                });
            }
        },

        select: function (selected, origin, originalEvent) {
            if (selected) {
                this.index = $.siblingIndex(selected);
            } else {
                selected = this.ul.children[this.index];
            }

            if (selected) {
                var suggestion = this.suggestions[this.index];

                var allowed = $.fire(this.input, "awesomplete-select", {
                    text: suggestion,
                    origin: origin || selected,
                    originalEvent: originalEvent
                });

                if (allowed) {
                    this.replace(suggestion);
                    this.close({ reason: "select" });
                    var eMessage = this.input.parentElement.parentElement.children;
                    for(var i=0;i<= eMessage.length;i++){
                       if(eMessage[i].classList.contains('error-txt')){
                            eMessage[i].textContent = "";
                            break;
                       } 
                    }
                    $.fire(this.input, "awesomplete-selectcomplete", {
                        text: suggestion,
                        originalEvent: originalEvent
                    });
                }
            }
        },

        evaluate: function () {
            var me = this;
            var value = this.input.value;

            if (value.length >= this.minChars && this._list && this._list.length > 0) {
                this.index = -1;
                // Populate list with options that match
                this.ul.innerHTML = "";

                this.suggestions = this._list
                    .map(function (item) {
                        return new Suggestion(me.data(item, value));
                    })
                    .filter(function (item) {
                        return me.filter(item, value);
                    });

                if (this.sort !== false) {
                    this.suggestions = this.suggestions.sort(this.sort);
                }

                this.suggestions = this.suggestions.slice(0, this.maxItems);

                this.suggestions.forEach(function (text, index) {
                    me.ul.appendChild(me.item(text, value, index));
                });

                if (this.ul.children.length === 0) {

                    this.status.textContent = "No results found";

                    this.close({ reason: "nomatches" });

                } else {
                    this.open();

                    this.status.textContent = this.ul.children.length + " results found";
                }
            }
            else {
                this.close({ reason: "nomatches" });

                this.status.textContent = "No results found";
            }
        }
    };

    // Static methods/properties

    _.all = [];

    _.FILTER_CONTAINS = function (text, input) {
        return RegExp($.regExpEscape(input.trim()), "i").test(text);
    };

    _.FILTER_STARTSWITH = function (text, input) {
        return RegExp("^" + $.regExpEscape(input.trim()), "i").test(text);
    };

    _.SORT_BYLENGTH = function (a, b) {
        if (a.length !== b.length) {
            return a.length - b.length;
        }

        return a < b ? -1 : 1;
    };

    _.CONTAINER = function (input) {
        return $.create("div", {
            className: "awesomplete",
            around: input
        });
    }

    _.ITEM = function (text, input, item_id) {
        var html = input.trim() === "" ? text : text.replace(RegExp($.regExpEscape(input.trim()), "gi"), "<mark>$&</mark>");
        return $.create("li", {
            innerHTML: html,
            "role": "option",
            "aria-selected": "false",
            "id": "awesomplete_list_" + this.count + "_item_" + item_id
        });
    };

    _.REPLACE = function (text) {
        this.input.value = text.value;
    };

    _.DATA = function (item/*, input*/) { return item; };

    // Private functions

    function Suggestion(data) {
        var o = Array.isArray(data)
            ? { label: data[0], value: data[1] }
            : typeof data === "object" && "label" in data && "value" in data ? data : { label: data, value: data };

        this.label = o.label || o.value;
        this.value = o.value;
    }
    Object.defineProperty(Suggestion.prototype = Object.create(String.prototype), "length", {
        get: function () { return this.label.length; }
    });
    Suggestion.prototype.toString = Suggestion.prototype.valueOf = function () {
        return "" + this.label;
    };

    function configure(instance, properties, o) {
        for (var i in properties) {
            var initial = properties[i],
                attrValue = instance.input.getAttribute("data-" + i.toLowerCase());

            if (typeof initial === "number") {
                instance[i] = parseInt(attrValue);
            }
            else if (initial === false) { // Boolean options must be false by default anyway
                instance[i] = attrValue !== null;
            }
            else if (initial instanceof Function) {
                instance[i] = null;
            }
            else {
                instance[i] = attrValue;
            }

            if (!instance[i] && instance[i] !== 0) {
                instance[i] = (i in o) ? o[i] : initial;
            }
        }
    }

    // Helpers

    var slice = Array.prototype.slice;

    function $(expr, con) {
        return typeof expr === "string" ? (con || document).querySelector(expr) : expr || null;
    }

    function $$(expr, con) {
        return slice.call((con || document).querySelectorAll(expr));
    }

    $.create = function (tag, o) {
        var element = document.createElement(tag);

        for (var i in o) {
            var val = o[i];

            if (i === "inside") {
                $(val).appendChild(element);
            }
            else if (i === "around") {
                var ref = $(val);
                ref.parentNode.insertBefore(element, ref);
                element.appendChild(ref);

                if (ref.getAttribute("autofocus") != null) {
                    ref.focus();
                }
            }
            else if (i in element) {
                element[i] = val;
            }
            else {
                element.setAttribute(i, val);
            }
        }

        return element;
    };

    $.bind = function (element, o) {
        if (element) {
            for (var event in o) {
                var callback = o[event];

                event.split(/\s+/).forEach(function (event) {
                    element.addEventListener(event, callback);
                });
            }
        }
    };

    $.unbind = function (element, o) {
        if (element) {
            for (var event in o) {
                var callback = o[event];

                event.split(/\s+/).forEach(function (event) {
                    element.removeEventListener(event, callback);
                });
            }
        }
    };

    $.fire = function (target, type, properties) {
        var evt = document.createEvent("HTMLEvents");

        evt.initEvent(type, true, true);

        for (var j in properties) {
            evt[j] = properties[j];
        }

        return target.dispatchEvent(evt);
    };

    $.regExpEscape = function (s) {
        return s.replace(/[-\\^$*+?.()|[\]{}]/g, "\\$&");
    };

    $.siblingIndex = function (el) {
        /* eslint-disable no-cond-assign */
        for (var i = 0; el = el.previousElementSibling; i++);
        return i;
    };

    // Initialization

    function init() {
        $$("input.awesomplete").forEach(function (input) {
            new _(input);
        });
    }

    // Make sure to export Awesomplete on self when in a browser
    if (typeof self !== "undefined") {
        self.Awesomplete = _;
    }

    // Are we in a browser? Check for Document constructor
    if (typeof Document !== "undefined") {
        // DOM already loaded?
        if (document.readyState !== "loading") {
            init();
        }
        else {
            // Wait for it
            document.addEventListener("DOMContentLoaded", init);
        }
    }

    _.$ = $;
    _.$$ = $$;

    // Expose Awesomplete as a CJS module
    if (typeof module === "object" && module.exports) {
        module.exports = _;
    }

    return _;

}());

var emailAutotag = document.querySelectorAll('.emailAuto');

for(var i=0;i<=emailAutotag.length;i++){
    if(emailAutotag[i] != null){
        new Awesomplete(emailAutotag[i], {
            list: ["gmail.com", "yahoo.com", "rediff.com", "hotmail.com", "yahoo.co.in"],
            data: function (text, input) {
                return input.slice(0, input.indexOf("@")) + "@" + text;
            },
            filter: Awesomplete.FILTER_STARTSWITH
        });
    }
}



new Awesomplete('.emailfooter', {
    list: ["gmail.com", "yahoo.com", "rediff.com", "hotmail.com", "yahoo.co.in"],
    data: function (text, input) {
        return input.slice(0, input.indexOf("@")) + "@" + text;
    },
    filter: Awesomplete.FILTER_STARTSWITH
});

    // Back to top arrow script

    var btn = $('.btn-top');

    $(window).scroll(function() {
    if ($(window).scrollTop() > 2500) {
        btn.addClass('show');
    } else {
        btn.removeClass('show');
    }
    });
    
    btn.on('click', function(e) {
    e.preventDefault();
    $('html, body').animate({scrollTop:0}, '300');
    });
    // scroll hide and show
    
$(document).ready(function(){

  $('.fieldgen #maleDownloadBrochure, .fieldgen #femaleDownloadBrochure').click(function(e){
    if(!$(this).hasClass('valid')){
        $(this).addClass('valid');
        $(this).siblings().removeClass('valid');
    }
})

  // daterangepicker initialization start
  var today = new Date();
  var currentFormat = 'DD/MM/YYYY'
  $('.downloadbrochure input[name="dateBirth"]').daterangepicker(
    {
      parentEl: $('.downloadbrochure .form-holder'),
      applyButtonClasses: "btn-primary color-white",
      autoUpdateInput: false,
      singleDatePicker: true,
      showDropdowns: true,
      startDate: "1985-01-01",
      minYear: 1958,
      minDate: "1958-01-01",
      maxDate: dayjs().format('YYYY-MM-DD'),
      maxYear: today.getFullYear(),
      locale: {
        format: "YYYY-MM-DD",
        separator: " - ",
      },
    },
    function (start, end, label) {
      // CALLBACK TO FORMAT THE SELECTED DATE
      var formattedDate = start.format(currentFormat);
      $('.downloadbrochure input[name="dateBirth"]').val(formattedDate);
      dateValidation()
      // FUNCTION FOR VALIDATION
      ValidateDOB(start);
    }
  );

  $('.downloadbrochure input[name="dateBirth"]').on('apply.daterangepicker', function (ev, picker) {
    var formattedDate = picker.startDate.format(currentFormat);
    $(this).val(formattedDate);
    ValidateDOB(picker.startDate);
  });

  var $jqDate = $('.downloadbrochure input[name="dateBirth"]');
  //Bind keyup/keydown to the input
  $jqDate.bind('keyup','keydown', function(e){
  
    //To accomdate for backspacing, we detect which key was pressed - if backspace, do nothing:
      if(e.which !== 8) { 
          var numChars = $jqDate.val().length;
          if(numChars === 2 || numChars === 5){
              var thisVal = $jqDate.val();
              thisVal += '/';
              $jqDate.val(thisVal);
          }
    }
  });

  function dateValidation() {
    var newDate = document.getElementById("dateBirth").value;
    var newDate1 = newDate.split('/');
    if (newDate.length <= 10) {
        var today = new Date();
        var dd = today.getDate();
        var mm = today.getMonth() + 1; //January is 0!
        var yyyy = today.getFullYear();
        if (dd < 10) {
            dd = '0' + dd
        }
        if (mm < 10) {
            mm = '0' + mm
        }

        today = dd + '/' + mm + '/' + yyyy;

        var today1 = today.split('/');

        if ((newDate1[1] > 12) || (newDate1[0] > 31) || ((newDate1[2] >= today1[2]) || (newDate1[2] <= 1910))) {
            $('.downloadbrochure #dateBirth').siblings('.error-txt').html('Enter Valid Date');
        }
        else {
            $('.downloadbrochure #dateBirth').siblings('.error-txt').html('');

        }


    }
    else {
        if (newDate.length !== 10) {
            $('.downloadbrochure .feedback-form-data-layer').attr('disabled', 'disabled');
        }
        else {
            $('.downloadbrochure .feedback-form-data-layer').removeAttr('disabled', 'disabled');
        }
        if (newDate.length == 0) {
            $('.downloadbrochure #dateBirth').siblings('.error-txt').html('');
        }
    }

}


    //DATE PICKER VALIDATION
    function ValidateDOB(dateString) {
      var $dateInput = $('.downloadbrochure input[name="dateBirth"]');
      var $formGroup = $dateInput.closest('.form-group');
      var $errorTxt = $dateInput.siblings('.error-txt');
      var dtDOB = dayjs(dateString);
      var dtCurrent = dayjs(new Date());
      var age = dtCurrent.diff(dtDOB, 'years');
      if(18 <= age && age <= 65){
        $dateInput.parent().parent().addClass('valid');
        $errorTxt.html("");
        $errorTxt.addClass('d-none');
      }else{
        $dateInput.parent().parent().removeClass('valid');
        $errorTxt.html("Age should be between 18-65 years");
        $errorTxt.removeClass('d-none');
      }
    }
  // daterangepicker initialization end

  // var date = document.getElementById('dateBirth');

  // var $jqDate = jQuery('input[name=dateBirth]');

  //Bind keyup/keydown to the input
  // $jqDate.bind('keyup','keydown', function(e){
  
  //   //To accomdate for backspacing, we detect which key was pressed - if backspace, do nothing:
  //     if(e.which !== 8) { 
  //         var numChars = $jqDate.val().length;
  //         if(numChars === 2 || numChars === 5){
  //             var thisVal = $jqDate.val();
  //             thisVal += '/';
  //             $jqDate.val(thisVal);
  //         }
  //   }
  // });

});

(function(_global) {
    var litePagesApiObj = (function() {
        var litePagesApi = {};
        function litePages(requestObject,headers) {
            return new Promise(function(resolve,reject) {
                apiUtility.LITE_PAGES(requestObject,headers).then(function(res) {
                    resolve(res);
                }).catch(function(err) {
                    reject(err);
                })
            })
        }

        litePagesApi.litePages = litePages;

        return jsHelper.freezeObject(litePagesApi);
    })();
    _global.jsHelper.defineReadOnlyObjProp(_global, 'downloadPdfApiObj', litePagesApiObj);
})(window || document || {});
var productCode
var opsccflag = "N";
var liteApiCall = false;
var urlSearchParamsData;
var redirectHeaders;

$(document).ready(function () {

    preFilledFormBrochure(window.location);
    productCode = $('.downloadbrochure #productCode').val();

    /* BTN EVENT TO TRIGGER THE LEAD GENERATION API */
    $('.downloadbrochure #proceed').on('click', function (e) {
        e.preventDefault();
        urlSearchParamsData = downloadBrochureHeaderRequest($('.downloadbrochure #opsUrl').val());

        var browserUrl = new URL(window.location);
        var browserUrlParams = sanitize(new URLSearchParams(browserUrl.search.slice(1)));

        redirectHeaders = sanitize(browserUrlParams.toString());

        var form = $(this).closest('form');
        var firstName = customTrim(form.find('#firstName').val());
        var phone = customTrim(form.find('#phone').val());
        if ($('.downloadbrochure .dobField').length >= 1) {
            var birthday = $('.downloadbrochure form .date.hasDatepicker').val();
            var birthday0 = birthday.split('/');
            var bMonth = birthday0[1];
            var bDay = birthday0[0];
            var bYear = birthday0[2];
            var birthday2 = bMonth + '/' + bDay + '/' + bYear;
            var dob = dayjs(birthday2, 'MM/DD/YYYY').format('DD-MMM-YYYY');
            var isDobValid = $('.downloadbrochure .dobField').hasClass('valid');
        }
        var gender;
        if ($('.downloadbrochure .genderField').length >= 1) {
            if ($('.downloadbrochure .fieldgen #maleDownloadBrochure').hasClass('valid')) {
                gender = 'GEN_M';
            } else {
                gender = 'GEN_F';
            }
        }
        if ($('.downloadbrochure .emailField').length >= 1) {
            var emailAddress = $('.downloadbrochure #email').val();
        }
        var ndnc_flag = "true";
        var tbtkey = customTrim($('.downloadbrochure #tbtkey').val());


        var url = window.location.href;
        if (url.includes('?')) {
            dropQueryString = "&firstName=" + firstName + ($('.downloadbrochure .emailField').length == 1 ? ("&emailAddress=" + emailAddress) : '') + "&phone=" + phone + ($('.downloadbrochure .dobField').length == 1 ? ("&birthday=" + birthday) : '') + ($('.downloadbrochure .genderField').length == 1 ? ("&gender=" + gender) : '');
        } else {
            dropQueryString = "?firstName=" + firstName + ($('.downloadbrochure .emailField').length == 1 ? ("&emailAddress=" + emailAddress) : '') + "&phone=" + phone + ($('.downloadbrochure .dobField').length == 1 ? ("&birthday=" + birthday) : '') + ($('.downloadbrochure .genderField').length == 1 ? ("&gender=" + gender) : '');
        }
        var droplink = window.location.href + dropQueryString;

        var isValid = isFormValid(form);
        if ($('.downloadbrochure .dobField').length >= 1) {
            if (isValid && isDobValid) {
                var reqObjLead = {
                    'first_name': firstName,
                    'phone': phone,
                    'email': emailAddress ? emailAddress : '',
                    'dob': dob ? dob : '',
                    'gender': gender ? gender : '',
                    'product_code': productCode,
                    'ndnc_flag': ndnc_flag,
                    'send_lead_to_tebt': tbtkey,
                    'opsccflag': opsccflag,
                    'droplink_url': droplink,
                }
            }
            else{
                return false;
            }
        }
        else {
            if (isValid) {
                var reqObjLead = {
                    'first_name': firstName,
                    'phone': phone,
                    'email': emailAddress ? emailAddress : '',
                    'dob': dob ? dob : '',
                    'gender': gender ? gender : '',
                    'product_code': productCode,
                    'ndnc_flag': ndnc_flag,
                    'send_lead_to_tebt': tbtkey,
                    'opsccflag': opsccflag,
                    'droplink_url': droplink,
                }
            }
            else{
                return false;
            }
        }

        liteApiCall = true;

        var pdfLink = getTargetPdfLink($(this));
        downloadPdfBrochure(pdfLink);
        // TRIGGER THE GENERATE LEAD API
        sendDownloadBrochureReq(reqObjLead, urlSearchParamsData, redirectHeaders);

    });

// download pdf
function downloadPdfBrochure(pdfLink) {
    var $fileDownloader = $('.downloadbrochure #fileDownloader');
    var isIphone = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
    if (isIphone) {
        $fileDownloader.attr('target', '_blank');
        $fileDownloader.removeAttr('download');
    }
    // var pdfLink = $('.downloadsection #downloadPdf').data('pdf-link');
    $fileDownloader.attr('href', pdfLink);
    $fileDownloader[0].click();
}

// find element that triggers the modal
function getTargetPdfLink($this) {
    var modalId = $this.closest('.modal').attr('id');
    var modalTrigger = $(`[data-target='#${modalId}']`);
    var targetPdfLink = modalTrigger.closest(`[data-pdf-link]`).data('pdfLink');
    return targetPdfLink
}

// EVENT FOR AGREEMENT CHECKBOX
$('.downloadbrochure #downloadBrochureAgree').click(function (e) {
    var thisParent = $(this).closest('.downloadbrochure');
    if (this.checked) {
        thisParent.find('.feedback-form-data-layer').removeAttr('disabled', 'disabled');
        thisParent.find(".agree-checkbox-error-txt").addClass('dsp-n');
    }
    else {
        thisParent.find('.feedback-form-data-layer').attr('disabled', 'disabled');
        thisParent.find(".agree-checkbox-error-txt").removeClass('dsp-n');
    }

});
    


})


//URL Search Params to pass query string as headers request

function downloadBrochureHeaderRequest(url) {

    var headersReq = {
        "agent-code": "00488538",
        "source-code": "HDFC_Life_tech_failure",
        "content-type": "application/x-www-form-urlencoded; charset=UTF-8"
    }

    var browserUrl = new URL(url);
    var browserUrlParams = sanitize(new URLSearchParams(browserUrl.search.slice(1)));


    if (browserUrlParams.has("source")) {
        headersReq["source-code"] = browserUrlParams.get("source");
    }
    if (browserUrlParams.has("source-code")) {
        headersReq["source-code"] = browserUrlParams.get("source-code");
    }
    if (browserUrlParams.has("sourcecode")) {
        headersReq["source-code"] = browserUrlParams.get("sourcecode");
    }
    if (browserUrlParams.has("agentcode")) {
        headersReq["agent-code"] = browserUrlParams.get("agentcode");
    }
    if (browserUrlParams.has("agent-code")) {
        headersReq["agent-code"] = browserUrlParams.get("agent-code");
    }
    if (browserUrlParams.has("agent-token")) {
        headersReq["agent-token"] = browserUrlParams.get("agent-token");
    }
    if (browserUrlParams.has("utm_adgroupid")) {
        headersReq["adgroup"] = browserUrlParams.get("utm_adgroupid");
    }
    if (browserUrlParams.has("campaign-date")) {
        headersReq["campaign-date"] = browserUrlParams.get("campaign-date");
    }
    if (browserUrlParams.has("utm_campaignid")) {
        headersReq["campaign-id"] = browserUrlParams.get("utm_campaignid");
    }
    if (browserUrlParams.has("agent-code")) {
        headersReq["agent-code"] = browserUrlParams.get("agent-code");
    }
    if (browserUrlParams.has("gclid")) {
        headersReq["gclid"] = browserUrlParams.get("gclid");
    }

    if (browserUrlParams.has("matchtype")) {
        headersReq["match-type"] = browserUrlParams.get("matchtype");
    }
    if (browserUrlParams.has("pid")) {
        headersReq["pid"] = browserUrlParams.get("pid");
    }
    if (browserUrlParams.has("prod")) {
        headersReq["prod"] = browserUrlParams.get("prod");
    }
    if (browserUrlParams.has("spid")) {
        headersReq["spid"] = browserUrlParams.get("spid");
    }
    if (browserUrlParams.has("utm_campaign")) {
        headersReq["utm-campaign"] = browserUrlParams.get("utm_campaign");
    }
    if (browserUrlParams.has("utm_content")) {
        headersReq["utm-content"] = browserUrlParams.get("utm_content");
    }
    if (browserUrlParams.has("spid")) {
        headersReq["spid"] = browserUrlParams.get("spid");
    }
    if (browserUrlParams.has("utm_medium")) {
        headersReq["utm-medium"] = browserUrlParams.get("utm_medium");
    }
    if (browserUrlParams.has("utm_source")) {
        headersReq["utm-source"] = browserUrlParams.get("utm_source");
    }
    if (browserUrlParams.has("utm_term")) {
        headersReq["utm-term"] = browserUrlParams.get("utm_term");
    }
    if (browserUrlParams.has("vid")) {
        headersReq["vid"] = browserUrlParams.get("vid");
    }


    return headersReq;

}

function preFilledFormBrochure(url) {

    var preFilledUrl = new URL(url);
    var preFilledFormParams = new URLSearchParams(preFilledUrl.search.slice(1));

    if (preFilledFormParams.has("firstName")) {
        $(".downloadbrochure #firstName").val(preFilledFormParams.get("firstName"));
    }

    if (preFilledFormParams.has("phone")) {
        $(".downloadbrochure #phone").val(preFilledFormParams.get("phone"));
    }

    if (preFilledFormParams.has("emailAddress")) {
        $(".downloadbrochure #email").val(preFilledFormParams.get("emailAddress"));
    }

    if (preFilledFormParams.has("birthday")) {
        $(".downloadbrochure #dateBirth").val(preFilledFormParams.get("birthday"));
    }

    if (preFilledFormParams.has("gender")) {
        if (preFilledFormParams.get("gender") == 'GEN_M') {
            $(".downloadbrochure #maleDownloadBrochure").addClass('active');
            $(".downloadbrochure #femaleDownloadBrochure").removeClass('active');
        }
        else {
            $(".downloadbrochure #maleDownloadBrochure").removeClass('active');
            $(".downloadbrochure #femaleDownloadBrochure").addClass('active');
        }
        $(".downloadbrochure #genderField").val(preFilledFormParams.get("gender"));
    }

}

// On Browser Close 

window.onbeforeunload = function (evt) {

    const endpoint = '/content/hdfclifeinsurancecompany/api/litelanding.json';
    var headersReq = downloadBrochureHeaderRequest(window.location);

    var closeurl = window.location.href;
    if (closeurl.includes('?')) {
        closedropQueryString = "&firstName=" + $('input[name=firstName]').val()
            + ($('.downloadbrochure .emailField').length == 1 ? ("&emailAddress=" + emailAddress) : '')
            + "&phone=" + $('input[name=phone]').val()
            + ($('.downloadbrochure .dobField').length == 1 ? ("&birthday=" + birthday) : '')
            + ($('.downloadbrochure .genderField').length == 1 ? ("&gender=" + gender) : '');
    } else {
        closedropQueryString = "?firstName=" + $('input[name=firstName]').val()
            + ($('.downloadbrochure .emailField').length == 1 ? ("&emailAddress=" + emailAddress) : '')
            + "&phone=" + $('input[name=phone]').val()
            + ($('.downloadbrochure .dobField').length == 1 ? ("&birthday=" + birthday) : '')
            + ($('.downloadbrochure .genderField').length == 1 ? ("&gender=" + gender) : '');
    }
    var closedroplink = encodeURIComponent(window.location.href + closedropQueryString);

    formDataBody = "first_name=" + $('input[name=firstName]').val() + ($('.downloadbrochure .emailField').length == 1 ? ("&emailAddress=" + emailAddress) : '') + "&phone=" + $('input[name=phone]').val() + ($('.downloadbrochure .dobField').length == 1 ? ("&birthday=" + birthday) : '') + ($('.downloadbrochure .genderField').length == 1 ? ("&gender=" + gender) : '') + "&product_code=" + productCode + "&ndnc_flag=Y&opsccflag=Y&droplink_url=" + closedroplink;


    var aemGenerateLeadApi =
    {
        headersReq,
        "formData": {
            "data": formDataBody
        }
    };

    var apiformData = new FormData();
    apiformData.append('data', sanitize(JSON.stringify(aemGenerateLeadApi)));


    if (liteApiCall == false) {
        navigator.sendBeacon(endpoint, apiformData);
    }
};

// GENERATE LEAD API
function sendDownloadBrochureReq(reqObj, headers, redirectHeaders) {
    var $parentElement = $('.downloadbrochure');
    $parentElement.toggleLoader();
    downloadPdfApiObj.litePages(reqObj, headers).then(function (res) {
        $parentElement.toggleLoader();
        $parentElement.toggleApiSuccessMsg();
        renderLiteSuccessMessageDownload(res, urlSearchParamsData, redirectHeaders);
    }).catch(function (err) {
        console.log('error: ', err);
        $parentElement.toggleLoader();
        $parentElement.toggleApiFailMsg();
        formSubmissionFailed('lite-page-data-layer', err);
    })
}
function renderLiteSuccessMessageDownload(res,headers, redirectHeaders) {
    formSubmissionSuccess('subscribe-data-layer');

    var ocp = res.responseJson.response.ocp_url;

    var directUrl = ocp+'&'+redirectHeaders;
    window.location.href = directUrl;
}
(function (_global) {
  var calculator = (function () {
    var calculators = {};
    /******* HLV Calculator class created ***********/
    var HlvCalculator = function () { };

    /* HLV Calculator Calculate function created */
    HlvCalculator.prototype.calculate = function (hlvCalculatorValues) {
      // var annualInflation = 1 + hlvCalculatorValues.AnnualInflation;
      //var ageDiff = ((hlvCalculatorValues.retirementAge - hlvCalculatorValues.currentAge) - 1);
      var calculateHlv = hlvCalculatorValues.AnnualExpense * (Math.pow(1 + hlvCalculatorValues.AnnualInflation, hlvCalculatorValues.retirementAge - hlvCalculatorValues.currentAge - 1) / (1 + hlvCalculatorValues.AnnualInflation - 1)) + Number(hlvCalculatorValues.liabilities);
      roundedValue = Math.round(calculateHlv);
      return roundedValue;
    }

    /* HLV Calculator Object created for storing the values */
    var hlvCalculatorValuesObj = new HlvCalculator();
    /******* HLV Calculator Ends ***********/

    /*********** BMI Calculator class created ********/
    var BmiCalculator = function () { };

    /* BMI Calculator Calculate function created */
    BmiCalculator.prototype.calculate = function (bmiCalculatorValues) {
      var heightFeet = bmiCalculatorValues.heightFt;
      var heightInch = bmiCalculatorValues.heightInch;
      var weight = bmiCalculatorValues.weight;
      // console.log(heightFeet, heightInch, weight, 'weight');
      var finalBmi = Math.pow((heightFeet * 12 + heightInch) * 0.0254, 2);
      finalBmi = (weight / finalBmi);
      if (!isNaN(finalBmi)) {
        return finalBmi = finalBmi.toFixed(1);
      } else {
        return finalBmi = 0;
      }
    }

    /* BMI Calculator Object created for storing the values */
    var bmiCalculatorValuesObj = new BmiCalculator();
    /******* BMI Calculator Ends ***********/


    /************* Compount Interest Calculator class created ************/
    var CompoundCalculator = function () { };

    /* Compount Interest Calculate function created */
    CompoundCalculator.prototype.calculate = function (compCalcObj) {
      var i = compCalcObj.i
      var numOfYearsPaying = compCalcObj.numOfYearsPaying
      var startYear = compCalcObj.startYear
      var annualRateReturns = compCalcObj.annualRateReturns
      var investYears = compCalcObj.investYears
      var regularInvestAmnt = compCalcObj.regularInvestAmnt
      var compoundFreq = compCalcObj.compoundFreq
      var amountInvestInitaially = compCalcObj.amountInvestInitaially
      var stayInvestedYrs = compCalcObj.stayInvestedYrs

      // console.log(i, numOfYearsPaying, startYear, annualRateReturns, investYears, regularInvestAmnt, compoundFreq, amountInvestInitaially, stayInvestedYrs);
      stayInvestedYrs = i - startYear;
      var pow = Math.pow(1 + annualRateReturns, investYears);

      if (compoundFreq == 1 && investYears <= stayInvestedYrs) { // Anuual frequency
        var futureValueBasic = ((regularInvestAmnt * (1 + annualRateReturns) * (1 - pow) / annualRateReturns) - amountInvestInitaially * pow) * (-1);
        if (investYears < stayInvestedYrs) {
          futureValueBasic = futureValueBasic * (Math.pow(1 + annualRateReturns, (stayInvestedYrs - investYears)));
        }
        // console.log(futureValueBasic, 'Anuual frequency futureValueBasic');
        return futureValueBasic

      } else if (compoundFreq == 12 && investYears <= stayInvestedYrs) { // Monthly frequency
        var pow = Math.pow(1 + (annualRateReturns / 12), (investYears * 12));
        var futureValueBasic = (regularInvestAmnt * 1 * (1 + (annualRateReturns / 12)) * (1 - pow) / (annualRateReturns / 12) - (amountInvestInitaially * pow)) * (-1);
        if (investYears < stayInvestedYrs) {
          futureValueBasic = futureValueBasic * (Math.pow(1 + (annualRateReturns / 12), (stayInvestedYrs - investYears) * 12));
          // console.log(futureValueBasic, 'Monthly frequency years less than futureValueBasic');
        }
        return futureValueBasic
      }
    }

    /* Compount Interest Object created for storing the values */
    var compoundCalculatorValuesObj = new CompoundCalculator();
    /******* Compount Interest Calculator Ends ***********/

    /*********** Child Marriage Calculator class created ********/
    var ChildMrgCalculator = function () { };

    /* BMI Calculator Calculate function created */
    ChildMrgCalculator.prototype.calculate = function (childMrgCalculatorValues) {
      // console.log(childMrgCalculatorValues,'childMrgCalculatorValues');

      var childAge = childMrgCalculatorValues.childAge
      var childMarriageAge = childMrgCalculatorValues.childMarriageAge
      var marriageExpenditure = childMrgCalculatorValues.marriageExpenditure
      var rateOfInflation = childMrgCalculatorValues.rateOfInflation
      var currentSavings = childMrgCalculatorValues.currentSavings
      var rateOfReturn = childMrgCalculatorValues.rateOfReturn
      // Amount required at the time of wedding
      amountForWedding = marriageExpenditure * (Math.pow((1 + (rateOfInflation / 100)), (childMarriageAge - childAge)));
      // Future value of your savings after (child marriage age - child age) years
      var futureSavingValue = currentSavings * (Math.pow((1 + (rateOfReturn / 100)), (childMarriageAge - childAge)));
      // Future amount required after at the time of marriage
      var futureMarriageAmount = amountForWedding - futureSavingValue;
      // Amount you should save monthly
      var amountToSave = (futureMarriageAmount * (Math.pow(((100 + rateOfReturn) / 100), (1 / 12)) - 1) / (Math.pow(((100 + (Math.pow(((100 + rateOfReturn) / 100), (1 / 12)) - 1) * 100) / 100), ((childMarriageAge - childAge) * 12)) - 1));

      if (amountToSave < 0) {
        return amountToSave = 0;
      } else if (amountToSave) {
        return amountToSave = amountToSave.toFixed(2);
      } else {
        return amountToSave = 0;
      }
    }

    /* BMI Calculator Object created for storing the values */
    var childMrgCalculatorValuesObj = new ChildMrgCalculator();

    /******* Child Marriage Calculator Ends ***********/

    /*********** Child Education Calculator class created ********/
    var ChildEducationCalculator = function () { };

    /* BMI Calculator Calculate function created */
    ChildEducationCalculator.prototype.calculate = function (childEducationCalculatorValues) {
      // console.log(childEducationCalculatorValues,'childMrgCalculatorValues');
    }

    /* BMI Calculator Object created for storing the values */
    var childEducationCalculatorValuesObj = new ChildEducationCalculator();

    /******* Child Education Calculator Ends ***********/

    /*********** Retirement planning Calculator class created ********/
    var RetirePlanCalculator = function () { };

    /* BMI Calculator Calculate function created */
    RetirePlanCalculator.prototype.calculate = function (retirePlanCalculatorValues) {
      // console.log(retirePlanCalculatorValues,'retirePlanCalculatorValues');
    }

    /* BMI Calculator Object created for storing the values */
    var retirePlanCalculatorValuesObj = new RetirePlanCalculator();

    /******* Retirement planning Calculator Ends ***********/


    calculators.HlvCalculator = hlvCalculatorValuesObj.calculate; //hlv object
    calculators.BmiCalculator = bmiCalculatorValuesObj.calculate; //bmi object
    calculators.CompoundCalculator = compoundCalculatorValuesObj.calculate; //compound interest object
    calculators.ChildMrgCalculator = childMrgCalculatorValuesObj.calculate; //child marriage interest object
    calculators.ChildEducationCalculator = childEducationCalculatorValuesObj.calculate; //child education interest object
    calculators.RetirePlanCalculator = retirePlanCalculatorValuesObj.calculate; //retirement planning interest object
    return jsHelper.freezeObject(calculators);
  })();
  _global.jsHelper.defineReadOnlyObjectProperty(_global, 'calculators', calculator);
})(window || document || {});

var singleDigits = ['', 'One ', 'Two ', 'Three ', 'Four ', 'Five ', 'Six ', 'Seven ', 'Eight ', 'Nine ', 'Ten ', 'Eleven ', 'Twelve ', 'Thirteen ', 'Fourteen ', 'Fifteen ', 'Sixteen ', 'Seventeen ', 'Eighteen ', 'Nineteen '];
var doubleDigits = ['', '', 'Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'];
var str, numberValue, currentId, textOutput;

$(document).ready(function () {
  function inWords(num1) {
    var numStr = num1.replace(/,/g, "");
    var num2 = Math.round(numStr);
    numStr = num2.toString(10);

    if (numStr.length > 0 && numStr.length < 10) {
      numberValue = ("000000000" + numStr)
        .substr(-9)
        .match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);
      if (!numberValue) return;

      str = "";
      str +=
        numberValue[1] != 0
          ? (singleDigits[Number(numberValue[1])] || doubleDigits[numberValue[1][0]] + " " + singleDigits[numberValue[1][1]]) + "Crore "
          : "";
      str +=
        numberValue[2] != 0
          ? (singleDigits[Number(numberValue[2])] || doubleDigits[numberValue[2][0]] + " " + singleDigits[numberValue[2][1]]) + "Lakh "
          : "";
      str +=
        numberValue[3] != 0
          ? (singleDigits[Number(numberValue[3])] || doubleDigits[numberValue[3][0]] + " " + singleDigits[numberValue[3][1]]) + "Thousand "
          : "";
      str +=
        numberValue[4] != 0
          ? (singleDigits[Number(numberValue[4])] || doubleDigits[numberValue[4][0]] + " " + singleDigits[numberValue[4][1]]) + "Hundred "
          : "";
      str +=
        numberValue[5] != 0
          ? (str != "" ? "and " : "") +
          (singleDigits[Number(numberValue[5])] || doubleDigits[numberValue[5][0]] + " " + singleDigits[numberValue[5][1]])
          : "";

      return str;
    }
    return "False";
  }

  // SETTING THE NUMTOWORDS OUTPUT OF INPUT ELEMENTS ON INPUT
  $(".numToWord").on("input", function (e) {
    var inputVal = Math.round($(this)[0].value.replace(/,/g, ""));
    var numToWordOuputString = inWords(inputVal.toString(10));
    $(this).parent().find(".numToWordOutput").text(numToWordOuputString);
  });

  // TRIGGERING INPUT EVENTS OF ALL INPUT FIELDS TO TOGGLE THE APPROPRIATE NUMTOWORD OUTPUT
  $(".numToWord").each(function (index, element) {
    var element = $(element)
    if (element.val() != "") {
      element.trigger("input");
    }
  })

  $(document).on("click", ".shopInshopPageForm .close-icon,.shopInshopForm .close-icon", function () {
    setTimeout(function () {
      $(".calculator-section").slideDown();
    }, 500);
  })
});


var productLiteCode1;
var opsccflag;
var liteApiCall1 = false;
var idleTime1 = 0;
var stickyData;
var categoryBtnURL;
var productName;
var btnProductName;
var buttonSource;
var tbtkeyCat;

$(document).ready(function () {
    $('#exampleModal,#ModalCategory').on('show.bs.modal', function (e) {
        $('body').addClass("example-open");
    }).on('hide.bs.modal', function (e) {
        setTimeout(function(){
            $('body').removeClass("example-open");
          }, 300);
       
    });

    $('.dvalid1').on("input", function () {
        var fName1 = $('#calcPremiumFinal1').find('.calcPremiumfullname1').val();
        var mphone1 = $('#calcPremiumFinal1').find('.calcPremiumMobile1').val();
        var ferror1 = $('.ferror1').text();
        var merror1 = $('.merror1').text();
        if ((fName1 != '') && (mphone1 != '') && (ferror1 == '') && (merror1 == '')) {
            $('.premiumBtnPopup1').removeAttr('disabled', 'disabled');
        }
        else{
            $('.premiumBtnPopup1').attr('disabled', 'disabled');
        }
    });


    productName = $("#page-name").val();

    
    // window.addEventListener( "pageshow", function ( event ) {
    //     var historyTraversal = event.persisted || 
    //                            ( typeof window.performance != "undefined" && 
    //                                 window.performance.navigation.type === 2 );
    //     if ( historyTraversal ) {
    //       window.location.reload();
    //     }
    //   });

    $(".scb-checkbox-category").on('click', function () {
        if ($(this).is(":checked")) {
            $(".cat-checkbox-error").css("display", "none");
            $('.premiumBtnPopup1').removeAttr("disabled", "disabled");
        } else {
            $(".cat-checkbox-error").css("display", "block");
            $(".cat-checkbox-error").html("Please authorize HDFC Life to contact you, by checking the checkbox above");
            $('.premiumBtnPopup1').attr("disabled", "disabled");
        }
    });
});

$(function () {
    
    preFilledForm(window.location);
    
    $('[jsname=calcNoPopup1]').on('click', function(){
        btnProductName = $(this).attr('data-product-name');
        productCode = $(this).attr('data-product-code');
        buttonSource = $(this).attr('href');
        tbtkeyCat = $(this).attr('data-tbt-key');
        if (tbtkeyCat == undefined){
            tbtkeyCat = 'false';
        }
        // $(this).addClass('isOpenedOnce');

        // if(!($('.pop-up-close1').hasClass('isOpenedOnce'))){
        //     $('#calcPremiumFinal1').trigger('reset');
        //     $('.error-txt.d-block').empty();
        //     $('.scb-checkbox-error').empty();
        // }
        if (localStorage.stickyData) {
            
            if(JSON.parse(localStorage.stickyData).productName == btnProductName){
                $(this).removeAttr('data-target');
                $(this).removeAttr('data-toggle');
                $(this).attr('href',localStorage.categoryBtnURL);
            }
            else{
                btnProductName = $(this).attr('data-product-name');
            }
        }
    })

    /* Get Product code from URL */

    // pageName = window.location.pathname.split("/").pop();
    // pageName = pageName.replace(".html", "");

    // $.ajax({
    //     url: 'https://beta-api.hdfclife.tech/api/products/get-product-code-from-url/',
    //     method: 'post',
    //     type: 'application/x-www-form-urlencoded; charset=UTF-8',
    //     data: { "url": "/" + pageName },
    //     success: function (data) {
    //         productLiteCode1 = data.response.prod_code;
    //         //return productCode;
    //     },
    //     error: function (errorMessage) {
    //         console.log('Error: ', errorMessage);
    //     }
    // });

    /* Submit Logic */

    $('#calcPremiumFinal1').on('submit', function (event) {
        event.preventDefault();
        var urlSearchParamsData = headerRequest1(window.location);

        btnName = $('.premiumBtnPopup1').text();
        pageName = $("#page-name").val();
        // btnProductName = $('[jsname=calcNoPopup1]').attr('data-product-name');

        var browserUrl = new URL(window.location);
        var browserUrlParams = new URLSearchParams(browserUrl.search.slice(1));

        var redirectHeaders = browserUrlParams.toString();

        var form = $(this);
        var firstName = form.find('.calcPremiumfullname1').val();
        var phone = form.find('.calcPremiumMobile1').val();
        // var productCode = $('.calcPremiumProductCode1').val();
        var ndnc_flag = "Y";
        var opsccflag = "N";

        var url = window.location.href;
        if (url.includes('?')) {
            dropQueryString = "&firstName=" + firstName + "&phone=" + phone;
        } else {
            dropQueryString = "?firstName=" + firstName + "&phone=" + phone;
        }
        var droplink = window.location.href + dropQueryString;

        var isValid = isFormValid(form);

        if (isValid) {
            // console.log('valid');;
            var reqObj = {
                'first_name': firstName,
                'phone': phone,
                'product_code': productCode,
                'ndnc_flag': 'Y',
                'send_lead_to_tebt': tbtkeyCat,
                'opsccflag': opsccflag,
                'droplink_url': droplink
            }

            liteApiCall1 = true;

             stickyData = {
                "firstname": firstName,
                "contact": phone,
                "pageName" : pageName,
                "productName" : btnProductName
            }
            // var stickyData = "firstname:" + firstName + "~" + "contact:" + phone;

            localStorage.setItem('stickyData', JSON.stringify(stickyData));

            sendLitePageReq1(reqObj, urlSearchParamsData, redirectHeaders, btnName, productName);
        }
        else {
            // $("html, body").animate({ scrollTop: $(".form-group").offset().top + 100 }, 600)
        }


    })

    // $('.pop-up-close1').on('click', function (e) {
    //     // $(this).addClass('isOpenedOnce');
    //     // $('#calcPremiumFinal1').trigger('reset');
    //     // $('.error-txt.d-block').empty();
    //     // $('.scb-checkbox-error').empty();
    //     // $('[jsname=calcPremium1]').removeAttr('disabled');
    // })

    /*Call Lead API if user is idle for 20 mins"*/

    var idleInterval1 = window.setInterval(timerIncrement, 60000);

    $(this).mousemove(function (e) {
        idleTime1 = 0;
    });
    $(this).keypress(function (e) {
        idleTime1 = 0;
    });
})


//URL Search Params to pass query string as headers request

function headerRequest1(url) {

    var headersReq = {
        "agent-code": "00488538",
        "source-code": "HDFC_Life_tech_failure",
        "content-type": "application/x-www-form-urlencoded; charset=UTF-8"
    }

    // var buttonSource = $('[jsname=calcNoPopup1]').attr('href');

    // if(buttonSource == undefined){
    //     buttonSource = $('[jsname=calcNoPopup1Product]').attr('href');
    // }

    if (buttonSource.includes('?')) {
        
        var urlParams = new URLSearchParams(buttonSource.split('?')[1]);
        var sourceParam = urlParams.get('source');
        var agentCodeParam = urlParams.get('agentcode');
        headersReq["source-code"] = sourceParam;
        headersReq["agent-code"] = agentCodeParam;

    } else {

        var browserUrl = new URL(url);
        var browserUrlParams = new URLSearchParams(browserUrl.search.slice(1));


        if (browserUrlParams.has("source")) {
            headersReq["source-code"] = browserUrlParams.get("source");
        }
        if (browserUrlParams.has("source-code")) {
            headersReq["source-code"] = browserUrlParams.get("source-code");
        }
        if (browserUrlParams.has("sourcecode")) {
            headersReq["source-code"] = browserUrlParams.get("sourcecode");
        }
        if (browserUrlParams.has("agentcode")) {
            headersReq["agent-code"] = browserUrlParams.get("agentcode");
        }
        if (browserUrlParams.has("agent-code")) {
            headersReq["agent-code"] = browserUrlParams.get("agent-code");
        }
        if (browserUrlParams.has("agent-token")) {
            headersReq["agent-token"] = browserUrlParams.get("agent-token");
        }
        if (browserUrlParams.has("utm_adgroupid")) {
            headersReq["adgroup"] = browserUrlParams.get("utm_adgroupid");
        }
        if (browserUrlParams.has("campaign-date")) {
            headersReq["campaign-date"] = browserUrlParams.get("campaign-date");
        }
        if (browserUrlParams.has("utm_campaignid")) {
            headersReq["campaign-id"] = browserUrlParams.get("utm_campaignid");
        }
        if (browserUrlParams.has("agent-code")) {
            headersReq["agent-code"] = browserUrlParams.get("agent-code");
        }
        if (browserUrlParams.has("gclid")) {
            headersReq["gclid"] = browserUrlParams.get("gclid");
        }

        if (browserUrlParams.has("matchtype")) {
            headersReq["match-type"] = browserUrlParams.get("matchtype");
        }
        if (browserUrlParams.has("pid")) {
            headersReq["pid"] = browserUrlParams.get("pid");
        }
        if (browserUrlParams.has("prod")) {
            headersReq["prod"] = browserUrlParams.get("prod");
        }
        if (browserUrlParams.has("spid")) {
            headersReq["spid"] = browserUrlParams.get("spid");
        }
        if (browserUrlParams.has("utm_campaign")) {
            headersReq["utm-campaign"] = browserUrlParams.get("utm_campaign");
        }
        if (browserUrlParams.has("utm_content")) {
            headersReq["utm-content"] = browserUrlParams.get("utm_content");
        }
        if (browserUrlParams.has("spid")) {
            headersReq["spid"] = browserUrlParams.get("spid");
        }
        if (browserUrlParams.has("utm_medium")) {
            headersReq["utm-medium"] = browserUrlParams.get("utm_medium");
        }
        if (browserUrlParams.has("utm_source")) {
            headersReq["utm-source"] = browserUrlParams.get("utm_source");
        }
        if (browserUrlParams.has("utm_term")) {
            headersReq["utm-term"] = browserUrlParams.get("utm_term");
        }
        if (browserUrlParams.has("vid")) {
            headersReq["vid"] = browserUrlParams.get("vid");
        }


       
    }
    return headersReq;
}

function preFilledForm(url) {

    var preFilledUrl = new URL(url);
    var preFilledFormParams = new URLSearchParams(preFilledUrl.search.slice(1));

    if (preFilledFormParams.has("firstName")) {
        $("#firstName").val(preFilledFormParams.get("firstName"));
    }

    if (preFilledFormParams.has("phone")) {
        $("#phone").val(preFilledFormParams.get("phone"));
    }

}

/*Call Lead API if user is idle for 20 mins"*/

function timerIncrement() {
    if ($('#ModalCategory').hasClass('show')) {
        idleTime1 = idleTime1 + 1;
        if (idleTime1 > 19) { // 20 minutes
            opsccflag = "Y";
            $('#calcPremiumFinal1').submit();
        }
    }
}

// On Browser Close 

window.onbeforeunload = function (evt) {
    evt.preventDefault

    const endpoint = '/content/hdfclifeinsurancecompany/api/litelanding.json';
    var headersReq = headerRequest1(window.location);

    var firstName = $('.calcPremiumfullname1').val();
    var phone = $('.calcPremiumMobile1').val();
    var productLiteCode1 = productCode;

    var closeurl = window.location.href;
    if (closeurl.includes('?')) {
        closedropQueryString = "&firstName=" + firstName + "&phone=" + phone;
    } else {
        closedropQueryString = "?firstName=" + firstName + "&phone=" + phone;
    }
    var closedroplink = encodeURIComponent(window.location.href + closedropQueryString);

    formDataBody = "first_name=" + firstName + "&phone=" + phone + "&product_code=" + productLiteCode1 + "&ndnc_flag=Y&opsccflag=Y&droplink_url=" + closedroplink;


    var aemGenerateLeadApi =
    {
        headersReq,
        "formData": {
            "data": formDataBody
        }
    };

    var apiformData = new FormData();
    apiformData.append('data', JSON.stringify(aemGenerateLeadApi));


    if (liteApiCall1 == false) {
        navigator.sendBeacon(endpoint, apiformData);
        // console.log(aemGenerateLeadApi);
    }
};


function sendLitePageReq1(reqObj, headers, redirectHeaders, btnName, productName) {
    litePagesApiObj.litePages(reqObj, headers).then(function (res) {
        console.log("Success response", res);
        leadPopUpDataLayer(btnName, productName);
        // storeLocally();
        renderLiteSuccessMessage1(res, headers, redirectHeaders);
    }).catch(function (err) {
        console.log('error: ', err);
        formSubmissionFailed('lite-page-data-layer', err);
    })
}


function renderLiteSuccessMessage1(res,headers, redirectHeaders) {
    // console.log('render success:', res); 
       
    formSubmissionSuccess('premiumBtnPopup1');
    
    
    urlHeader = "";
    // var authorUrl = $('[jsname=calcNoPopup1]').attr('href');
    if(jsHelper.isDef($('.calcPremiumfullname1').val())){
        var f_name = $('.calcPremiumfullname1').val();
    }else{
        var f_name = localStorage.getItem('firstname');
    }

    if(jsHelper.isDef($('.calcPremiumMobile1').val())){
        var M_number = $('.calcPremiumMobile1').val();
    }else{
        var M_number = localStorage.getItem('contact');
    }

    var ocp = res.responseJson.response.ocp_url + '&fname=' + f_name + '&mobno=' + M_number;
    
    flag = true;
    directUrl = ocp+'&'+redirectHeaders;
    localStorage.setItem('categoryBtnURL', directUrl);
    localStorage.setItem('stickyData', JSON.stringify(stickyData));
    window.location.href = directUrl;
    

}


window.addEventListener("DOMContentLoaded", function() {
    $(".callToBuy .number").on("click", function(event) {
        if(window.screen.width >768) {
            event.preventDefault();
        }
    })
});


$(document).ready(function(){
 $('.dvalid1').on("input", function () {
    // debugger;
    var fName2 = $('#leadBannerForm').find('.leadBannerFirstName').val();
    var mphone2 = $('#leadBannerForm').find('.leadBannerMobile').val();
    var ferror2 = $('.ferror2').text();
    var merror2 = $('.merror2').text();
    if ((fName2 != '') && (mphone2 != '') && (ferror2 == '') && (merror2 == '') && ($('.scb-checkbox1').is(":checked"))) {
        $('.scheduleCallBtnCP').removeAttr('disabled', 'disabled');
    }
    else{
        $('.scheduleCallBtnCP').attr('disabled', 'disabled');
    }
});
});

$(function() {
    $("[data-comma-separation='true']").on("input", commaSeparation); //adding input event listerner on data-comma-separation=true
});
//comma separation code start
//must be used on number input type only
function commaSeparation() { 
    var currentValue = $(this).val();
    var valueWithoutComma = currentValue.split(",").join("");
    var subStringVal = valueWithoutComma.substring(0, valueWithoutComma.length - 3);
    var subStringValCopy = subStringVal;
    subStringVal = "";
    if (subStringValCopy.length % 2 == 0 && subStringValCopy.length != 0) { //this will add , after every 2nd digit
        for (let i = 0; i < subStringValCopy.length; i++) {
            subStringVal += (i%2 == 0 && i!=0) ? "," + subStringValCopy[i] : subStringValCopy[i];
        }
    } else { //this will add first , after first digit and then after every 2nd digit
        for (let i = 0; i < subStringValCopy.length; i++) {
            subStringVal += (i%2 != 0 && i!=0) ? "," + subStringValCopy[i] : subStringValCopy[i];
        }
    }
    var finalString = (subStringVal.length == 0) ? valueWithoutComma.substr(-3) : subStringVal + "," + valueWithoutComma.substr(-3); //joining the last 3 digits with the rest of the string
    if(finalString[0] == '0') {
        while(finalString[0] == '0' || finalString[0] == ',') {
            finalString = finalString.substring(1, finalString.length);
        }
        if(finalString == "") {
            finalString = "0";
        }
    }
    $(this).val(finalString);
}
//comma separation code end

//comma separation for summary value (with float number)
function separateWithComma(orNum) {
    orNum = orNum.toString();
    orNum = orNum.replace(/,/g, '');
    var afterPoint = '';
    if(orNum.indexOf('.') > 0) {
       afterPoint = orNum.substring(orNum.indexOf('.'),orNum.length);
    }
    orNum = Math.floor(orNum);
    orNum=orNum.toString();
    var lastThree = orNum.substring(orNum.length-3);
    var otherNumbers = orNum.substring(0,orNum.length-3);
    if(otherNumbers != '') {
        lastThree = ',' + lastThree;
    }
    var res = otherNumbers.replace(/\B(?=(\d{2})+(?!\d))/g, ",") + lastThree + afterPoint;
    return res;
}
