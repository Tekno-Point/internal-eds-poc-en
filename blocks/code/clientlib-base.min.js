/*!
 * typeahead.js 0.11.1
 * https://github.com/twitter/typeahead.js
 * Copyright 2013-2015 Twitter, Inc. and other contributors; Licensed MIT
 */

(function(root, factory) {
    if (typeof define === "function" && define.amd) {
        define("bloodhound", [ "jquery" ], function(a0) {
            return root["Bloodhound"] = factory(a0);
        });
    } else if (typeof exports === "object") {
        module.exports = factory(require("jquery"));
    } else {
        root["Bloodhound"] = factory(jQuery);
    }
})(this, function($) {
    var _ = function() {
        "use strict";
        return {
            isMsie: function() {
                return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2] : false;
            },
            isBlankString: function(str) {
                return !str || /^\s*$/.test(str);
            },
            escapeRegExChars: function(str) {
                return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");
            },
            isString: function(obj) {
                return typeof obj === "string";
            },
            isNumber: function(obj) {
                return typeof obj === "number";
            },
            isArray: $.isArray,
            isFunction: $.isFunction,
            isObject: $.isPlainObject,
            isUndefined: function(obj) {
                return typeof obj === "undefined";
            },
            isElement: function(obj) {
                return !!(obj && obj.nodeType === 1);
            },
            isJQuery: function(obj) {
                return obj instanceof $;
            },
            toStr: function toStr(s) {
                return _.isUndefined(s) || s === null ? "" : s + "";
            },
            bind: $.proxy,
            each: function(collection, cb) {
                $.each(collection, reverseArgs);
                function reverseArgs(index, value) {
                    return cb(value, index);
                }
            },
            map: $.map,
            filter: $.grep,
            every: function(obj, test) {
                var result = true;
                if (!obj) {
                    return result;
                }
                $.each(obj, function(key, val) {
                    if (!(result = test.call(null, val, key, obj))) {
                        return false;
                    }
                });
                return !!result;
            },
            some: function(obj, test) {
                var result = false;
                if (!obj) {
                    return result;
                }
                $.each(obj, function(key, val) {
                    if (result = test.call(null, val, key, obj)) {
                        return false;
                    }
                });
                return !!result;
            },
            mixin: $.extend,
            identity: function(x) {
                return x;
            },
            clone: function(obj) {
                return $.extend(true, {}, obj);
            },
            getIdGenerator: function() {
                var counter = 0;
                return function() {
                    return counter++;
                };
            },
            templatify: function templatify(obj) {
                return $.isFunction(obj) ? obj : template;
                function template() {
                    return String(obj);
                }
            },
            defer: function(fn) {
                setTimeout(fn, 0);
            },
            debounce: function(func, wait, immediate) {
                var timeout, result;
                return function() {
                    var context = this, args = arguments, later, callNow;
                    later = function() {
                        timeout = null;
                        if (!immediate) {
                            result = func.apply(context, args);
                        }
                    };
                    callNow = immediate && !timeout;
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                    if (callNow) {
                        result = func.apply(context, args);
                    }
                    return result;
                };
            },
            throttle: function(func, wait) {
                var context, args, timeout, result, previous, later;
                previous = 0;
                later = function() {
                    previous = new Date();
                    timeout = null;
                    result = func.apply(context, args);
                };
                return function() {
                    var now = new Date(), remaining = wait - (now - previous);
                    context = this;
                    args = arguments;
                    if (remaining <= 0) {
                        clearTimeout(timeout);
                        timeout = null;
                        previous = now;
                        result = func.apply(context, args);
                    } else if (!timeout) {
                        timeout = setTimeout(later, remaining);
                    }
                    return result;
                };
            },
            stringify: function(val) {
                return _.isString(val) ? val : JSON.stringify(val);
            },
            noop: function() {}
        };
    }();
    var VERSION = "0.11.1";
    var tokenizers = function() {
        "use strict";
        return {
            nonword: nonword,
            whitespace: whitespace,
            obj: {
                nonword: getObjTokenizer(nonword),
                whitespace: getObjTokenizer(whitespace)
            }
        };
        function whitespace(str) {
            str = _.toStr(str);
            return str ? str.split(/\s+/) : [];
        }
        function nonword(str) {
            str = _.toStr(str);
            return str ? str.split(/\W+/) : [];
        }
        function getObjTokenizer(tokenizer) {
            return function setKey(keys) {
                keys = _.isArray(keys) ? keys : [].slice.call(arguments, 0);
                return function tokenize(o) {
                    var tokens = [];
                    _.each(keys, function(k) {
                        tokens = tokens.concat(tokenizer(_.toStr(o[k])));
                    });
                    return tokens;
                };
            };
        }
    }();
    var LruCache = function() {
        "use strict";
        function LruCache(maxSize) {
            this.maxSize = _.isNumber(maxSize) ? maxSize : 100;
            this.reset();
            if (this.maxSize <= 0) {
                this.set = this.get = $.noop;
            }
        }
        _.mixin(LruCache.prototype, {
            set: function set(key, val) {
                var tailItem = this.list.tail, node;
                if (this.size >= this.maxSize) {
                    this.list.remove(tailItem);
                    delete this.hash[tailItem.key];
                    this.size--;
                }
                if (node = this.hash[key]) {
                    node.val = val;
                    this.list.moveToFront(node);
                } else {
                    node = new Node(key, val);
                    this.list.add(node);
                    this.hash[key] = node;
                    this.size++;
                }
            },
            get: function get(key) {
                var node = this.hash[key];
                if (node) {
                    this.list.moveToFront(node);
                    return node.val;
                }
            },
            reset: function reset() {
                this.size = 0;
                this.hash = {};
                this.list = new List();
            }
        });
        function List() {
            this.head = this.tail = null;
        }
        _.mixin(List.prototype, {
            add: function add(node) {
                if (this.head) {
                    node.next = this.head;
                    this.head.prev = node;
                }
                this.head = node;
                this.tail = this.tail || node;
            },
            remove: function remove(node) {
                node.prev ? node.prev.next = node.next : this.head = node.next;
                node.next ? node.next.prev = node.prev : this.tail = node.prev;
            },
            moveToFront: function(node) {
                this.remove(node);
                this.add(node);
            }
        });
        function Node(key, val) {
            this.key = key;
            this.val = val;
            this.prev = this.next = null;
        }
        return LruCache;
    }();
    var PersistentStorage = function() {
        "use strict";
        var LOCAL_STORAGE;
        try {
            LOCAL_STORAGE = window.localStorage;
            LOCAL_STORAGE.setItem("~~~", "!");
            LOCAL_STORAGE.removeItem("~~~");
        } catch (err) {
            LOCAL_STORAGE = null;
        }
        function PersistentStorage(namespace, override) {
            this.prefix = [ "__", namespace, "__" ].join("");
            this.ttlKey = "__ttl__";
            this.keyMatcher = new RegExp("^" + _.escapeRegExChars(this.prefix));
            this.ls = override || LOCAL_STORAGE;
            !this.ls && this._noop();
        }
        _.mixin(PersistentStorage.prototype, {
            _prefix: function(key) {
                return this.prefix + key;
            },
            _ttlKey: function(key) {
                return this._prefix(key) + this.ttlKey;
            },
            _noop: function() {
                this.get = this.set = this.remove = this.clear = this.isExpired = _.noop;
            },
            _safeSet: function(key, val) {
                try {
                    this.ls.setItem(key, val);
                } catch (err) {
                    if (err.name === "QuotaExceededError") {
                        this.clear();
                        this._noop();
                    }
                }
            },
            get: function(key) {
                if (this.isExpired(key)) {
                    this.remove(key);
                }
                return decode(this.ls.getItem(this._prefix(key)));
            },
            set: function(key, val, ttl) {
                if (_.isNumber(ttl)) {
                    this._safeSet(this._ttlKey(key), encode(now() + ttl));
                } else {
                    this.ls.removeItem(this._ttlKey(key));
                }
                return this._safeSet(this._prefix(key), encode(val));
            },
            remove: function(key) {
                this.ls.removeItem(this._ttlKey(key));
                this.ls.removeItem(this._prefix(key));
                return this;
            },
            clear: function() {
                var i, keys = gatherMatchingKeys(this.keyMatcher);
                for (i = keys.length; i--; ) {
                    this.remove(keys[i]);
                }
                return this;
            },
            isExpired: function(key) {
                var ttl = decode(this.ls.getItem(this._ttlKey(key)));
                return _.isNumber(ttl) && now() > ttl ? true : false;
            }
        });
        return PersistentStorage;
        function now() {
            return new Date().getTime();
        }
        function encode(val) {
            return JSON.stringify(_.isUndefined(val) ? null : val);
        }
        function decode(val) {
            return $.parseJSON(val);
        }
        function gatherMatchingKeys(keyMatcher) {
            var i, key, keys = [], len = LOCAL_STORAGE.length;
            for (i = 0; i < len; i++) {
                if ((key = LOCAL_STORAGE.key(i)).match(keyMatcher)) {
                    keys.push(key.replace(keyMatcher, ""));
                }
            }
            return keys;
        }
    }();
    var Transport = function() {
        "use strict";
        var pendingRequestsCount = 0, pendingRequests = {}, maxPendingRequests = 6, sharedCache = new LruCache(10);
        function Transport(o) {
            o = o || {};
            this.cancelled = false;
            this.lastReq = null;
            this._send = o.transport;
            this._get = o.limiter ? o.limiter(this._get) : this._get;
            this._cache = o.cache === false ? new LruCache(0) : sharedCache;
        }
        Transport.setMaxPendingRequests = function setMaxPendingRequests(num) {
            maxPendingRequests = num;
        };
        Transport.resetCache = function resetCache() {
            sharedCache.reset();
        };
        _.mixin(Transport.prototype, {
            _fingerprint: function fingerprint(o) {
                o = o || {};
                return o.url + o.type + $.param(o.data || {});
            },
            _get: function(o, cb) {
                var that = this, fingerprint, jqXhr;
                fingerprint = this._fingerprint(o);
                if (this.cancelled || fingerprint !== this.lastReq) {
                    return;
                }
                if (jqXhr = pendingRequests[fingerprint]) {
                    jqXhr.done(done).fail(fail);
                } else if (pendingRequestsCount < maxPendingRequests) {
                    pendingRequestsCount++;
                    pendingRequests[fingerprint] = this._send(o).done(done).fail(fail).always(always);
                } else {
                    this.onDeckRequestArgs = [].slice.call(arguments, 0);
                }
                function done(resp) {
                    cb(null, resp);
                    that._cache.set(fingerprint, resp);
                }
                function fail() {
                    cb(true);
                }
                function always() {
                    pendingRequestsCount--;
                    delete pendingRequests[fingerprint];
                    if (that.onDeckRequestArgs) {
                        that._get.apply(that, that.onDeckRequestArgs);
                        that.onDeckRequestArgs = null;
                    }
                }
            },
            get: function(o, cb) {
                var resp, fingerprint;
                cb = cb || $.noop;
                o = _.isString(o) ? {
                    url: o
                } : o || {};
                fingerprint = this._fingerprint(o);
                this.cancelled = false;
                this.lastReq = fingerprint;
                if (resp = this._cache.get(fingerprint)) {
                    cb(null, resp);
                } else {
                    this._get(o, cb);
                }
            },
            cancel: function() {
                this.cancelled = true;
            }
        });
        return Transport;
    }();
    var SearchIndex = window.SearchIndex = function() {
        "use strict";
        var CHILDREN = "c", IDS = "i";
        function SearchIndex(o) {
            o = o || {};
            if (!o.datumTokenizer || !o.queryTokenizer) {
                $.error("datumTokenizer and queryTokenizer are both required");
            }
            this.identify = o.identify || _.stringify;
            this.datumTokenizer = o.datumTokenizer;
            this.queryTokenizer = o.queryTokenizer;
            this.reset();
        }
        _.mixin(SearchIndex.prototype, {
            bootstrap: function bootstrap(o) {
                this.datums = o.datums;
                this.trie = o.trie;
            },
            add: function(data) {
                var that = this;
                data = _.isArray(data) ? data : [ data ];
                _.each(data, function(datum) {
                    var id, tokens;
                    that.datums[id = that.identify(datum)] = datum;
                    tokens = normalizeTokens(that.datumTokenizer(datum));
                    _.each(tokens, function(token) {
                        var node, chars, ch;
                        node = that.trie;
                        chars = token.split("");
                        while (ch = chars.shift()) {
                            node = node[CHILDREN][ch] || (node[CHILDREN][ch] = newNode());
                            node[IDS].push(id);
                        }
                    });
                });
            },
            get: function get(ids) {
                var that = this;
                return _.map(ids, function(id) {
                    return that.datums[id];
                });
            },
            search: function search(query) {
                var that = this, tokens, matches;
                tokens = normalizeTokens(this.queryTokenizer(query));
                _.each(tokens, function(token) {
                    var node, chars, ch, ids;
                    if (matches && matches.length === 0) {
                        return false;
                    }
                    node = that.trie;
                    chars = token.split("");
                    while (node && (ch = chars.shift())) {
                        node = node[CHILDREN][ch];
                    }
                    if (node && chars.length === 0) {
                        ids = node[IDS].slice(0);
                        matches = matches ? getIntersection(matches, ids) : ids;
                    } else {
                        matches = [];
                        return false;
                    }
                });
                return matches ? _.map(unique(matches), function(id) {
                    return that.datums[id];
                }) : [];
            },
            all: function all() {
                var values = [];
                for (var key in this.datums) {
                    values.push(this.datums[key]);
                }
                return values;
            },
            reset: function reset() {
                this.datums = {};
                this.trie = newNode();
            },
            serialize: function serialize() {
                return {
                    datums: this.datums,
                    trie: this.trie
                };
            }
        });
        return SearchIndex;
        function normalizeTokens(tokens) {
            tokens = _.filter(tokens, function(token) {
                return !!token;
            });
            tokens = _.map(tokens, function(token) {
                return token.toLowerCase();
            });
            return tokens;
        }
        function newNode() {
            var node = {};
            node[IDS] = [];
            node[CHILDREN] = {};
            return node;
        }
        function unique(array) {
            var seen = {}, uniques = [];
            for (var i = 0, len = array.length; i < len; i++) {
                if (!seen[array[i]]) {
                    seen[array[i]] = true;
                    uniques.push(array[i]);
                }
            }
            return uniques;
        }
        function getIntersection(arrayA, arrayB) {
            var ai = 0, bi = 0, intersection = [];
            arrayA = arrayA.sort();
            arrayB = arrayB.sort();
            var lenArrayA = arrayA.length, lenArrayB = arrayB.length;
            while (ai < lenArrayA && bi < lenArrayB) {
                if (arrayA[ai] < arrayB[bi]) {
                    ai++;
                } else if (arrayA[ai] > arrayB[bi]) {
                    bi++;
                } else {
                    intersection.push(arrayA[ai]);
                    ai++;
                    bi++;
                }
            }
            return intersection;
        }
    }();
    var Prefetch = function() {
        "use strict";
        var keys;
        keys = {
            data: "data",
            protocol: "protocol",
            thumbprint: "thumbprint"
        };
        function Prefetch(o) {
            this.url = o.url;
            this.ttl = o.ttl;
            this.cache = o.cache;
            this.prepare = o.prepare;
            this.transform = o.transform;
            this.transport = o.transport;
            this.thumbprint = o.thumbprint;
            this.storage = new PersistentStorage(o.cacheKey);
        }
        _.mixin(Prefetch.prototype, {
            _settings: function settings() {
                return {
                    url: this.url,
                    type: "GET",
                    dataType: "json"
                };
            },
            store: function store(data) {
                if (!this.cache) {
                    return;
                }
                this.storage.set(keys.data, data, this.ttl);
                this.storage.set(keys.protocol, location.protocol, this.ttl);
                this.storage.set(keys.thumbprint, this.thumbprint, this.ttl);
            },
            fromCache: function fromCache() {
                var stored = {}, isExpired;
                if (!this.cache) {
                    return null;
                }
                stored.data = this.storage.get(keys.data);
                stored.protocol = this.storage.get(keys.protocol);
                stored.thumbprint = this.storage.get(keys.thumbprint);
                isExpired = stored.thumbprint !== this.thumbprint || stored.protocol !== location.protocol;
                return stored.data && !isExpired ? stored.data : null;
            },
            fromNetwork: function(cb) {
                var that = this, settings;
                if (!cb) {
                    return;
                }
                settings = this.prepare(this._settings());
                this.transport(settings).fail(onError).done(onResponse);
                function onError() {
                    cb(true);
                }
                function onResponse(resp) {
                    cb(null, that.transform(resp));
                }
            },
            clear: function clear() {
                this.storage.clear();
                return this;
            }
        });
        return Prefetch;
    }();
    var Remote = function() {
        "use strict";
        function Remote(o) {
            this.url = o.url;
            this.prepare = o.prepare;
            this.transform = o.transform;
            this.transport = new Transport({
                cache: o.cache,
                limiter: o.limiter,
                transport: o.transport
            });
        }
        _.mixin(Remote.prototype, {
            _settings: function settings() {
                return {
                    url: this.url,
                    type: "GET",
                    dataType: "json"
                };
            },
            get: function get(query, cb) {
                var that = this, settings;
                if (!cb) {
                    return;
                }
                query = query || "";
                settings = this.prepare(query, this._settings());
                return this.transport.get(settings, onResponse);
                function onResponse(err, resp) {
                    err ? cb([]) : cb(that.transform(resp));
                }
            },
            cancelLastRequest: function cancelLastRequest() {
                this.transport.cancel();
            }
        });
        return Remote;
    }();
    var oParser = function() {
        "use strict";
        return function parse(o) {
            var defaults, sorter;
            defaults = {
                initialize: true,
                identify: _.stringify,
                datumTokenizer: null,
                queryTokenizer: null,
                sufficient: 5,
                sorter: null,
                local: [],
                prefetch: null,
                remote: null
            };
            o = _.mixin(defaults, o || {});
            !o.datumTokenizer && $.error("datumTokenizer is required");
            !o.queryTokenizer && $.error("queryTokenizer is required");
            sorter = o.sorter;
            o.sorter = sorter ? function(x) {
                return x.sort(sorter);
            } : _.identity;
            o.local = _.isFunction(o.local) ? o.local() : o.local;
            o.prefetch = parsePrefetch(o.prefetch);
            o.remote = parseRemote(o.remote);
            return o;
        };
        function parsePrefetch(o) {
            var defaults;
            if (!o) {
                return null;
            }
            defaults = {
                url: null,
                ttl: 24 * 60 * 60 * 1e3,
                cache: true,
                cacheKey: null,
                thumbprint: "",
                prepare: _.identity,
                transform: _.identity,
                transport: null
            };
            o = _.isString(o) ? {
                url: o
            } : o;
            o = _.mixin(defaults, o);
            !o.url && $.error("prefetch requires url to be set");
            o.transform = o.filter || o.transform;
            o.cacheKey = o.cacheKey || o.url;
            o.thumbprint = VERSION + o.thumbprint;
            o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;
            return o;
        }
        function parseRemote(o) {
            var defaults;
            if (!o) {
                return;
            }
            defaults = {
                url: null,
                cache: true,
                prepare: null,
                replace: null,
                wildcard: null,
                limiter: null,
                rateLimitBy: "debounce",
                rateLimitWait: 300,
                transform: _.identity,
                transport: null
            };
            o = _.isString(o) ? {
                url: o
            } : o;
            o = _.mixin(defaults, o);
            !o.url && $.error("remote requires url to be set");
            o.transform = o.filter || o.transform;
            o.prepare = toRemotePrepare(o);
            o.limiter = toLimiter(o);
            o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;
            delete o.replace;
            delete o.wildcard;
            delete o.rateLimitBy;
            delete o.rateLimitWait;
            return o;
        }
        function toRemotePrepare(o) {
            var prepare, replace, wildcard;
            prepare = o.prepare;
            replace = o.replace;
            wildcard = o.wildcard;
            if (prepare) {
                return prepare;
            }
            if (replace) {
                prepare = prepareByReplace;
            } else if (o.wildcard) {
                prepare = prepareByWildcard;
            } else {
                prepare = idenityPrepare;
            }
            return prepare;
            function prepareByReplace(query, settings) {
                settings.url = replace(settings.url, query);
                return settings;
            }
            function prepareByWildcard(query, settings) {
                settings.url = settings.url.replace(wildcard, encodeURIComponent(query));
                return settings;
            }
            function idenityPrepare(query, settings) {
                return settings;
            }
        }
        function toLimiter(o) {
            var limiter, method, wait;
            limiter = o.limiter;
            method = o.rateLimitBy;
            wait = o.rateLimitWait;
            if (!limiter) {
                limiter = /^throttle$/i.test(method) ? throttle(wait) : debounce(wait);
            }
            return limiter;
            function debounce(wait) {
                return function debounce(fn) {
                    return _.debounce(fn, wait);
                };
            }
            function throttle(wait) {
                return function throttle(fn) {
                    return _.throttle(fn, wait);
                };
            }
        }
        function callbackToDeferred(fn) {
            return function wrapper(o) {
                var deferred = $.Deferred();
                fn(o, onSuccess, onError);
                return deferred;
                function onSuccess(resp) {
                    _.defer(function() {
                        deferred.resolve(resp);
                    });
                }
                function onError(err) {
                    _.defer(function() {
                        deferred.reject(err);
                    });
                }
            };
        }
    }();
    var Bloodhound = function() {
        "use strict";
        var old;
        old = window && window.Bloodhound;
        function Bloodhound(o) {
            o = oParser(o);
            this.sorter = o.sorter;
            this.identify = o.identify;
            this.sufficient = o.sufficient;
            this.local = o.local;
            this.remote = o.remote ? new Remote(o.remote) : null;
            this.prefetch = o.prefetch ? new Prefetch(o.prefetch) : null;
            this.index = new SearchIndex({
                identify: this.identify,
                datumTokenizer: o.datumTokenizer,
                queryTokenizer: o.queryTokenizer
            });
            o.initialize !== false && this.initialize();
        }
        Bloodhound.noConflict = function noConflict() {
            window && (window.Bloodhound = old);
            return Bloodhound;
        };
        Bloodhound.tokenizers = tokenizers;
        _.mixin(Bloodhound.prototype, {
            __ttAdapter: function ttAdapter() {
                var that = this;
                return this.remote ? withAsync : withoutAsync;
                function withAsync(query, sync, async) {
                    return that.search(query, sync, async);
                }
                function withoutAsync(query, sync) {
                    return that.search(query, sync);
                }
            },
            _loadPrefetch: function loadPrefetch() {
                var that = this, deferred, serialized;
                deferred = $.Deferred();
                if (!this.prefetch) {
                    deferred.resolve();
                } else if (serialized = this.prefetch.fromCache()) {
                    this.index.bootstrap(serialized);
                    deferred.resolve();
                } else {
                    this.prefetch.fromNetwork(done);
                }
                return deferred.promise();
                function done(err, data) {
                    if (err) {
                        return deferred.reject();
                    }
                    that.add(data);
                    that.prefetch.store(that.index.serialize());
                    deferred.resolve();
                }
            },
            _initialize: function initialize() {
                var that = this, deferred;
                this.clear();
                (this.initPromise = this._loadPrefetch()).done(addLocalToIndex);
                return this.initPromise;
                function addLocalToIndex() {
                    that.add(that.local);
                }
            },
            initialize: function initialize(force) {
                return !this.initPromise || force ? this._initialize() : this.initPromise;
            },
            add: function add(data) {
                this.index.add(data);
                return this;
            },
            get: function get(ids) {
                ids = _.isArray(ids) ? ids : [].slice.call(arguments);
                return this.index.get(ids);
            },
            search: function search(query, sync, async) {
                var that = this, local;
                local = this.sorter(this.index.search(query));
                sync(this.remote ? local.slice() : local);
                if (this.remote && local.length < this.sufficient) {
                    this.remote.get(query, processRemote);
                } else if (this.remote) {
                    this.remote.cancelLastRequest();
                }
                return this;
                function processRemote(remote) {
                    var nonDuplicates = [];
                    _.each(remote, function(r) {
                        !_.some(local, function(l) {
                            return that.identify(r) === that.identify(l);
                        }) && nonDuplicates.push(r);
                    });
                    async && async(nonDuplicates);
                }
            },
            all: function all() {
                return this.index.all();
            },
            clear: function clear() {
                this.index.reset();
                return this;
            },
            clearPrefetchCache: function clearPrefetchCache() {
                this.prefetch && this.prefetch.clear();
                return this;
            },
            clearRemoteCache: function clearRemoteCache() {
                Transport.resetCache();
                return this;
            },
            ttAdapter: function ttAdapter() {
                return this.__ttAdapter();
            }
        });
        return Bloodhound;
    }();
    return Bloodhound;
});

(function(root, factory) {
    if (typeof define === "function" && define.amd) {
        define("typeahead.js", [ "jquery" ], function(a0) {
            return factory(a0);
        });
    } else if (typeof exports === "object") {
        module.exports = factory(require("jquery"));
    } else {
        factory(jQuery);
    }
})(this, function($) {
    var _ = function() {
        "use strict";
        return {
            isMsie: function() {
                return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2] : false;
            },
            isBlankString: function(str) {
                return !str || /^\s*$/.test(str);
            },
            escapeRegExChars: function(str) {
                return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");
            },
            isString: function(obj) {
                return typeof obj === "string";
            },
            isNumber: function(obj) {
                return typeof obj === "number";
            },
            isArray: $.isArray,
            isFunction: $.isFunction,
            isObject: $.isPlainObject,
            isUndefined: function(obj) {
                return typeof obj === "undefined";
            },
            isElement: function(obj) {
                return !!(obj && obj.nodeType === 1);
            },
            isJQuery: function(obj) {
                return obj instanceof $;
            },
            toStr: function toStr(s) {
                return _.isUndefined(s) || s === null ? "" : s + "";
            },
            bind: $.proxy,
            each: function(collection, cb) {
                $.each(collection, reverseArgs);
                function reverseArgs(index, value) {
                    return cb(value, index);
                }
            },
            map: $.map,
            filter: $.grep,
            every: function(obj, test) {
                var result = true;
                if (!obj) {
                    return result;
                }
                $.each(obj, function(key, val) {
                    if (!(result = test.call(null, val, key, obj))) {
                        return false;
                    }
                });
                return !!result;
            },
            some: function(obj, test) {
                var result = false;
                if (!obj) {
                    return result;
                }
                $.each(obj, function(key, val) {
                    if (result = test.call(null, val, key, obj)) {
                        return false;
                    }
                });
                return !!result;
            },
            mixin: $.extend,
            identity: function(x) {
                return x;
            },
            clone: function(obj) {
                return $.extend(true, {}, obj);
            },
            getIdGenerator: function() {
                var counter = 0;
                return function() {
                    return counter++;
                };
            },
            templatify: function templatify(obj) {
                return $.isFunction(obj) ? obj : template;
                function template() {
                    return String(obj);
                }
            },
            defer: function(fn) {
                setTimeout(fn, 0);
            },
            debounce: function(func, wait, immediate) {
                var timeout, result;
                return function() {
                    var context = this, args = arguments, later, callNow;
                    later = function() {
                        timeout = null;
                        if (!immediate) {
                            result = func.apply(context, args);
                        }
                    };
                    callNow = immediate && !timeout;
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                    if (callNow) {
                        result = func.apply(context, args);
                    }
                    return result;
                };
            },
            throttle: function(func, wait) {
                var context, args, timeout, result, previous, later;
                previous = 0;
                later = function() {
                    previous = new Date();
                    timeout = null;
                    result = func.apply(context, args);
                };
                return function() {
                    var now = new Date(), remaining = wait - (now - previous);
                    context = this;
                    args = arguments;
                    if (remaining <= 0) {
                        clearTimeout(timeout);
                        timeout = null;
                        previous = now;
                        result = func.apply(context, args);
                    } else if (!timeout) {
                        timeout = setTimeout(later, remaining);
                    }
                    return result;
                };
            },
            stringify: function(val) {
                return _.isString(val) ? val : JSON.stringify(val);
            },
            noop: function() {}
        };
    }();
    var WWW = function() {
        "use strict";
        var defaultClassNames = {
            wrapper: "twitter-typeahead",
            input: "tt-input",
            hint: "tt-hint",
            menu: "tt-menu",
            dataset: "tt-dataset",
            suggestion: "tt-suggestion",
            selectable: "tt-selectable",
            empty: "tt-empty",
            open: "tt-open",
            cursor: "tt-cursor",
            highlight: "tt-highlight"
        };
        return build;
        function build(o) {
            var www, classes;
            classes = _.mixin({}, defaultClassNames, o);
            www = {
                css: buildCss(),
                classes: classes,
                html: buildHtml(classes),
                selectors: buildSelectors(classes)
            };
            return {
                css: www.css,
                html: www.html,
                classes: www.classes,
                selectors: www.selectors,
                mixin: function(o) {
                    _.mixin(o, www);
                }
            };
        }
        function buildHtml(c) {
            return {
                wrapper: '<span class="' + c.wrapper + '"></span>',
                menu: '<div class="' + c.menu + '"></div>'
            };
        }
        function buildSelectors(classes) {
            var selectors = {};
            _.each(classes, function(v, k) {
                selectors[k] = "." + v;
            });
            return selectors;
        }
        function buildCss() {
            var css = {
                wrapper: {
                    position: "relative",
                    display: "inline-block"
                },
                hint: {
                    position: "absolute",
                    top: "0",
                    left: "0",
                    borderColor: "transparent",
                    boxShadow: "none",
                    opacity: "1"
                },
                input: {
                    position: "relative",
                    verticalAlign: "top",
                    backgroundColor: "transparent"
                },
                inputWithNoHint: {
                    position: "relative",
                    verticalAlign: "top"
                },
                menu: {
                    position: "absolute",
                    top: "100%",
                    left: "0",
                    zIndex: "100",
                    display: "none"
                },
                ltr: {
                    left: "0",
                    right: "auto"
                },
                rtl: {
                    left: "auto",
                    right: " 0"
                }
            };
            if (_.isMsie()) {
                _.mixin(css.input, {
                    backgroundImage: "url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"
                });
            }
            return css;
        }
    }();
    var EventBus = function() {
        "use strict";
        var namespace, deprecationMap;
        namespace = "typeahead:";
        deprecationMap = {
            render: "rendered",
            cursorchange: "cursorchanged",
            select: "selected",
            autocomplete: "autocompleted"
        };
        function EventBus(o) {
            if (!o || !o.el) {
                $.error("EventBus initialized without el");
            }
            this.$el = $(o.el);
        }
        _.mixin(EventBus.prototype, {
            _trigger: function(type, args) {
                var $e;
                $e = $.Event(namespace + type);
                (args = args || []).unshift($e);
                this.$el.trigger.apply(this.$el, args);
                return $e;
            },
            before: function(type) {
                var args, $e;
                args = [].slice.call(arguments, 1);
                $e = this._trigger("before" + type, args);
                return $e.isDefaultPrevented();
            },
            trigger: function(type) {
                var deprecatedType;
                this._trigger(type, [].slice.call(arguments, 1));
                if (deprecatedType = deprecationMap[type]) {
                    this._trigger(deprecatedType, [].slice.call(arguments, 1));
                }
            }
        });
        return EventBus;
    }();
    var EventEmitter = function() {
        "use strict";
        var splitter = /\s+/, nextTick = getNextTick();
        return {
            onSync: onSync,
            onAsync: onAsync,
            off: off,
            trigger: trigger
        };
        function on(method, types, cb, context) {
            var type;
            if (!cb) {
                return this;
            }
            types = types.split(splitter);
            cb = context ? bindContext(cb, context) : cb;
            this._callbacks = this._callbacks || {};
            while (type = types.shift()) {
                this._callbacks[type] = this._callbacks[type] || {
                    sync: [],
                    async: []
                };
                this._callbacks[type][method].push(cb);
            }
            return this;
        }
        function onAsync(types, cb, context) {
            return on.call(this, "async", types, cb, context);
        }
        function onSync(types, cb, context) {
            return on.call(this, "sync", types, cb, context);
        }
        function off(types) {
            var type;
            if (!this._callbacks) {
                return this;
            }
            types = types.split(splitter);
            while (type = types.shift()) {
                delete this._callbacks[type];
            }
            return this;
        }
        function trigger(types) {
            var type, callbacks, args, syncFlush, asyncFlush;
            if (!this._callbacks) {
                return this;
            }
            types = types.split(splitter);
            args = [].slice.call(arguments, 1);
            while ((type = types.shift()) && (callbacks = this._callbacks[type])) {
                syncFlush = getFlush(callbacks.sync, this, [ type ].concat(args));
                asyncFlush = getFlush(callbacks.async, this, [ type ].concat(args));
                syncFlush() && nextTick(asyncFlush);
            }
            return this;
        }
        function getFlush(callbacks, context, args) {
            return flush;
            function flush() {
                var cancelled;
                for (var i = 0, len = callbacks.length; !cancelled && i < len; i += 1) {
                    cancelled = callbacks[i].apply(context, args) === false;
                }
                return !cancelled;
            }
        }
        function getNextTick() {
            var nextTickFn;
            if (window.setImmediate) {
                nextTickFn = function nextTickSetImmediate(fn) {
                    setImmediate(function() {
                        fn();
                    });
                };
            } else {
                nextTickFn = function nextTickSetTimeout(fn) {
                    setTimeout(function() {
                        fn();
                    }, 0);
                };
            }
            return nextTickFn;
        }
        function bindContext(fn, context) {
            return fn.bind ? fn.bind(context) : function() {
                fn.apply(context, [].slice.call(arguments, 0));
            };
        }
    }();
    var highlight = function(doc) {
        "use strict";
        var defaults = {
            node: null,
            pattern: null,
            tagName: "strong",
            className: null,
            wordsOnly: false,
            caseSensitive: false
        };
        return function hightlight(o) {
            var regex;
            o = _.mixin({}, defaults, o);
            if (!o.node || !o.pattern) {
                return;
            }
            o.pattern = _.isArray(o.pattern) ? o.pattern : [ o.pattern ];
            regex = getRegex(o.pattern, o.caseSensitive, o.wordsOnly);
            traverse(o.node, hightlightTextNode);
            function hightlightTextNode(textNode) {
                var match, patternNode, wrapperNode;
                if (match = regex.exec(textNode.data)) {
                    wrapperNode = doc.createElement(o.tagName);
                    o.className && (wrapperNode.className = o.className);
                    patternNode = textNode.splitText(match.index);
                    patternNode.splitText(match[0].length);
                    wrapperNode.appendChild(patternNode.cloneNode(true));
                    textNode.parentNode.replaceChild(wrapperNode, patternNode);
                }
                return !!match;
            }
            function traverse(el, hightlightTextNode) {
                var childNode, TEXT_NODE_TYPE = 3;
                for (var i = 0; i < el.childNodes.length; i++) {
                    childNode = el.childNodes[i];
                    if (childNode.nodeType === TEXT_NODE_TYPE) {
                        i += hightlightTextNode(childNode) ? 1 : 0;
                    } else {
                        traverse(childNode, hightlightTextNode);
                    }
                }
            }
        };
        function getRegex(patterns, caseSensitive, wordsOnly) {
            var escapedPatterns = [], regexStr;
            for (var i = 0, len = patterns.length; i < len; i++) {
                escapedPatterns.push(_.escapeRegExChars(patterns[i]));
            }
            regexStr = wordsOnly ? "\\b(" + escapedPatterns.join("|") + ")\\b" : "(" + escapedPatterns.join("|") + ")";
            return caseSensitive ? new RegExp(regexStr) : new RegExp(regexStr, "i");
        }
    }(window.document);
    var Input = function() {
        "use strict";
        var specialKeyCodeMap;
        specialKeyCodeMap = {
            9: "tab",
            27: "esc",
            37: "left",
            39: "right",
            13: "enter",
            38: "up",
            40: "down"
        };
        function Input(o, www) {
            o = o || {};
            if (!o.input) {
                $.error("input is missing");
            }
            www.mixin(this);
            this.$hint = $(o.hint);
            this.$input = $(o.input);
            this.query = this.$input.val();
            this.queryWhenFocused = this.hasFocus() ? this.query : null;
            this.$overflowHelper = buildOverflowHelper(this.$input);
            this._checkLanguageDirection();
            if (this.$hint.length === 0) {
                this.setHint = this.getHint = this.clearHint = this.clearHintIfInvalid = _.noop;
            }
        }
        Input.normalizeQuery = function(str) {
            return _.toStr(str).replace(/^\s*/g, "").replace(/\s{2,}/g, " ");
        };
        _.mixin(Input.prototype, EventEmitter, {
            _onBlur: function onBlur() {
                this.resetInputValue();
                this.trigger("blurred");
            },
            _onFocus: function onFocus() {
                this.queryWhenFocused = this.query;
                this.trigger("focused");
            },
            _onKeydown: function onKeydown($e) {
                var keyName = specialKeyCodeMap[$e.which || $e.keyCode];
                this._managePreventDefault(keyName, $e);
                if (keyName && this._shouldTrigger(keyName, $e)) {
                    this.trigger(keyName + "Keyed", $e);
                }
            },
            _onInput: function onInput() {
                this._setQuery(this.getInputValue());
                this.clearHintIfInvalid();
                this._checkLanguageDirection();
            },
            _managePreventDefault: function managePreventDefault(keyName, $e) {
                var preventDefault;
                switch (keyName) {
                  case "up":
                  case "down":
                    preventDefault = !withModifier($e);
                    break;

                  default:
                    preventDefault = false;
                }
                preventDefault && $e.preventDefault();
            },
            _shouldTrigger: function shouldTrigger(keyName, $e) {
                var trigger;
                switch (keyName) {
                  case "tab":
                    trigger = !withModifier($e);
                    break;

                  default:
                    trigger = true;
                }
                return trigger;
            },
            _checkLanguageDirection: function checkLanguageDirection() {
                var dir = (this.$input.css("direction") || "ltr").toLowerCase();
                if (this.dir !== dir) {
                    this.dir = dir;
                    this.$hint.attr("dir", dir);
                    this.trigger("langDirChanged", dir);
                }
            },
            _setQuery: function setQuery(val, silent) {
                var areEquivalent, hasDifferentWhitespace;
                areEquivalent = areQueriesEquivalent(val, this.query);
                hasDifferentWhitespace = areEquivalent ? this.query.length !== val.length : false;
                this.query = val;
                if (!silent && !areEquivalent) {
                    this.trigger("queryChanged", this.query);
                } else if (!silent && hasDifferentWhitespace) {
                    this.trigger("whitespaceChanged", this.query);
                }
            },
            bind: function() {
                var that = this, onBlur, onFocus, onKeydown, onInput;
                onBlur = _.bind(this._onBlur, this);
                onFocus = _.bind(this._onFocus, this);
                onKeydown = _.bind(this._onKeydown, this);
                onInput = _.bind(this._onInput, this);
                this.$input.on("blur.tt", onBlur).on("focus.tt", onFocus).on("keydown.tt", onKeydown);
                if (!_.isMsie() || _.isMsie() > 9) {
                    this.$input.on("input.tt", onInput);
                } else {
                    this.$input.on("keydown.tt keypress.tt cut.tt paste.tt", function($e) {
                        if (specialKeyCodeMap[$e.which || $e.keyCode]) {
                            return;
                        }
                        _.defer(_.bind(that._onInput, that, $e));
                    });
                }
                return this;
            },
            focus: function focus() {
                this.$input.focus();
            },
            blur: function blur() {
                this.$input.blur();
            },
            getLangDir: function getLangDir() {
                return this.dir;
            },
            getQuery: function getQuery() {
                return this.query || "";
            },
            setQuery: function setQuery(val, silent) {
                this.setInputValue(val);
                this._setQuery(val, silent);
            },
            hasQueryChangedSinceLastFocus: function hasQueryChangedSinceLastFocus() {
                return this.query !== this.queryWhenFocused;
            },
            getInputValue: function getInputValue() {
                return this.$input.val();
            },
            setInputValue: function setInputValue(value) {
                this.$input.val(value);
                this.clearHintIfInvalid();
                this._checkLanguageDirection();
            },
            resetInputValue: function resetInputValue() {
                this.setInputValue(this.query);
            },
            getHint: function getHint() {
                return this.$hint.val();
            },
            setHint: function setHint(value) {
                this.$hint.val(value);
            },
            clearHint: function clearHint() {
                this.setHint("");
            },
            clearHintIfInvalid: function clearHintIfInvalid() {
                var val, hint, valIsPrefixOfHint, isValid;
                val = this.getInputValue();
                hint = this.getHint();
                valIsPrefixOfHint = val !== hint && hint.indexOf(val) === 0;
                isValid = val !== "" && valIsPrefixOfHint && !this.hasOverflow();
                !isValid && this.clearHint();
            },
            hasFocus: function hasFocus() {
                return this.$input.is(":focus");
            },
            hasOverflow: function hasOverflow() {
                var constraint = this.$input.width() - 2;
                this.$overflowHelper.text(this.getInputValue());
                return this.$overflowHelper.width() >= constraint;
            },
            isCursorAtEnd: function() {
                var valueLength, selectionStart, range;
                valueLength = this.$input.val().length;
                selectionStart = this.$input[0].selectionStart;
                if (_.isNumber(selectionStart)) {
                    return selectionStart === valueLength;
                } else if (document.selection) {
                    range = document.selection.createRange();
                    range.moveStart("character", -valueLength);
                    return valueLength === range.text.length;
                }
                return true;
            },
            destroy: function destroy() {
                this.$hint.off(".tt");
                this.$input.off(".tt");
                this.$overflowHelper.remove();
                this.$hint = this.$input = this.$overflowHelper = $("<div>");
            }
        });
        return Input;
        function buildOverflowHelper($input) {
            return $('<pre aria-hidden="true"></pre>').css({
                position: "absolute",
                visibility: "hidden",
                whiteSpace: "pre",
                fontFamily: $input.css("font-family"),
                fontSize: $input.css("font-size"),
                fontStyle: $input.css("font-style"),
                fontVariant: $input.css("font-variant"),
                fontWeight: $input.css("font-weight"),
                wordSpacing: $input.css("word-spacing"),
                letterSpacing: $input.css("letter-spacing"),
                textIndent: $input.css("text-indent"),
                textRendering: $input.css("text-rendering"),
                textTransform: $input.css("text-transform")
            }).insertAfter($input);
        }
        function areQueriesEquivalent(a, b) {
            return Input.normalizeQuery(a) === Input.normalizeQuery(b);
        }
        function withModifier($e) {
            return $e.altKey || $e.ctrlKey || $e.metaKey || $e.shiftKey;
        }
    }();
    var Dataset = function() {
        "use strict";
        var keys, nameGenerator;
        keys = {
            val: "tt-selectable-display",
            obj: "tt-selectable-object"
        };
        nameGenerator = _.getIdGenerator();
        function Dataset(o, www) {
            o = o || {};
            o.templates = o.templates || {};
            o.templates.notFound = o.templates.notFound || o.templates.empty;
            if (!o.source) {
                $.error("missing source");
            }
            if (!o.node) {
                $.error("missing node");
            }
            if (o.name && !isValidName(o.name)) {
                $.error("invalid dataset name: " + o.name);
            }
            www.mixin(this);
            this.highlight = !!o.highlight;
            this.name = o.name || nameGenerator();
            this.limit = o.limit || 5;
            this.displayFn = getDisplayFn(o.display || o.displayKey);
            this.templates = getTemplates(o.templates, this.displayFn);
            this.source = o.source.__ttAdapter ? o.source.__ttAdapter() : o.source;
            this.async = _.isUndefined(o.async) ? this.source.length > 2 : !!o.async;
            this._resetLastSuggestion();
            this.$el = $(o.node).addClass(this.classes.dataset).addClass(this.classes.dataset + "-" + this.name);
        }
        Dataset.extractData = function extractData(el) {
            var $el = $(el);
            if ($el.data(keys.obj)) {
                return {
                    val: $el.data(keys.val) || "",
                    obj: $el.data(keys.obj) || null
                };
            }
            return null;
        };
        _.mixin(Dataset.prototype, EventEmitter, {
            _overwrite: function overwrite(query, suggestions) {
                suggestions = suggestions || [];
                if (suggestions.length) {
                    this._renderSuggestions(query, suggestions);
                } else if (this.async && this.templates.pending) {
                    this._renderPending(query);
                } else if (!this.async && this.templates.notFound) {
                    this._renderNotFound(query);
                } else {
                    this._empty();
                }
                this.trigger("rendered", this.name, suggestions, false);
            },
            _append: function append(query, suggestions) {
                suggestions = suggestions || [];
                if (suggestions.length && this.$lastSuggestion.length) {
                    this._appendSuggestions(query, suggestions);
                } else if (suggestions.length) {
                    this._renderSuggestions(query, suggestions);
                } else if (!this.$lastSuggestion.length && this.templates.notFound) {
                    this._renderNotFound(query);
                }
                this.trigger("rendered", this.name, suggestions, true);
            },
            _renderSuggestions: function renderSuggestions(query, suggestions) {
                var $fragment;
                $fragment = this._getSuggestionsFragment(query, suggestions);
                this.$lastSuggestion = $fragment.children().last();
                this.$el.html($fragment).prepend(this._getHeader(query, suggestions)).append(this._getFooter(query, suggestions));
            },
            _appendSuggestions: function appendSuggestions(query, suggestions) {
                var $fragment, $lastSuggestion;
                $fragment = this._getSuggestionsFragment(query, suggestions);
                $lastSuggestion = $fragment.children().last();
                this.$lastSuggestion.after($fragment);
                this.$lastSuggestion = $lastSuggestion;
            },
            _renderPending: function renderPending(query) {
                var template = this.templates.pending;
                this._resetLastSuggestion();
                template && this.$el.html(template({
                    query: query,
                    dataset: this.name
                }));
            },
            _renderNotFound: function renderNotFound(query) {
                var template = this.templates.notFound;
                this._resetLastSuggestion();
                template && this.$el.html(template({
                    query: query,
                    dataset: this.name
                }));
            },
            _empty: function empty() {
                this.$el.empty();
                this._resetLastSuggestion();
            },
            _getSuggestionsFragment: function getSuggestionsFragment(query, suggestions) {
                var that = this, fragment;
                fragment = document.createDocumentFragment();
                _.each(suggestions, function getSuggestionNode(suggestion) {
                    var $el, context;
                    context = that._injectQuery(query, suggestion);
                    $el = $(that.templates.suggestion(context)).data(keys.obj, suggestion).data(keys.val, that.displayFn(suggestion)).addClass(that.classes.suggestion + " " + that.classes.selectable);
                    fragment.appendChild($el[0]);
                });
                this.highlight && highlight({
                    className: this.classes.highlight,
                    node: fragment,
                    pattern: query
                });
                return $(fragment);
            },
            _getFooter: function getFooter(query, suggestions) {
                return this.templates.footer ? this.templates.footer({
                    query: query,
                    suggestions: suggestions,
                    dataset: this.name
                }) : null;
            },
            _getHeader: function getHeader(query, suggestions) {
                return this.templates.header ? this.templates.header({
                    query: query,
                    suggestions: suggestions,
                    dataset: this.name
                }) : null;
            },
            _resetLastSuggestion: function resetLastSuggestion() {
                this.$lastSuggestion = $();
            },
            _injectQuery: function injectQuery(query, obj) {
                return _.isObject(obj) ? _.mixin({
                    _query: query
                }, obj) : obj;
            },
            update: function update(query) {
                var that = this, canceled = false, syncCalled = false, rendered = 0;
                this.cancel();
                this.cancel = function cancel() {
                    canceled = true;
                    that.cancel = $.noop;
                    that.async && that.trigger("asyncCanceled", query);
                };
                this.source(query, sync, async);
                !syncCalled && sync([]);
                function sync(suggestions) {
                    if (syncCalled) {
                        return;
                    }
                    syncCalled = true;
                    suggestions = (suggestions || []).slice(0, that.limit);
                    rendered = suggestions.length;
                    that._overwrite(query, suggestions);
                    if (rendered < that.limit && that.async) {
                        that.trigger("asyncRequested", query);
                    }
                }
                function async(suggestions) {
                    suggestions = suggestions || [];
                    if (!canceled && rendered < that.limit) {
                        that.cancel = $.noop;
                        rendered += suggestions.length;
                        that._append(query, suggestions.slice(0, that.limit - rendered));
                        that.async && that.trigger("asyncReceived", query);
                    }
                }
            },
            cancel: $.noop,
            clear: function clear() {
                this._empty();
                this.cancel();
                this.trigger("cleared");
            },
            isEmpty: function isEmpty() {
                return this.$el.is(":empty");
            },
            destroy: function destroy() {
                this.$el = $("<div>");
            }
        });
        return Dataset;
        function getDisplayFn(display) {
            display = display || _.stringify;
            return _.isFunction(display) ? display : displayFn;
            function displayFn(obj) {
                return obj[display];
            }
        }
        function getTemplates(templates, displayFn) {
            return {
                notFound: templates.notFound && _.templatify(templates.notFound),
                pending: templates.pending && _.templatify(templates.pending),
                header: templates.header && _.templatify(templates.header),
                footer: templates.footer && _.templatify(templates.footer),
                suggestion: templates.suggestion || suggestionTemplate
            };
            function suggestionTemplate(context) {
                return $("<div>").text(displayFn(context));
            }
        }
        function isValidName(str) {
            return /^[_a-zA-Z0-9-]+$/.test(str);
        }
    }();
    var Menu = function() {
        "use strict";
        function Menu(o, www) {
            var that = this;
            o = o || {};
            if (!o.node) {
                $.error("node is required");
            }
            www.mixin(this);
            this.$node = $(o.node);
            this.query = null;
            this.datasets = _.map(o.datasets, initializeDataset);
            function initializeDataset(oDataset) {
                var node = that.$node.find(oDataset.node).first();
                oDataset.node = node.length ? node : $("<div>").appendTo(that.$node);
                return new Dataset(oDataset, www);
            }
        }
        _.mixin(Menu.prototype, EventEmitter, {
            _onSelectableClick: function onSelectableClick($e) {
                this.trigger("selectableClicked", $($e.currentTarget));
            },
            _onRendered: function onRendered(type, dataset, suggestions, async) {
                this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());
                this.trigger("datasetRendered", dataset, suggestions, async);
            },
            _onCleared: function onCleared() {
                this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());
                this.trigger("datasetCleared");
            },
            _propagate: function propagate() {
                this.trigger.apply(this, arguments);
            },
            _allDatasetsEmpty: function allDatasetsEmpty() {
                return _.every(this.datasets, isDatasetEmpty);
                function isDatasetEmpty(dataset) {
                    return dataset.isEmpty();
                }
            },
            _getSelectables: function getSelectables() {
                return this.$node.find(this.selectors.selectable);
            },
            _removeCursor: function _removeCursor() {
                var $selectable = this.getActiveSelectable();
                $selectable && $selectable.removeClass(this.classes.cursor);
            },
            _ensureVisible: function ensureVisible($el) {
                var elTop, elBottom, nodeScrollTop, nodeHeight;
                elTop = $el.position().top;
                elBottom = elTop + $el.outerHeight(true);
                nodeScrollTop = this.$node.scrollTop();
                nodeHeight = this.$node.height() + parseInt(this.$node.css("paddingTop"), 10) + parseInt(this.$node.css("paddingBottom"), 10);
                if (elTop < 0) {
                    this.$node.scrollTop(nodeScrollTop + elTop);
                } else if (nodeHeight < elBottom) {
                    this.$node.scrollTop(nodeScrollTop + (elBottom - nodeHeight));
                }
            },
            bind: function() {
                var that = this, onSelectableClick;
                onSelectableClick = _.bind(this._onSelectableClick, this);
                this.$node.on("click.tt", this.selectors.selectable, onSelectableClick);
                _.each(this.datasets, function(dataset) {
                    dataset.onSync("asyncRequested", that._propagate, that).onSync("asyncCanceled", that._propagate, that).onSync("asyncReceived", that._propagate, that).onSync("rendered", that._onRendered, that).onSync("cleared", that._onCleared, that);
                });
                return this;
            },
            isOpen: function isOpen() {
                return this.$node.hasClass(this.classes.open);
            },
            open: function open() {
                this.$node.addClass(this.classes.open);
            },
            close: function close() {
                this.$node.removeClass(this.classes.open);
                this._removeCursor();
            },
            setLanguageDirection: function setLanguageDirection(dir) {
                this.$node.attr("dir", dir);
            },
            selectableRelativeToCursor: function selectableRelativeToCursor(delta) {
                var $selectables, $oldCursor, oldIndex, newIndex;
                $oldCursor = this.getActiveSelectable();
                $selectables = this._getSelectables();
                oldIndex = $oldCursor ? $selectables.index($oldCursor) : -1;
                newIndex = oldIndex + delta;
                newIndex = (newIndex + 1) % ($selectables.length + 1) - 1;
                newIndex = newIndex < -1 ? $selectables.length - 1 : newIndex;
                return newIndex === -1 ? null : $selectables.eq(newIndex);
            },
            setCursor: function setCursor($selectable) {
                this._removeCursor();
                if ($selectable = $selectable && $selectable.first()) {
                    $selectable.addClass(this.classes.cursor);
                    this._ensureVisible($selectable);
                }
            },
            getSelectableData: function getSelectableData($el) {
                return $el && $el.length ? Dataset.extractData($el) : null;
            },
            getActiveSelectable: function getActiveSelectable() {
                var $selectable = this._getSelectables().filter(this.selectors.cursor).first();
                return $selectable.length ? $selectable : null;
            },
            getTopSelectable: function getTopSelectable() {
                var $selectable = this._getSelectables().first();
                return $selectable.length ? $selectable : null;
            },
            update: function update(query) {
                var isValidUpdate = query !== this.query;
                if (isValidUpdate) {
                    this.query = query;
                    _.each(this.datasets, updateDataset);
                }
                return isValidUpdate;
                function updateDataset(dataset) {
                    dataset.update(query);
                }
            },
            empty: function empty() {
                _.each(this.datasets, clearDataset);
                this.query = null;
                this.$node.addClass(this.classes.empty);
                function clearDataset(dataset) {
                    dataset.clear();
                }
            },
            destroy: function destroy() {
                this.$node.off(".tt");
                this.$node = $("<div>");
                _.each(this.datasets, destroyDataset);
                function destroyDataset(dataset) {
                    dataset.destroy();
                }
            }
        });
        return Menu;
    }();
    var DefaultMenu = function() {
        "use strict";
        var s = Menu.prototype;
        function DefaultMenu() {
            Menu.apply(this, [].slice.call(arguments, 0));
        }
        _.mixin(DefaultMenu.prototype, Menu.prototype, {
            open: function open() {
                !this._allDatasetsEmpty() && this._show();
                return s.open.apply(this, [].slice.call(arguments, 0));
            },
            close: function close() {
                this._hide();
                return s.close.apply(this, [].slice.call(arguments, 0));
            },
            _onRendered: function onRendered() {
                if (this._allDatasetsEmpty()) {
                    this._hide();
                } else {
                    this.isOpen() && this._show();
                }
                return s._onRendered.apply(this, [].slice.call(arguments, 0));
            },
            _onCleared: function onCleared() {
                if (this._allDatasetsEmpty()) {
                    this._hide();
                } else {
                    this.isOpen() && this._show();
                }
                return s._onCleared.apply(this, [].slice.call(arguments, 0));
            },
            setLanguageDirection: function setLanguageDirection(dir) {
                this.$node.css(dir === "ltr" ? this.css.ltr : this.css.rtl);
                return s.setLanguageDirection.apply(this, [].slice.call(arguments, 0));
            },
            _hide: function hide() {
                this.$node.hide();
            },
            _show: function show() {
                this.$node.css("display", "block");
            }
        });
        return DefaultMenu;
    }();
    var Typeahead = function() {
        "use strict";
        function Typeahead(o, www) {
            var onFocused, onBlurred, onEnterKeyed, onTabKeyed, onEscKeyed, onUpKeyed, onDownKeyed, onLeftKeyed, onRightKeyed, onQueryChanged, onWhitespaceChanged;
            o = o || {};
            if (!o.input) {
                $.error("missing input");
            }
            if (!o.menu) {
                $.error("missing menu");
            }
            if (!o.eventBus) {
                $.error("missing event bus");
            }
            www.mixin(this);
            this.eventBus = o.eventBus;
            this.minLength = _.isNumber(o.minLength) ? o.minLength : 1;
            this.input = o.input;
            this.menu = o.menu;
            this.enabled = true;
            this.active = false;
            this.input.hasFocus() && this.activate();
            this.dir = this.input.getLangDir();
            this._hacks();
            this.menu.bind().onSync("selectableClicked", this._onSelectableClicked, this).onSync("asyncRequested", this._onAsyncRequested, this).onSync("asyncCanceled", this._onAsyncCanceled, this).onSync("asyncReceived", this._onAsyncReceived, this).onSync("datasetRendered", this._onDatasetRendered, this).onSync("datasetCleared", this._onDatasetCleared, this);
            onFocused = c(this, "activate", "open", "_onFocused");
            onBlurred = c(this, "deactivate", "_onBlurred");
            onEnterKeyed = c(this, "isActive", "isOpen", "_onEnterKeyed");
            onTabKeyed = c(this, "isActive", "isOpen", "_onTabKeyed");
            onEscKeyed = c(this, "isActive", "_onEscKeyed");
            onUpKeyed = c(this, "isActive", "open", "_onUpKeyed");
            onDownKeyed = c(this, "isActive", "open", "_onDownKeyed");
            onLeftKeyed = c(this, "isActive", "isOpen", "_onLeftKeyed");
            onRightKeyed = c(this, "isActive", "isOpen", "_onRightKeyed");
            onQueryChanged = c(this, "_openIfActive", "_onQueryChanged");
            onWhitespaceChanged = c(this, "_openIfActive", "_onWhitespaceChanged");
            this.input.bind().onSync("focused", onFocused, this).onSync("blurred", onBlurred, this).onSync("enterKeyed", onEnterKeyed, this).onSync("tabKeyed", onTabKeyed, this).onSync("escKeyed", onEscKeyed, this).onSync("upKeyed", onUpKeyed, this).onSync("downKeyed", onDownKeyed, this).onSync("leftKeyed", onLeftKeyed, this).onSync("rightKeyed", onRightKeyed, this).onSync("queryChanged", onQueryChanged, this).onSync("whitespaceChanged", onWhitespaceChanged, this).onSync("langDirChanged", this._onLangDirChanged, this);
        }
        _.mixin(Typeahead.prototype, {
            _hacks: function hacks() {
                var $input, $menu;
                $input = this.input.$input || $("<div>");
                $menu = this.menu.$node || $("<div>");
                $input.on("blur.tt", function($e) {
                    var active, isActive, hasActive;
                    active = document.activeElement;
                    isActive = $menu.is(active);
                    hasActive = $menu.has(active).length > 0;
                    if (_.isMsie() && (isActive || hasActive)) {
                        $e.preventDefault();
                        $e.stopImmediatePropagation();
                        _.defer(function() {
                            $input.focus();
                        });
                    }
                });
                $menu.on("mousedown.tt", function($e) {
                    $e.preventDefault();
                });
            },
            _onSelectableClicked: function onSelectableClicked(type, $el) {
                this.select($el);
            },
            _onDatasetCleared: function onDatasetCleared() {
                this._updateHint();
            },
            _onDatasetRendered: function onDatasetRendered(type, dataset, suggestions, async) {
                this._updateHint();
                this.eventBus.trigger("render", suggestions, async, dataset);
            },
            _onAsyncRequested: function onAsyncRequested(type, dataset, query) {
                this.eventBus.trigger("asyncrequest", query, dataset);
            },
            _onAsyncCanceled: function onAsyncCanceled(type, dataset, query) {
                this.eventBus.trigger("asynccancel", query, dataset);
            },
            _onAsyncReceived: function onAsyncReceived(type, dataset, query) {
                this.eventBus.trigger("asyncreceive", query, dataset);
            },
            _onFocused: function onFocused() {
                this._minLengthMet() && this.menu.update(this.input.getQuery());
            },
            _onBlurred: function onBlurred() {
                if (this.input.hasQueryChangedSinceLastFocus()) {
                    this.eventBus.trigger("change", this.input.getQuery());
                }
            },
            _onEnterKeyed: function onEnterKeyed(type, $e) {
                var $selectable;
                if ($selectable = this.menu.getActiveSelectable()) {
                    this.select($selectable) && $e.preventDefault();
                }
            },
            _onTabKeyed: function onTabKeyed(type, $e) {
                var $selectable;
                if ($selectable = this.menu.getActiveSelectable()) {
                    this.select($selectable) && $e.preventDefault();
                } else if ($selectable = this.menu.getTopSelectable()) {
                    this.autocomplete($selectable) && $e.preventDefault();
                }
            },
            _onEscKeyed: function onEscKeyed() {
                this.close();
            },
            _onUpKeyed: function onUpKeyed() {
                this.moveCursor(-1);
            },
            _onDownKeyed: function onDownKeyed() {
                this.moveCursor(+1);
            },
            _onLeftKeyed: function onLeftKeyed() {
                if (this.dir === "rtl" && this.input.isCursorAtEnd()) {
                    this.autocomplete(this.menu.getTopSelectable());
                }
            },
            _onRightKeyed: function onRightKeyed() {
                if (this.dir === "ltr" && this.input.isCursorAtEnd()) {
                    this.autocomplete(this.menu.getTopSelectable());
                }
            },
            _onQueryChanged: function onQueryChanged(e, query) {
                this._minLengthMet(query) ? this.menu.update(query) : this.menu.empty();
            },
            _onWhitespaceChanged: function onWhitespaceChanged() {
                this._updateHint();
            },
            _onLangDirChanged: function onLangDirChanged(e, dir) {
                if (this.dir !== dir) {
                    this.dir = dir;
                    this.menu.setLanguageDirection(dir);
                }
            },
            _openIfActive: function openIfActive() {
                this.isActive() && this.open();
            },
            _minLengthMet: function minLengthMet(query) {
                query = _.isString(query) ? query : this.input.getQuery() || "";
                return query.length >= this.minLength;
            },
            _updateHint: function updateHint() {
                var $selectable, data, val, query, escapedQuery, frontMatchRegEx, match;
                $selectable = this.menu.getTopSelectable();
                data = this.menu.getSelectableData($selectable);
                val = this.input.getInputValue();
                if (data && !_.isBlankString(val) && !this.input.hasOverflow()) {
                    query = Input.normalizeQuery(val);
                    escapedQuery = _.escapeRegExChars(query);
                    frontMatchRegEx = new RegExp("^(?:" + escapedQuery + ")(.+$)", "i");
                    match = frontMatchRegEx.exec(data.val);
                    match && this.input.setHint(val + match[1]);
                } else {
                    this.input.clearHint();
                }
            },
            isEnabled: function isEnabled() {
                return this.enabled;
            },
            enable: function enable() {
                this.enabled = true;
            },
            disable: function disable() {
                this.enabled = false;
            },
            isActive: function isActive() {
                return this.active;
            },
            activate: function activate() {
                if (this.isActive()) {
                    return true;
                } else if (!this.isEnabled() || this.eventBus.before("active")) {
                    return false;
                } else {
                    this.active = true;
                    this.eventBus.trigger("active");
                    return true;
                }
            },
            deactivate: function deactivate() {
                if (!this.isActive()) {
                    return true;
                } else if (this.eventBus.before("idle")) {
                    return false;
                } else {
                    this.active = false;
                    this.close();
                    this.eventBus.trigger("idle");
                    return true;
                }
            },
            isOpen: function isOpen() {
                return this.menu.isOpen();
            },
            open: function open() {
                if (!this.isOpen() && !this.eventBus.before("open")) {
                    this.menu.open();
                    this._updateHint();
                    this.eventBus.trigger("open");
                }
                return this.isOpen();
            },
            close: function close() {
                if (this.isOpen() && !this.eventBus.before("close")) {
                    this.menu.close();
                    this.input.clearHint();
                    this.input.resetInputValue();
                    this.eventBus.trigger("close");
                }
                return !this.isOpen();
            },
            setVal: function setVal(val) {
                this.input.setQuery(_.toStr(val));
            },
            getVal: function getVal() {
                return this.input.getQuery();
            },
            select: function select($selectable) {
                var data = this.menu.getSelectableData($selectable);
                if (data && !this.eventBus.before("select", data.obj)) {
                    this.input.setQuery(data.val, true);
                    this.eventBus.trigger("select", data.obj);
                    this.close();
                    return true;
                }
                return false;
            },
            autocomplete: function autocomplete($selectable) {
                var query, data, isValid;
                query = this.input.getQuery();
                data = this.menu.getSelectableData($selectable);
                isValid = data && query !== data.val;
                if (isValid && !this.eventBus.before("autocomplete", data.obj)) {
                    this.input.setQuery(data.val);
                    this.eventBus.trigger("autocomplete", data.obj);
                    return true;
                }
                return false;
            },
            moveCursor: function moveCursor(delta) {
                var query, $candidate, data, payload, cancelMove;
                query = this.input.getQuery();
                $candidate = this.menu.selectableRelativeToCursor(delta);
                data = this.menu.getSelectableData($candidate);
                payload = data ? data.obj : null;
                cancelMove = this._minLengthMet() && this.menu.update(query);
                if (!cancelMove && !this.eventBus.before("cursorchange", payload)) {
                    this.menu.setCursor($candidate);
                    if (data) {
                        this.input.setInputValue(data.val);
                    } else {
                        this.input.resetInputValue();
                        this._updateHint();
                    }
                    this.eventBus.trigger("cursorchange", payload);
                    return true;
                }
                return false;
            },
            destroy: function destroy() {
                this.input.destroy();
                this.menu.destroy();
            }
        });
        return Typeahead;
        function c(ctx) {
            var methods = [].slice.call(arguments, 1);
            return function() {
                var args = [].slice.call(arguments);
                _.each(methods, function(method) {
                    return ctx[method].apply(ctx, args);
                });
            };
        }
    }();
    (function() {
        "use strict";
        var old, keys, methods;
        old = $.fn.typeahead;
        keys = {
            www: "tt-www",
            attrs: "tt-attrs",
            typeahead: "tt-typeahead"
        };
        methods = {
            initialize: function initialize(o, datasets) {
                var www;
                datasets = _.isArray(datasets) ? datasets : [].slice.call(arguments, 1);
                o = o || {};
                www = WWW(o.classNames);
                return this.each(attach);
                function attach() {
                    var $input, $wrapper, $hint, $menu, defaultHint, defaultMenu, eventBus, input, menu, typeahead, MenuConstructor;
                    _.each(datasets, function(d) {
                        d.highlight = !!o.highlight;
                    });
                    $input = $(this);
                    $wrapper = $(www.html.wrapper);
                    $hint = $elOrNull(o.hint);
                    $menu = $elOrNull(o.menu);
                    defaultHint = o.hint !== false && !$hint;
                    defaultMenu = o.menu !== false && !$menu;
                    defaultHint && ($hint = buildHintFromInput($input, www));
                    defaultMenu && ($menu = $(www.html.menu).css(www.css.menu));
                    $hint && $hint.val("");
                    $input = prepInput($input, www);
                    if (defaultHint || defaultMenu) {
                        $wrapper.css(www.css.wrapper);
                        $input.css(defaultHint ? www.css.input : www.css.inputWithNoHint);
                        $input.wrap($wrapper).parent().prepend(defaultHint ? $hint : null).append(defaultMenu ? $menu : null);
                    }
                    MenuConstructor = defaultMenu ? DefaultMenu : Menu;
                    eventBus = new EventBus({
                        el: $input
                    });
                    input = new Input({
                        hint: $hint,
                        input: $input
                    }, www);
                    menu = new MenuConstructor({
                        node: $menu,
                        datasets: datasets
                    }, www);
                    typeahead = new Typeahead({
                        input: input,
                        menu: menu,
                        eventBus: eventBus,
                        minLength: o.minLength
                    }, www);
                    $input.data(keys.www, www);
                    $input.data(keys.typeahead, typeahead);
                }
            },
            isEnabled: function isEnabled() {
                var enabled;
                ttEach(this.first(), function(t) {
                    enabled = t.isEnabled();
                });
                return enabled;
            },
            enable: function enable() {
                ttEach(this, function(t) {
                    t.enable();
                });
                return this;
            },
            disable: function disable() {
                ttEach(this, function(t) {
                    t.disable();
                });
                return this;
            },
            isActive: function isActive() {
                var active;
                ttEach(this.first(), function(t) {
                    active = t.isActive();
                });
                return active;
            },
            activate: function activate() {
                ttEach(this, function(t) {
                    t.activate();
                });
                return this;
            },
            deactivate: function deactivate() {
                ttEach(this, function(t) {
                    t.deactivate();
                });
                return this;
            },
            isOpen: function isOpen() {
                var open;
                ttEach(this.first(), function(t) {
                    open = t.isOpen();
                });
                return open;
            },
            open: function open() {
                ttEach(this, function(t) {
                    t.open();
                });
                return this;
            },
            close: function close() {
                ttEach(this, function(t) {
                    t.close();
                });
                return this;
            },
            select: function select(el) {
                var success = false, $el = $(el);
                ttEach(this.first(), function(t) {
                    success = t.select($el);
                });
                return success;
            },
            autocomplete: function autocomplete(el) {
                var success = false, $el = $(el);
                ttEach(this.first(), function(t) {
                    success = t.autocomplete($el);
                });
                return success;
            },
            moveCursor: function moveCursoe(delta) {
                var success = false;
                ttEach(this.first(), function(t) {
                    success = t.moveCursor(delta);
                });
                return success;
            },
            val: function val(newVal) {
                var query;
                if (!arguments.length) {
                    ttEach(this.first(), function(t) {
                        query = t.getVal();
                    });
                    return query;
                } else {
                    ttEach(this, function(t) {
                        t.setVal(newVal);
                    });
                    return this;
                }
            },
            destroy: function destroy() {
                ttEach(this, function(typeahead, $input) {
                    revert($input);
                    typeahead.destroy();
                });
                return this;
            }
        };
        $.fn.typeahead = function(method) {
            if (methods[method]) {
                return methods[method].apply(this, [].slice.call(arguments, 1));
            } else {
                return methods.initialize.apply(this, arguments);
            }
        };
        $.fn.typeahead.noConflict = function noConflict() {
            $.fn.typeahead = old;
            return this;
        };
        function ttEach($els, fn) {
            $els.each(function() {
                var $input = $(this), typeahead;
                (typeahead = $input.data(keys.typeahead)) && fn(typeahead, $input);
            });
        }
        function buildHintFromInput($input, www) {
            return $input.clone().addClass(www.classes.hint).removeData().css(www.css.hint).css(getBackgroundStyles($input)).prop("readonly", true).removeAttr("id name placeholder required").attr({
                autocomplete: "off",
                spellcheck: "false",
                tabindex: -1
            });
        }
        function prepInput($input, www) {
            $input.data(keys.attrs, {
                dir: $input.attr("dir"),
                autocomplete: $input.attr("autocomplete"),
                spellcheck: $input.attr("spellcheck"),
                style: $input.attr("style")
            });
            $input.addClass(www.classes.input).attr({
                autocomplete: "off",
                spellcheck: false
            });
            try {
                !$input.attr("dir") && $input.attr("dir", "auto");
            } catch (e) {}
            return $input;
        }
        function getBackgroundStyles($el) {
            return {
                backgroundAttachment: $el.css("background-attachment"),
                backgroundClip: $el.css("background-clip"),
                backgroundColor: $el.css("background-color"),
                backgroundImage: $el.css("background-image"),
                backgroundOrigin: $el.css("background-origin"),
                backgroundPosition: $el.css("background-position"),
                backgroundRepeat: $el.css("background-repeat"),
                backgroundSize: $el.css("background-size")
            };
        }
        function revert($input) {
            var www, $wrapper;
            www = $input.data(keys.www);
            $wrapper = $input.parent().filter(www.selectors.wrapper);
            _.each($input.data(keys.attrs), function(val, key) {
                _.isUndefined(val) ? $input.removeAttr(key) : $input.attr(key, val);
            });
            $input.removeData(keys.typeahead).removeData(keys.www).removeData(keys.attr).removeClass(www.classes.input);
            if ($wrapper.length) {
                $input.detach().insertAfter($wrapper);
                $wrapper.remove();
            }
        }
        function $elOrNull(obj) {
            var isValid, $el;
            isValid = _.isJQuery(obj) || _.isElement(obj);
            $el = isValid ? $(obj).first() : [];
            return $el.length ? $el : null;
        }
    })();
});

// Adobe Analytics start
var eventName, policyNo, keyPolicyNo, nri, userType;
var digitalData;
var lowerCasePageName;
adobeAnalyticsOnLoad();

// On load -page
function adobeAnalyticsOnLoad(eventName, policyNo, keyPolicyNo, nri, userType) {
    try {
    digitalData = {};
    if((window.location.href != 'https://www.hdfclife.com') && (window.location.href != 'https://www.hdfclife.com/')){
    pageName = window.location.href.split('/')[window.location.href.split('/').length - 1];
    if(pageName.includes('.')){
        lowerCasePageName = pageName.split('.')[0].replaceAll('-', ' ')
        
    } 
    else if(pageName.includes('?')){
        lowerCasePageName = pageName.split('?')[0].replaceAll('-', ' ')
    }
    else{
        lowerCasePageName = pageName.replaceAll('-', ' ')
    }

    var lowerCaseArray = lowerCasePageName.split(" ");

    for (var i = 0; i < lowerCaseArray.length; i++) {
        lowerCaseArray[i] = lowerCaseArray[i].charAt(0).toUpperCase() + lowerCaseArray[i].slice(1);
    }

    var eventName = lowerCaseArray.join(' ');
}
else{
    var eventName = 'HDFC Life Insurance Company';
}

    policyNo = policyNo ? policyNo : '';
    keyPolicyNo = keyPolicyNo ? keyPolicyNo : '';
    nri = nri ? nri : '';
    userType = userType ? userType : '';


    digitalData.policyNo = policyNo || "";
    digitalData.keyPolicyNo = keyPolicyNo || "";
    digitalData.nri = nri || "";
    digitalData.userType = userType || "";

    console.log(eventName, policyNo, keyPolicyNo, nri, userType, 'on load');
    _satellite.track("page");

    }
    catch (err) {
        console.log('err: ', err);
    }
}

// function of adobeAnalytics
function adobeAnalytics(eventName, policyNo, keyPolicyNo, nri, userType) {
    try {
        digitalData = {};
        digitalData.eventName = eventName || "";
        digitalData.policyNo = policyNo || "";
        digitalData.keyPolicyNo = keyPolicyNo || "";
        digitalData.nri = nri || "";
        digitalData.userType = userType || "";
        _satellite.track("event");
        console.log(eventName, policyNo, keyPolicyNo, nri, userType, 'click event');
          
    }
    catch (err) {
        console.log('err: ', err);
    }
}

// on click 
$(document).ready(function () {
    $('.linkAdobeAnalytics').click(function () {
        if ($(this).attr('data-eventname')) {
            eventName = $(this).attr('data-eventname');
            policyNo = policyNo ? policyNo : '';
            keyPolicyNo = keyPolicyNo ? keyPolicyNo : '';
            nri = nri ? nri : '';
            userType = userType ? userType : '';
            adobeAnalytics(eventName, policyNo, keyPolicyNo, nri, userType);
        }
    });

});

// on dropdown option select
var selectElements = document.querySelectorAll('.products-tab-select');

selectElements.forEach(function(selectElement) {
    selectElement.addEventListener('change', function() {
        var selectedOption = this.options[this.selectedIndex];
        
        if (selectedOption.getAttribute('data-eventname')) {
            var eventName = selectedOption.getAttribute('data-eventname');
            var policyNo = policyNo ? policyNo : '';
            var keyPolicyNo = keyPolicyNo ? keyPolicyNo : '';
            var nri = nri ? nri : '';
            var userType = userType ? userType : '';
            
            adobeAnalytics(eventName, policyNo, keyPolicyNo, nri, userType);
        }
    });
});
// Adobe Analytics end

// on click lemnisk tracking
$(document).ready(function () {
    $('.lemniskTrackingEventName').click(function (event) {
        try {
            // Check if the clicked element has the data-eventname attribute
            if ($(this).attr('data-eventname')) {
                event.preventDefault();
                // Get the value of data-eventname attribute
                let lemniskEventName = $(this).attr('data-eventname');
                // Get the href attribute for the redirection URL
                let redirectUrl = $(this).attr('href');
                // Check if lmSMTObj is defined and has the track function
                if (typeof lmSMTObj !== 'undefined' && typeof lmSMTObj.track === 'function') {
                    // Call the Lemnisk tracking function with the event name
                    lmSMTObj.track(lemniskEventName);
                    if (redirectUrl) {
                        setTimeout(function() {
                            window.location.href = redirectUrl;
                        }, 500);
                    }
                }
            } else {
                console.log('data-eventname attribute is missing on the clicked element');
            }
        } catch (error) {
            console.error('Error in Lemnisk tracking:', error);
        }
    });  

    // Attach blur event to the email input field
    $('.lemniskTrackingEmailInput').blur(function () {
        try {
            // Check if the email input field has the data-eventname attribute
            let lemniskEventName = $(this).attr('data-eventname');
            if (lemniskEventName) {
                // Get the value of the email input field
                let emailValue = $(this).val();

                // Check if lmSMTObj is defined and has the track function
                if (typeof lmSMTObj !== 'undefined' && typeof lmSMTObj.track === 'function') {
                    // Call the Lemnisk tracking function with the event name and email value
                    lmSMTObj.track(lemniskEventName, {}, { "email": emailValue });
                }
            }
        } catch (error) {
            console.error('Error in Lemnisk tracking:', error);
        }
    });

    // Attach click event to the talktoAdvisor button
    $('.lemniskTrackingtalktoAdvisorButton').click(function () {
        try {
            // Get the event name from the data-eventname attribute
            let lemniskEventName = $(this).attr('data-eventname');
            if (lemniskEventName) {
                // Get the category product value from the hidden input field
                let categoryProduct = $('#lemniskTrackingCategoryProduct').val();

                // Check if lmSMTObj is defined and has the track function
                if (typeof lmSMTObj !== 'undefined' && typeof lmSMTObj.track === 'function') {
                    // Call the Lemnisk tracking function with the event name and category product value
                    lmSMTObj.track(lemniskEventName, { "categoryProduct": categoryProduct });
                }
            }
        } catch (error) {
            console.error('Error in Lemnisk tracking:', error);
        }
    });

    // Handler for the scheduleCall button
    $('.lemniskTrackingscheduleCallButton').click(function () {
        try {
            // Get the event name from the data-eventname attribute
            let lemniskEventName = $(this).attr('data-eventname');
            if (lemniskEventName) {
                // Get the product value from the hidden input field
                let product = $('#lemniskTrackingProduct').val();

                // Check if lmSMTObj is defined and has the track function
                if (typeof lmSMTObj !== 'undefined' && typeof lmSMTObj.track === 'function') {
                    // Call the Lemnisk tracking function with the event name and product value
                    lmSMTObj.track(lemniskEventName, { "product": product });
                }
            }
        } catch (error) {
            console.error('Error in Lemnisk tracking:', error);
        }
    });

    // downloadsection component white btn
    try {
        $('.lemniskTrackingEventTriggerWhite').on("click", function (event) {
            if ($(this).attr('data-eventname')) {
                event.preventDefault();
                let eventName = $(this).attr('data-eventname').trim();
                let redirectUrl = $(this).attr('href');
                if (eventName) {
                    let revisedEventName = eventName.trim().toLowerCase();
                    const currentwebpage = window.location.href;
                    const currentWebPageOrigin = window.location.origin;
                    const categoryCTA = currentwebpage == currentWebPageOrigin ? "HomePage" : "product page";
                    const leadID = "";
                    const stepName = "Calculate Click";
                    if (typeof lmSMTObj !== 'undefined' && typeof lmSMTObj.track === 'function') {
                        if (revisedEventName == 'calculateclickedc2ps'.trim().toLowerCase()) {
                            let productCode = "C2PS";
                            lemniskTrackingFourField(eventName, categoryCTA, leadID, productCode, stepName);
                        }
                        if (revisedEventName == 'calculateclickedsp'.trim().toLowerCase()) {
                            let productCode = "Sanchay Plus";
                            lemniskTrackingThreeField(eventName, leadID, productCode, stepName);
                        }
                        if (redirectUrl) {
                            setTimeout(function() {
                                window.location.href = redirectUrl;
                            }, 500);
                        }
                    }
                }
            }
        });
    } catch (error) {
        console.error('An error occurred in the event handler:', error);
    }

    // downloadsection component red btn
    $('.lemniskTrackingEventTriggerRed').on("click", function (event) {
        try {
            if ($(this).attr('data-eventname')) {
                event.preventDefault();
                let eventName = $(this).attr('data-eventname').trim();
                let redirectUrl = $(this).attr('href');
                if (eventName) {
                    let revisedEventName = eventName.trim().toLowerCase();
                    const leadID = "";
                    const stepName = "Buy Now";
                    let productCode;
                    if (typeof lmSMTObj !== 'undefined' && typeof lmSMTObj.track === 'function') {
                        if (revisedEventName == 'buynowclickedsp'.trim().toLowerCase()) {
                            productCode = "Sanchay Plus";
                            lemniskTrackingThreeField(eventName, leadID, productCode, stepName);
                        }
                        if (revisedEventName == 'buynowclickedc2ps'.trim().toLowerCase()) {
                            productCode = "C2PS";
                            lemniskTrackingThreeField(eventName, leadID, productCode, stepName);
                        }
                        if (redirectUrl) {
                            setTimeout(function() {
                                window.location.href = redirectUrl;
                            }, 500);
                        }
                    }
                }
            }
        } catch (error) {
            console.error('Error in tracking event:', error);
        }
    });

    // category banner v2 
    $('.lemniskTrackingEventClickTrigger').on('click', function (e) {
        try {
            if ($(this).attr('data-eventname')) {
                e.preventDefault();
                let eventName = $(this).attr('data-eventname').trim();
                if (eventName) {
                    let revisedEventName = eventName.toLowerCase();
                    let leadID = "";
                    let productCode = "";
                    let stepName = "";
                    if (typeof lmSMTObj !== 'undefined' && typeof lmSMTObj.track === 'function') {
                        if (revisedEventName == "calculatePremiumTI".trim().toLowerCase()) {
                            productCode = "C2PS";
                            stepName = "Calculate Premium TI";
                            lemniskTrackingThreeField(eventName, leadID, productCode, stepName);
                        }
                        if (revisedEventName == "calculatePremiumSavingsPlan".trim().toLowerCase()) {
                            productCode = "Sanchay Plus";
                            stepName = "Calculate Premium SP";
                            lemniskTrackingThreeField(eventName, leadID, productCode, stepName);
                        }
                    }
                }
            }
        } catch (error) {
            console.error('An error occurred:', error);
        }
    });

    // term banner v2 calculate premium
    $('.lemniskTrackingEventNameCalPremium').on('click', function (event) {
        try {
            if ($(this).attr('data-eventname')) {
                event.preventDefault();
                let eventName = $(this).attr('data-eventname').trim();
                let redirectUrl = $(this).attr('href');
                if (eventName) {
                    let revisedEventName = eventName.toLowerCase();
                    let leadID = "";
                    let productCode = "";
                    let stepName = "";
                    if (typeof lmSMTObj !== 'undefined' && typeof lmSMTObj.track === 'function') {
                        if (revisedEventName == "calculatePremiumTI".trim().toLowerCase()) {
                            productCode = "C2PS";
                            stepName = "Calculate Premium TI";
                            lemniskTrackingThreeField(eventName, leadID, productCode, stepName);
                        }
                        if (redirectUrl) {
                            setTimeout(function() {
                                window.location.href = redirectUrl;
                            }, 500);
                        }
                    }
                }
            }
        } catch (error) {
            console.error('An error occurred:', error);
        }
    });

    $(".lemniskNameFilled").on("blur", function () {
        try {
            var eventName = $(this).data("event-name");
            if (eventName) {
                var fullName = customTrim($(this).val());
                lmSMTObj.track(eventName, {
                    "fullName": fullName
                })
            }
        } catch {
            console.log("error")
        }
    });
    $(".lemniskPhoneFilled").on("blur", function () {
        try {
            var eventName = $(this).data("event-name");
            if (eventName) {
                var phoneNumber = customTrim($(this).val());
                var countryCode = customTrim($(this).closest("form").find("input[data-id='countryCode']").val());
                lmSMTObj.track(eventName, {}, {
                    "phone": "+" + countryCode + phoneNumber
                });
            }
        } catch {
            console.log("error");
        }
    });
    
});

// Function to check if any searchString exists in the URL
function searchStringInUrl(url, searchStrings) {
    for (let searchString of searchStrings) {
        if (url.includes(searchString)) {
            return searchString;
        }
    }
    return null;
}

function isTrackingDataValid(value) {
    return value !== null && value !== undefined && value !== '';
}

// banner-form-otp & banner-form-otp-v2 cta click event
function lemniskTrackingBannerFormOtpCta(eventName, fullName, nri, leadID, product, stepName, countryPhoneCode, phone) {
    let mainObj = {};
    if (isTrackingDataValid(fullName)) mainObj.fullName = fullName;
    if (isTrackingDataValid(nri)) mainObj.NRI = nri;
    if (isTrackingDataValid(leadID)) mainObj.leadID = leadID.toString();
    if (isTrackingDataValid(product)) mainObj.product = product;
    if (isTrackingDataValid(stepName)) mainObj.stepName = stepName;
    let phoneObj = {};
    if (countryPhoneCode && phone) {
        phoneObj.phone = `+${countryPhoneCode}${phone}`;
    }
    lmSMTObj.track(eventName, mainObj, phoneObj);
}

// categoryCTA, leadID, productCode, stepName
function lemniskTrackingFourField(eventName, categoryCTA, leadID, productCode, stepName) {
    let trackingData = {};
    if (isTrackingDataValid(categoryCTA)) trackingData["categoryCTA"] = categoryCTA;
    if (isTrackingDataValid(leadID)) trackingData["leadID"] = leadID.toString();
    if (isTrackingDataValid(productCode)) trackingData["product"] = productCode;
    if (isTrackingDataValid(stepName)) trackingData["stepName"] = stepName;
    // Send tracking data
    lmSMTObj.track(eventName, trackingData);
}
// three field
function lemniskTrackingThreeField(eventName, lead, productCode, stepName) {
    let trackingData = {};
    if (isTrackingDataValid(lead)) trackingData["leadID"] = lead.toString();
    if (isTrackingDataValid(productCode)) trackingData["product"] = productCode;
    if (isTrackingDataValid(stepName)) trackingData["stepName"] = stepName;
    lmSMTObj.track(eventName, trackingData)
}
// ulip banner form cta click event 
function lemniskTrackingUlipBannerFormCta(eventName, fullName, gender, nri, dob, leadID, product, stepName, countryPhoneCode, phone, email) {
    let mainObj = {};
    if (isTrackingDataValid(fullName)) mainObj['fullName'] = fullName;
    if (isTrackingDataValid(gender)) mainObj['Gender'] = gender;
    if (isTrackingDataValid(nri)) mainObj['NRI'] = nri;
    if (isTrackingDataValid(dob)) mainObj['dob'] = dob;
    if (isTrackingDataValid(leadID)) mainObj['leadID'] = leadID.toString();
    if (isTrackingDataValid(product)) mainObj['product'] = product;
    if (isTrackingDataValid(stepName)) mainObj['stepName'] = stepName;

    let phoneObj = {};
    if (isTrackingDataValid(countryPhoneCode) && isTrackingDataValid(phone)) {
        phoneObj['phone'] = `+${countryPhoneCode}${phone}`;
    }

    if (isTrackingDataValid(email)) phoneObj['email'] = email;
    lmSMTObj.track(eventName, mainObj, phoneObj);
}

// term banner form v2
function lemniskTrackingTermBannerFormV2Cta(eventName, name, gender, dob, nri, smoker, consent, categoryProduct, leadId, product, stepName, countryCode, phone, email) {
    let mainObj = {};
    if (isTrackingDataValid(name)) mainObj['fullName'] = name;
    if (isTrackingDataValid(gender)) mainObj['Gender'] = gender;
    if (isTrackingDataValid(dob)) mainObj['dob'] = dob;
    if (isTrackingDataValid(nri)) mainObj['NRI'] = nri;
    if (isTrackingDataValid(smoker)) mainObj['Smoker'] = smoker;
    if (isTrackingDataValid(consent)) mainObj['consent'] = consent;
    if (isTrackingDataValid(categoryProduct)) mainObj['categoryProduct'] = categoryProduct;
    if (isTrackingDataValid(leadId)) mainObj['leadID'] = leadId.toString();
    if (isTrackingDataValid(product)) mainObj['product'] = product;
    if (isTrackingDataValid(stepName)) mainObj['stepName'] = stepName;

    let contactObj = {};
    if (isTrackingDataValid(countryCode) && isTrackingDataValid(phone)) {
        contactObj['phone'] = `+${countryCode}${phone}`;
    }
    if (isTrackingDataValid(email)) {
        contactObj['email'] = email;
    }

    lmSMTObj.track(eventName, mainObj, contactObj);
}
/**
 * jQuery.browser.mobile (http://detectmobilebrowser.com/)
 * jQuery.browser.mobile will be true if the browser is a mobile device
 **/



var isMobileDevice = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
var isiPad = /ipad/i.test(navigator.userAgent.toLowerCase());
var isiPhone = /iphone/i.test(navigator.userAgent.toLowerCase());
var isiPod = /ipod/i.test(navigator.userAgent.toLowerCase());
var isiDevice = /ipad|iphone|ipod/i.test(navigator.userAgent.toLowerCase());
var isAndroid = /android/i.test(navigator.userAgent.toLowerCase());
var isBlackBerry = /blackberry/i.test(navigator.userAgent.toLowerCase());
var isWebOS = /webos/i.test(navigator.userAgent.toLowerCase());
var isWindowsPhone = /windows phone/i.test(navigator.userAgent.toLowerCase());
(function ($) {

    $.fn.appTabs = function (params) {

        // merge default and user parameters
        params = $.extend({ active: 0 }, params);

        this.each(function () {
            let tabMenu = $(this).find('ul.appTabMenu');
            let tabContent = $(this).children('div');

            tabContent.each(function (index) {
                (index == params.active) ? $(this).show() : $(this).hide()
            });

            $(tabMenu).find('a').click(function (e) {
                let calprevent = $("meta[name='template']").attr("content");
                 if (calprevent == 'home-template') {
                    e.preventDefault();
                }
                else if(calprevent == 'fund-performance-page'){
                    e.preventDefault();
                }
                else if(calprevent == 'home-template22'){
                    e.preventDefault();
                }
                // var current = e.currentTarget;
                // if(!$(current).parent().parent().hasClass('annuity-mobile') ){
                let target = $(this).attr('href')
                // console.log(tabMenu.find('a'), "tabMenu bere");
                tabMenu.find('a').removeClass('active')
                $(this).addClass('active')
                tabContent.each(function (index) { $(this).hide() })
                $(target).fadeIn();
                if(window.screen.width < 768) {
                    $('.products-tab-content').hide();
                    $(`#${$(target).find(".form-select option:selected").val()}`).show();
                }
                // console.log($(this).closest('.aboutTabWrap').find('.products-tab-title-section ul li'), 'tabs li');
                // } 
            })

        });

        return this;
    };
})(jQuery);

//verticalTab
(function ($) {

    $.fn.verticalTab = function (params) {

        params = $.extend({ active: 0 }, params);

        this.each(function () {
            let self = $(this);
            let tabMenu = $(this).find('a');
            let tabContentWrap = $(this).attr('data-contentWrap');
            let tabContent = $('#' + tabContentWrap).find("[data-vid]");

            tabContent.each(function (index) {
                (index == params.active) ? $(this).show() : $(this).hide()
            });

            $(tabMenu).click(function (e) {
                e.preventDefault();
                let content = $(this).attr('href').substring(1);
                self.find('a').removeClass('active')
                $(this).addClass('active')
                $('#' + tabContentWrap).children('div').hide()
                $("[data-vid='" + content + "']").fadeIn();
            })
        });

        return this;
    };
})(jQuery);

//View More Content
(function ($) {
 
    $.fn.viewMoreCont = function (params) {

        params = $.extend({
            toggleText: ['View More', 'View Less'],
            toggleClass: 'viewLessBtn'
        }, params);

        //let iconMoreHtml = $(this).find('span').prop('outerHTML');
        let iconMoreHtml = '<span><svg width="20" height="13" viewBox="0 0 20 13" fill="none" xmlns="http://www.w3.org/2000/svg">';
        iconMoreHtml += '<rect x="0.5" y="0.5" width="19" height="12" rx="6" stroke="#ED1C24"/>'
        iconMoreHtml += '<circle cx="7.5" cy="6.5" r="1.5" fill="#ED1C24"/>'
        iconMoreHtml += '<circle cx="12.5" cy="6.5" r="1.5" fill="#ED1C24"/>'
        iconMoreHtml += '</svg></span>';

        let iconLessHtml = '<span><svg xmlns="http://www.w3.org/2000/svg" width="20" height="13" viewBox="0 0 20 13" fill="none">';
        iconLessHtml += '<rect x="0.5" y="0.5" width="19" height="12" rx="6" stroke="#ED1C24"/>';
        iconLessHtml += '<line x1="7" y1="6.5" x2="14" y2="6.5" stroke="#ED1C24" stroke-width="2" stroke-linecap="round"/>';
        iconLessHtml += '</svg></span>';

        this.each(function () {
            $(this).on('click', function (e) {
                e.preventDefault();
                let hiddenContent = $(this).attr('data-hidden');
                let viewMore = $(this).attr("data-view-text");

                // iconLessHtml = $.parseHTML(iconLessHtml)
                $(this).toggleClass(params.toggleClass);
                let viewLestTxt = iconMoreHtml ? params.toggleText[1] + iconLessHtml : params.toggleText[1] + iconMoreHtml;
                let viewMoreTxt = viewMore + iconMoreHtml;
                $(this).html($(this).hasClass(params.toggleClass) ? viewLestTxt : viewMoreTxt)
                $(this).parent().parent().find('.' + hiddenContent).slideToggle();
                if($(this).parents().hasClass('faq')){  
                        //FAQ Specific
                        if($(this).parent().parent().find('.secondQuestion').position().top < 400)
                        {
                            $('html, body').animate({
                                scrollTop: $(this).parent().parent().find('.secondQuestion').position().top + 590
                            });   
                        }else{
                            $('html, body').animate({
                                scrollTop: $(this).parent().parent().find('.secondQuestion').offset().top
                            }); 
                        }                
                }
                else if ($(this).parents().hasClass('cform')) {
                     
                       // $('html, body').animate({
                       //     scrollTop: $(this).offset().top - 10
                       // });
               }
                else{
                    $('html, body').animate({
                       scrollTop: $(this).parent().parent().find('.' + hiddenContent).offset().top - 150
                      });
                }
            //     var self = this;
            //     setTimeout(function() {
            //     theOffset = $(self).offset();
            //     $('body,html').animate({ scrollTop: theOffset.top - 250});
            // }, 310); 
            $('#download-forms-right').toggleClass("contentHide");
            })
        });
        return this;
    };
})(jQuery);


//View More Content
(function ($) {

   $.fn.viewMoreContTermPage = function (params) {
 
       params = $.extend({
           toggleText: ['View More', 'View Less'],
           toggleClass: 'viewLessBtn'
       }, params);
 
       //let iconMoreHtml = $(this).find('span').prop('outerHTML');
       let iconMoreHtml = '<span><svg width="20" height="13" viewBox="0 0 20 13" fill="none" xmlns="http://www.w3.org/2000/svg">';
       iconMoreHtml += '<rect x="0.5" y="0.5" width="19" height="12" rx="6" stroke="#ED1C24"/>'
       iconMoreHtml += '<circle cx="7.5" cy="6.5" r="1.5" fill="#ED1C24"/>'
       iconMoreHtml += '<circle cx="12.5" cy="6.5" r="1.5" fill="#ED1C24"/>'
       iconMoreHtml += '</svg></span>';
 
       let iconLessHtml = '<span><svg xmlns="http://www.w3.org/2000/svg" width="20" height="13" viewBox="0 0 20 13" fill="none">';
       iconLessHtml += '<rect x="0.5" y="0.5" width="19" height="12" rx="6" stroke="#ED1C24"/>';
       iconLessHtml += '<line x1="7" y1="6.5" x2="14" y2="6.5" stroke="#ED1C24" stroke-width="2" stroke-linecap="round"/>';
       iconLessHtml += '</svg></span>';
 
       this.each(function () {
           $(this).on('click', function (e) {
               e.preventDefault();
               let hiddenContent = $(this).attr('data-hidden');
               let viewMore = $(this).attr("data-view-text");
 
               // iconLessHtml = $.parseHTML(iconLessHtml)
               $(this).toggleClass(params.toggleClass);
               let viewLestTxt = iconMoreHtml ? params.toggleText[1] + iconLessHtml : params.toggleText[1] + iconMoreHtml;
               let viewMoreTxt = viewMore + iconMoreHtml;
               $(this).html($(this).hasClass(params.toggleClass) ? viewLestTxt : viewMoreTxt)
               $(this).parent().parent().parent().find('.' + hiddenContent).slideToggle();
               if($(this).parents().hasClass('faq')){  
                       //FAQ Specific
                       if($(this).parent().parent().find('.secondQuestion').position().top < 400)
                       {
                           $('html, body').animate({
                               scrollTop: $(this).parent().parent().find('.secondQuestion').position().top + 590
                           });   
                       }else{
                           $('html, body').animate({
                               scrollTop: $(this).parent().parent().find('.secondQuestion').position().top
                           }); 
                       }                
               }
               else if ($(this).parents().hasClass('cform')) {
                    
                      // $('html, body').animate({
                      //     scrollTop: $(this).offset().top - 10
                      // });
              }
               else{
                   $('html, body').animate({
                      scrollTop: $(this).parent().parent().parent().find('.' + hiddenContent).offset().top - 150
                     });
               }
           $('#download-forms-right').toggleClass("contentHide");
           })
       });
       return this;
   };
 })(jQuery);

//AppAccordian
(function ($) {

    $.fn.AppAccordian = function (params) {

        // merge default and user parameters
        params = $.extend({ active: 0 }, params);

        this.each(function () {
            let accordMenu = $(this).find(":header");
            let accordCont = $(this).children("div");

            //accordCont.each(function( index ) { (index == params.active) ? $(this).show() : $(this).hide() });

            $(accordMenu).find('a').click(function (e) {
                e.preventDefault();
                let self = $(this);
                let target = self.parent(":header").next('div');

                accordCont.each(function (index) {
                    $(this).not(target).slideUp();
                })
                if (!self.parent(":header").hasClass("opened")) {
                    self.parent(":header").addClass("opened")
                    target.slideDown("medium", function () {
                        $(accordMenu).not(self.parent(":header")).removeClass("opened");
                    })
                } else {
                    target.slideUp('medium', function (e) {
                        self.parent(":header").removeClass("opened");
                    });
                }
            })

        });

        return this;
    }
})(jQuery);



$(document).ready(function () {

    $('.icon-wrap').on('mouseout', function (e) {
        $('.icon-wrap').removeClass('active');
    });

    if ($(window).width() > 1024) {
        $('.icon-wrap').on('mouseover', function (e) {
            $('.icon-wrap').removeClass('active');
            $(this).addClass('active');
        });
    } else {
        $('.icon-wrap').on('click', function (e) {
            e.stopPropagation();
            if ($(this).hasClass('active')) {
                $(this).removeClass('active');
            } else {
                $('.icon-wrap').removeClass('active');
                $(this).addClass('active');
            }
        });
    }

    // $("#product-search").blur(function () {
    //     $(".product-search-autofill").css("display", "none");
    // });

    $('.custom-dropdown ul').hide();
    $('.custom-dropdown li').click(function (e) {
        //alert("xczxc");
        if ($(this).hasClass('open')) {
            $(this).removeClass('open');
            $('.custom-dropdown ul').slideUp();
        } else {
            $(this).addClass('open');
            //$('.custom-dropdown ul').slideDown();
            $(".custom-dropdown ul").slideUp();
        }
    });
    $('.custom-dropdown li').click(function (e) {
        var selValue = $(this).html();
        $('.custom-dropdown li').removeClass('active');
        $(this).addClass('active');
        $('.custom-dropdown span').html(selValue);
        $(".custom-dropdown ul").slideUp();
    });
    commonMethod();
    $('.float-contact-btn').click(function (e) {
        $(".slide-contact-info-wrap").animate({ "left": "0" }, "slow");
        e.preventDefault();
    });
    $('.close-slide-contact-info').click(function (e) {
        $(".slide-contact-info-wrap").animate({ "left": "100%" }, "slow");
        e.preventDefault();
    });


    function hideOtherDropDown(except, classRemove) {
        var popOverSec = ['.megaMenuSec', '.deskTopAccountDD', '.contactInfoPopOver', '.hamMenuWrp'];
        var classDel = (classRemove) ? classRemove : 'opened';
        var otherDropDown = popOverSec.filter(function (sec) {
            return except !== sec
        }).join();
        // console.log('otherDropDown', otherDropDown);
        // console.log('class', classDel);
        $(otherDropDown).removeClass(classDel);
    }

    //Event For Mobile Hamburger Menu
    $('.mobHamMenuLink').click(function (e) {
        e.preventDefault()
        $('.hamMenuSection').addClass('opened')

        var $hamMenus = $('.hamMenuLinks .subMenuLink')
        for (let i = 0; i < $hamMenus.length; i++) {
            if($hamMenus.eq(i).parent().find('.subMenuSection').length === 0){
                $hamMenus.eq(i).find('svg').remove();
            }         
        }
    })
    $('.hamMenuLinks .subMenuLink .menuBullet').click(function (e) {
        e.preventDefault();
        e.stopPropagation();
        
        if (e.target.tagName.toLowerCase() == 'svg') {
            e.preventDefault()
        }
        $(this).parent().siblings('.subMenuSection').addClass('opened')

        var $hamSubMenus = $('.hamMenuLinks .subMenuBC').parent().find('.hamMenuList').children('li')
        for (let i = 0; i < $hamSubMenus.length; i++) {
            if($hamSubMenus.eq(i).find('.hamSubMenu').length === 0){
                $hamSubMenus.eq(i).find('svg').remove();
            }         
        }
    })
    $('.subMenuBC > a, .closePlanMenu').click(function (e) {
        e.preventDefault();
        $(this).parents('.subMenuSection').removeClass('opened')
    })
    $('.closeHamMenu').click(function (e) {
        e.preventDefault();
        $(this).parents('.hamMenuSection').removeClass('opened')
    })



    $('.hamMenuBtnLink').on('click', function (e) {
        e.preventDefault()
        var targetDDSec = '.hamMenuWrp';
        var hasClass = $(this).hasClass('opened')
        $(this)[hasClass ? 'removeClass' : 'addClass']('opened')
        $('.blurOverlayBg')[hasClass ? 'fadeOut' : 'fadeIn']();
        // $(this).toggleClass('opened');
        $(this).siblings(targetDDSec).toggleClass('opened');
    })


    //Event for Footer Form Input Focus and Blur
    $('.singleInputForm input').on('focus', function (e) {
        $(this).parent().parent('.singleInputForm').addClass('focused');
    }).on('blur', function (e) {
        $(this).parent().parent('.singleInputForm').removeClass('focused');
    })


    $('.hamMenuWrp .appDownloadForm input').on({
        focus: function (e) {
            e.preventDefault()
            $(this).parents('.appDownloadForm').addClass('focused');
        },
        blur: function (e) {
            e.preventDefault()
            $(this).parents('.appDownloadForm').removeClass('focused');
        }
    })

    /* Added by Komal T from line 466 to 475*/
    $('.hamQuickLinkSection .appDwnldForm input').on({
        focus: function (e) {
            e.preventDefault()
            $(this).parents('.appDwnldForm').addClass('focused');
        },
        blur: function (e) {
            e.preventDefault()
            $(this).parents('.appDwnldForm').removeClass('focused');
        }
    })




    $('.aboutTabWrap').appTabs()

    //Vertical Tab
    $('.verticalTab').verticalTab()
    //Owl Carousel Function
    const initiateOwlCarosel = function (ele, options) {
        const carouselOption = Object.assign({}, options);
        $(ele).owlCarousel(carouselOption);
    }

    //Board Of Director Content Event
    $('.bodList .bodImage').on('click', function (e) {
        e.preventDefault();
        var bodContentID = $(this).attr('data-bod');
        var bodContentEl = "[data-bod='" + bodContentID + "']";
        // $(this).parent('li').siblings('li').show();

        // $(this).parent('li').hide();
        // $("ul#bodList").children("li").not("li.contentHide").show();
        $('.bodDetailContent').removeClass('contentVisible');
        $(".bodContentWrap").find(bodContentEl).addClass('contentVisible');
        $('html, body').animate({
            scrollTop: $(bodContentEl).offset().top - 250
        }, 400);
    });
    $('.bodContentClose').on('click', function (e) {
        e.preventDefault();
        var bodContentID = $(this).parent('.bodDetailContent').attr('data-bod');
        $(this).parent('.bodDetailContent').removeClass('contentVisible');
        // $('#bodList').children('li').show();
        $("ul#bodList").children("li").not("li.contentHide").show();
    });


    $('.bodTabWrap li').on('click', function (e) {
        $('.bodDetailContent').removeClass('contentVisible');
    });
    //View More Btn
    $('.viewMoreBtn').viewMoreCont();
    $('.mobArticleViewMore').viewMoreCont();
    $('.viewMoreInsure').viewMoreCont();
    $('.viewMoreBtnTermPage').viewMoreContTermPage();
    // $('.viewMoreBtn').click(function(e) {
    //   e.preventDefault();
    //   let hiddenContent = $(this).attr('data-hidden')
    //   $(this).toggleClass("viewLessBtn")
    //   $(this).text( $(this).hasClass('viewLessBtn') ? 'View Less' : 'View More') 
    //   $('.'+ hiddenContent).slideToggle()
    // })






    //For Mobile Device
    if (isMobileDevice) {
        $('.bodList .bodImage').off("click").on('click', function (e) { e.preventDefault() })
        $('.mobileContentBtn').on('click', function (e) {
            e.preventDefault()
            $(this).toggleClass("opened")
            //$(this).toggleClass("opened")
            $(this).siblings('a.bodImage').toggleClass("active")
            $(this).siblings('.bodContent').slideToggle()
        })

        //Plans Mega Menu DD
        $('.mobPlanMenuAccord').click(function (e) {
            e.preventDefault();
            $(this).toggleClass('opened');
            $(this).parent('h3').siblings('.mobPlanMenuAccordCont').slideToggle();
        })



        //Plans Mega Menu's SubMenu
    } else {
        //For Desktop Device
        /* All Plans Pointer Arrow */
        $('.megaMenuLink').each(function () {
            var allPlansOffsetLeft = $(this).offset().left;
            var allPlansMenuWidth = $(this).width();
            var allPlansArrLeft = ((allPlansOffsetLeft) + (allPlansMenuWidth / 2)) - 12;
            $(this).siblings().children("span.arrowUp").css('left', allPlansArrLeft + 'px');
          });
    }


})

function commonMethod() {
    $('.cust-accordion .accordion-head').click(function () {
        var parent = $(this).parent('.cust-accordion');
        var isOpen = $(parent).hasClass('open');
        if (isOpen) {
            $(parent).find('.accordion-content').slideUp();
            $(parent).removeClass('open');
        } else {
            $('.accordion-content').slideUp();
            $('.cust-accordion').removeClass('open');
            $(parent).find('.accordion-content').slideDown();
            $(parent).addClass('open');
        }
    });
    $('.disclaimer-sec .disclaimer-head').click(function () {
        var isOpen = $('.disclaimer-sec').hasClass('open');
        if (isOpen) {
            $('.disclaimer-sec').find('.disclaimer-cont').slideUp();
            $('.disclaimer-sec').removeClass('open');
        } else {
            $('.disclaimer-cont').slideDown();
            $('.disclaimer-sec').addClass('open');
        }
    });
    $('.cust-accordion.open .accordion-content').slideDown();
    $('.tab li').click(function () {
        var listParent = $(this).parent('ul');
        var parent = $(listParent).closest('.tab-wrap');
        $(parent).find('.tab li').removeClass('active');
        $(this).addClass('active');
        var content = $(this).attr('rel');
        $(parent).find('.tab-content > div').fadeOut();
        $(parent).find('.tab-content .' + content).fadeIn();
    });
    // $('.product-search-autofill li').click(function () {
    //     $('.product-search-autofill').fadeOut();
    //     $('.net-assessment-cont').fadeOut();
    //     $('.fund-performance-search-cont').fadeIn();
    //     $('.fund-performance-search-result .tab li').removeClass('active');
    //     $('.fund-performance-search-result .tab li.tab1').addClass('active');
    //     $('.accordion-section, .re-discover-sec').hide();
    // });
    $('.search-label-txt .search-close').click(function () {
        $('.fund-performance-search-cont').fadeOut();
        $('.net-assessment-cont').fadeIn();
        $('.accordion-section, .re-discover-sec').show();
        $('.fund-performance-search-cont').removeClass('view-product-cont-wrap');
    });
    // $(".product-search-form input").keyup(function () {
    //     var val = $(this).val();
    //     if (val.length > 0) {
    //         $('.product-search-autofill').slideDown();
    //     } else {
    //         $('.product-search-autofill').slideUp();
    //     }
    // });
    $('.search-text-right li span').click(function (e) {
        $(this).parent().remove();
    })
    $('.product-wrap a.product-view-al').click(function (e) {
        $('.net-assessment-cont').fadeOut();
        $('.fund-performance-search-cont').addClass('view-product-cont-wrap').fadeIn();
        $('.fund-performance-search-result .tab li').removeClass('active');
        var tab = $(this).attr('rel');
        $('.fund-performance-search-result .tab li.' + tab).addClass('active');
        $('.accordion-section, .re-discover-sec').hide();
        e.preventDefault();
        return;
    });
    $('.view-product-report').click(function (e) {
        var parent = $(this).parents('.product-wrap');
        $(parent).addClass('show-graph');
        $(parent).find('.product-graph-wrap').show();
        e.preventDefault();
        return;
    });
    $('.product-graph-wrap .close-product-graph').click(function (e) {
        var parent = $(this).parents('.product-wrap');
        $(parent).find('.product-graph-wrap').hide();
        $(parent).removeClass('show-graph');
        e.preventDefault();
        return;
    });
    $('.featured-post-video-ico').click(function (e) {
        $('.video-popup-wrap').fadeIn();
        e.preventDefault();
        return;
    });
    $('.video-popup-wrap .close').click(function (e) {
        $('.video-popup-wrap').fadeOut();
        e.preventDefault();
        return;
    });
    $(document).click(function (e) {
        var container = $('.custom-dropdown');
        if (!container.is(e.target) // if the target of the click isn't the container...
            && container.has(e.target).length === 0) // ... nor a descendant of the container
        {
            $(container).removeClass('open');
            $('.custom-dropdown ul').slideUp('slow');
        }
    });
    $('.product-search-form .siteButton').click(function (e) {
        $('html, body').animate({
            scrollTop: 0
        }, 100);
        $('.fund-lists-popup').fadeIn();
        e.preventDefault();
        return;
    });
    $('.close-fund-lists').click(function (e) {
        $('.fund-lists-popup').fadeOut();
    });

    //online support 1st accordion
    $(".cust-accordion").first().addClass("open");
    $(".accordion-content").first().css('display', 'block');

}

function isMobile() {
    var winWidth = $(window).width();
    if (winWidth <= 768)
        return true;
    return false;
}

// $(document).ready(function () {
//     AOS.init({ easing: "ease-in-out-sine" }),
//         setInterval(addItem, 300);
//     var itemsCounter = 1,
//         container = document.getElementById("aos-demo");
//     function addItem() {
//         var t;
//         42 < itemsCounter || ((t = document.createElement("div")).classList.add("aos-item"), t.setAttribute("data-aos", "fade-up"), (t.innerHTML = '<div class="aos-item__inner"><h3>' + itemsCounter + "</h3></div>"), itemsCounter++);
//     }
// });

$(document).ready(function () {

    $('.about-us-inner-menu').on('click', function () {
        $(".hamMenuWrp").removeClass("opened");
        $('.blurOverlayBg').hasClass("fadeOut");
        $(".hamMenuBtnLink").removeClass("opened");
        $('.subMenuSection').removeClass('opened');
        $('.hamMenuSection').removeClass('opened');
    });

    //  $('.about-us-inner-menu').on('click',function(){
    //      if (window.location.href.match(/\/(about-us\/futurance)/)){
    //         return;
    //      }else if (window.location.href.match(/\/(about-us)/)) {
    //         // var addressValue = $(this).attr("href");
    //         // alert(addressValue );
    //         setTimeout(function(){
    //             location.reload();
    //         })
    //     }
    //  });

    // $('.subMenuSection knowledge-center li a').on('click',function(){
    //      if (window.location.href.indexOf("insurance-knowledge-centre") > -1) {
    //          setTimeout(function(){
    //              location.reload();
    //          })
    //      }
    //  });
    const el = document.querySelectorAll('img');
    const observer = lozad(el); // passing a `NodeList` (e.g. `document.querySelectorAll()`) is also valid
    observer.observe();


    // const ef = document.querySelectorAll('picture');
    // const observer1 = lozad(ef);
    // observer1.observe();

    const observer2 = lozad();
    observer2.observe();
 



});

$(document).ready(function () {
    if ($(window).width() < 760) {
        $('table').css({ "width": "100%" });
    } else if ($(window).width() > 760 && $(window).width() < 1921) {
        $('table').css({ "width": "100%" });
    }
    else {
        $('table').css({ "width": "800px" });
        $('.modal table').css({ "width": "100%" });
    }
    $('table').removeAttr("width");
    $('table').removeAttr("cellpadding");
    $('table').removeAttr("cellspacing");
    $('table th,td,tr').removeAttr("width height");
    $('table th,td,tr').css({ "width": "", "height": "" });



    let calprevent = $("meta[name='template']").attr("content");
    if (calprevent == 'aboutus-page') {

    }
    else {
        $('.aboutTabWrap nav ul li.sourcepathlist:first-child').find('a').addClass("active");
    }

});

$(document).ready(function () {
    $(window).scroll(function () {
        if ($(window).scrollTop() > 50) {
            $(".stickyTermBtn").fadeIn();
        } else {
            $(".stickyTermBtn").hide();
        }
    });

    if ($(".langSwitch").length > 0) {
        var hindiUrl = $("#hinditoggle").val();

        $(".langHindi").click(function () {
            if (!location.pathname.includes("/hindi")) {
                window.location.href = hindiUrl;
            }
        });

        $(".langEng").click(function () {
            if (location.pathname.includes("/hindi")) {
                window.location.href = window.location.href.replace("/hindi", "");
            }
        });
    }

    if (location.pathname.includes("/hindi")) {
        $("#switchLanguageMob").prop("checked", true);
    } else {
        $("#switchLanguageMob").prop("checked", false);
    }

    if ($(".tabs div").length > 0 && $(".tabs div")[1].classList.contains("activeTab")) {
        var activeTab = $(".activeTab");
        var firstTabMenu = $(".appTabMenu li:first-child a:first-child");
        activeTab.find("li a:first").removeClass("active");
        activeTab.find(".bggrey:first").hide();
        $(firstTabMenu).on("click", function () {
            activeTab.find(".bggrey:eq(1)").removeClass("about-active-tab");
        });
    }
});

// FUNCTION TO SCROLL TO GIVEN ELEMENT 
function scrollToElement(element, offset) {
    offset = typeof offset !== 'undefined' ? offset : 0;
    var elementPosition = element.getBoundingClientRect().top + window.scrollY;
    window.scrollTo(0, elementPosition - offset);
}


// FUNCTION FOR SCROLLING TO ERROR MESSAGE
function scrollToError(e,targetButton,offsetValue){
      
    var allErrors = targetButton.closest('form').find('.error-txt , .error-txt1')
    for(let i=0; i<allErrors.length; i++){
        if(allErrors[i].checkVisibility() && allErrors[i].innerHTML!=''){
            scrollToElement(allErrors[i],offsetValue)
            break
        }
    }
}

// hindi pages url structure source agent code append start REDM25717

function pageSourceAgentCodeAppend() {
    var pageNameCodeArr = ['claims', 'customer-service', 'financial-tools-calculators', 'fund-performance', 'insurance-knowledge-centre', 'retirement-and-pension-plans', 'systematic-retirement-plan', 'savings-plans', 
    'sanchay-plus','term-insurance-plans','ulip-plans','c2w','health-insurance-plans','cancer-care-insurance','children-insurance-plans','youngstar-udaan','term-insurance-calculator','human-life-value-calculator','compound-interest-calculator','child-education-expense-planning-calculator','child-marriage-planning-calculator','retirement-planning-calculator','bmi-calculator','cost-of-delay-calculator','investment-returns-calculator','new-immediate-annuity-plan','life-insurance-plans','click-2-protect-super','']
    var pageName = window.location.pathname
    .replace('/hindi/', "")
    .replace('retirement-and-pension-plans/', "")
    .replace('savings-plans/', "")
    .replace('health-insurance-plans/', "")
    .replace('financial-tools-calculators/', "")
    .replace('term-insurance-plans/', "")
    .replace('children-insurance-plans/',"")
    pageName = pageName == "/hindi" ? "" : pageName; //for hindi hompage only
    const url = new URL(window.location.href);

    if (window.location.pathname.includes('hindi')) {
        if (pageNameCodeArr.includes(pageName)) {
            url.searchParams.set('agentcode', '760642');
            url.searchParams.set('source', pageName);
            window.history.replaceState(null, null, url);
        }
        //pageNameCodeArr.includes(pageName) ? (url.searchParams.set('agentcode', '760642'),url.searchParams.set('source', pageName)) : (url.searchParams.set('agentcode', '760642'),url.searchParams.set('source', ""));
    }
}


$(window).on('load','',function(){
    pageSourceAgentCodeAppend();
});
// $(window).load(function () {
//     pageSourceAgentCodeAppend();
// });
    // hindi pages url structure source agent code append end REDM25717

//************SANITIZATION FUNCTION START************/

function sanitize(string) {
    if (typeof string == "string") {
      const map = {
        "<": "&lt;",
        ">": "&gt;",
        '"': "&quot;",
        "'": "&#x27;",
        "/": "&sol;",
        "\\": "&bsol;",
        ";": "&semi;",
        ":": "&colon;",
        "(": "&lpar;", 
        ")": "&rpar;",
        "[": "&lsqb;",
        "]": "&rsqb;",
        "{": "&lcub;",
        "}": "&rcub;",
      };
      var reg = /[<>"']/gi;
      return string.replace(reg, function (match) {
        return map[match];
      });
    } else {
      return string;
    }
  };

//************SANITIZATION FUNCTION END************/

// CUSTOM TRIM FUNCTION BECAUSE THE .trim() FUNCTION IS DEPRECATED (START)//

function customTrim(string) {
    if (typeof string === 'string'){
        return string.replace(/^\s+|\s+$/g , '');
    }else{
        return string
    }
}

// CUSTOM TRIM FUNCTION BECAUSE THE .trim() FUNCTION IS DEPRECATED (END)//
//mFilter event script start

function mFilterEventScript(uniqueId) {
    try {
        (function (m, f, i, l, t, e, r) {
            m[t] = m[t] || function () { (m[t].q = m[t].q || []).push(arguments) }, m[t].l = 1 * new Date();
            e = f.createElement(l); e.async = 1; e.id = "mfilterit-event-tag"; e.src = i;
            r = f.getElementsByTagName(l)[0]; r.parentNode.insertBefore(e, r);
        })(window, document, "https://script.mfilterit.net/v3/e/client/web.hdfclifev3.cpv.js", "script", "mfe");
        mfe("mf_package_name", "web.hdfclifev3.cpv");
        mfe("mf_tracking_type", "conversion");
        mfe("mf_order_id", "{'"+uniqueId+"'}");
        mfe("mf_order_amount", "{ORDER-AMOUNT}");
        mfe("mf_customer_publisher_name", "{YOUR-PUBLISHER-NAME}");
        console.log('mFilter event script executed');
    } catch (error) {
        console.log(error);
    }
}    

//mFilter event script end

(function($){

    // FUNCTION TO TOGGLE LOADER 
    $.fn.toggleLoader = function(options){

        var settings = $.extend({
            loaderText: "Please wait... Data is Loading"
        },options)

        var loaderHtml = `
                            <div style="visibility: visible;" class="customloader rdmore">
                                <div class="rdmore-inner">
                                    <button class="draw"></button>
                                    <p class="rdmore-loader-text">${settings.loaderText}</p>
                                    <div class="cardcontainer">
                                        <img class="galleryImg" data-src="/content/dam/hdfclifeinsurancecompany/hdfclogo.png" src="/content/dam/hdfclifeinsurancecompany/hdfclogo.png" alt="HDFC Logo"
                                            title="HDFC Logo" width="50" height="50">
                                    </div>
                                </div>
                            </div>
                        `;

        return this.each(function(){
            if($(this).children('.rdmore').length > 0 && $(this).children('.rdmore').css('display') != 'none'){
                $(this).children('.rdmore').css('display','none');
            }else if($(this).children('.rdmore').length > 0 && $(this).children('.rdmore').css('display') == 'none'){
                $(this).children('.rdmore').css('display','block');
            }else{
                $(this).css('position','relative');
                $(this).append(loaderHtml);
            }
        })
    }

    // FUNCTION TO TOGGLE API FAILURE MESSAGE
    $.fn.toggleApiFailMsg = function(options){

        var settings = $.extend({
            failureMsg: "Oops! Something went wrong."
        },options)

        var failureScreenHtml = `
                            <div class="api-container api-fail-container">
                                <p class="api-response-msg">${settings.failureMsg}</p>
                                <img class="close-icon" onclick="$(this).closest('.api-fail-container').css('display','none')" src="/content/dam/hdfclifeinsurancecompany/images/home-images/pop-close.png" alt="close-icon">
                            </div>
                        `;

        return this.each(function(){
            if($(this).children('.api-fail-container').length > 0 && $(this).children('.api-fail-container').css('display') != 'none'){
                $(this).children('.api-fail-container').css('display','none');
            }else if($(this).children('.api-fail-container').length > 0 && $(this).children('.api-fail-container').css('display') == 'none'){
                $(this).children('.api-fail-container').css('display','flex');
            }else{
                $(this).css('position','relative');
                $(this).append(failureScreenHtml);
            }
        })
    }

    // FUNCTION TO TOGGLE API SUCCESS MESSAGE
    $.fn.toggleApiSuccessMsg = function(options){

        var settings = $.extend({
            successMsg: "Thank you for your interest, please continue with the next steps."
        },options)

        var successScreenHtml = `
                            <div class="api-container api-success-container">
                                <p class="api-response-msg" style="line-height: 1.5;">${settings.successMsg}</p>
                                <img class="close-icon" onclick="$(this).closest('.api-success-container').css('display','none')" src="/content/dam/hdfclifeinsurancecompany/images/home-images/pop-close.png" alt="close-icon">
                            </div>
                        `;

        return this.each(function(){
            if($(this).children('.api-success-container').length > 0 && $(this).children('.api-success-container').css('display') != 'none'){
                $(this).children('.api-success-container').css('display','none');
            }else if($(this).children('.api-success-container').length > 0 && $(this).children('.api-success-container').css('display') == 'none'){
                $(this).children('.api-success-container').css('display','flex');
            }else{
                $(this).css('position','relative');
                $(this).append(successScreenHtml);
            }
        })
    }    

}(jQuery))


// READMORE READLESS START

$(document).ready(function () {
    $(".ReadMore").click(function (e) {
            e.preventDefault();
            $(this).hide();
            $(this).siblings($('.HideText')).show();
        });

    $(".ReadLess").click(function (e) {
            e.preventDefault();
            $(this).parent().hide();
            $(this).parent().siblings($(".ReadMore")).show();

            var self = $(this).parent().parent();
              theOffset = $(self).offset();
              $('body,html').animate({ scrollTop: theOffset.top - 150});
          
        //     var self = $(this);
        //   setTimeout(function() {
        //       theOffset = $(self).offset();
        //       $('body,html').animate({ scrollTop: theOffset.top - $(this).parent().parent()[0].scrollHeight});
        //   }, 310);
        });
    });

// READMORE READLESS END

// FUNCTION TO USE ALPHANUMERIC IN UPPERCASE
$(".uppercaseLetters").bind('keyup', function (e) {
    var ths = $(this);
    ths.val(ths.val().toUpperCase());
 
  });


// 31940 Tooltip addition on category lead forms Start
$(document).ready(function () {
    var fullNameToolTipContent = document.getElementById("form-toolTip-FullName");
    var dobToolTipContent = document.getElementById("form-toolTip-Dob");
    var mobileOTPToolTipContent = document.getElementById("form-toolTip-mobileOTP");
    // console.log(fullNameToolTip.value);
    // console.log(dobToolTipContent.value);
    
    var dobToolTip = document.querySelectorAll(".tooltipForDob");
    dobToolTip.forEach(element => {
        element.addEventListener('focus', function (e) {
            //     console.log(this)
    
            var tooltipDiv = document.createElement("div");
            tooltipDiv.className = "global-tooltip";
    
            // Set the content of the tooltipDiv to the value from dobToolTipContent
            tooltipDiv.innerHTML = dobToolTipContent.value;
    
            this.parentNode.appendChild(tooltipDiv);
            
        });
        element.addEventListener('blur', function (e) {
            var tooltipToRemove = this.parentNode.querySelector('.global-tooltip');
            if (tooltipToRemove) {
                tooltipToRemove.remove();
            }
        });
    });
    
    var fullNameToolTip = document.querySelectorAll(".tooltipForFullName");
    fullNameToolTip.forEach(element => {
        element.addEventListener('focus', function (e) {
            //     console.log(this)
    
            var tooltipDiv = document.createElement("div");
            tooltipDiv.className = "global-tooltip";
    
            // Set the content of the tooltipDiv to the value from fullNameToolTipContent
            tooltipDiv.innerHTML = fullNameToolTipContent.value;
    
            this.parentNode.appendChild(tooltipDiv);
            
        });
        element.addEventListener('blur', function (e) {
            var tooltipToRemove = this.parentNode.querySelector('.global-tooltip');
            if (tooltipToRemove) {
                tooltipToRemove.remove();
            }
        });
    });
    
    var mobileOTPToolTip = document.querySelectorAll(".tooltipForMobileOTP");
    mobileOTPToolTip.forEach(element => {
        element.addEventListener('focus', function (e) {
            //     console.log(this)
    
            var tooltipDiv = document.createElement("div");
            tooltipDiv.className = "global-tooltip";
    
            // Set the content of the tooltipDiv to the value from mobileOTPToolTipContent
            tooltipDiv.innerHTML = mobileOTPToolTipContent.value;
    
            this.parentNode.appendChild(tooltipDiv);
            
        });
        element.addEventListener('blur', function (e) {
            var tooltipToRemove = this.parentNode.querySelector('.global-tooltip');
            if (tooltipToRemove) {
                tooltipToRemove.remove();
            }
        });
    });
    
    // Mobile OTP tooltip for pop up & Sanchay Plus forms (to fix the alignment issue)
    var mobileOTPPopUpToolTip = document.querySelectorAll(".tooltipForMobileOTPPopUp");
    mobileOTPPopUpToolTip.forEach(element => {
        element.addEventListener('focus', function (e) {
            //     console.log(this)
    
            var tooltipDiv = document.createElement("div");
            tooltipDiv.className = "global-tooltip-mobileOtp";
    
            // Set the content of the tooltipDiv to the value from mobileOTPToolTipContent
            tooltipDiv.innerHTML = mobileOTPToolTipContent.value;
    
            this.parentNode.appendChild(tooltipDiv);
            
        });
        element.addEventListener('blur', function (e) {
            var tooltipToRemove = this.parentNode.querySelector('.global-tooltip-mobileOtp');
            if (tooltipToRemove) {
                tooltipToRemove.remove();
            }
        });
    });
    
    // Mobile NRI tooltip Start
    
    document.querySelectorAll(".tooltipForMobileOTPNriYes").forEach((element) => {
        element.addEventListener("focus", function () {
            handleTooltipMobileNriOtpYes(this);
        });
    
        element.addEventListener("blur", function () {
            const form = this.closest("form");
            if (!form) return;
    
            const tooltipToRemove = this.parentNode.querySelector(".global-tooltip");
            if (tooltipToRemove) {
                tooltipToRemove.remove();
            }
        });
    });
    
    function handleTooltipMobileNriOtpYes(inputElement) {
        const form = inputElement.closest("form");
        if (!form) return;
        const countryCodeField = form.querySelector('[data-id="countryCode"]');
        const countryCode = countryCodeField?.value || "";
    
        if (countryCode === "91") {
            if (!inputElement.parentNode.querySelector(".global-tooltip")) {
                const tooltipDiv = document.createElement("div");
                tooltipDiv.className = "global-tooltip";
                tooltipDiv.innerHTML = mobileOTPToolTipContent.value;
                inputElement.parentNode.appendChild(tooltipDiv);
            }
        } else {
            const tooltipToRemove = inputElement.parentNode.querySelector(".global-tooltip");
            if (tooltipToRemove) {
                tooltipToRemove.remove();
            }
        }
    }
    
    // Update country code input to work within its form only
    document.querySelectorAll('[data-id="countryCode"]').forEach((countryCodeField) => {
        countryCodeField.addEventListener("input", function () {
            const form = this.closest("form");
            if (!form) return;
    
            form.querySelectorAll(".tooltipForMobileOTPNriYes").forEach((inputElement) => {
                handleTooltipMobileNriOtpYes(inputElement);
            });
        });
    });
    
    });
    
    // 31940 Tooltip addition on category lead forms End

function validateIndianPhoneNumber(phoneNumber) {
    const pattern = /^[0]?[6789]\d{9}$/;
    return pattern.test(phoneNumber) && !notAllowedNumbersArray.includes(Number(phoneNumber));
}

function toggleCountryCodeField(parent, selectElem) {
    var noNriBannerForm = $(parent).find('#no_nriBannerForm');
    var countryCodeList = $(parent).find('.countryCode-list'); 
    var select2Containers = $(parent).find('.select2-container'); 
    const code = $(parent).find('#code'); 

    if (noNriBannerForm.hasClass('valid')) {
        countryCodeList.css('display', 'none');
        select2Containers.each(function() {
            $(this).css('display', 'none');
        });
        code.css('display', 'block');
    } else {
        code.css('display', 'none');
        countryCodeList.css('display', 'block');
        select2Containers.each(function() {
            $(this).css('display', 'block');
        });

        // IntersectionObserver to initialize select2 when the element becomes visible
        const observer = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    $(selectElem).each(function() {
                        if (!$(this).hasClass('select2-hidden-accessible')) {
                            $(this).select2({
                                dropdownParent: $(this).closest('.mobileNo_wrap'),
                                templateResult: function(item) {
                                    return item.text;
                                },
                                templateSelection: function(item) {
                                    if (item.id) {
                                        return item.text.split(' - ')[0];
                                    }
                                    return item.text;
                                }
                            }).on('select2:open', function() {
                                $('.select2-search__field').attr('placeholder', 'Search Country...');
                            });
                        }
                    });
                    observer.unobserve(entry.target);
                }
            });
        }, { threshold: 0.1 });

        $(selectElem).each(function() {
            observer.observe(this);
        });
    }
}


var stored;
function countryResidenceApi(selectElem, flag) {
    var $parentEle = $(selectElem);
    if (!flag) {
        // var apiEndPoint = 'https://beta-api.hdfclife.tech/api/country/get';
        var apiEndPoint = 'https://api.hdfclife.com/api/country/get';
        fetch(apiEndPoint)
            .then(response => {
                return response.json();
            })
            .then(data => {
                stored = data;
                data.response.forEach(function (country) {
                    $parentEle.append(`<option value="${country.country_code}">${country.country_code} - ${country.country_name}</option>`);
                });
                // $parentEle.trigger('change');
                $parentEle.val('91').trigger('change');
            })
            .catch(error => {
                console.error('Error:', error);
            });
    } else {
        $parentEle.html("");
        stored.response.forEach(function (country) {
            $parentEle.append(`<option value="${country.country_code}">${country.country_code} - ${country.country_name}</option>`);
        });
        $parentEle.val('91').trigger('change');
    }
}


// ************ kc universal lead form feasibility globally ***************//

document.addEventListener('DOMContentLoaded', function () {
    var viewportWidth = document.documentElement.clientWidth || document.body.clientWidth;
    if (viewportWidth <= 767) {
        const firstH2 = document.querySelector('.allinone h2');
        const formElement = document.querySelector('.universalLeadForm');

        if (firstH2 && formElement) {
            const container = document.createElement('div');
            container.classList.add('helloWorld');
            formElement.classList.add('dsp-n');
            container.appendChild(formElement);

            const parentLi = firstH2.closest('li');
            if (parentLi) {
                parentLi.parentNode.insertBefore(container, parentLi);
            } else {
                firstH2.parentNode.insertBefore(container, firstH2);
            }
            formElement.classList.remove('dsp-n');
        }
        else {
            if (formElement) {
                formElement.classList.add('dsp-n');
            }
        }
    }
});
var arr;

function isFormValid(form) {
  arr = [];
  form.find("[data-validation]").each(function (index, val) {
    if ($(this).is(':visible')) {
      $(this).trigger('input');
      var valid = $(this).parents().hasClass("valid");
      arr.push(valid);
    }
  });
  var formValid;
  if (arr.includes(false)) {
    formValid = false;
  } else {
    formValid = true;
  }
  if (formValid) {
    form.addClass("validForm");
    return true;
  } else {
    try {
      form.removeClass("validForm");
      return false;
    } catch (error) {
      console.log(error);
    }
  }
}

var validationobj = {
  search: searchValidation,
  fullname: nameValidation,
  firstname: firstNameValidation,
  newfirstname: newfirstNameValidation,
  firstnamewithsinglespace: firstnamewithsinglespaceValidation,
  lastname: lastNameValidation,
    alphaNumMaxLength: alphaNumMaxLengthValidation,
    lifeServiceAlphaNumMaxLength: lifeServiceAlphaNumMaxLengthValidation,
  numericMax8: numericMaxLength8Validation, 
  lifeServiceNumericMax8: lifeServicePopNumericMaxLength8Validation, 
    currentAge: currentAgeValidation,
  rcCurrentAge: rcCurrentAgeValidation,
  childAge: childAgeValidation,
  notEmpty: notEmptyValidation,
monthlyExpenseNotGreater : monthlyExpenseNotGreater,  
  textAreaNotEmpty: textAreaNotEmptyValidation,
    retireAge: retiredAgeValidation,
  rcRetireAge: rcRetiredAgeValidation,
  dropdown: dropdownValidation,
  newdropdown: newDropdownValidation,
  emailaddress: emailaddressValidation,
  emailaddressCustom: emailaddressCustomValidation,
  mobileNo: mobileNumberValidation,
  mobileNo14: mobileNumberValidation14,
  mobileNo14opti: mobileNumberValidation14Opti,
  countrycode:countrycodeNumberValidation,
  countrycodeopti:countrycodeNumberValidationOpti,
  internationalNumber:internationalNumberValidation,
  folioId: folioIdValidation,
  city: cityvalidation,
  state: stateValidation,
  applicationNo: applicationNoValidation,
  policyNo: policyNoValidation,
  policyNoFund: policyNoFundValidation,
  policyNoOptional:policyNoOptionalValidation,
  claimReferenceNo: claimReferenceNoValidation,
  // pancardno: panCardValidation,
  heightFt: heightvalidationFt,
  heightInch: heightvalidationInch,
  hra:hraValidation,
  weight: weightvalidation,
  // categoryExpense: categoryExpenseValidation,
  // country: countryValidation,
  // bankaccountnumber: bankAccountNumber,
  // ifsccode: ifscCode,
  // bankname: bankName,
  // branchname: branchName,
  // searchlocation: searchLocation,
  // claimid: claimValidation,
  // details: detailsvalidation,
  // commonFiled: commonFileldValidation,
  // numberLetters: numberLettersValid,
  // policyHolderLoan: policyHolderLoanNoValid,
  // groupPolicyOwnername: groupPolicyValidation,
  // relationshipwithinsured: relationshipwithinsuredvalidation,
  // upiid: upiIdValidation,
  // policycustomername: policycustomernameValidation,
  // query: queryvalidation,
  // area: areavalidation,
  // customeramount: customeramountvalidation,
  // agentnamelicensecode: agentnamelicensecodevalidation,
  // minimumIncome: minimumIncomeValidation,
  // mostlyExpanses: mostlyExpansesValidation,
  // userenteramount: useramountValidation,
  futureyear: futureYearValidation,
  // policyterm: policyTermValidation,
  // loannoofyear: loannoOfYearValidation,
  // calenderyear: calenderYearValidation,
  // optionalmobileNo: optioanalmobileNumberValidation
  annualrateReturn: annualrateReturnValidation,
  referenceNumber: referenceNumberValidation,
  policyApplication: policyApplicationValidation,
  memberName: membernameValidation,
  relmember:  relationwithmemberValidation,
  placeofdeath: placeofdeathValidation,
  pincodeno: pincodeValidation,
  policyUnclaimed: policyNoUnclaimedValidation,
  panNumber: panNumberValidation,
  panNumberPosp: panNumberPospValidation,
  dobUnclaimed: dobUnclaimedValidation,
  address: addressValidation,
  companyname: companynameValidation,
  loanaccountNumber: loanaccountnumberValidation,
  coiNumber: coinumberValidation,
  landlineNumber: landlinenumberValidation,
  stdCode: stdCodeValidation,
  caseReference: caseReferenceValidation,
  lifeCoverAmount: lifeCoverAmountValidation,
  codAge: codAgeValidation,
  forInvestmentReturn: forInvestmentReturnValidtion,
  forInvestmentReturnInvest: forInvestmentReturnInvestValidtion,
  rateOfReturn: rateOfReturnValidation,
  itNpsAmount: itNpsAmountValidation,
  dob: dobValidation,
  hindiFirstName: hindiFirstNameValidation,
  hindiDob: hindiDobValidation,
  hindiMobileNumber: hindiMobileNumberValidation,
  hindiEmail: hindiEmailAddressValidation
  // pptAndTerm: pptAndTermValidation,
};
var notAllowedNumbersArray =
  [    
      7070700707,
      8889988899,
      8555666666,
      9858888888,
      8065656565,
      7007601255,
      8989899999,
      9989998040,
      9000000000,
      9898898989,
      8888888888,
      9999999999,
      9111111111,
      9777777777,
      9890098900,
      8989999999,
      9888888888,
      9999955555,
      9999995555,
      7777777777,
      9899999999,
      9999900000,
      9898989898,
      9898989888,
      8787878787,
      9999999991,
      9999999995,
      9999999992,
      9999999990,
      9898999999,
      9999908765,
      6999999999,
      9999988888,
      8999999999,
      9898988888,
      8998989898,
      9890000000,
      9898899889,
      9000000001,
      9811111111,
      6666666666,
      9999099990,
      8989898989,
      9555555555,
      9000000009,
      9222222222,
      9877777777,
      9699999999,
      9666666666,
      7999999999,
      8585858585,
      9820098200,
      8000000000,
      9800000000,
      7878787878,
      9999999989,
      9898988988,
      9999000099,
      8888888889,
      9099999999,
      9999999996,
      9999999998,
      9123456789,
      9999999919,
      9898989999,
      9999911111,
      9900990099,
      7676767676,
      9999998888,
      9900000000,
      8888999900,
      9898889898,
      7000000000,
      9889898989,
      9999966666,
      9999999988,
      9999999958,
      9999999898,
      9898998989,
      9999999997,
      9797979797,
      8888899999,
      9977997799,
      6565656565,
      9999999909,
      9000000008,
      9960000000,
      9858585858,
      9999999993,
      9999999900,
      9988877888,
      1111111111,
      9898959898,
      9999000000,
      9998888999,
      8888800000,
      9898998999,
      8056565656,
      9988889999,
      9711111111,
      9999912345,
      7788778877,
      9100000000,
      8999989999,
      8888888855,
      8899999999,
      9999999922,
      9988998899,
      9191919191,
      9977777777,
      9999990000,
      8080808080,
      9999922222,
      9000090000,
      9200000000,
      9998888888,
      8888888880,
      9999999966,
      9856666666,
      1234567890,
      8989898888,
      8988888888,
      6777777777,
      9820000000,
      9700000000,
      9494949494,
      8777777777,
      0000000000
  ]

//WILL RETURN CURRENT ELEMENTS
function returnValidationElements(event) {
  var ele =
    event.currentTarget.closest(".form-group,.ta-val-fn") || event.currentTarget.parentElement;
  var value = event.currentTarget.value;
  var fvc = event.currentTarget.closest(".form-group") || ele;
  return {
    ele,
    value,
    fvc
  };
}

// search validation

function searchValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[A-Za-z0-9\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
  if (!pattern.test(currentValue)) {
    $(currentElement).siblings(".search-error").text("Please enter alphanumeric characters");
    // $(currentElement).find(".error-txt").text("Field should contain minimum 3 and max 50 characters");
    fvc.classList.remove("valid");
  } else {
    $(currentElement).siblings(".search-error").text("");
    fvc.classList.add("valid");
  }
}
//  else {
//   $(currentElement).siblings(".search-error").text("Sorry! You have not searched anything.");
//   fvc.classList.remove("valid");
// }
}

// name validation

function nameValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
  if (!pattern.test(currentValue)) {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").removeClass("d-none");
    $(currentElement).find(".error-txt").text("Please enter valid name");
    // $(currentElement).find(".error-txt").text("Field should contain minimum 3 and max 50 characters");
    fvc.classList.remove("valid");
  } else if (currentValue.length < 3 || currentValue.length > 50)  {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Field should contain minimum 3 and max 50 characters");
    fvc.classList.remove("valid");
  } else {
    $(currentElement).find(".error-txt").text("");
    fvc.classList.add("valid");
  }
} else {
  $(currentElement).find(".error-txt").addClass("d-block");
  $(currentElement).find(".error-txt").text("Please enter valid name");
  fvc.classList.remove("valid");
}
}

// first name validation

function firstNameValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid first name");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter first name");
    fvc.classList.remove("valid");
  }
}

// last name validation

function lastNameValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid last name");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter last name");
    fvc.classList.remove("valid");
  }
}

function numericMaxLength8Validation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[0-9\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue.length < 6 && currentValue.length != 8) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid business code");
      fvc.classList.remove("valid");
    }else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid business code");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter business code");
    fvc.classList.remove("valid");
  }
}

function lifeServicePopNumericMaxLength8Validation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern12 = /^[0-9\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue.length < 4 && currentValue.length != 8) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid Policy Id");
      fvc.classList.remove("valid");
    }else if (!pattern12.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid Policy Id");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter Policy Id");
    fvc.classList.remove("valid");
  }
}

function numericMaxLength10Validation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[0-9\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue.length != 10) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid lead id");
      fvc.classList.remove("valid");
    }else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid lead id");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter lead id");
    fvc.classList.remove("valid");
  }
}


function firstnamewithsinglespaceValidation(event){
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value.trim();
  var fvc = _obj.fvc;

  var pattern = /^(?!.*([A-Za-z])\1{2})[A-Za-z]{3,30}(?:\s[A-Za-z]{0,29})?$/
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) { 
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid name");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter name");
    fvc.classList.remove("valid");
  }

}


// application number validation

function applicationNoValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  policyNo = $("input[name=policyNumber]").val();

  if(policyNo==""){
    var pattern = /^.{1,13}$/;
    if (currentValue !== "" && currentValue != undefined) {
      if (currentValue.length != 13) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Field should contain 13 Numeric Characters");
        fvc.classList.remove("valid");
      } else if (!pattern.test(currentValue)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Field should contain 13 Numeric Characters");
        fvc.classList.remove("valid");
      } else {
        $(currentElement).find(".error-txt").text("");
        fvc.classList.add("valid");
      }
    } else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("Please enter valid application number");
      fvc.classList.remove("valid");
    }
  }else{
    $(currentElement).find(".error-txt").text("");
    fvc.classList.add("valid");    
  }
}

// policy no validation

function policyNoValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z0-9]{8,}$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue.length != 8) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Field should contain 8 Alphanumeric Characters");
      fvc.classList.remove("valid");
    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Field should contain 8 Alphanumeric Characters");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter valid policy number");
    fvc.classList.remove("valid");
  }
}

function policyNoFundValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z0-9]{8,}$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue.length != 8) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Field should contain 8 Alphanumeric Characters");
      fvc.classList.remove("valid");
    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Field should contain 8 Alphanumeric Characters");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter valid policy number");
    fvc.classList.remove("valid");
  }
}



function policyNoOptionalValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  applicationData = $("input[name=applicationNumber]").val();

  if(applicationData==""){
    var pattern = /^.{1,8}$/;
    if (currentValue !== "" && currentValue != undefined) {
      if (currentValue.length != 8) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Field should contain 8 Numeric Characters");
        fvc.classList.remove("valid");
      } else if (!pattern.test(currentValue)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Field should contain 8 Numeric Characters");
        fvc.classList.remove("valid");
      } else {
        $(currentElement).find(".error-txt").text("");
        fvc.classList.add("valid");
      }
    } else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("Please enter valid policy number");
      fvc.classList.remove("valid");
    }
  }else{
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
  }
}


// Policy number unclaimed dues validation

function policyNoUnclaimedValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  applicationData = $("input[name=applicationNumber]").val();
  panNumber = $("input[name=pan_no]").val();

  if(applicationData=="" || panNumber == ""){
    var pattern = /^.{1,8}$/;
    if (currentValue !== "" && currentValue != undefined) {
      if (!(currentValue.length >= 4 && currentValue.length <= 8)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Field should contain 4 - 8 Numeric Characters");
        fvc.classList.remove("valid");
      } else if (!pattern.test(currentValue)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Field should contain 8 Numeric Characters");
        fvc.classList.remove("valid");
      } else {
        $(currentElement).find(".error-txt").text("");
        $(currentElement).find(".error-txt").removeClass("d-block");
        fvc.classList.add("valid");
      }
    } else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("Please enter policy number");
      fvc.classList.remove("valid");
    }
  }else{
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
  }
}


// Pan Number Validation

function panNumberValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  policyNoUnclaimed = $("input[name=policy_id]").val();

  if(policyNoUnclaimed == ""){
    var pattern = /^([a-zA-Z]){5}([0-9]){4}([a-zA-Z]){1}?$/;
    if (currentValue !== "" && currentValue != undefined) {
      if ((currentValue.length < 10)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Pan number should contain 10 characters");
        fvc.classList.remove("valid");
      } else if(!pattern.test(currentValue)){
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Please enter valid pan number");
        fvc.classList.remove("valid");
      } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
      }
    }
    else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter pan number");
      fvc.classList.remove("valid");
    }
  }else{
    $(currentElement).find(".error-txt").text("");
    fvc.classList.add("valid");  
      }
}

//Dob Unclaimed Validation

function dobUnclaimedValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var pattern = /^\d{4}\-(0?[1-9]|1[012])\-(0?[1-9]|[12][0-9]|3[01])$/ ;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid Date");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter date");
    fvc.classList.remove("valid");
  }
}


// reference no validation

function referenceNumberValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z0-9]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue.length != 9) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Field should contain 9 Alpha-Numeric Characters");
      fvc.classList.remove("valid");
    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Field should contain 9 Alpha-Numeric Characters");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter valid reference number");
    fvc.classList.remove("valid");
  }
}

// policy or application no validation

function policyApplicationValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z0-9]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue.length < 8 || currentValue.length > 13) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Field should contain between 8 to 13 Alpha-Numeric Characters");
      fvc.classList.remove("valid");
    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Field should contain between 8 to 13 Alpha-Numeric Characters");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter valid policy or application number");
    fvc.classList.remove("valid");
  }
}

// Pan Number Validation

function panNumberPospValidation(event) {
  //GET ALL ELEMENTS
  // debugger
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  $('.pan-agree-checkbox-error-txt').css('display','none');
  $('.pan-non-agree-checkbox-error-txt').css('display','none');
    var pattern = /^[A-Z]{5}[0-9]{4}[A-Z]$/;
    if (currentValue !== "" && currentValue != undefined) {
      if ((currentValue.length < 10)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Please enter valid pan number");
        fvc.classList.remove("valid");
      } else if(!pattern.test(currentValue)){
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Please enter valid pan number");
        fvc.classList.remove("valid");
      } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
      }
    }
    else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter pan number");
      fvc.classList.remove("valid");
    }
}

// claim Reference validation

function claimReferenceNoValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z0-9-]*$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid claim reference number");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter valid claim reference number");
    fvc.classList.remove("valid");
  }
}

// current age validation
var currentAgeVal, retireAgeVal;

function currentAgeValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  currentAgeVal = currentValue;
  var fvc = _obj.fvc;
  if (retireAgeVal < currentAgeVal) {
    // currentAgeVal = currentValue
    // $('#retire-age').val('');
    $('#retire-age').trigger('input');
  }
  var pattern = /^[0-9]{2,3}$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue) || Number(currentValue) < 18 || Number(currentValue) > 65) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Min: 18 yrs, Max: 65 yrs");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Min: 18 yrs, Max: 65 yrs");
    fvc.classList.remove("valid");
  }
}

// retirement age validation
function retiredAgeValidation(event) {
  if (!currentAgeVal) {
    currentAgeVal = 18
  } else if (currentAgeVal < 18 || currentAgeVal > 65) {
    currentAgeVal = 18;
  }
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  retireAgeVal = currentValue
  var pattern = /^[0-9]{2,3}$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue) || Number(currentValue) < Number(currentAgeVal) || Number(currentValue) > 75) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Min: " + currentAgeVal + " yrs, Max: 75 yrs");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Min: " + currentAgeVal + " yrs, Max: 75 yrs");
    fvc.classList.remove("valid");
  }
}



// current age validation
var rcCurrentAgeVal, rcRetireAgeVal;

function rcCurrentAgeValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  rcCurrentAgeVal = currentValue;
  rcCurrentAgeVal = parseInt(rcCurrentAgeVal);
  rcCurrentAgeVal += 10;
  var fvc = _obj.fvc;
  if (rcRetireAgeVal < rcCurrentAgeVal) {
    // rcCurrentAgeVal = currentValue
    // $('#retire-age').val('');
    $('#retirement-calc-form #retirementAge').trigger('input');
  }
  var pattern = /^[0-9]{2,3}$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue) || Number(currentValue) < 18 || Number(currentValue) > 50) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Min: 18 yrs, Max 50 yrs");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Min: 18 yrs, Max 50 yrs");
    fvc.classList.remove("valid");
  }
}

// retirement age validation
function rcRetiredAgeValidation(event) {
  if (!rcCurrentAgeVal) {
    rcCurrentAgeVal = 40
  } else if (rcCurrentAgeVal < 40 || rcCurrentAgeVal > 60) {
    rcCurrentAgeVal = 40;
  }
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  rcRetireAgeVal = currentValue
  var pattern = /^[0-9]{2,3}$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue) || Number(currentValue) < Number(rcCurrentAgeVal) || Number(currentValue) > 60) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Min: " + rcCurrentAgeVal + " yrs, Max: 60 yrs");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Min: " + rcCurrentAgeVal + " yrs, Max: 60 yrs");
    fvc.classList.remove("valid");
  }
}

//Not empty validation
function notEmptyValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  if (currentValue != "" && currentValue != undefined) {
    $(currentElement).find(".error-txt").text("");
    fvc.classList.add("valid");
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required!");
    fvc.classList.remove("valid");
  }
}

//Text area not empty validation
function textAreaNotEmptyValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  if (currentValue != "" && currentValue != undefined) {
    $(currentElement).find(".error-txt").text("");
    fvc.classList.add("valid");
  } else {
    //$(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required!");
        fvc.classList.remove("valid");
  }
}

//Monthly Expense not greater than Annual Income Validation

function monthlyExpenseNotGreater(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var annInc = Number( $('#annual-income')[0].value.replace(/,/g , ""));
  var monExp = Number($('#monthly-expenses')[0].value.replace(/,/g , ""));
  if(annInc < monExp){
    fvc.classList.remove("valid");
      $('#monthly-expenses')[0].nextElementSibling.innerText = "";
      $('#monthly-expenses')[0].nextElementSibling.nextElementSibling.innerText = "Monthly Expense can't be more than Annual Income";
  }
  else{
    fvc.classList.add("valid");
    $('#monthly-expenses')[0].nextElementSibling.nextElementSibling.innerText = "";
    $(currentElement).find(".error-txt").removeClass("d-block");
    $(currentElement).find(".error-txt").addClass("d-none");
  }

  // if (currentValue) {
  //   $(currentElement).find(".error-txt").text("");
  //   $(currentElement).find(".error-txt").removeClass("d-block");
  //   fvc.classList.add("valid");
  // } else {
  //   $(currentElement).find(".error-txt").addClass("d-block");
  //   $(currentElement).find(".error-txt").text("This field is required!");
  //   fvc.classList.remove("valid");
  // }
}

// DROPDOWN VALIDATION
function dropdownValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  if (currentValue) {
    $(currentElement).find(".error-txt").text("");
    fvc.classList.add("valid");
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please select value");
    fvc.classList.remove("valid");
  }
}

// New Dropdown Validation
function newDropdownValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  if (currentValue) {
    $(currentElement).find(".error-txt").text("");
    $(currentElement).find(".error-txt").removeClass("d-block");
    fvc.classList.add("valid");
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please select value");
    fvc.classList.remove("valid");
  }
}

//email address
function emailaddressValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  //
  if (currentValue !== "") {
    //var pattern = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;

    // var pattern = /^([a-zA-Z])+([a-zA-Z0-9_.+-])+\@(([a-zA-Z])+\.+?(com|co|in|org|net|edu|info|gov|vekomy))\.?(in|org|net|edu|info|gov)?$/;
    // var pattern = /^([a-zA-Z])+([a-zA-Z0-9_.-])+\@(([a-zA-Z0-9])+\.+?(com|co|in|org|net|edu|info|gov|vekomy))\.?(in|org|net|edu|info|gov)?$/;
    var pattern = /^[\w-\.]+@([A-Za-z-]+\.)+[A-Za-z-]{2,4}$/g;

    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("Please enter valid e-mail id");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter valid e-mail id");
    fvc.classList.remove("valid");
  }
}

// Email validation to block specific usernames
function emailaddressCustomValidation(event) {
  // GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value.trim().toLowerCase(); // Trim and lowercase for consistency
  var fvc = _obj.fvc;

  // List of blocked usernames (before "@")
  var blockedUsernames = [
    "na", "abc", "ab", "test", "dhee", "av", 
    "a", "xyz", "n", "nish", "abcd", "s", "ram"
  ];

  // Email pattern for general format validation
  var pattern = /^[\w-\.]+@([A-Za-z-]+\.)+[A-Za-z-]{2,4}$/g;

  if (currentValue !== "") {
    if (!pattern.test(currentValue)) {
      // Invalid email format
      showError(currentElement, "Please enter a valid email address");
      fvc.classList.remove("valid");
      return;
    }

    // Extract username from email (before "@")
    var username = currentValue.split("@")[0];

    // Check if the username is blocked
    if (blockedUsernames.includes(username)) {
      showError(currentElement, "Please enter a valid email address");
      fvc.classList.remove("valid");
    } else {
      // Valid email
      clearError(currentElement);
      fvc.classList.add("valid");
    }
  } else {
    // Empty input field
    showError(currentElement, "Please enter a valid email address");
    fvc.classList.remove("valid");
  }
}

// Helper function to show error messages
function showError(element, message) {
  $(element).find(".error-txt").addClass("d-block").text(message);
}

// Helper function to clear error messages
function clearError(element) {
  $(element).find(".error-txt").removeClass("d-block").text("");
}

// mobile number validation for 10 to 14
function mobileNumberValidation14(event) {
  //GET ALL ELEMENTS
    
  
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var blockSpecificNumbers = event.currentTarget.dataset.blockspecificnumbers

  var pattern = /^[0]?[123456789]\d{5}|[123456789]\d{14}$/;
  if (currentValue !== "") {
    if (currentValue.length < 6 && currentValue.length > 14 ) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    }else if (blockSpecificNumbers && notAllowedNumbersArray.includes(Number(currentValue))){
      // BLOCK SPECIFIC NUMBER FOR SANCHAY PLUS OTP REQUIREMENT
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    }else {
        $(currentElement).find(".error-txt").text("");
        fvc.classList.add("valid");
      }
  } else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("Please enter mobile number");
      fvc.classList.remove("valid");
  }
}

// mobile number validation for 10 to 14 for opti lead
function mobileNumberValidation14Opti(event) {
  //GET ALL ELEMENTS
  // debugger
  
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var blockSpecificNumbers = event.currentTarget.dataset.blockspecificnumbers

  var pattern = /^[0]?[123456789]\d{5}|[123456789]\d{14}$/;
  if (currentValue !== "") {
    if (currentValue.length < 6 && currentValue.length > 14 ) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    }else if (blockSpecificNumbers && notAllowedNumbersArray.includes(Number(currentValue))){
      // BLOCK SPECIFIC NUMBER FOR SANCHAY PLUS OTP REQUIREMENT
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    }else {
        $(currentElement).find(".error-txt").text("");
        // fvc.classList.add("valid");
        var inputElement = document.querySelector('.newBannerFormV2 #code'); 
        var inputElementOptiSavings = document.querySelector('.ulipFormV3 #code');
        if (inputElement && inputElement.value.length == 0) {
          var event = new Event('input');  
          inputElement.dispatchEvent(event);
        }else if (inputElementOptiSavings && inputElementOptiSavings.value.length == 0) {
            var event = new Event('input');  
            inputElementOptiSavings.dispatchEvent(event);
        }else{
             fvc.classList.add("valid");
        }
      }
  } else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("Please enter mobile number");
      fvc.classList.remove("valid");
  }
}



// mobile number validation
function mobileNumberValidation(event) {
  //GET ALL ELEMENTS
    
  
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var blockSpecificNumbers = event.currentTarget.dataset.blockspecificnumbers

  var pattern = /^[0]?[6789]\d{9}$/;
  if (currentValue !== "") {
    if (currentValue.length != 10) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    }else if (blockSpecificNumbers && notAllowedNumbersArray.includes(Number(currentValue))){
      // BLOCK SPECIFIC NUMBER FOR SANCHAY PLUS OTP REQUIREMENT
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    }else {
        $(currentElement).find(".error-txt").text("");
        fvc.classList.add("valid");
      }
  } else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("Please enter mobile number");
      fvc.classList.remove("valid");
  }
}

// folioId-ClientId Validation
function folioIdValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^([IN]{2}[0-9]{14})|([0-9]{7})$/;
  if (currentValue !== "") {
    if (currentValue.length < 6) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid ID");
      fvc.classList.remove("valid");

    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid ID");
      fvc.classList.remove("valid");

    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter valid ID");
    fvc.classList.remove("valid");
  }
}


//state validation
var isStateSelect;

function stateValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  isStateSelect = currentValue;
  if (currentValue == "" || currentValue == undefined) {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").removeClass("d-none");
    $(currentElement).find(".error-txt").text("Please enter state name");
    fvc.classList.remove("valid");
  } else {
    $(currentElement).find(".error-txt").text("");
    fvc.classList.add("valid");
  }
}

//city validation
function cityvalidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  if (currentValue !== "" && currentValue != undefined) {
    if (isStateSelect == "" || !isStateSelect) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement)
        .find(".error-txt")
        .text("Please select the state first");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter city name");
    fvc.classList.remove("valid");
  }
}

//weight validation
function weightvalidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  currentValue = currentValue.toString().slice(0,3);
  var firstDigit = currentValue.toString().slice(0,1)
  var fvc = _obj.fvc;

  // var pattern = /^\d{1,3}$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (firstDigit==0 || (currentValue < 1 || currentValue > 200)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Invalid value (Enter a value between 1 and 200)");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required!");
    fvc.classList.remove("valid");
  }
}

//for investment validation
function forInvestmentReturnValidtion(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[1-9][0-9]?$|^99$/;
  if (currentValue !== "" && currentValue != undefined && currentValue !== "0" && currentValue !== "00") {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Value should be between 1 and 99");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Value should be between 1 and 99");
    fvc.classList.remove("valid");
  }
}

//for investment return calc invest field validation
function forInvestmentReturnInvestValidtion(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^(1000|[1-9]\d{3,8}|999999999)$/;
  if (currentValue !== "" && currentValue != undefined && currentValue !== "0" && currentValue !== "00") {
    if (!pattern.test(currentValue.replaceAll(",",""))) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Value should be between 1000 and 999999999");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Value should be between 1000 and 999999999");
    fvc.classList.remove("valid");
  }
}

//expecte rate of return validation
function rateOfReturnValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var pattern = /^([1-9]|[12]\d|3[0-0])$/;
  if (currentValue !== "" && currentValue != undefined && currentValue !== "0" && currentValue !== "00") {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Value should be between 1 and 30");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Value should be between 1 and 30");
    fvc.classList.remove("valid");
  }
}


//heightFeet validation
function heightvalidationFt(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  currentValue = currentValue.toString().slice(0,1)
  var fvc = _obj.fvc;
  // var pattern = /^(\d{1}|10)$/;
  // var pattern = /^[4-7]$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue < 4  || currentValue > 6) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Invalid value (Enter a value between 4 and 6)");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required!");
    fvc.classList.remove("valid");
  }
}


//heightInch validation
function heightvalidationInch(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  currentValue = currentValue.toString().slice(0,2)
  var fvc = _obj.fvc;
  // var pattern = /^[0-11]$/;

  if (currentValue != undefined) {
    // if (!pattern.test(currentValue)) {
    if (currentValue < 0 ||  currentValue > 11) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Invalid value (Enter a value between 0 and 11)");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required!");
    fvc.classList.remove("valid");
  }
}


function futureYearValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  //
  // var pattern = /^[0-9]{1,4}$/;
  var pattern = /^([5-9]|[1-9][0-9])$/;

  if (currentValue !== "" && currentValue != undefined && currentValue > 4 && currentValue < 100) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid year");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
    
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Enter Year between 5-99");
    fvc.classList.remove("valid");
  }
}


// hra validation

function hraValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  currentValue = currentValue.replaceAll(",","")

  var minAmnt,maxAmnt, error
  if (currentValue.length > 0) {
    minAmnt = 1000;
    maxAmnt = 10000000;
    error = "Please enter a value within the given range 1K to 1Cr";
  }
  if (currentValue !== "" && currentValue != undefined) {
    // THE BELOW CONDITIONAL MAKES SURE THAT 0 IS AN ACCEPTABLE INPUT FOR DEARNESS ALLOWANCE
    // if(event.currentTarget.name == 'dearnessAllowance' && currentValue == 0){
    //BELOW CODE MAKES SURE THAT VALIDATION IS SKIPED FOR DEARNESS ALLOWANCE 
    if(event.currentTarget.name == 'dearnessAllowance'){
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
      return 
    }
    if (currentValue < minAmnt || currentValue > maxAmnt) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text(error);
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    // THE BELOW CONDITIONAL MAKES SURE THAT DEARNESS ALLOWANCE IS NOT A REQUIRED FIELD
    if(event.currentTarget.name != 'dearnessAllowance'){
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("This field is required");
      fvc.classList.remove("valid");
    }else{
      $(currentElement).find(".error-txt").addClass("d-none");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  }
}


// annualrateReturn validation

function annualrateReturnValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var annualRateCompound = $(currentElement).find('input[name=annual_rate_returns]')
  var rateReturnChildMrg = $(currentElement).find('input[name=ror_child_mrg]')
  var rateInflationChildMrg = $(currentElement).find('input[name=roi_child_mrg]')
  var incomeGrowthRate = $(currentElement).find('input[name=income_growth_rate]')
  // console.log(childAgeInput,'childAgeInput',childMrgAgeInput,'childMrgAgeInput');
  var pattern, error
  if (annualRateCompound.length > 0) {
    pattern = /^(3[0]|[1-9]|[1-2][0-9])$/;
    error = "Value should be between 1 and 30";
  } else if (rateReturnChildMrg.length > 0) {
    // pattern = /^(\d|[1][0-9]|2[0-5])$/;
    pattern =/^(0?[1-9]|[1-9]|1\d|2[0-5])$/
    error = "Value should be between 1 and 25";
  } else if(rateInflationChildMrg.length > 0){
    pattern = /^(0?[1-9]|[1-4][0-9]|50)$/;
    error = "Value should be between 1 and 50";
  }
   else if(incomeGrowthRate.length > 0){
    pattern = /^([4-9]|1[0-4])$/;
    error = "Value should be between 4 and 14";
  }else {
    pattern = /^(\d|[1][0-9]|2[0-5])$/;
    error = "Value should be between 0 and 25";
  }
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text(error);
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required");
    fvc.classList.remove("valid");
  }
}

//child age validation
function childAgeValidation(event) {
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value.replaceAll(",","");
  var isMarriageAge = currentElement.firstElementChild.id=='marriageAge'
  var childAge = $('#childAge').val()
  var fvc = _obj.fvc;
  var maxAge = event.currentTarget.max
  var minAge = event.currentTarget.min
  var error = `Please enter a value within the given range (${minAge} to ${maxAge})`

  if (currentValue !== "" && currentValue != undefined) {
    // THIS IS FOR MARRIAGE AGE TO MAKE SURE MARRIAGE AGE IS NOT GREATER THAN CHILD AGE
    if(isMarriageAge){
      if (currentValue < Number(minAge) ||  currentValue > Number(maxAge)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text(error);
        fvc.classList.remove("valid");
      }
      else if(parseInt(currentValue) <= parseInt(childAge)){
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text('Marriage age should be greater than child age');
        fvc.classList.remove("valid");
      }else{
        $(currentElement).find(".error-txt").text("");
        $(currentElement).find(".error-txt").removeClass("d-block");
        fvc.classList.add("valid");
      }

    // THIS IS FOR CHILD AGE
    }else{
      if (currentValue < Number(minAge) ||  currentValue > Number(maxAge)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text(error);
        fvc.classList.remove("valid");
      } else {
        $(currentElement).find(".error-txt").text("");
        $(currentElement).find(".error-txt").removeClass("d-block");
        fvc.classList.add("valid");
      }
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required!");
    fvc.classList.remove("valid");
  }
}

// membername validation

function membernameValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

      var pattern = /^[a-zA-Z\s]+$/;
    if (currentValue !== "" && currentValue != undefined) {
      if (!pattern.test(currentValue)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Please enter valid member name");
        fvc.classList.remove("valid");
      } else {
        $(currentElement).find(".error-txt").text("");
                fvc.classList.add("valid");
              }
    } else {
              $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").text("Please enter member name");
        fvc.classList.remove("valid");
      }
}


// relationwithmember validation

function relationwithmemberValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter only characters");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter realtionship with member");
    fvc.classList.remove("valid");
  }
}

// Place of Death validation

function placeofdeathValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[a-zA-Z]+(?:[\s-][a-zA-Z]+)*$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid Place name");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter Death of Place");
    fvc.classList.remove("valid");
  }
}


// Pincode validation

function pincodeValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[1-9]{1}[0-9]{2}\s{0,1}[0-9]{3}$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid pincode");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter Pincode");
    fvc.classList.remove("valid");
  }
}


// Address validation

function addressValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^(\w*\s*[\#\-\,\/\.\(\)\&]*)+/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid Address");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter Address");
    fvc.classList.remove("valid");
  }
}


// companyname validation

function companynameValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  // memberName = $("input[name=member_name]");

  // if(memberName.val()==''){
    var pattern = /^[a-zA-Z]([a-zA-Z0-9.-_,]|[- @.#&!()\'])[^<>]*$/;
    if (currentValue !== "" && currentValue != undefined) {
      if (!pattern.test(currentValue)) {
        $(currentElement).find(".error-txt").addClass("d-block");
        $(currentElement).find(".error-txt").removeClass("d-none");
        $(currentElement).find(".error-txt").text("Please enter valid company name");
        fvc.classList.remove("valid");
      } else {
        $(currentElement).find(".error-txt").text("");
        $(currentElement).find(".error-txt").removeClass("d-block");
        fvc.classList.add("valid");
        // ADDED TO REMOVE ERROR TEXT ON THE UNCLAIMED POLICYHOLDER PAGE (GROUP FORM)
        // if(memberName.length){
        //   memberName.parent().find('.error-txt').text('');
        //   memberName.parent().find('.error-txt').removeClass("d-block");
        //   memberName.parent().addClass("valid");
        // }
      }
    } else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("Please enter Company name");
      fvc.classList.remove("valid");
    }
  // }else{
  //   $(currentElement).find(".error-txt").text("");
  //   fvc.classList.add("valid");  
  // }
}


// Loan Account Number validation

function loanaccountnumberValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var pattern = /^[^<>]{4,20}$/
  // // console.log(event.currentTarget.dataset.groupclaim)
  // if(event.currentTarget.dataset.groupclaim == 'groupClaim'){
  //   pattern = /^[a-zA-Z0-9\_\-]{4,20}$/;
  // }else{
  //   pattern = /^\d{8,18}$/;
  // }

  // var pattern = /^\d{9,18}$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid Loan account number");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter Loan account number");
    fvc.classList.remove("valid");
  }
}


// COI Number validation

function coinumberValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var pattern = /^[^<>]{4,20}$/

  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid COI number");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter COI number");
    fvc.classList.remove("valid");
  }
}


// Landline Number validation

function landlinenumberValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /[0-9]{8}/g;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid contact number");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter contact number");
    fvc.classList.remove("valid");
  }
}


// STD Code validation

function stdCodeValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /[0-9]{3}/g;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".stdError").addClass("d-block");
      $(currentElement).find(".stdError").removeClass("d-none");
      $(currentElement).find(".stdError").text("Please enter valid STD code");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".stdError").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".stdError").addClass("d-block");
    $(currentElement).find(".stdError").text("Please enter STD code");
    fvc.classList.remove("valid");
  }
}

// Case Reference Validation
function caseReferenceValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^([IN]{2}[0-9]{14})|([0-9]{7})$/;
  if (currentValue !== "") {
    if (currentValue.length < 11) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid Case Reference");
      fvc.classList.remove("valid");

    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid Case Reference");
      fvc.classList.remove("valid");

    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter valid Case Reference");
    fvc.classList.remove("valid");
  }
}


// lifeCoverAmountValidation validation

function lifeCoverAmountValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  currentValue = currentValue.replaceAll(",","")
  var c2plLifeCover = $(currentElement).find('input[name=lifeCover]')
  var ulipPremium = $(currentElement).find('input[name=premium]')
  var nps_1b = $(currentElement).find('input[name=nps_1b]')
  var interestPaid = $(currentElement).find('input[name=interest_paid]')
  // console.log(childAgeInput,'childAgeInput',childMrgAgeInput,'childMrgAgeInput');
  var minAmnt,maxAmnt, error
  if (c2plLifeCover.length > 0) {
    minAmnt = 2500000;
    maxAmnt = 500000000;
    error = "Please enter a value within the given range 25L to 50Cr";
  } else if (ulipPremium.length > 0 ) {
    var minAmount = $(ulipPremium).attr('data-min-amount')
    // console.log(parseInt(minAmount),'minAmount');
    minAmnt = parseInt(minAmount);
    maxAmnt = 999999999;
    error = "Minimum amount is "+minAmnt ;
  } else if (nps_1b.length > 0) {
    minAmnt = 0;
    maxAmnt = 50000;
    error = "Maximum of Rs 50,000 per annum allowed";
  } else if(interestPaid.length > 0){
    minAmnt = 0;
    maxAmnt = 200000;
    error = "Please enter a value within the given range (Rs.0 to Rs.200000)";
  }

  // var pattern = /^[a-zA-Z\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue < minAmnt || currentValue > maxAmnt) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text(error);
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required");
    fvc.classList.remove("valid");
  }
}

// COD-age validation
var codSetAge
function codAgeValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  // codSetAge = dayjs().diff(parseInt(currentValue), 'years');
  // codSetAge = $(currentElement).find('#scdate').data('age');
  if (currentValue !== "" && currentValue != undefined) {
    if (!currentValue) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Age should be between 21-65 years");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required");
    fvc.classList.remove("valid");
  }
}

// itNpsAmountValidation validation

function itNpsAmountValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  currentValue = currentValue.replaceAll(",","")
  var basicSalary = $("#income-tax-form input[name=basic_salary]").val().replaceAll(",","")
  var nps_1 = $(currentElement).find('input[name=nps_1]')
  var nps_2 = $(currentElement).find('input[name=nps_2]')
  // console.log(childAgeInput,'childAgeInput',childMrgAgeInput,'childMrgAgeInput');
  var minAmnt,maxAmnt, error
  if (nps_1.length > 0 || nps_2.length > 0) {
    minAmnt = 0;
    maxAmnt = (basicSalary * 10) / 100;
    error = "Please enter a value within the given range (Rs."+minAmnt+" to Rs."+maxAmnt+")";
  } 

  // var pattern = /^[a-zA-Z\s]+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (currentValue < minAmnt || currentValue > maxAmnt) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text(error);
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("This field is required");
    fvc.classList.remove("valid");
  }
}


// International Number validation

function internationalNumberValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var maxValue = event.currentTarget.max
  var minValue = event.currentTarget.min
  var blockSpecificNumbers = event.currentTarget.dataset.blockspecificnumbers


  var pattern = new RegExp (`^([0-9])\\d{${minValue},${maxValue}}$`);
  // var pattern = /^([0-9])\d{1,10}$/;
  // var pattern1 = new RegExp ("/^([0-9])\d{{"+minValue+"},13}$/");
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid mobile number");
      fvc.classList.remove("valid");
    }
    else if (blockSpecificNumbers && notAllowedNumbersArray.includes(Number(currentValue))){
      // BLOCK SPECIFIC NUMBER FOR SANCHAY PLUS OTP REQUIREMENT
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("Please enter valid mobile number");
      fvc.classList.remove("valid");
     }
     else {
        $(currentElement).find(".error-txt").text("");
       $(currentElement).find(".error-txt").removeClass("d-block");
       fvc.classList.add("valid");

      } 
    }
   
  else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter mobile number");
    fvc.classList.remove("valid");
  }

}

// first name validation

function newfirstNameValidation(event) {
//GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^(?=.{3,20}$)(([a-zA-z\s])\2?(?!\2))+$/;
  if (currentValue !== "" && currentValue != undefined) {
if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid name");
      fvc.classList.remove("valid");
    } else {
        $(currentElement).find(".error-txt").text("");
        $(currentElement).find(".error-txt").removeClass("d-block");
        fvc.classList.add("valid");
            }
  } else {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("Please enter name");
      fvc.classList.remove("valid");
  }
}


// Mobile  Number Country Code validation

function countrycodeNumberValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^(?!0+$|\+?0+$)(\+?\d{1,3}|\d{1,4})$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt1").addClass("d-block");
      $(currentElement).find(".error-txt1").removeClass("d-none");
      $(currentElement).find(".error-txt1").text("Please enter valid country code");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt1").text("");
      $(currentElement).find(".error-txt1").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt1").addClass("d-block");
    $(currentElement).find(".error-txt1").text("Please enter country code");
    fvc.classList.remove("valid");
  }
}


//Mobile  Number Country Code validation for optilead

function countrycodeNumberValidationOpti(event) {
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^(?!0+$|\+?0+$)(\+?\d{1,3}|\d{1,4})$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt1").addClass("d-block");
      $(currentElement).find(".error-txt1").removeClass("d-none");
      $(currentElement).find(".error-txt1").text("Please enter valid country code");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt1").text("");
      $(currentElement).find(".error-txt1").removeClass("d-block");
      // fvc.classList.add("valid");
      var inputElement = document.querySelector('.newBannerFormV2 #phone');
      var inputElementOptiSavings = document.querySelector('.ulipFormV3 #phone');
      if (inputElement && inputElement.value.length == 0) {
        var event = new Event('input');  
        inputElement.dispatchEvent(event);
      }else if (inputElementOptiSavings && inputElementOptiSavings.value.length == 0) {
          var event = new Event('input');  
          inputElementOptiSavings.dispatchEvent(event);
      }else{
         fvc.classList.add("valid");
      }
    }
  } else {
    $(currentElement).find(".error-txt1").addClass("d-block");
    $(currentElement).find(".error-txt1").text("Please enter country code");
    fvc.classList.remove("valid");
  }
}

// Date validation

function dobValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var pattern = /^\d{2}\/\d{2}\/\d{4}$/ ;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid Date");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter date");
    fvc.classList.remove("valid");
  }
}

// DOB hindi validation

function hindiDobValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var pattern = /^\d{2}\/\d{2}\/\d{4}$/ ;
    
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("कृपया सही जन्म तिथि दर्ज करें");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("कृपया जन्म तिथि दर्ज करें");
    fvc.classList.remove("valid");
  }
}

// Hindi first name validation

function hindiFirstNameValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^(?=.{3,20}$)(([a-zA-z\s])\2?(?!\2))+$/;
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("कृपया सही नाम दर्ज करें");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("कृपया नाम दर्ज करें");
    fvc.classList.remove("valid");
  }
}

// Hindi Email Validation

function hindiEmailAddressValidation(event) {
  //GET ALL ELEMENTS
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  //
  if (currentValue !== "") {
    //var pattern = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;

    // var pattern = /^([a-zA-Z])+([a-zA-Z0-9_.+-])+\@(([a-zA-Z])+\.+?(com|co|in|org|net|edu|info|gov|vekomy))\.?(in|org|net|edu|info|gov)?$/;
    //var pattern = /^([a-zA-Z])+([a-zA-Z0-9_.-])+\@(([a-zA-Z]+\.)?(com|co|in|org|net|edu|info|gov|vekomy))\.?(in|org|net|edu|info|gov)?$/;
    var pattern = /^[\w-\.]+@([A-Za-z-]+\.)+[A-Za-z-]{2,4}$/g;

    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").text("कृपया सही ईमेल दर्ज करें");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("कृपया ईमेल दर्ज करें");
    fvc.classList.remove("valid");
  }
}

// Hindi mobile number validation
function hindiMobileNumberValidation(event) {
  //GET ALL ELEMENTS
    
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;

  var pattern = /^[0]?[6789]\d{9}$/;
  if (currentValue !== "") {
    if (currentValue.length != 10) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("कृपया सही मोबाइल नंबर दर्ज करें");
      fvc.classList.remove("valid");
    } else if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement)
        .find(".error-txt")
        .text("कृपया सही मोबाइल नंबर दर्ज करें");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("कृपया मोबाइल नंबर दर्ज करें");
    fvc.classList.remove("valid");
  }
}

// APLHA NUMBERIC CHARACTERS WITH CUSTOM LENGTH
function alphaNumMaxLengthValidation(event) {
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var maxLength = event.currentTarget.dataset.maxlength ? event.currentTarget.dataset.maxlength : '20';
  var minlength = event.currentTarget.dataset.minlength ? event.currentTarget.dataset.minlength : '1';
  var fieldName = event.currentTarget.dataset.fieldname;
  var validMsg = fieldName ? `Please enter valid ${fieldName}` : `Please enter only alpha numeric characters`;
  var requiredMsg = fieldName ? `Please enter ${fieldName}` : `This field is required!`

  var pattern = new RegExp (`^[\\w\\d]{${minlength},${maxLength}}$`);
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text(validMsg);
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text(requiredMsg);
    fvc.classList.remove("valid");
  }
}

function lifeServiceAlphaNumMaxLengthValidation(event) {
  var _obj = returnValidationElements(event);
  var currentElement = _obj.ele;
  var currentValue = _obj.value;
  var fvc = _obj.fvc;
  var maxLength = event.currentTarget.dataset.maxlength ? event.currentTarget.dataset.maxlength : '20';
  var minlength = event.currentTarget.dataset.minlength ? event.currentTarget.dataset.minlength : '1';

  var pattern = new RegExp (`^[\\w\\d]{${minlength},${maxLength}}$`);
  if (currentValue !== "" && currentValue != undefined) {
    if (!pattern.test(currentValue)) {
      $(currentElement).find(".error-txt").addClass("d-block");
      $(currentElement).find(".error-txt").removeClass("d-none");
      $(currentElement).find(".error-txt").text("Please enter valid Client Id");
      fvc.classList.remove("valid");
    } else {
      $(currentElement).find(".error-txt").text("");
      $(currentElement).find(".error-txt").removeClass("d-block");
      fvc.classList.add("valid");
    }
  } else {
    $(currentElement).find(".error-txt").addClass("d-block");
    $(currentElement).find(".error-txt").text("Please enter Client Id");
    fvc.classList.remove("valid");
  }
}



// input function
$(document).ready(function () {

  
  //The regular expression /[^\d]/g is used to find all characters in a given string that are not digits (0-9)
  $(".digitsOnly").on("input", function (e) {
    $(this).attr('data-comma-separation') ? $(this).val($(this).val().replace(/[^0-9,]/g, '')) : $(this).val($(this).val().replace(/[^\d]/g, ''));
    //$(this).val($(this).val().replace(/[^\d]/g, ''))
  });

  //Validation for floating number accept

  $(".digitsWithDecimal").on("input", function (e) {
    $(this).val($(this).val().replace(/[^0-9\.]/g, ''));
  });

  // BELOW FUNCTION REMOVES EMOJIS AND '<','>' SCRIPT BRACKETS FROM ALL INPUT FIELDS
  $('input[type=text], input[type=number]').on('input', function(event){
      var pattern  = /^$|^(?!\s)[a-zA-Z0-9,.;:_@.#&!-/()'\s-]+$/;
      var value = $(this).val();
      if(!(pattern.test(value))){
        $(this).val('');
        var emojiError = $(this).parent().find('.error-txt')
        emojiError.text('');
        emojiError.removeClass('d-block');
      }
  })

  // ATTACHING APPROPRIATE VALIDATION FUNCTIONS TO INPUT FIELDS
  $("[data-validation]").on("input", function (event) {
    var validation = $(this).attr("data-validation");
    if ($(event.currentTarget).is(':visible')) {
      validationobj[validation](event);
    }
  });
});
var addBtn;
var pwaSection;

$(document).ready(function(){
    addBtn = document.querySelector('.add-button');
    pwaSection = document.querySelector('.pwaSection');
    pwaSection.style.display = 'none';
});

let deferredPrompt;

 var isMobileBoolean;
 var mobileDevice = window.matchMedia("(max-width: 768px)");

 if (mobileDevice.matches) { // If media query matches
    isMobileBoolean = true;
  } else {
    isMobileBoolean = false;;
  }

window.addEventListener('beforeinstallprompt', (e) => {

    if(isMobileBoolean){
      // console.log("beforeinstallprompt", e);
      // Prevent Chrome 67 and earlier from automatically showing the prompt
      e.preventDefault();
      // Stash the event so it can be triggered later.
      deferredPrompt = e;
      // Update UI to notify the user they can add to home screen
      pwaSection.style.display = 'block';
    
      addBtn.addEventListener('click', (e) => {
        // hide our user interface that shows our A2HS button
        pwaSection.parentElement.style.display = 'none';
        // Show the prompt
        deferredPrompt.prompt();
        // Wait for the user to respond to the prompt
        deferredPrompt.userChoice.then((choiceResult) => {
            if (choiceResult.outcome === 'accepted') {
              console.log('User accepted the A2HS prompt');
            } else {
              console.log('User dismissed the A2HS prompt');
            }
            deferredPrompt = null;
          });
      });
    } 
  });
dataLayer = [{
    'pageName': window.location.pathname + window.location.hash,
    'userType': 'Guest',
}];

function productBox(e) {
    const currClickedEleName = e.innerHTML;
    dataLayer.push({ 'event': 'productBox', 'planName': currClickedEleName });
}

function moreMenuLink(e) {
    const currClickedEleName = e.previousElementSibling.previousElementSibling.innerHTML;
    dataLayer.push({ 'event': 'productBox', 'planName': currClickedEleName });
}

function categoryBox(e) {
    const clickedCategory = e.innerText;
    dataLayer.push({ 'event': 'productBox', 'planName': clickedCategory });
}

function downloadPdf() {
    const productName = $('.product-title').data("product-name");
    const pdfName = $(this).attr("data-pdf-link");
    const sectionName = $(this).attr("data-section-name");
    dataLayer.push({ 'event': 'pdfDownload', 'pdfName': pdfName, 'sectionName': sectionName, 'productName': productName });
}

function formSuccess() {
    dataLayer.push({ 'event': 'formSubmitSuccess', 'buttonName': 'pass CTA name', 'leadCounts': 'pass 1', 'leadId': 'pass lead id', 'quoteId': 'pass the quoteid', 'applicationId': 'pass the application ID' });
}

function formFailure() {
    dataLayer.push({ 'event': 'formSubmitFailed', 'buttonName': 'pass CTA name', 'errorDescription': 'pass the description of error occured', 'errorCounts': 'pass total number of error fields counts if applicable', 'applicationId': 'pass the application ID' });
}

function searchResult() {
    dataLayer.push({ 'event': 'searchResultClicked', 'searchResultClick': 'pass the search result that is clicked' });
}

function buttonClicked(e) {

    buttonName = $(this).attr("data-button-name");
    tabName = $(this).attr("data-tab-name");
    sectionName = $(this).attr("data-section-name");
    productName = $(this).attr("data-product-name");

    dataLayer.push({
        'event': 'ctaClick',
        'buttonName': buttonName,
        'tabName': tabName,
        'sectionName': sectionName,
        'productName': productName
    });
}

function videoClicked() {
    dataLayer.push({
        'event': 'videoClick',
        'videoName': 'pass the name of the video',
        'productName': 'pass the name of the plan for which video is related'
    });
}

function calculateClicked() {
    dataLayer.push({
        'event': 'calculatorClick',
        'planName': 'pass the recommended plan name ',
        'annualIncome': 'pass the annual income',
        'monthlyExpense': 'pass the monthly expense',
        'existingCover': 'pass the existing insurance cover',
        'educationQualification': 'pass the qualification of user'
    });
}

function contactClicked() {
    dataLayer.push({
        'event': 'contactClick',
        'contactMethod': 'pass the name of the contact like emailcall',
        'contactSection': 'pass the section name like online buy support,NRI services',
        'contactPostion': 'pass the position like top navigation'
    });
}

function iconClicked() {
    dataLayer.push({
        'event': 'iconClick',
        'iconName': 'pass the name of the icon like login,contact,share',
        'iconPosition': 'pass the position of the icon like header, footer',
        'sectionName': 'pass the section name'
    });
}

function genericLink() {
    dataLayer.push({
        'event': 'linkClick',
        'linkName': 'pass the link name',
        'tabName': 'Pass the tab name',
        'sectionName': 'pass the section name',
        'productName': 'pass the product name'
    });
}

function getCallBack(planName, productName) {

    dataLayer.push({
        'event': 'callFormSubmit',
        'planName': planName,
        'productName': productName
    });
}



function supportDataLayer(contactMethod, contactSection, contactPostion) {
    dataLayer.push({ 
    'event': 'contactClick', 
    'contactMethod': contactMethod,
    'contactSection': contactSection, 
    'contactPostion': contactPostion
 });
}

function linkDatalayer(linkName,tabName,sectionName,productName){
    dataLayer.push({
    'event':'linkClick',
    'linkName':linkName,
    'tabName': tabName,
    'sectionName': sectionName,
    'productName': productName
});
}

$(document).ready(function () {

    $('.chat-icon-container').on('click', function () {
        dataLayer.push({ 'event': 'chatWithUs' });
    });


    $('.toggleBtnClick').on('click', function () {

        buttonName = $(this).attr('data-button-name');
        tabName = $(this).parent().parent().find('h3').text();
        if (tabName = ' ') {
            tabName = $('body').find('a.product-calculate-btn').attr("data-tab-name");
        }

        dataLayer.push({
            'event': 'ctaClick',
            'buttonName': buttonName,
            'tabName': tabName
        });

    });

    $(".searchLinkClick").on('click', function () {

        linkName = $(this).innerHTML();
        dataLayer.push({
            'event': 'searchResultClicked',
            'searchResultClick': linkName
        });
    })


    var downloadPdfClick = document.querySelectorAll('.downloadPdfClick');
    downloadPdfClick.forEach(function (element) {
        element.addEventListener('click', function (event) {

            buttonName = element.getAttribute("data-button-name");
            sectionName = element.getAttribute("data-section-name");
            productName = element.getAttribute("data-product-name");
            pdfName = element.getAttribute("data-pdf-name");

            dataLayer.push({
                'event': 'pdfDownload',
                'pdfName': pdfName,
                'sectionName': sectionName,
                'productName': productName
            });
        })
    })


    var dataLayerBtnClick = document.querySelectorAll('.dataLayerBtnClick');
    dataLayerBtnClick.forEach(function (element) {
        element.addEventListener('click', function (event) {

            buttonName = element.getAttribute("data-button-name");
            tabName = element.getAttribute("data-tab-name");
            // if(tabName == null){
            //     tabName = $(this).parents().find('.products-tab-title-section ul li').hasClass("active").attr("data-tab-name");
            // }
            sectionName = element.getAttribute("data-section-name");
            // if(sectionName == null){
            //     sectionName = $(this).parent().parent().find('h4').text();
            // }
            productName = element.getAttribute("data-product-name");
            // if(productName == null){
            //     productName = $('body').find('h1.product-title').attr("data-product-name");
            // }
            dataLayer.push({
                'event': 'ctaClick',
                'buttonName': buttonName,
                'tabName': tabName,
                'sectionName': sectionName,
                'productName': productName

            });
        })
    })

    var dataLayerVideoClick = document.querySelectorAll('.videoBtnDataLayer');
    dataLayerVideoClick.forEach(function (element) {
        element.addEventListener('click', function (event) {

            videoName = element.getAttribute("data-video-name");
            productName = element.getAttribute("data-product-name");

            dataLayer.push({
                'event': 'videoClick',
                'videoName': videoName,
                'productName': productName
            });
        })
    })


    var supportedLinks = document.querySelectorAll('a[data-support]');
    supportedLinks.forEach(function (element) {
        element.addEventListener('click', function (event) {
            supportDataLayer(event.currentTarget.dataset.support, event.currentTarget.dataset.section, event.currentTarget.dataset.position)
        });
    })

    // Generic Button Click Events Across the Website Start
    var btnClickDataLayer = document.querySelectorAll('.siteButton');
    btnClickDataLayer.forEach(function (element) {
        element.addEventListener('click', function (event) {
            buttonName = element.innerText ? element.innerText : '';
            tabName = document.querySelector('.active') ? document.querySelector('.active').innerText : '';
            sectionName = element.getAttribute("data-section-name");
            productName = document.getElementById('page-name').value;
            // console.log(document.getElementsByTagName('section').className)
            
            dataLayer.push({
                'event':'ctaClick',
                'buttonName':buttonName,
                'tabName':tabName,
                'sectionName':'',
                'productName':productName
            });

        })
    })
    // Generic Button Click Events Across the Website End

    // Button click event for Branch Locator Start
    var branchLocatorDataLayer = document.querySelectorAll('.hdfc-office-locations');
    branchLocatorDataLayer.forEach(function (element) {
        element.addEventListener('click', function (event) {
            buttonName = element.innerText ? element.innerText : '';
            tabName = document.querySelector('.sourcepathlist .active') ? document.querySelector('.sourcepathlist .active').innerText : '';
            sectionName = element.getAttribute("data-section-name");
            productName = document.getElementById('page-name').value;
            // console.log(document.getElementsByTagName('section').className)
            
            dataLayer.push({
                'event':'ctaClick',
                'buttonName':buttonName,
                'tabName':tabName,
                'sectionName':'',
                'productName':productName
            });

        })
    })
    // Button click event for Branch Locator End

    // Button click event for Toggle Image SCB Button Start
    var scbDataLayer = document.querySelectorAll('.scb-data-layer');
    scbDataLayer.forEach(function (element) {
        element.addEventListener('click', function (event) {
            buttonName = element.innerText ? element.innerText : '';
            tabName = document.querySelector('.sourcepathlist .active') ? document.querySelector('.sourcepathlist .active').innerText : '';
            sectionName = element.getAttribute("data-section-name");
            productName = document.getElementById('page-name').value;
            // console.log(document.getElementsByTagName('section').className)
            
            dataLayer.push({
                'event':'ctaClick',
                'buttonName':buttonName,
                'tabName':tabName,
                'sectionName':'',
                'productName':productName
            });

        })
    })
    // Button click event for Toggle Image SCB Button End

    // product-benefits-cards-data-layer Start
    var pbcDataLayer = document.querySelectorAll('.product-benefits-cards-data-layer');
    pbcDataLayer.forEach(function (element) {
        element.addEventListener('click', function (event) {
            buttonName = element.innerText ? element.innerText : '';
            tabName = document.querySelector('.sourcepathlist .active') ? document.querySelector('.sourcepathlist .active').innerText : '';
            sectionName = element.getAttribute("data-section-name");
            productName = document.getElementById('page-name').value;
            // console.log(document.getElementsByTagName('section').className)
            
            dataLayer.push({
                'event':'ctaClick',
                'buttonName':buttonName,
                'tabName':tabName,
                'sectionName':'',
                'productName':productName
            });

        })
    })
    // product-benefits-cards-data-layer End

    // elig-data-layer Start
    var eligDataLayer = document.querySelectorAll('.elig-data-layer');
    eligDataLayer.forEach(function (element) {
        element.addEventListener('click', function (event) {
            buttonName = element.innerText ? element.innerText : '';
            tabName = document.querySelector('.sourcepathlist .active') ? document.querySelector('.sourcepathlist .active').innerText : '';
            sectionName = element.getAttribute("data-section-name");
            productName = document.getElementById('page-name').value;
            // console.log(document.getElementsByTagName('section').className)
            
            dataLayer.push({
                'event':'ctaClick',
                'buttonName':buttonName,
                'tabName':tabName,
                'sectionName':'',
                'productName':productName
            });

        })
    })
    // elig-data-layer End

    // cal-data-layer Start
    var calDataLayer = document.querySelectorAll('.cal-data-layer');
    calDataLayer.forEach(function (element) {
        element.addEventListener('click', function (event) {
            buttonName = element.innerText ? element.innerText : '';
            tabName = document.querySelector('.sourcepathlist .active') ? document.querySelector('.sourcepathlist .active').innerText : '';
            sectionName = element.getAttribute("data-section-name");
            productName = document.getElementById('page-name').value;
            // console.log(document.getElementsByTagName('section').className)
            
            dataLayer.push({
                'event':'ctaClick',
                'buttonName':buttonName,
                'tabName':tabName,
                'sectionName':'',
                'productName':productName
            });

        })
    })
    // cal-data-layer End

    // btn-white-data-layer Start
    var btnWhiteDataLayer = document.querySelectorAll('.btn-white-data-layer');
    btnWhiteDataLayer.forEach(function (element) {
        element.addEventListener('click', function (event) {
            buttonName = element.innerText ? element.innerText : '';
            tabName = document.querySelector('.sourcepathlist .active') ? document.querySelector('.sourcepathlist .active').innerText : '';
            sectionName = element.getAttribute("data-section-name");
            productName = document.getElementById('page-name').value;
            // console.log(document.getElementsByTagName('section').className)
            
            dataLayer.push({
                'event':'ctaClick',
                'buttonName':buttonName,
                'tabName':tabName,
                'sectionName':'',
                'productName':productName
            });

        })
    })
    // btn-white-data-layer End
    var linkdata = document.querySelectorAll('a[data-support]');

    

    //Icon Clicked DataLayer start

    var iconClicked = document.querySelectorAll('a[data-icon]');
    iconClicked.forEach(function (element) {
        element.addEventListener('click', function (event) {
            
            iconName = element.getAttribute("data-icon-name");
            iconPosition = element.getAttribute("data-position");
            sectionName = element.getAttribute("data-section-name");
            
            dataLayer.push({
                'event':'iconClick',
                'iconName':iconName,
                'iconPosition':iconPosition,
                'sectionName':sectionName
            });

        })
    })
    //Icon Clicked DataLayer end
    

    //Link Clicked DataLayer start

    // var linkClicked = document.querySelectorAll('a');
    // linkClicked.forEach(function (element) {
    //     element.addEventListener('click', function (event) {
            
    //         linkName = element.getAttribute("href");
    //         tabName = "";
    //         sectionName = "";
    //         productName = "";
            
    //         dataLayer.push({
    //             'event':'linkClick',
    //             'linkName': linkName,
    //             'tabName': tabName,
    //             'sectionName': sectionName,
    //             'productName': productName
    //         });

    //     })
    // })
    //Link Clicked DataLayer end

        // Banner Click Data layer
        var bannerTag = document.querySelectorAll('.bannerClick');
        bannerTag.forEach(function (element) {
            element.addEventListener('click', function (event) {
                var bannerLocation = '';
                var bannerCategory = event.currentTarget.getAttribute('data-categoryName');
                var bannerName = event.currentTarget.querySelector('img').getAttribute('alt');
                var urlObject = new URL(window.location.href);
                var path = urlObject.pathname;
    
                // only for local system
                if (window.location.href.includes('localhost')) {
                    path = path.replace('/content/hdfclifeinsurancecompany/in/en', "/").replace(".html", "");
                } 
    
                if (path == '/') {
                    bannerLocation = 'home page'
                } else {
                    bannerLocation = path.replaceAll("/", "").replaceAll("-", " ");
                }
              
    
                dataLayer.push({
                    'event': 'select_banner',
                    'banner_location': bannerLocation,
                    'banner_category': bannerCategory,
                    'banner_name': bannerName,
                    'userID': ''
                });
    
            })
        });
        // End of Banner Click Data layer
});

// Form Submission - Successful Start

function formSubmissionSuccess(btnName) {
    dataLayer.push({
        'event':'formSubmitSuccess',
        'buttonName':btnName,
        'leadId': '',
        'leadCounts':'1',
        'quoteId': '',
        'applicationId': ''
    });
}
// Form Submission - Successful End

// Form Submission - Failed Start

function formSubmissionFailed(btnName, err) {
    dataLayer.push({
        'event':'formSubmitFailed',
        'buttonName':btnName,
        'errorDescription': err,
        'errorCounts':'',
        'applicationId': ''
    });
}
// Form Submission - Failed End


// Lead Popup Category Page start here

function leadPopUpDataLayer(btnName, productName){
    dataLayer.push({
        'event': 'popUp_formSubmit',
        'event_category':'Form Submmision',
        'event_action':btnName,
        'event_label':' Pop Up Form Submitted',       
        'productName':productName
    });
}
// Lead Popup Category Page end here

//Home logo click

var HomeLogoClick = document.querySelectorAll('.logodl');
HomeLogoClick.forEach(function (element) {
        element.addEventListener('click', function (event) {
            dataLayer.push({
                event: "ctaClick",
                buttonName: "homebuttonLogo",
                productName: "Home Page",
                pagePath:'/'
            });
        })
    })

// KC Recommended Button Data Layer start
var recommendbtn = document.querySelectorAll('.recommended-form-submit');
recommendbtn.forEach(function (element) {
    element.addEventListener('click', function (event) {
        event_action = document.getElementById('type_of_query').value;
        event_label = document.getElementById('type_of_subquery').value;
        
        dataLayer.push({
            'event':'cta_dropdown',
            'event_category':'Reccomended to me',
            'event_action':event_action,
            'event_label':event_label
        });

    })
})

// End of KC Recommended Button Data Layer

// Iwantto Proceed Button Data layer
var proceedbtn = document.querySelectorAll('.ProceedButton');
proceedbtn.forEach(function (element) {
    element.addEventListener('click', function (event) {
        if($('#Desktop').is(':visible')){
            event_label = document.querySelector('#Desktop option:checked').text;
        }
        else{
            event_label = document.querySelector('#Mobile option:checked').text;
        }
        dataLayer.push({

          'event': 'cta_dropdown', 
          'event_category':'I Want To', 
          'event_action':'Proceed',
          'event_label':event_label
        });

    })
})
// End of Iwantto Proceed Button Data layer
let parts = window.location.pathname.split('/');
let lastItem = parts[parts.length - 1];
let isPageAllowed = (lastItem != "aggregator" && lastItem !="digital-alliance" && lastItem != "search-result");

$(document).ready(function(){
    
    
    var url = new URL(window.location);
    let params = new URLSearchParams(url.search.slice(1));
    

    var dataAttribution = document.querySelectorAll('a[data-attribution]');
    dataAttribution.forEach(function(element){

        if(element.href!="" && isPageAllowed){
            
            checkParams(params, element);
        }

    });


    var maDataAttribution = document.querySelectorAll('a[href^="http"], a[href^="/"]');
    maDataAttribution.forEach(function (element){

        if(element.href!="" && isPageAllowed){

            checkParams(params, element);
        }

    })
    
})


function checkParams(params, element){
    
        
    linkURL = new URL(element.href);
    linkOrigin = linkURL.origin+linkURL.pathname;
    let linkParams = new URLSearchParams(linkURL.search.slice(1));

    if(params==""){

        element.href = linkURL;

    }else{        

        if(params.has("source")){
            var sourceCode = params.get("source");  
            linkParams.delete("source");  
            linkParams.delete("sourcecode");    
            linkParams.delete("source-code");                
            params.set("source", sourceCode);
        }
        if(params.has("source-code")){
            var sourceCode = params.get("source-code");
            linkParams.delete("source");  
            linkParams.delete("sourcecode");    
            linkParams.delete("source-code");  
            params.set("source-code", sourceCode);
        }
        if(params.has("sourcecode")){
            var sourceCode = params.get("sourcecode");  
            linkParams.delete("source");  
            linkParams.delete("sourcecode");    
            linkParams.delete("source-code");
            params.set("sourcecode", sourceCode);
        }

        if(params.has("agentcode")){
            var agentCode = params.get("agentcode");
            linkParams.delete("agentcode");             
            linkParams.delete("agent-code");        
            params.set("agentcode", agentCode);
        }

        if(params.has("agent-code")){
            var agentCode = params.get("agent-code");
            linkParams.delete("agentcode");         
            linkParams.delete("agent-code");            
            params.set("agent-code", agentCode);
        }
        if(params.has("utm_medium")){
            var utmMedium = params.get("utm_medium");
            linkParams.delete("utm_medium");            
            params.set("utm_medium", utmMedium);
        }
        if(params.has("utm_source")){
            var utmSource = params.get("utm_source");
            linkParams.delete("utm_source");            
            params.set("utm_source", utmSource);
        }

        if(linkParams==""){
            element.href = linkOrigin+"?"+params;
        }else{
            if(lastItem != "aggregator" || lastItem !="digital-alliance"){
                return;
            }
            element.href = linkOrigin+"?"+linkParams+"&"+params;
        }

    }
}
/*! lozad.js - v1.16.0 - 2020-09-06
* https://github.com/ApoorvSaxena/lozad.js
* Copyright (c) 2020 Apoorv Saxena; Licensed MIT */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});
$(document).ready(function () {
    // const filteredEmailFields = $('[data-validation="emailaddress"]').not('.emailAuto, .emailFooter, .emailAddress');
    const filteredEmailFields = $('[data-validation="emailaddress"], [data-validation="emailaddressCustom"]').not('.emailAuto, .emailFooter, .emailAddress');


    // Append the ul to each email field's parent
    filteredEmailFields.each(function (index) {
        let ul = $('<ul>', {
            id: 'autoEmailSuggestionList-' + index,
            class: 'autoEmailSuggestionList',
            css: { display: 'none' }
        });
        const email = $(this);
        const parent = email.parent();
        // Check if the parent has position set to relative or if it has no position property
        const position = parent.css('position');
        if (position !== 'relative') {
            parent.css({ position: 'relative' });
        }

        $(this).closest(".modal-dialog").css({ "overflow": "unset" });
        $(this).closest(".modal-content").css({ "border-radius": "10px" });

        parent.append(ul);

    });

    filteredEmailFields.autoEmail([
        // "aol.com",
        // "facebook.com",
        "gmail.com",
        // "googlemail.com",
        // "google.com",
        "hotmail.com",
        // "hotmail.com",
        // "mac.com",
        // "me.com",
        // "mail.com",
        // "msn.com",
        // "live.com",
        "rediff.com",
        "yahoo.com",
        "yahoo.co.in"
    ]);
});

(function ($) {
    $.fn.autoEmail = function (domains) {
        return this.each(function (index) {
            var $this = $(this);
            var $suggestionList = $('#autoEmailSuggestionList-' + index);

            function addListeners() {
                var $results = $suggestionList.find('li');
                $results.first().addClass("highlighted");
                $results.click(function () {
                    $this.val($(this).text());
                    $this.focus();
                    $suggestionList.hide();
                    $this.trigger('input');
                });
                $results.mouseenter(function () {
                    $(this).addClass("highlighted");
                    $(this).siblings().removeClass("highlighted");
                });

                $suggestionList.show();
            }

            // check for autocomplete after each key
            $this.keyup(function (e) {
                if (e.keyCode == 40 || e.keyCode == 38) {
                    // if user clicks down or up arrow
                    var $highlighted = $suggestionList.find('.highlighted');
                    var $newHighlight;
                    if (e.keyCode == 40) {
                        // down arrow
                        $newHighlight = $highlighted.next();
                        if (!$newHighlight.length) {
                            $newHighlight = $suggestionList.find('li').first();
                        }
                    } else if (e.keyCode == 38) {
                        // up arrow
                        $newHighlight = $highlighted.prev();
                        if (!$newHighlight.length) {
                            $newHighlight = $suggestionList.find('li').last();
                        }
                    }
                    $highlighted.removeClass("highlighted");
                    $newHighlight.addClass("highlighted");
                }
                else if (e.keyCode == 13) {
                    var $selected = $suggestionList.find('.highlighted');
                    if ($selected.length && $suggestionList.is(':visible')) {
                        $this.val($selected.text());
                        $suggestionList.hide();
                        $this.trigger('input');
                        e.preventDefault();
                    }
                }

                else {
                    var exactMatches = [];
                    var errorMatches = [];

                    $suggestionList.empty();
                    $suggestionList.hide();

                    // get substring to try appending with autocomplete email
                    var emailsDirty = $(this).val().split("@");
                    if (emailsDirty.length < 2 || emailsDirty[0] == "") {
                        return;
                    }
                    var emailDomain = emailsDirty[1]; //get the text after @

                    if (emailDomain.length === 0) {
                        exactMatches.push(
                            // domains[1],
                            // domains[2],
                            // domains[5],
                            // domains[6],
                            // domains[12]
                            ...domains
                        );
                    } else {
                        for (var i = 0; i < domains.length; i++) {
                            var testString = domains[i].substr(0, emailDomain.length);
                            if (emailDomain === testString) {
                                exactMatches.push(domains[i]);
                            } else if (
                                getEditDistance(emailDomain, testString) < 2 &&
                                emailDomain.length > 1
                            ) {
                                errorMatches.push(domains[i]);
                            }
                        }
                    }

                    if (exactMatches.length > 0) {
                        for (var i = 0; i < exactMatches.length; i++) {
                            // take first domain match for autocomplete
                            var subStr = exactMatches[i].substr(
                                emailDomain.length,
                                exactMatches[i].length
                            );

                            // insert exact match into list
                            $suggestionList.append(
                                "<li class='emailSuggestionListItem'>" + $this.val() + "<span class='suggestion-end'>" + subStr + "</span></li>"
                            );
                        }
                        addListeners();
                    }
                    // else if (errorMatches.length > 0) {
                    //     for (var i = 0; i < errorMatches.length; i++) {
                    //         // take first domain match for autocomplete
                    //         var subStr = errorMatches[i].substr(
                    //             emailDomain.length,
                    //             errorMatches[i].length
                    //         );

                    //         // insert error corrected match into list
                    //         $suggestionList.append(
                    //             "<li>" + emailsDirty[0] + "@<b>" + errorMatches[i] + "</b></li>"
                    //         );
                    //     }
                    //     addListeners();
                    // }
                    // } 
                }
            });

            // Prevent form submission on enter key when suggestion list is visible
            $this.on('keydown', function (e) {
                if (e.keyCode == 13 && $suggestionList.is(':visible')) {
                    e.preventDefault();
                }
            });

            // Hide suggestion list when clicking outside
            $(document).on('click', function (e) {
                if (!$(e.target).closest($this).length && !$(e.target).closest($suggestionList).length) {
                    $suggestionList.hide();
                }
            });
        });
    };
})(jQuery);

// Compute the edit distance between the two given strings
function getEditDistance(a, b) {
    if (a.length === 0) return b.length;
    if (b.length === 0) return a.length;

    var matrix = [];

    // increment along the first column of each row
    var i;
    for (i = 0; i <= b.length; i++) {
        matrix[i] = [i];
    }

    // increment each column in the first row
    var j;
    for (j = 0; j <= a.length; j++) {
        matrix[0][j] = j;
    }

    // Fill in the rest of the matrix
    for (i = 1; i <= b.length; i++) {
        for (j = 1; j <= a.length; j++) {
            if (b.charAt(i - 1) == a.charAt(j - 1)) {
                matrix[i][j] = matrix[i - 1][j - 1];
            } else {
                matrix[i][j] = Math.min(
                    matrix[i - 1][j - 1] + 1, // substitution
                    Math.min(
                        matrix[i][j - 1] + 1, // insertion
                        matrix[i - 1][j] + 1
                    )
                ); // deletion
            }
        }
    }

    return matrix[b.length][a.length];
}


const upperCaseInputs = document.querySelector('[data-transFormUppercase="uppercase"]');
if (upperCaseInputs) {
upperCaseInputs.addEventListener('input', function() {
  const uppercasedValue = this.value.toUpperCase(); 
  this.value = uppercasedValue; 
  console.log(uppercasedValue); 
});
}
